import{r as i,j as e,I as Ir,C as Qt,a2 as yt,a as U,az as Xt,O as bt,au as Ye,e as V,_ as Ze,x as Je,aA as Or,c as Ur,H as Hr,V as Ve,as as qe,aB as zt,ab as pt,a0 as Re,S as Wt,X as Ke,q as Br,Q as Gt,g as Vt,P as Kt,W as zr,am as Wr,ay as Gr,aa as A}from"./vendor-react-HyG-4ult.js";import{l as ee,h as te,n as be,C as er,A as u,u as Vr,L as Kr,B as q,d as gt}from"./index-wG_3VDbk.js";import{a as Jr}from"./useCategories-CEMBLaj6.js";import{m as De}from"./messagingService-CJG5b0WI.js";import{D as Yr}from"./DataTable-BqJsQkYC.js";import{m as ft}from"./vendor-motion-t1viSSsG.js";import{M as ce}from"./Modal-DWzFJ5g3.js";import{B as _e}from"./Badge-CcjDYO0u.js";import{A as xt}from"./Avatar-Q1Avxq2U.js";const fe={submitRequest:async p=>{try{const o=await ee.post("/employer/request",p);return{success:!0,data:o.data.request,message:o.data.message}}catch(o){if(o.response?.data){const{data:s}=o.response;if(s.details&&Array.isArray(s.details))return{success:!1,error:s.details.map(c=>`${c.field}: ${c.message}`).join(", ")};if(s.error)return{success:!1,error:s.error};if(s.message)return{success:!1,error:s.message}}return{success:!1,error:te(o,{context:"submit_employer_request"}).userMessage}}},getAllRequests:async(p={})=>{try{const{page:o=1,limit:n=10,status:s,priority:d,search:c,sortBy:b,sortOrder:h,category:S,dateFrom:y,dateTo:Y,...W}=p,f=new URLSearchParams({page:o.toString(),limit:n.toString(),...W});s&&f.append("status",s),d&&f.append("priority",d),c&&f.append("search",c),b&&f.append("sortBy",b),h&&f.append("sortOrder",h),S&&f.append("category",S),y&&f.append("dateFrom",y),Y&&f.append("dateTo",Y);const T=await ee.get(`/employer/requests?${f}`,{headers:be()});return{success:!0,data:{requests:T.data.requests||[],pagination:T.data.pagination||{page:parseInt(o),limit:parseInt(n),total:0,totalPages:1}}}}catch(o){return o.response?.data?.error?{success:!1,error:o.response.data.error}:{success:!1,error:te(o,{context:"get_all_employer_requests"}).userMessage}}},getRequestById:async p=>{try{return{success:!0,data:(await ee.get(`/employer/requests/${p}`,{headers:be()})).data}}catch(o){return o.response?.data?.error?{success:!1,error:o.response.data.error}:{success:!1,error:te(o,{context:"get_employer_request_by_id"}).userMessage}}},replyToRequest:async(p,o)=>{try{const n=await ee.post(`/employer/requests/${p}/reply`,o,{headers:be()});return{success:!0,data:n.data.messageData,message:n.data.message}}catch(n){if(n.response?.data){const{data:d}=n.response;if(d.details&&Array.isArray(d.details))return{success:!1,error:d.details.map(b=>`${b.field}: ${b.message}`).join(", ")};if(d.error)return{success:!1,error:d.error};if(d.message)return{success:!1,error:d.message}}return{success:!1,error:te(n,{context:"reply_to_employer_request"}).userMessage}}},selectJobSeeker:async(p,o,n="picture")=>{try{const s=await ee.post(`/employer/requests/${p}/select`,{selectedUserId:o,detailsType:n},{headers:be()});return{success:!0,data:s.data.request,message:s.data.message}}catch(s){if(s.response?.data){const{data:c}=s.response;if(c.details&&Array.isArray(c.details))return{success:!1,error:c.details.map(h=>`${h.field}: ${h.message}`).join(", ")};if(c.error)return{success:!1,error:c.error};if(c.message)return{success:!1,error:c.message}}return{success:!1,error:te(s,{context:"select_job_seeker_for_request"}).userMessage}}},updateRequestStatus:async(p,o)=>{try{const n=await ee.put(`/employer/requests/${p}/status`,o,{headers:be()});return{success:!0,data:n.data.request,message:n.data.message}}catch(n){if(n.response?.data){const{data:d}=n.response;if(d.details&&Array.isArray(d.details))return{success:!1,error:d.details.map(b=>`${b.field}: ${b.message}`).join(", ")};if(d.error)return{success:!1,error:d.error};if(d.message)return{success:!1,error:d.message}}return{success:!1,error:te(n,{context:"update_request_status"}).userMessage}}},getRequestStatistics:async()=>{try{const p=await ee.get("/admin/dashboard/stats",{headers:be()});return{success:!0,data:{totalRequests:p.data.overview?.totalEmployerRequests||0,pendingRequests:p.data.overview?.pendingEmployerRequests||0,recentRequests:p.data.recentActivity?.recentEmployerRequests||[],requestDistribution:p.data.distributions?.employerRequests||[]}}}catch(p){return p.response?.data?.error?{success:!1,error:p.response.data.error}:{success:!1,error:te(p,{context:"get_request_statistics"}).userMessage}}},getPublicConversation:async(p,o)=>{try{return{success:!0,data:(await ee.get(`/public/employer/requests/${p}`,{params:{email:o}})).data}}catch(n){return n.response?.data?.error?{success:!1,error:n.response.data.error}:{success:!1,error:te(n,{context:"get_public_conversation"}).userMessage}}},replyAsEmployer:async(p,o,n)=>{try{const s=await ee.post(`/public/employer/requests/${p}/reply`,{...n,email:o});return{success:!0,data:s.data.messageData,message:s.data.message}}catch(s){if(s.response?.data){const{data:c}=s.response;if(c.details&&Array.isArray(c.details))return{success:!1,error:c.details.map(h=>`${h.field}: ${h.message}`).join(", ")};if(c.error)return{success:!1,error:c.error};if(c.message)return{success:!1,error:c.message}}return{success:!1,error:te(s,{context:"reply_as_employer"}).userMessage}}}},tr=(p={})=>{const{autoFetch:o=!0,includeAdmin:n=!1,itemsPerPage:s=10}=p,[d,c]=i.useState([]),[b,h]=i.useState(!1),[S,y]=i.useState(null),[Y,W]=i.useState(null),[f,T]=i.useState(1),[r,$]=i.useState(1),[je,Ne]=i.useState(0),[ne,re]=i.useState({}),[D,oe]=i.useState(""),[H,de]=i.useState({}),[L,ve]=i.useState("createdAt"),[E,Fe]=i.useState("desc"),_=i.useCallback(async(x=f,g=D,N=H,w={field:L,order:E})=>{if(n){h(!0),y(null);try{const C={page:x,limit:s,search:g,sortBy:w.field,sortOrder:w.order,...N},B=await fe.getAllRequests(C);B.success?(c(B.data.requests||[]),$(B.data.pagination?.totalPages||1),Ne(B.data.pagination?.total||0),T(B.data.pagination?.page||1),re(B.data.pagination||{})):y(B.error||"Failed to fetch requests")}catch(C){y("An error occurred while fetching requests"),console.error("Error fetching requests:",C)}finally{h(!1)}}},[n,s,f,D,H,L,E]),me=i.useCallback(async x=>{h(!0),y(null);try{const g=await fe.submitRequest(x);return g.success?{success:!0,data:g.data}:(y(g.error||"Failed to submit request"),{success:!1,error:g.error})}catch{const N="An error occurred while submitting request";return y(N),{success:!1,error:N}}finally{h(!1)}},[]),jt=i.useCallback(async x=>{if(!n||!x)return null;h(!0),y(null);try{const g=await fe.getRequestById(x);return g.success?(W(g.data),{success:!0,data:g.data}):(y(g.error||"Failed to fetch request"),{success:!1,error:g.error})}catch{const N="An error occurred while fetching request";return y(N),{success:!1,error:N}}finally{h(!1)}},[n]),we=i.useCallback(async(x,g)=>{if(!n)return{success:!1,error:"Unauthorized"};h(!0),y(null);try{const N=await fe.replyToRequest(x,g);return N.success?(await _(),{success:!0,data:N.data}):(y(N.error||"Failed to reply to request"),{success:!1,error:N.error})}catch{const w="An error occurred while replying to request";return y(w),{success:!1,error:w}}finally{h(!1)}},[n,_]),ue=i.useCallback(async(x,g,N="picture")=>{if(!n)return{success:!1,error:"Unauthorized"};h(!0),y(null);try{const w=await fe.selectJobSeeker(x,g,N);return w.success?(await _(),{success:!0,data:w.data}):(y(w.error||"Failed to send candidate information"),{success:!1,error:w.error})}catch{const C="An error occurred while sending candidate information";return y(C),{success:!1,error:C}}finally{h(!1)}},[n,_]),Ee=i.useCallback(async(x,g)=>{if(!n)return{success:!1,error:"Unauthorized"};h(!0),y(null);try{const N=await fe.updateRequestStatus(x,g);return N.success?(await _(),{success:!0,data:N.data}):(y(N.error||"Failed to update request status"),{success:!1,error:N.error})}catch{const w="An error occurred while updating request status";return y(w),{success:!1,error:w}}finally{h(!1)}},[n,_]),se=i.useCallback(x=>{T(x),_(x,D,H,{field:L,order:E})},[_,D,H,L,E]),pe=i.useCallback(()=>{f<r&&se(f+1)},[f,r,se]),Nt=i.useCallback(()=>{f>1&&se(f-1)},[f,se]),Te=i.useMemo(()=>f<r,[f,r]),vt=i.useMemo(()=>f>1,[f]),$e=i.useCallback(x=>{oe(x),T(1)},[]),le=i.useCallback((x,g)=>{const N={...H,[x]:g};de(N),T(1)},[H]),ke=i.useCallback((x,g)=>{ve(x),Fe(g)},[]),ge=i.useCallback(()=>{_(f,D,H,{field:L,order:E})},[_,f,D,H,L,E]);i.useEffect(()=>{n&&ge()},[ge,n]);const I=i.useCallback(x=>{W(x)},[]),Ce=i.useCallback(()=>{W(null)},[]),Qe=i.useMemo(()=>d.filter(x=>!0),[d]);return i.useEffect(()=>{o&&n&&_()},[_,o,n]),i.useEffect(()=>{y(null)},[Y]),{requests:Qe,selectedRequest:Y,loading:b,error:S,currentPage:f,totalPages:r,totalItems:je,pageInfo:ne,hasNextPage:Te,hasPrevPage:vt,searchTerm:D,filters:H,sortBy:L,sortOrder:E,fetchRequests:_,submitRequest:me,getRequestById:jt,replyToRequest:we,selectJobSeekerForRequest:ue,updateRequestStatus:Ee,goToPage:se,nextPage:pe,prevPage:Nt,setSearchTerm:$e,setFilters:le,setSortBy:x=>ke(x,E),setSortOrder:x=>ke(L,x),applyFilters:ge,selectRequest:I,clearSelection:Ce,hasRequests:d.length>0,requestsCount:d.length,isAdmin:n}},ms=(p={})=>tr({...p,includeAdmin:!0}),Zr=({title:p,value:o,change:n,changeType:s="increase",icon:d,color:c,bgColor:b,description:h,index:S=0,trendPeriod:y="7 days",showTrend:Y=!0,loading:W=!1})=>e.jsx(ft.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:S*.1},children:e.jsxs(er,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`w-12 h-12 ${b} rounded-lg flex items-center justify-center`,children:e.jsx(d,{className:`w-6 h-6 ${c}`})}),Y&&n&&!W&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`flex items-center space-x-1 text-sm ${s==="increase"?"text-green-600":s==="decrease"?"text-red-600":"text-gray-500"}`,children:[s==="increase"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 17l9.2-9.2M17 17V7H7"})}):s==="decrease"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 7l-9.2 9.2M7 7v10h10"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14"})}),e.jsx("span",{children:n})]}),e.jsxs("div",{className:"group relative",children:[e.jsx(Ir,{className:"w-3 h-3 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute bottom-full right-0 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:["Trend based on last ",y]})]})]})]}),e.jsx("div",{children:W?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-1/2"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:o}),e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:p}),e.jsx("p",{className:"text-xs text-gray-500",children:h})]})})]})}),Qr=p=>{switch(p?.toLowerCase()){case"pending":return"text-orange-600 bg-orange-50 border-orange-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"approved":return"text-green-600 bg-green-50 border-green-200";case"completed":return"text-purple-600 bg-purple-50 border-purple-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";case"rejected":return"text-red-600 bg-red-50 border-red-200";case"active":return"text-green-600 bg-green-50 border-green-200";case"inactive":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},us=p=>{switch(p?.toLowerCase()){case"pending":return"Pending";case"in_progress":return"In Progress";case"approved":return"Approved";case"completed":return"Completed";case"cancelled":return"Cancelled";case"rejected":return"Rejected";case"active":return"Active";case"inactive":return"Inactive";default:return p||"Unknown"}},Jt=p=>{switch(p){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-orange-600 bg-orange-50 border-orange-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},ps=p=>{switch(p){case"JavaScript":return"text-blue-600 bg-blue-50 border-blue-200";case"React":return"text-cyan-600 bg-cyan-50 border-cyan-200";case"Python":return"text-green-600 bg-green-50 border-green-200";case"Java":return"text-orange-600 bg-orange-50 border-orange-200";case"Cooking":return"text-red-600 bg-red-50 border-red-200";case"Housekeeping":return"text-purple-600 bg-purple-50 border-purple-200";case"Childcare":return"text-pink-600 bg-pink-50 border-pink-200";case"Gardening":return"text-emerald-600 bg-emerald-50 border-emerald-200";case"Cleaning":return"text-gray-600 bg-gray-50 border-gray-200";case"Driving":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"Teaching":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"Nursing":return"text-rose-600 bg-rose-50 border-rose-200";case"Construction":return"text-amber-600 bg-amber-50 border-amber-200";case"Agriculture":return"text-lime-600 bg-lime-50 border-lime-200";case"domestic":return"text-blue-600 bg-blue-50 border-blue-200";case"care":return"text-pink-600 bg-pink-50 border-pink-200";case"food":return"text-orange-600 bg-orange-50 border-orange-200";case"maintenance":return"text-green-600 bg-green-50 border-green-200";case"sales":return"text-purple-600 bg-purple-50 border-purple-200";case"transport":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"Technology":return"text-blue-600 bg-blue-50 border-blue-200";case"Healthcare":return"text-green-600 bg-green-50 border-green-200";case"Education":return"text-purple-600 bg-purple-50 border-purple-200";case"Manufacturing":return"text-red-600 bg-red-50 border-red-200";case"Services":return"text-gray-600 bg-gray-50 border-gray-200";case"General":return"text-gray-600 bg-gray-50 border-gray-200";case"Job Seeker":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},Yt=(p,o)=>{o==="email"?window.open(`mailto:${p.email}`,"_blank"):o==="phone"&&window.open(`tel:${p.phone}`,"_blank")};class ht{static async getWorkflowNotifications(){try{const o=await fetch(`${u.BASE_URL}/notifications/workflow`,{headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching workflow notifications:",o),o}}static async markAsRead(o){try{const n=await fetch(`${u.BASE_URL}/notifications/${o}/read`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(n){throw console.error("Error marking notification as read:",n),n}}static async markAllAsRead(){try{const o=await fetch(`${u.BASE_URL}/notifications/mark-all-read`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error marking all notifications as read:",o),o}}static async createWorkflowNotification(o,n,s,d){try{const c=await fetch(`${u.BASE_URL}/notifications/workflow`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({type:o,message:n,requestId:s,status:d})});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);return await c.json()}catch(c){throw console.error("Error creating workflow notification:",c),c}}static async getNotificationCount(){try{const o=await fetch(`${u.BASE_URL}/notifications/count`,{headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching notification count:",o),o}}static async getUserNotifications(){try{const o=await fetch(`${u.BASE_URL}/notifications/user`,{headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching user notifications:",o),o}}static async getNotificationStats(){try{const o=await fetch(`${u.BASE_URL}/notifications/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching notification stats:",o),o}}}class R{static async approveRequest(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/approve`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error approving request:",s),s}}static async rejectRequest(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/reject`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error rejecting request:",s),s}}static async requestFirstPayment(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/request-first-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error requesting first payment:",s),s}}static async approveFirstPayment(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/approve-first-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error approving first payment:",s),s}}static async rejectFirstPayment(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/reject-first-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error rejecting first payment:",s),s}}static async requestSecondPayment(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/request-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error requesting second payment:",s),s}}static async approveFullDetailsRequest(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/approve-full-details-request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error approving full details request:",s),s}}static async rejectFullDetailsRequest(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/reject-full-details-request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error rejecting full details request:",s),s}}static async approveSecondPayment(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/approve-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error approving second payment:",s),s}}static async rejectSecondPayment(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/reject-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error rejecting second payment:",s),s}}static async updateCandidateAvailability(o,n=""){try{const s=await fetch(`${u.BASE_URL}/admin/employer-requests/${o}/update-candidate-availability`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error updating candidate availability:",s),s}}static async requestFullDetails(o,n=""){try{const s=await fetch(`${u.BASE_URL}/employer/requests/${o}/request-full-details`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:n})});if(!s.ok){const c=await s.json();throw new Error(c.error||`HTTP error! status: ${s.status}`)}return await s.json()}catch(s){throw console.error("Error requesting full details:",s),s}}static async markHiringDecision(o,n,s=""){try{const d=await fetch(`${u.BASE_URL}/employer/requests/${o}/mark-${n}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({decision:n,notes:s})});if(!d.ok){const b=await d.json();throw new Error(b.error||`HTTP error! status: ${d.status}`)}return await d.json()}catch(d){throw console.error("Error marking hiring decision:",d),d}}static async getPhotoAccess(o){try{const n=await fetch(`${u.BASE_URL}/employer/requests/${o}/photo-access`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!n.ok){const d=await n.json();throw new Error(d.error||`HTTP error! status: ${n.status}`)}return await n.json()}catch(n){throw console.error("Error getting photo access:",n),n}}static async getFullDetails(o){try{const n=await fetch(`${u.BASE_URL}/employer/requests/${o}/full-details`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(!n.ok){const d=await n.json();throw new Error(d.error||`HTTP error! status: ${n.status}`)}return await n.json()}catch(n){throw console.error("Error getting full details:",n),n}}}const Zt=({status:p,className:o=""})=>{const s=(d=>{switch(d){case"pending":return{icon:e.jsx(Ze,{className:"w-5 h-5"}),color:"text-yellow-600",bgColor:"bg-yellow-100",label:"Pending Review",description:"Request is waiting for admin approval"};case"approved":return{icon:e.jsx(U,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Approved",description:"Request approved, payment required"};case"first_payment_required":return{icon:e.jsx(Ye,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"First Payment Required",description:"Pay 5,000 RWF for photo access"};case"first_payment_confirmed":return{icon:e.jsx(U,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"Payment Confirmed",description:"Waiting for admin approval"};case"photo_access_granted":return{icon:e.jsx(V,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Photo Access Granted",description:"You can view candidate photo"};case"full_details_requested":return{icon:e.jsx(bt,{className:"w-5 h-5"}),color:"text-purple-600",bgColor:"bg-purple-100",label:"Full Details Requested",description:"Waiting for admin approval"};case"second_payment_required":return{icon:e.jsx(Ye,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"Second Payment Required",description:"Pay for full details access"};case"second_payment_confirmed":return{icon:e.jsx(U,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"Second Payment Confirmed",description:"Waiting for admin approval"};case"full_access_granted":return{icon:e.jsx(bt,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Full Access Granted",description:"You can view all candidate details"};case"hiring_decision_made":return{icon:e.jsx(Xt,{className:"w-5 h-5"}),color:"text-purple-600",bgColor:"bg-purple-100",label:"Hiring Decision Made",description:"Waiting for admin to update availability"};case"completed":return{icon:e.jsx(U,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Completed",description:"Request completed successfully"};case"cancelled":return{icon:e.jsx(yt,{className:"w-5 h-5"}),color:"text-red-600",bgColor:"bg-red-100",label:"Cancelled",description:"Request was cancelled"};default:return{icon:e.jsx(Qt,{className:"w-5 h-5"}),color:"text-gray-600",bgColor:"bg-gray-100",label:"Unknown Status",description:"Status not recognized"}}})(p);return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${s.bgColor} ${s.color} ${o}`,children:[s.icon,e.jsx("span",{children:s.label})]})},Xr=({currentStatus:p,className:o=""})=>{const n=[{id:"pending",label:"Request Submitted",icon:e.jsx(Je,{className:"w-5 h-5"}),description:"Request submitted and waiting for admin review"},{id:"approved",label:"Request Approved",icon:e.jsx(U,{className:"w-5 h-5"}),description:"Admin approved the request"},{id:"first_payment_required",label:"First Payment",icon:e.jsx(Ye,{className:"w-5 h-5"}),description:"Pay 5,000 RWF for photo access"},{id:"photo_access_granted",label:"Photo Access",icon:e.jsx(V,{className:"w-5 h-5"}),description:"View candidate photo and basic info"},{id:"second_payment_required",label:"Second Payment",icon:e.jsx(Ye,{className:"w-5 h-5"}),description:"Pay for full details access"},{id:"full_access_granted",label:"Full Access",icon:e.jsx(bt,{className:"w-5 h-5"}),description:"View all candidate details"},{id:"hiring_decision_made",label:"Hiring Decision",icon:e.jsx(Xt,{className:"w-5 h-5"}),description:"Mark candidate as hired or not hired"},{id:"completed",label:"Completed",icon:e.jsx(U,{className:"w-5 h-5"}),description:"Request completed successfully"}],s=b=>{const h=["pending","approved","first_payment_required","first_payment_confirmed","photo_access_granted","full_details_requested","second_payment_required","second_payment_confirmed","full_access_granted","hiring_decision_made","completed"],S=h.indexOf(p),y=h.indexOf(b);return S===-1||y===-1?"pending":y<S?"completed":y===S?"current":"pending"},d=(b,h)=>h==="completed"?e.jsx(U,{className:"w-5 h-5 text-green-600"}):h==="current"?e.jsx(Ze,{className:"w-5 h-5 text-blue-600"}):e.jsx(Or,{className:"w-5 h-5 text-gray-400"}),c=b=>{switch(b){case"completed":return"text-green-600 bg-green-50 border-green-200";case"current":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-400 bg-gray-50 border-gray-200"}};return e.jsxs("div",{className:`space-y-4 ${o}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Request Progress"}),e.jsx("div",{className:"space-y-3",children:n.map((b,h)=>{const S=s(b.id),y=h===n.length-1;return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full border-2 flex items-center justify-center ${c(S)}`,children:d(b,S)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:`text-sm font-medium ${S==="current"?"text-blue-900":S==="completed"?"text-green-900":"text-gray-500"}`,children:b.label}),S==="current"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Current"})]}),e.jsx("p",{className:`text-sm mt-1 ${S==="current"?"text-blue-700":S==="completed"?"text-green-700":"text-gray-400"}`,children:b.description})]}),!y&&e.jsx("div",{className:"absolute left-5 top-10 w-0.5 h-8 bg-gray-200"})]},b.id)})})]})},es=({stats:p,className:o=""})=>e.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 ${o}`,children:p.map((n,s)=>e.jsx(Zr,{...n,index:s},n.title))}),ts=()=>{const{t:p}=Ur(),{user:o}=Vr(),{requests:n,loading:s,error:d,goToPage:c,applyFilters:b,replyToRequest:h,selectJobSeekerForRequest:S,updateRequestStatus:y}=tr({includeAdmin:!0}),{categories:Y,loadingCategories:W,fetchCategories:f}=Jr(),T={status:[{value:"",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"first_payment_required",label:"First Payment Required"},{value:"first_payment_confirmed",label:"First Payment Confirmed"},{value:"photo_access_granted",label:"Photo Access Granted"},{value:"full_details_requested",label:"Full Details Requested"},{value:"second_payment_required",label:"Second Payment Required"},{value:"second_payment_confirmed",label:"Second Payment Confirmed"},{value:"full_access_granted",label:"Full Access Granted"},{value:"hiring_decision_made",label:"Hiring Decision Made"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"},{value:"payment_required",label:"Payment Required (Legacy)"},{value:"payment_confirmed",label:"Payment Confirmed (Legacy)"}],priority:[{value:"",label:"All Priorities"},{value:"urgent",label:"Urgent"},{value:"high",label:"High"},{value:"normal",label:"Normal"},{value:"low",label:"Low"}],category:[{value:"",label:"All Categories"},...(Y||[]).map(t=>({value:t.name_en.toLowerCase(),label:t.name_en}))],dateRange:[{value:"",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"}],monthlyRateRange:[{value:"",label:"All Rates"},{value:"0-50000",label:"0 - 50,000 frw"},{value:"50000-100000",label:"50,000 - 100,000 frw"},{value:"100000-200000",label:"100,000 - 200,000 frw"},{value:"200000+",label:"200,000+ frw"}]},[r,$]=i.useState(null),[je,Ne]=i.useState(!1),[ne,re]=i.useState(!1),[D,oe]=i.useState(null),[H,de]=i.useState(""),[L,ve]=i.useState(""),[E,Fe]=i.useState(!1),[_,me]=i.useState(""),[jt,we]=i.useState(null),[ue,Ee]=i.useState(!1),[se,pe]=i.useState(""),[Nt,Te]=i.useState(!1),[vt,$e]=i.useState("picture"),[le,ke]=i.useState(!1),[ge,I]=i.useState(!1),[Ce,Qe]=i.useState(null),[x,g]=i.useState(!1),[N,w]=i.useState(""),[C,B]=i.useState(""),[wt,Le]=i.useState(""),[Me,Xe]=i.useState(""),[rr,kt]=i.useState({}),[Ct,Se]=i.useState([]),[Ie,St]=i.useState(!1),[z,Pe]=i.useState(0),[sr,Pt]=i.useState(!1),[Oe,et]=i.useState(!1),[At,Ae]=i.useState([]),[Ue,He]=i.useState(""),[Be,ze]=i.useState(!1),[qt,xe]=i.useState(""),[Rt,tt]=i.useState(!1),[ar,nr]=i.useState([]),[rt,Dt]=i.useState(!1),[_t,ie]=i.useState(""),[k,K]=i.useState({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),[Ft,st]=i.useState(!1),[at,Et]=i.useState(!1),[Tt,ae]=i.useState(""),[O,he]=i.useState({action:"approve",notes:""}),[or,We]=i.useState(!1),[Z,Ge]=i.useState(""),[P,$t]=i.useState({status:"",priority:"",category:"",dateRange:"",monthlyRateRange:""}),[nt,lr]=i.useState(!1),[ir,Lt]=i.useState(!1),F=i.useCallback(()=>{re(!1),oe(null),$(null),ve(""),de(""),me(""),Xe(""),Le(""),we(null),pe(""),Ne(!1),et(!1),Ae([]),He(""),xe(""),ie(""),tt(!1),K({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),ie(""),st(!1),he({action:"approve",notes:""}),ae(""),We(!1)},[]),cr=async t=>{try{$(t),et(!0),ze(!0),xe("");const a=await De.getMessagesByRequest(t.id);Ae(a.messages||[])}catch(a){console.error("Error opening messaging:",a),xe("Failed to load messages"),A.error("Failed to load messages")}finally{ze(!1)}},dr=()=>{et(!1),Ae([]),He(""),xe("")},Mt=async()=>{if(!(!Ue.trim()||!r))try{ze(!0),xe(""),await De.sendMessage(r.id,{content:Ue.trim(),messageType:"text"}),He("");const t=await De.getMessagesByRequest(r.id);Ae(t.messages||[]),A.success("Message sent successfully")}catch(t){console.error("Error sending message:",t),xe("Failed to send message"),A.error("Failed to send message")}finally{ze(!1)}},mr=async()=>{if(r)try{await De.markMessagesAsRead(r.id);const t=await De.getMessagesByRequest(r.id);Ae(t.messages||[])}catch(t){console.error("Error marking messages as read:",t)}};i.useEffect(()=>{Oe&&r&&mr()},[Oe,r]);const It=async()=>{try{Pt(!0);const t=await ht.getWorkflowNotifications();Se(t.notifications||[]),Pe(t.unreadCount||0)}catch(t){console.error("Error fetching notifications:",t),Se([]),Pe(0)}finally{Pt(!1)}},ur=async t=>{try{await ht.markAsRead(t),Se(a=>a.map(l=>l.id===t?{...l,isRead:!0}:l)),Pe(a=>Math.max(0,a-1))}catch(a){console.error("Error marking notification as read:",a)}},pr=async()=>{try{await ht.markAllAsRead(),Se(t=>t.map(a=>({...a,isRead:!0}))),Pe(0)}catch(t){console.error("Error marking all notifications as read:",t)}},gr=(t,a,l,m)=>{const v={id:Date.now(),type:t,message:a,requestId:l,status:m,timestamp:new Date,isRead:!1};Se(J=>[v,...J]),Pe(J=>J+1),A.success(a,{duration:5e3,position:"top-right"})};i.useEffect(()=>{It();const t=setInterval(It,3e4);return()=>clearInterval(t)},[]),i.useEffect(()=>{const t=a=>{Ie&&!a.target.closest(".notification-dropdown")&&St(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[Ie]);const xr=async()=>{try{const a=await(await fetch(`${u.BASE_URL}/payment-methods/active`)).json();nr(a.paymentMethods||[])}catch(t){console.error("Error fetching payment methods:",t),A.error("Failed to load payment methods")}},hr=async t=>{$(t),tt(!0),K({amount:t.paymentAmount||"5000",currency:t.paymentCurrency||"RWF",description:t.paymentDescription||"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),await xr()},ot=()=>{tt(!1),K({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),ie("")},yr=async t=>{if(t.preventDefault(),!k.paymentMethodId||!k.amount){ie("Please select a payment method and enter amount");return}try{Dt(!0),ie("");const a=await fetch(`${u.BASE_URL}/payments/request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({employerRequestId:r.id,amount:k.amount,currency:k.currency,description:k.description,paymentMethodId:k.paymentMethodId,paymentType:k.paymentType,dueDate:k.dueDate||null})}),l=await a.json();a.ok?(A.success("Payment request sent successfully!"),ot(),M()):ie(l.error||"Failed to send payment request")}catch(a){console.error("Error sending payment request:",a),ie("Network error. Please try again.")}finally{Dt(!1)}},br=async t=>{console.log("Opening request details modal for request:",t);try{We(!0);const a=await fetch(`${u.BASE_URL}/admin/employer-requests/${t.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(a.ok){const l=await a.json();console.log("Fetched full request data from backend:",l),console.log("Employer Account data:",l.employerAccount),console.log("Employer User data:",l.employerAccount?.user);const m=it(l);console.log("Transformed request data:",m),$(m)}else console.error("Failed to fetch full request data"),$(t)}catch(a){console.error("Error fetching request details:",a),$(t)}finally{We(!1)}Ne(!0)},fr=async t=>{console.log("Opening payment approval modal for request:",t),console.log("Request latestPayment:",t.latestPayment),console.log("Request _backendData:",t._backendData);try{const a=await fetch(`${u.BASE_URL}/admin/employer-requests/${t.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem(u.AUTH_CONFIG.tokenKey)}`}});if(a.ok){const l=await a.json();console.log("Fetched full request data from backend:",l);const m=it(l);console.log("Transformed request data:",m),$(m)}else console.error("Failed to fetch full request data"),$(t)}catch(a){console.error("Error fetching request details:",a),$(t)}st(!0),he({action:"approve",notes:""}),ae("")},lt=()=>{st(!1),he({action:"approve",notes:""}),ae("")},jr=async t=>{if(t.preventDefault(),!r){ae("No request selected");return}try{Et(!0),ae("");let a;const l=r.id;if(r.status==="first_payment_confirmed"||r.status==="payment_confirmed")O.action==="approve"?a=await R.approveFirstPayment(l,O.notes):a=await R.rejectFirstPayment(l,O.notes);else if(r.status==="second_payment_confirmed")O.action==="approve"?a=await R.approveSecondPayment(l,O.notes):a=await R.rejectSecondPayment(l,O.notes);else{ae("Invalid status for payment approval");return}if(a){const m=O.action==="approve"?"approved":"rejected";A.success(`Payment ${m} successfully!`),lt(),M()}else ae("Failed to process payment approval")}catch(a){console.error("Error processing payment approval:",a),ae(a.message||"Network error. Please try again.")}finally{Et(!1)}},Ot=i.useCallback(()=>{},[ne,D,r,je,L,H,Me]),it=t=>{if(!t)return null;try{const a=l=>{if(!l||l==="Not specified")return"Not specified";if(typeof l=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(l);if(typeof l=="string"){const m=parseFloat(l);return isNaN(m)?l:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(m)}return"Not specified"};return{id:t.id,employerName:t.employerAccount?.user?.name||t.employerAccount?.companyName||t.name||"Unknown",companyName:t.employerAccount?.companyName||t.companyName||"Private",candidateName:t.requestedCandidate&&`${t.requestedCandidate.profile?.firstName||""} ${t.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:t.requestedCandidate?.profile?.skills||"General",status:t.status||"pending",priority:t.priority||"normal",date:t.createdAt,monthlyRate:a(t.requestedCandidate?.profile?.monthlyRate),message:t.message||"",employerContact:{email:t.employerAccount?.user?.email||t.employerAccount?.email||t.email||"",phone:t.employerAccount?.phoneNumber||t.employerAccount?.user?.phoneNumber||t.phoneNumber||""},employerDetails:{companyAddress:t.employerAccount?.companyAddress||"",industry:t.employerAccount?.industry||"",companySize:t.employerAccount?.companySize||"",website:t.employerAccount?.website||"",description:t.employerAccount?.description||"",establishedYear:t.employerAccount?.establishedYear||"",contactPerson:t.employerAccount?.contactPerson||""},adminNotes:"",lastContactDate:t.updatedAt,isCompleted:t.status==="completed",category:t.requestedCandidate?.profile?.jobCategory?.name_en||"General",latestPayment:t.payments&&t.payments.length>0?{id:t.payments[0].id,amount:t.payments[0].amount,currency:t.payments[0].currency||"RWF",paymentType:t.payments[0].paymentType,status:t.payments[0].status,confirmationName:t.payments[0].confirmationName,confirmationPhone:t.payments[0].confirmationPhone,confirmationDate:t.payments[0].confirmationDate,paymentReference:t.payments[0].paymentReference,adminNotes:t.payments[0].adminNotes,createdAt:t.payments[0].createdAt,updatedAt:t.payments[0].updatedAt}:null,candidateExperience:t.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:t.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:t.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:t.requestedCandidate?.profile?.location||"Not specified",candidateCity:t.requestedCandidate?.profile?.city||"Not specified",candidateCountry:t.requestedCandidate?.profile?.country||"Not specified",candidateContact:t.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:t.requestedCandidate?.email||"Not specified",candidateLanguages:t.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:t.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:t.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:t.requestedCandidate?.profile?.description||"Not specified",candidateGender:t.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:t.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:t.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:t.requestedCandidate?.profile?.references||"Not specified",_backendData:t}}catch(a){return console.error("Error transforming request data:",a),{id:t?.id||"unknown",employerName:"Data unavailable",companyName:"Data unavailable",candidateName:"Data unavailable",position:"Data unavailable",status:"pending",priority:"normal",date:new Date,monthlyRate:"Data unavailable",message:"Data unavailable",employerContact:{email:"",phone:""},adminNotes:"",lastContactDate:new Date,isCompleted:!1,category:"Data unavailable",_backendData:t,_hasError:!0}}},ct=n.map(it).filter(Boolean),Q=ct.map(t=>t._hasError?{...t,employerName:"Data unavailable",companyName:"Data unavailable",candidateName:"Data unavailable",position:"Data unavailable",status:"pending",priority:"normal",monthlyRate:"Data unavailable",message:"Data unavailable",employerContact:{email:"",phone:""}}:{...t,employerName:t.employerName||"Unknown",companyName:t.companyName||"Private",candidateName:t.candidateName||"Not specified",position:t.position||"General",status:t.status||"pending",priority:t.priority||"normal",monthlyRate:t.monthlyRate||"Not specified",message:t.message||"",employerContact:{email:t.employerContact?.email||"",phone:t.employerContact?.phone||""}});Hr.useEffect(()=>{try{ct.forEach(t=>{const a=t._backendData?.requestedCandidate?.profile?.photo||t._backendData?.requestedCandidate?.photo||null})}catch(t){console.log("EmployerRequestsPage: debug logging error",t)}},[ct]);const Nr=[{key:"employerInfo",label:"Employer",sortable:!1,render:t=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(Gt,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.employerName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.companyName})]})]})},{key:"candidateInfo",label:"Candidate",sortable:!1,render:t=>{const a=t._backendData?.requestedCandidate,l=a?.profile?.photo||a?.photo||null,m=l?/^https?:\/\//i.test(l)?l:`${u.BASE_URL}/${l.replace(/^\//,"")}`:null;return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(xt,{src:m,alt:t.candidateName,size:"sm",fallback:t.candidateName,fallbackSrc:gt}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.candidateName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.position})]})]})}},{key:"category",label:"Category",sortable:!0,searchable:!0,type:"badge",badgeColor:t=>{switch(t?.toLowerCase()){case"domestic":return"text-blue-600 bg-blue-50 border-blue-200";case"care":return"text-pink-600 bg-pink-50 border-pink-200";case"food":return"text-orange-600 bg-orange-50 border-orange-200";case"maintenance":return"text-green-600 bg-green-50 border-green-200";case"transport":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"general":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}},{key:"monthlyRate",label:"Monthly Rate",sortable:!0,type:"text"},{key:"status",label:"Status",sortable:!0,type:"badge",badgeColor:Qr},{key:"priority",label:"Priority",sortable:!0,type:"badge",badgeColor:Jt},{key:"date",label:"Request Date",sortable:!0,type:"date"},{key:"actions",label:"Actions",sortable:!1,render:t=>e.jsxs("div",{className:"flex items-center gap-1",children:[ut(t).slice(0,4).map((a,l)=>{const m=a.icon,v=rr[`${a.key}-${t.id}`];return e.jsxs("button",{onClick:()=>dt(a.key,t),disabled:v,className:`relative group p-2 rounded-lg transition-all duration-200 hover:scale-110 ${a.className} border border-gray-200 hover:border-current ${v?"opacity-50 cursor-not-allowed":""}`,title:a.title,children:[v?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):e.jsx(m,{className:"w-4 h-4"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[v?"Processing...":a.title,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]},l)}),ut(t).length>4&&e.jsxs("button",{onClick:()=>dt("openActions",t),className:"relative group p-2 rounded-lg transition-all duration-200 hover:scale-110 text-gray-600 hover:bg-gray-50 border border-gray-200 hover:border-gray-400",title:"More actions",children:[e.jsx(Gr,{className:"w-4 h-4"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:["More actions",e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]})]})}];i.useEffect(()=>{f()},[f]),i.useEffect(()=>()=>{F()},[F]),i.useEffect(()=>{Ot()},[Ot]);const G=i.useMemo(()=>{let t=Q||[];if(Z.trim()){const a=Z.toLowerCase();t=t.filter(l=>l.employerName?.toLowerCase().includes(a)||l.companyName?.toLowerCase().includes(a)||l.candidateName?.toLowerCase().includes(a)||l.message?.toLowerCase().includes(a)||l.position?.toLowerCase().includes(a))}if(P.status&&(t=t.filter(a=>a.status===P.status)),P.priority&&(t=t.filter(a=>a.priority===P.priority)),P.category&&(t=t.filter(a=>a.category?.toLowerCase()===P.category.toLowerCase())),P.dateRange){const a=new Date,l=new Date(a.getFullYear(),a.getMonth(),a.getDate());t=t.filter(m=>{const v=new Date(m.date);switch(P.dateRange){case"today":return v>=l;case"week":const J=new Date(l.getTime()-10080*60*1e3);return v>=J;case"month":const $r=new Date(l.getTime()-720*60*60*1e3);return v>=$r;case"quarter":const Lr=new Date(l.getTime()-2160*60*60*1e3);return v>=Lr;case"year":const Mr=new Date(l.getTime()-365*24*60*60*1e3);return v>=Mr;default:return!0}})}return P.monthlyRateRange&&(t=t.filter(a=>{const l=a.monthlyRate;if(l==="Not specified")return!1;const m=typeof l=="string"?parseFloat(l.replace(/[^\d.]/g,"")):l;if(isNaN(m))return!1;switch(P.monthlyRateRange){case"0-50000":return m>=0&&m<=5e4;case"50000-100000":return m>5e4&&m<=1e5;case"100000-200000":return m>1e5&&m<=2e5;case"200000+":return m>2e5;default:return!0}})),t},[Q,Z,P]),vr=i.useCallback(t=>{Ge(t),Lt(!0);const a=setTimeout(()=>{Lt(!1)},300);return()=>clearTimeout(a)},[]),ye=i.useCallback((t,a)=>{$t(l=>({...l,[t]:a}))},[]),Ut=i.useCallback(()=>{$t({status:"",priority:"",category:"",dateRange:"",monthlyRateRange:""}),Ge("")},[]),X=i.useMemo(()=>{let t=0;return Z.trim()&&t++,Object.values(P).forEach(a=>{a&&t++}),t},[Z,P]),wr=i.useMemo(()=>[{title:"Total Requests",value:G.length.toString(),change:`+${G.length-(Q||[]).length}`,changeType:G.length>=(Q||[]).length?"increase":"decrease",icon:Ve,color:"text-blue-600",bgColor:"bg-blue-50",description:`${X>0?"Filtered":"All"} employer requests`},{title:"Pending Review",value:G.filter(t=>t.status==="pending").length.toString(),change:"+2",changeType:"increase",icon:Ze,color:"text-orange-600",bgColor:"bg-orange-50",description:"Awaiting admin approval"},{title:"Payment Pending",value:G.filter(t=>["first_payment_required","second_payment_required","first_payment_confirmed","second_payment_confirmed","payment_required","payment_confirmed"].includes(t.status)).length.toString(),change:"+1",changeType:"increase",icon:qe,color:"text-yellow-600",bgColor:"bg-yellow-50",description:"Payment processing"},{title:"Completed",value:G.filter(t=>t.status==="completed").length.toString(),change:"+3",changeType:"increase",icon:U,color:"text-green-600",bgColor:"bg-green-50",description:"Successfully closed"},{title:"Notifications",value:z.toString(),change:z>0?`${z} unread`:"All caught up",changeType:z>0?"increase":"neutral",icon:z>0?zt:pt,color:z>0?"text-orange-600":"text-gray-600",bgColor:z>0?"bg-orange-50":"bg-gray-50",description:"Workflow updates"}],[G,Q,X]),M=i.useCallback(()=>{c(1),b()},[c,b]),dt=(t,a)=>{switch($(a),de(a.adminNotes||""),t){case"openActions":re(!0),oe(null);break;case"view":br(a),re(!1);break;case"contact":Yt(a.employerContact,"email"),F();break;case"call":Yt(a.employerContact,"phone"),F();break;case"reply":oe("reply"),re(!0);break;case"message":cr(a);break;case"payment":hr(a);break;case"paymentApproval":fr(a);break;case"select":oe("select"),re(!0);break;case"approveRequest":j("approveRequest",a);break;case"rejectRequest":j("rejectRequest",a);break;case"requestFirstPayment":j("requestFirstPayment",a);break;case"viewPaymentDetails":j("viewPaymentDetails",a);break;case"approveFirstPayment":j("approveFirstPayment",a);break;case"rejectFirstPayment":j("rejectFirstPayment",a);break;case"requestSecondPayment":j("requestSecondPayment",a);break;case"viewPhotoAccess":j("viewPhotoAccess",a);break;case"approveFullDetailsRequest":j("approveFullDetailsRequest",a);break;case"rejectFullDetailsRequest":j("rejectFullDetailsRequest",a);break;case"approveSecondPayment":j("approveSecondPayment",a);break;case"rejectSecondPayment":j("rejectSecondPayment",a);break;case"viewFullDetails":j("viewFullDetails",a);break;case"waitForHiringDecision":j("waitForHiringDecision",a);break;case"reviewHiringDecision":j("reviewHiringDecision",a);break;case"updateCandidateAvailability":j("updateCandidateAvailability",a);break;case"viewCompletedRequest":j("viewCompletedRequest",a);break;case"start":mt("in_progress","Starting to process this request"),F();break;case"approve":mt("approved","Request approved and ready for completion"),F();break;case"complete":oe("complete"),re(!0);break;case"reactivate":mt("pending","Request reactivated and back to pending status"),F();break;default:console.warn("Unknown action:",t),F()}},mt=async(t,a)=>{if(r)try{const l=await y(r.id,{status:t,adminNotes:a});l.success?(A.success(`Request status updated to ${t}. ${a||""}`),M()):(console.error(" Failed to update status:",l.error),A.error(`Failed to update status: ${l.error}`))}catch(l){console.error(" Error updating status:",l),A.error("Network error. Please try again.")}},kr=async()=>{if(!(!r||!L.trim())){Fe(!0),me("");try{const t=await h(r.id,{content:L});if(t.success){const a=t.data.emailSent?`Reply sent successfully to ${r.employerName} at ${r.employerContact.email}`:"Reply saved but email delivery failed. Please check the email configuration.";A.success(a),ve(""),de(""),F(),M()}else console.error(" Reply failed:",t.error),me(t.error||"Failed to send reply")}catch(t){console.error(" Error sending reply:",t),me("Network error. Please try again.")}finally{Fe(!1)}}},Ht=async(t,a="picture")=>{if(r){Ee(!0),pe("");try{const l=await S(r.id,t,a);if(l.success){const m=a==="picture"?`Candidate profile picture sent to ${r.employerName}`:`Complete candidate details sent to ${r.employerName}`;A.success(m),F(),M()}else console.error(" Failed to send candidate information:",l.error),pe(l.error||"Failed to send candidate information")}catch(l){console.error(" Error sending candidate information:",l),pe("Network error. Please try again.")}finally{Ee(!1)}}},Cr=async()=>{if(r){ke(!0),Le("");try{const t=await y(r.id,{status:"completed",adminNotes:Me});t.success?(A.success(`Request completed successfully. ${Me?"Notes have been saved.":""}`),Xe(""),F(),M()):(console.error(" Failed to complete request:",t.error),Le(t.error||"Failed to complete request"))}catch(t){console.error(" Error completing request:",t),Le("Network error. Please try again.")}finally{ke(!1)}}},Sr=async()=>{if(r)try{g(!0),w("");const t=await R.requestFullDetails(r.id,C);t.message&&(A.success(t.message),I(!1),B(""),M())}catch(t){console.error("Error requesting full details:",t),w(t.message||"Failed to request full details")}finally{g(!1)}},Bt=async t=>{if(r)try{g(!0),w("");const a=await R.markHiringDecision(r.id,t,C);a.message&&(A.success(a.message),I(!1),B(""),M())}catch(a){console.error("Error marking hiring decision:",a),w(a.message||"Failed to mark hiring decision")}finally{g(!1)}},Pr=async()=>{if(r)try{g(!0),w("");const t=await R.getPhotoAccess(r.id);we(t),$e("photo"),Te(!0),I(!1)}catch(t){console.error("Error getting photo access:",t),w(t.message||"Failed to get photo access")}finally{g(!1)}},Ar=async()=>{if(r)try{g(!0),w("");const t=await R.getFullDetails(r.id);we(t),$e("full"),Te(!0),I(!1)}catch(t){console.error("Error getting full details:",t),w(t.message||"Failed to get full details")}finally{g(!1)}},qr=t=>({approveRequest:"Approve Request",rejectRequest:"Reject Request",requestFirstPayment:"Request First Payment",viewPaymentDetails:"View Payment Details",approveFirstPayment:"Approve First Payment",rejectFirstPayment:"Reject First Payment",requestSecondPayment:"Request Second Payment",viewPhotoAccess:"View Photo Access",approveFullDetailsRequest:"Approve Full Details Request",rejectFullDetailsRequest:"Reject Full Details Request",approveSecondPayment:"Approve Second Payment",rejectSecondPayment:"Reject Second Payment",viewFullDetails:"View Full Details",waitForHiringDecision:"Wait for Hiring Decision",reviewHiringDecision:"Review Hiring Decision",updateCandidateAvailability:"Update Candidate Availability",viewCompletedRequest:"View Completed Request",request_full_details:"Request Full Details",mark_hired:"Mark as Hired",mark_not_hired:"Mark as Not Hired",get_photo_access:"View Photo Access",get_full_details:"View Full Details"})[t]||"Workflow Action",Rr=t=>["approveRequest","rejectRequest","requestFirstPayment","approveFirstPayment","rejectFirstPayment","requestSecondPayment","approveFullDetailsRequest","rejectFullDetailsRequest","approveSecondPayment","rejectSecondPayment","updateCandidateAvailability","request_full_details","mark_hired","mark_not_hired"].includes(t)?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:Dr(t)}),e.jsx("textarea",{value:C,onChange:l=>B(l.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:_r(t)})]}):t.startsWith("view")||t==="reviewHiringDecision"||t==="waitForHiringDecision"?e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Information"}),e.jsx("p",{className:"text-blue-800 text-sm",children:Fr(t)})]}):null,Dr=t=>({approveRequest:"Approval Notes (Optional)",rejectRequest:"Rejection Reason (Required)",requestFirstPayment:"Payment Request Notes (Optional)",approveFirstPayment:"Approval Notes (Optional)",rejectFirstPayment:"Rejection Reason (Required)",requestSecondPayment:"Payment Request Notes (Optional)",approveFullDetailsRequest:"Approval Notes (Optional)",rejectFullDetailsRequest:"Rejection Reason (Required)",approveSecondPayment:"Approval Notes (Optional)",rejectSecondPayment:"Rejection Reason (Required)",updateCandidateAvailability:"Update Notes (Optional)",request_full_details:"Reason for requesting full details (optional)",mark_hired:"Notes about hiring decision (optional)",mark_not_hired:"Notes about not hiring (optional)"})[t]||"Notes (Optional)",_r=t=>({approveRequest:"Add any notes about approving this request...",rejectRequest:"Explain why this request is being rejected...",requestFirstPayment:"Add any notes about the payment request...",approveFirstPayment:"Add any notes about approving the first payment...",rejectFirstPayment:"Explain why the first payment is being rejected...",requestSecondPayment:"Add any notes about the second payment request...",approveFullDetailsRequest:"Add any notes about approving full details access...",rejectFullDetailsRequest:"Explain why full details access is being rejected...",approveSecondPayment:"Add any notes about approving the second payment...",rejectSecondPayment:"Explain why the second payment is being rejected...",updateCandidateAvailability:"Add any notes about updating candidate availability...",request_full_details:"Explain why you need full details...",mark_hired:"Add any notes about the hiring decision...",mark_not_hired:"Add any notes about why the candidate was not hired..."})[t]||"Add notes...",Fr=t=>({viewPaymentDetails:"View payment confirmation details and approve or reject the payment.",viewPhotoAccess:"View the photo access that has been granted to the employer.",viewFullDetails:"View the full details access that has been granted to the employer.",reviewHiringDecision:"Review the hiring decision made by the employer and update candidate availability.",waitForHiringDecision:"The employer has full access and should make a hiring decision soon.",viewCompletedRequest:"This request has been completed successfully."})[t]||"No additional information available.",Er=t=>({approveRequest:"Approving Request...",rejectRequest:"Rejecting Request...",requestFirstPayment:"Requesting Payment...",approveFirstPayment:"Approving Payment...",rejectFirstPayment:"Rejecting Payment...",requestSecondPayment:"Requesting Payment...",approveFullDetailsRequest:"Approving Full Details...",rejectFullDetailsRequest:"Rejecting Full Details...",approveSecondPayment:"Approving Payment...",rejectSecondPayment:"Rejecting Payment...",updateCandidateAvailability:"Updating Status...",request_full_details:"Requesting Details...",mark_hired:"Marking as Hired...",mark_not_hired:"Marking as Not Hired...",get_photo_access:"Loading Photo Access...",get_full_details:"Loading Full Details..."})[t]||"Processing...",Tr=t=>{const l={approveRequest:{text:"Approve Request",className:"bg-green-600 hover:bg-green-700",onClick:()=>j("approveRequest",r)},rejectRequest:{text:"Reject Request",className:"bg-red-600 hover:bg-red-700",onClick:()=>j("rejectRequest",r)},requestFirstPayment:{text:"Request First Payment",className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>j("requestFirstPayment",r)},approveFirstPayment:{text:"Approve First Payment",className:"bg-green-600 hover:bg-green-700",onClick:()=>j("approveFirstPayment",r)},rejectFirstPayment:{text:"Reject First Payment",className:"bg-red-600 hover:bg-red-700",onClick:()=>j("rejectFirstPayment",r)},requestSecondPayment:{text:"Request Second Payment",className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>j("requestSecondPayment",r)},approveFullDetailsRequest:{text:"Approve Full Details",className:"bg-green-600 hover:bg-green-700",onClick:()=>j("approveFullDetailsRequest",r)},rejectFullDetailsRequest:{text:"Reject Full Details",className:"bg-red-600 hover:bg-red-700",onClick:()=>j("rejectFullDetailsRequest",r)},approveSecondPayment:{text:"Approve Second Payment",className:"bg-green-600 hover:bg-green-700",onClick:()=>j("approveSecondPayment",r)},rejectSecondPayment:{text:"Reject Second Payment",className:"bg-red-600 hover:bg-red-700",onClick:()=>j("rejectSecondPayment",r)},updateCandidateAvailability:{text:"Update Candidate Status",className:"bg-purple-600 hover:bg-purple-700",onClick:()=>j("updateCandidateAvailability",r)},request_full_details:{text:"Request Full Details",className:"bg-purple-600 hover:bg-purple-700",onClick:Sr},mark_hired:{text:"Mark as Hired",className:"bg-green-600 hover:bg-green-700",onClick:()=>Bt("hired")},mark_not_hired:{text:"Mark as Not Hired",className:"bg-red-600 hover:bg-red-700",onClick:()=>Bt("not_hired")},get_photo_access:{text:"View Photo Access",className:"bg-blue-600 hover:bg-blue-700",onClick:Pr},get_full_details:{text:"View Full Details",className:"bg-indigo-600 hover:bg-indigo-700",onClick:Ar}}[t];return l?e.jsx(q,{onClick:l.onClick,disabled:x,className:l.className,children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),Er(t)]}):l.text}):null},j=async(t,a)=>{$(a),Qe(t),w(""),B("");const l=`${t}-${a.id}`;kt(m=>({...m,[l]:!0}));try{g(!0);let m;const v=a.id;switch(t){case"approveRequest":m=await R.approveRequest(v,C);break;case"rejectRequest":m=await R.rejectRequest(v,C);break;case"requestFirstPayment":m=await R.requestFirstPayment(v,C);break;case"viewPaymentDetails":I(!0);return;case"approveFirstPayment":console.log("Approving first payment for request:",v,"with notes:",C),m=await R.approveFirstPayment(v,C),console.log("First payment approval result:",m);break;case"rejectFirstPayment":m=await R.rejectFirstPayment(v,C);break;case"requestSecondPayment":m=await R.requestSecondPayment(v,C);break;case"viewPhotoAccess":I(!0);return;case"approveFullDetailsRequest":m=await R.approveFullDetailsRequest(v,C);break;case"rejectFullDetailsRequest":m=await R.rejectFullDetailsRequest(v,C);break;case"approveSecondPayment":m=await R.approveSecondPayment(v,C);break;case"rejectSecondPayment":m=await R.rejectSecondPayment(v,C);break;case"viewFullDetails":I(!0);return;case"waitForHiringDecision":A.info("Waiting for employer to make hiring decision...");return;case"reviewHiringDecision":I(!0);return;case"updateCandidateAvailability":m=await R.updateCandidateAvailability(v,C);break;case"viewCompletedRequest":I(!0);return;default:throw new Error(`Unknown workflow action: ${t}`)}if(m){const J=m.message||`${t.replace(/([A-Z])/g," $1").toLowerCase()} completed successfully`;A.success(J),gr(t,J,v,m.newStatus||"updated"),M()}else{const J=`${t.replace(/([A-Z])/g," $1").toLowerCase()} completed successfully`;A.success(J),M()}}catch(m){console.error(`Error in workflow action ${t}:`,m),w(m.message||`Failed to ${t.replace(/([A-Z])/g," $1").toLowerCase()}`),A.error(`Failed to ${t.replace(/([A-Z])/g," $1").toLowerCase()}`)}finally{g(!1),kt(m=>({...m,[l]:!1}))}},ut=t=>{const a=[{key:"view",title:"View Details",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"view"},{key:"message",title:"Message",icon:Ve,className:"text-indigo-600 hover:bg-indigo-50",group:"contact"}],l=[];switch(t.status){case"pending":l.push({key:"approveRequest",title:"Approve Request",icon:U,className:"text-green-600 hover:bg-green-50",group:"workflow"},{key:"rejectRequest",title:"Reject Request",icon:yt,className:"text-red-600 hover:bg-red-50",group:"workflow"});break;case"approved":l.push({key:"requestFirstPayment",title:"Request First Payment",icon:qe,className:"text-yellow-600 hover:bg-yellow-50",group:"workflow"});break;case"first_payment_required":l.push({key:"viewPaymentDetails",title:"View Payment Details",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"first_payment_confirmed":l.push({key:"paymentApproval",title:"Approve First Payment",icon:U,className:"text-green-600 hover:bg-green-50",group:"workflow"});break;case"photo_access_granted":l.push({key:"requestSecondPayment",title:"Request Second Payment",icon:qe,className:"text-yellow-600 hover:bg-yellow-50",group:"workflow"},{key:"viewPhotoAccess",title:"View Photo Access",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"full_details_requested":l.push({key:"approveFullDetailsRequest",title:"Approve Full Details",icon:U,className:"text-green-600 hover:bg-green-50",group:"workflow"},{key:"rejectFullDetailsRequest",title:"Reject Full Details",icon:yt,className:"text-red-600 hover:bg-red-50",group:"workflow"});break;case"second_payment_required":l.push({key:"viewPaymentDetails",title:"View Payment Details",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"second_payment_confirmed":l.push({key:"paymentApproval",title:"Approve Second Payment",icon:U,className:"text-green-600 hover:bg-green-50",group:"workflow"});break;case"payment_required":l.push({key:"viewPaymentDetails",title:"View Payment Details",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"payment_confirmed":l.push({key:"paymentApproval",title:"Approve Payment",icon:U,className:"text-green-600 hover:bg-green-50",group:"workflow"});break;case"full_access_granted":l.push({key:"viewFullDetails",title:"View Full Details",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"},{key:"waitForHiringDecision",title:"Wait for Hiring Decision",icon:Ze,className:"text-orange-600 hover:bg-orange-50",group:"workflow"});break;case"hiring_decision_made":l.push({key:"reviewHiringDecision",title:"Review Hiring Decision",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"},{key:"updateCandidateAvailability",title:"Update Candidate Status",icon:Je,className:"text-purple-600 hover:bg-purple-50",group:"workflow"});break;case"completed":l.push({key:"viewCompletedRequest",title:"View Completed Request",icon:V,className:"text-gray-600 hover:bg-gray-50",group:"workflow"});break;case"cancelled":l.push({key:"reactivate",title:"Reactivate",icon:Re,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;default:l.push({key:"view",title:"View Details",icon:V,className:"text-blue-600 hover:bg-blue-50",group:"workflow"})}return[...a,...l]};return s||!n||!Q?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(Kr,{size:"lg",text:"Loading employer requests..."})}):d?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Requests"}),e.jsx("p",{className:"text-gray-600 mb-4",children:d}),e.jsxs(q,{onClick:M,variant:"primary",disabled:s,children:[e.jsx(Re,{className:"mr-2 h-4 w-4"}),s?"Retrying...":"Try Again"]})]})}):!s&&Q&&Q.length===0?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"E"})}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Employer Requests"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(q,{variant:"outline",size:"sm",onClick:M,disabled:s,children:"Refresh"})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"No Employer Requests"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There are currently no employer requests to display."}),e.jsxs(q,{onClick:M,variant:"primary",disabled:s,children:[e.jsx(Re,{className:"mr-2 h-4 w-4"}),s?"Refreshing...":"Refresh Data"]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Employer Requests"})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>St(!Ie),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",title:"Workflow Notifications",children:[z>0?e.jsx(zt,{className:"h-5 w-5 text-orange-500"}):e.jsx(pt,{className:"h-5 w-5"}),z>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:z>9?"9+":z})]}),Ie&&e.jsxs("div",{className:"notification-dropdown absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Workflow Notifications"}),z>0&&e.jsx("button",{onClick:pr,className:"text-sm text-blue-600 hover:text-blue-800",children:"Mark all read"})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:sr?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading notifications..."})]}):Ct.length===0?e.jsxs("div",{className:"p-4 text-center text-gray-500",children:[e.jsx(pt,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):Ct.map(t=>e.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${t.isRead?"":"bg-blue-50"}`,onClick:()=>{t.isRead||ur(t.id),t.requestId},children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 rounded-full mt-2 ${t.isRead?"bg-gray-300":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:t.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(t.timestamp).toLocaleString()}),t.status&&e.jsxs("span",{className:"inline-block mt-1 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:["Status: ",t.status]})]})]})},t.id))})]})]}),e.jsxs(q,{variant:"outline",size:"sm",onClick:M,disabled:s,children:[e.jsx(Re,{className:"mr-2 h-4 w-4"}),s?"Refreshing...":"Refresh"]})]})]})})}),e.jsxs("div",{className:" mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(ft.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsx(es,{stats:wr})}),e.jsx(ft.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(er,{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Employer Requests (",G.length,")"]}),X>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",G.length," of ",(Q||[]).length," total requests"]})]})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Wt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search by employer name, company, candidate, or message...",value:Z,onChange:t=>vr(t.target.value),className:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm"}),ir&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-500"})}),Z&&e.jsx("button",{onClick:()=>Ge(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:e.jsx(Ke,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("button",{onClick:()=>lr(!nt),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${nt?"bg-red-50 border-red-200 text-red-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Br,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters"}),X>0&&e.jsx("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full",children:X})]}),X>0&&e.jsxs("button",{onClick:Ut,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Clear All"]})]}),nt&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx("select",{value:P.status,onChange:t=>ye("status",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:T.status.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsx("select",{value:P.priority,onChange:t=>ye("priority",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:T.priority.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("select",{value:P.category,onChange:t=>ye("category",t.target.value),disabled:W,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:W?e.jsx("option",{value:"",children:"Loading categories..."}):T.category.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsx("select",{value:P.dateRange,onChange:t=>ye("dateRange",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:T.dateRange.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Rate"}),e.jsx("select",{value:P.monthlyRateRange,onChange:t=>ye("monthlyRateRange",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:T.monthlyRateRange.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),X>0&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Z&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:['Search: "',Z,'"',e.jsx("button",{onClick:()=>Ge(""),className:"ml-1 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(Ke,{className:"h-3 w-3"})})]}),Object.entries(P).map(([t,a])=>{if(!a)return null;const l=T[t]?.find(m=>m.value===a);return l?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-800 text-sm rounded-full",children:[l.label,e.jsx("button",{onClick:()=>ye(t,""),className:"ml-1 hover:bg-gray-200 rounded-full p-0.5",children:e.jsx(Ke,{className:"h-3 w-3"})})]},t):null})]})})]})]}),e.jsx("div",{className:"space-y-4",children:G.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx(Wt,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No results found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:X>0?"Try adjusting your search terms or filters to find what you're looking for.":"There are no employer requests to display."}),X>0&&e.jsx(q,{onClick:Ut,variant:"outline",size:"sm",className:"mx-auto",children:"Clear All Filters"})]}):e.jsx(Yr,{data:G,columns:Nr,pagination:!0,itemsPerPage:15,showSearch:!1})})]})})]}),je&&r&&e.jsx(ce,{isOpen:je,onClose:()=>{Ne(!1),$(null),We(!1)},title:`Request Details - #${r.id}`,size:"xl",children:e.jsxs("div",{className:"space-y-6 relative",children:[or&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Loading request details..."}),e.jsx("div",{className:"text-xs text-gray-500 text-center max-w-xs",children:"Fetching the latest information from the database."})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Request #",r.id]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Created on ",new Date(r.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[e.jsx(Zt,{status:r.status}),e.jsxs(_e,{color:Jt(r.priority),children:[r.priority," Priority"]})]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Gt,{className:"w-5 h-5 mr-2 text-blue-600"}),"Employer Information"]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Full Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.employerName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Company Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.companyName})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsxs("label",{className:"text-sm font-medium text-blue-600 block mb-1 flex items-center",children:[e.jsx(Vt,{className:"w-4 h-4 mr-1"}),"Email Address"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.employerContact.email||"Not provided"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsxs("label",{className:"text-sm font-medium text-blue-600 block mb-1 flex items-center",children:[e.jsx(Kt,{className:"w-4 h-4 mr-1"}),"Phone Number"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.employerContact.phone||"Not provided"})]})]})]}),(r.employerDetails.companyAddress||r.employerDetails.industry||r.employerDetails.companySize||r.employerDetails.website||r.employerDetails.description||r.employerDetails.establishedYear||r.employerDetails.contactPerson)&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-blue-200",children:[e.jsx("h4",{className:"text-md font-semibold text-blue-900 mb-3",children:"Additional Company Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.employerDetails.companyAddress&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Company Address"}),e.jsx("p",{className:"text-gray-900 text-sm",children:r.employerDetails.companyAddress})]}),r.employerDetails.industry&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Industry"}),e.jsx("p",{className:"text-gray-900 text-sm",children:r.employerDetails.industry})]}),r.employerDetails.companySize&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Company Size"}),e.jsx("p",{className:"text-gray-900 text-sm",children:r.employerDetails.companySize})]}),r.employerDetails.website&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Website"}),e.jsx("a",{href:r.employerDetails.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline",children:r.employerDetails.website})]}),r.employerDetails.establishedYear&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Established Year"}),e.jsx("p",{className:"text-gray-900 text-sm",children:r.employerDetails.establishedYear})]}),r.employerDetails.contactPerson&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Contact Person"}),e.jsx("p",{className:"text-gray-900 text-sm",children:r.employerDetails.contactPerson})]})]}),r.employerDetails.description&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-2",children:"Company Description"}),e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:r.employerDetails.description})]})})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ve,{className:"w-5 h-5 mr-2 text-green-600"}),"Request Information"]}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-2",children:"Request Message"}),e.jsx("p",{className:"text-gray-900 leading-relaxed",children:r.message||"No message provided"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Request Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(r.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Last Updated"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(r.lastContactDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Request ID"}),e.jsxs("p",{className:"text-gray-900 font-mono text-sm",children:["#",r.id]})]})]})]})})]}),r.candidateName!=="Not specified"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Je,{className:"w-5 h-5 mr-2 text-purple-600"}),"Candidate Information"]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center space-x-6 pb-6 border-b border-purple-200 mb-6",children:[(()=>{const t=r._backendData?.requestedCandidate?.profile?.photo||r._backendData?.requestedCandidate?.photo||null,a=t?/^https?:\/\//i.test(t)?t:`${u.BASE_URL}/${t.replace(/^\//,"")}`:null;return e.jsx(xt,{src:a,alt:r.candidateName,size:"xl",fallback:r.candidateName,fallbackSrc:gt})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-2xl font-bold text-gray-900 mb-2",children:r.candidateName}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsx(_e,{color:"text-purple-600 bg-purple-100 border-purple-200",children:r.category}),e.jsx(_e,{color:"text-blue-600 bg-blue-100 border-blue-200",children:r.position})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-lg font-semibold text-green-600",children:r.monthlyRate})]}),r.candidateExperienceLevel!=="Not specified"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Experience:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r.candidateExperienceLevel})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Job Category"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.category})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Skills/Position"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.position})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Experience Level"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateExperienceLevel})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Education Level"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateEducation})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsxs("label",{className:"text-sm font-medium text-purple-600 block mb-1 flex items-center",children:[e.jsx(Kt,{className:"w-4 h-4 mr-1"}),"Contact Number"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateContact})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsxs("label",{className:"text-sm font-medium text-purple-600 block mb-1 flex items-center",children:[e.jsx(Vt,{className:"w-4 h-4 mr-1"}),"Email Address"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateEmail})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Location Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Location"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateLocation})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"City"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateCity})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Country"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateCountry})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Skills & Qualifications"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Languages"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateLanguages})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Certifications"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateCertifications})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Gender"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateGender})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Marital Status"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateMaritalStatus})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"ID Number"}),e.jsx("p",{className:"text-gray-900 font-medium font-mono text-sm",children:r.candidateIdNumber})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Availability"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Availability Status"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.candidateAvailability})]})]}),r.candidateDescription!=="Not specified"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Description"}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:e.jsx("p",{className:"text-gray-900 leading-relaxed",children:r.candidateDescription})})]}),r.candidateReferences!=="Not specified"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"References"}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:e.jsx("p",{className:"text-gray-900 leading-relaxed",children:r.candidateReferences})})]})]})]})]}),r.latestPayment&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(qe,{className:"w-5 h-5 mr-2 text-green-600"}),"Payment Information"]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Payment Type"}),e.jsx(_e,{color:"text-green-600 bg-green-100 border-green-200",children:r.latestPayment.paymentType?.replace("_"," ").toUpperCase()||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Amount"}),e.jsxs("p",{className:"text-gray-900 font-semibold text-lg",children:[r.latestPayment.amount," ",r.latestPayment.currency]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Payment Status"}),e.jsx(_e,{color:r.latestPayment.status==="confirmed"?"text-green-600 bg-green-100 border-green-200":"text-yellow-600 bg-yellow-100 border-yellow-200",children:r.latestPayment.status?.toUpperCase()||"Not specified"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Payment Reference"}),e.jsx("p",{className:"text-gray-900 font-mono text-sm",children:r.latestPayment.paymentReference||"Not provided"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Confirmation Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.latestPayment.confirmationDate?new Date(r.latestPayment.confirmationDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not provided"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Payment Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(r.latestPayment.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]}),(r.latestPayment.confirmationName||r.latestPayment.confirmationPhone)&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-green-200",children:[e.jsx("h4",{className:"text-md font-semibold text-green-900 mb-3",children:"Payment Confirmation Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.latestPayment.confirmationName&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Payer Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.latestPayment.confirmationName})]}),r.latestPayment.confirmationPhone&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Payer Phone"}),e.jsx("p",{className:"text-gray-900 font-medium",children:r.latestPayment.confirmationPhone})]})]})]}),r.latestPayment.adminNotes&&r.latestPayment.adminNotes!=="No additional notes"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-green-200",children:[e.jsx("h4",{className:"text-md font-semibold text-green-900 mb-3",children:"Admin Notes"}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:e.jsx("p",{className:"text-gray-900 leading-relaxed",children:r.latestPayment.adminNotes})})]})]})]})]})}),ne&&r&&!D&&e.jsx(ce,{isOpen:ne,onClose:F,title:`Actions for ${r.employerName} - ${r.companyName}`,maxWidth:"max-w-md",children:e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"grid grid-cols-4 gap-3",children:ut(r).map((t,a)=>{const l=t.icon;return e.jsxs("button",{onClick:()=>dt(t.key,r),className:`relative group flex items-center justify-center p-4 rounded-lg transition-all duration-200 hover:scale-105 ${t.className} border border-gray-200 hover:border-current`,title:t.title,children:[e.jsx(l,{className:"w-6 h-6"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[t.title,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]},a)})})})}),ne&&r&&D&&e.jsxs(ce,{isOpen:ne,onClose:F,title:D==="reply"?"Reply to Request":D==="select"?"Send Candidate Details":D==="complete"?"Complete Request":"Action",size:"md",children:[D==="reply"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Replying to:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Name:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.employerContact.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Phone:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.employerContact.phone})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reply Message ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:L,onChange:t=>ve(t.target.value),className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your reply message to the employer...",disabled:E}),E&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Sending reply to employer..."]}),_&&e.jsx("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:_})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Internal)"}),e.jsx("textarea",{value:H,onChange:t=>de(t.target.value),className:"w-full h-20 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Add internal notes for your reference...",disabled:E}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"These notes are for internal use only and won't be sent to the employer."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(q,{variant:"outline",onClick:()=>{F()},disabled:E,children:"Cancel"}),e.jsx(q,{variant:"primary",onClick:kr,disabled:!L.trim()||E,children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):"Send Reply"})]})]}),D==="select"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-900 mb-2",children:"Selecting candidate for:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-green-900 ml-1",children:r.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-green-900 ml-1",children:r.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Position:"}),e.jsx("span",{className:"text-green-900 ml-1",children:r.position})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Category:"}),e.jsx("span",{className:"text-green-900 ml-1",children:r.category})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Send Candidate Information"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Send the requested candidate's information to the employer. Choose whether to send just a profile picture or complete details."}),r._backendData?.requestedCandidate?e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const t=r._backendData?.requestedCandidate?.profile?.photo||r._backendData?.requestedCandidate?.photo||null,a=t?/^https?:\/\//i.test(t)?t:`${u.BASE_URL}/${t.replace(/^\//,"")}`:null;return e.jsx(xt,{src:a,alt:r.candidateName,size:"md",fallback:r.candidateName,fallbackSrc:gt})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-lg",children:r.candidateName}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[r.position,"  ",r.candidateExperience]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",r.candidateLocation]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rate:"})," ",r.monthlyRate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Experience Level:"})," ",r.candidateExperienceLevel]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Education:"})," ",r.candidateEducation]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(q,{variant:"outline",size:"sm",onClick:()=>Ht(r._backendData.requestedCandidate.id,"picture"),disabled:ue,children:"Send Profile Picture"}),e.jsx(q,{variant:"primary",size:"sm",onClick:()=>Ht(r._backendData.requestedCandidate.id,"full"),disabled:ue,children:"Send Complete Details"})]})]})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Je,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No candidate specified in this request"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"The employer did not specify a particular candidate"})]})]}),se&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:se}),ue&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}),"Sending candidate information to employer..."]}),e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx(q,{variant:"outline",onClick:()=>{F()},disabled:ue,children:"Cancel"})})]}),D==="complete"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-900 mb-2",children:"Completing Request:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:r.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:r.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Position:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:r.position})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Current Status:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:r.status})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Completion Notes (Optional)"}),e.jsx("textarea",{value:Me,onChange:t=>Xe(t.target.value),className:"w-full h-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Add notes about how this request was completed...",disabled:le}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"These notes will be saved with the request and sent to the employer."})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center mr-2",children:e.jsx("span",{className:"text-yellow-800 text-xs",children:"!"})}),e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Warning:"})," This action will permanently mark the request as completed and close it. This action cannot be undone."]})]})}),wt&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:wt}),le&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600 mr-2"}),"Completing request..."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(q,{variant:"outline",onClick:()=>{F()},disabled:le,children:"Cancel"}),e.jsx(q,{variant:"primary",onClick:Cr,disabled:le,className:"bg-orange-600 hover:bg-orange-700",children:le?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete Request"})]})]})]}),Oe&&r&&e.jsx(ce,{isOpen:Oe,onClose:dr,title:`Messaging - Request #${r.id}`,maxWidth:"max-w-2xl",children:e.jsxs("div",{className:"flex flex-col h-[calc(100vh-200px)]",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto pr-4 space-y-4 mb-4",children:[Be?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Re,{className:"animate-spin h-8 w-8 text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]}):At.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ve,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Start the conversation!"})]}):At.map(t=>e.jsx("div",{className:`flex ${t.fromAdmin?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg shadow-sm ${t.fromAdmin?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"}`,children:[e.jsx("p",{className:"text-sm",children:t.content}),e.jsx("p",{className:`text-xs mt-1 ${t.fromAdmin?"text-blue-100":"text-gray-500"}`,children:new Date(t.createdAt).toLocaleString()})]})},t.id)),qt&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:qt})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Type a message...",value:Ue,onChange:t=>He(t.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",disabled:Be,onKeyPress:t=>t.key==="Enter"&&Mt()}),e.jsx(q,{variant:"primary",onClick:Mt,disabled:!Ue.trim()||Be,children:Be?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(zr,{className:"h-5 w-5"})})]})]})}),Rt&&r&&e.jsx(ce,{isOpen:Rt,onClose:ot,title:`Request Payment - Request #${r.id}`,maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:yr,className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Request Details:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Candidate:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.candidateName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Status:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:r.status})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentType",value:"photo_access",checked:k.paymentType==="photo_access",onChange:t=>K({...k,paymentType:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Photo Access"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Basic candidate photo"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentType",value:"full_details",checked:k.paymentType==="full_details",onChange:t=>K({...k,paymentType:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Full Details"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Complete candidate information"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:k.paymentMethodId,onChange:t=>K({...k,paymentMethodId:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Payment Method"}),ar.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.accountNumber]},t.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:k.amount,onChange:t=>K({...k,amount:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"5000",min:"0",step:"100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:k.currency,onChange:t=>K({...k,currency:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"RWF",children:"RWF (Rwandan Franc)"}),e.jsx("option",{value:"USD",children:"USD (US Dollar)"}),e.jsx("option",{value:"EUR",children:"EUR (Euro)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:k.description,onChange:t=>K({...k,description:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:`Payment for ${k.paymentType==="photo_access"?"photo access":"full details"} access to candidate information`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date (Optional)"}),e.jsx("input",{type:"date",value:k.dueDate,onChange:t=>K({...k,dueDate:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]})]}),_t&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:_t}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(q,{type:"button",variant:"outline",onClick:ot,disabled:rt,children:"Cancel"}),e.jsx(q,{type:"submit",variant:"primary",disabled:rt,className:"bg-green-600 hover:bg-green-700",children:rt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):"Send Payment Request"})]})]})}),Ft&&r&&e.jsx(ce,{isOpen:Ft,onClose:lt,title:`Approve Payment - Request #${r.id}`,maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:jr,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Request Overview"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Employer:"}),e.jsx("span",{className:"text-gray-900",children:r.employerName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Company:"}),e.jsx("span",{className:"text-gray-900",children:r.companyName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Candidate:"}),e.jsx("span",{className:"text-gray-900",children:r.candidateName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Request Status:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:r.status?.replace("_"," ")})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-green-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Payment Confirmation Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payer Name:"}),e.jsx("span",{className:"text-gray-900",children:r.latestPayment?.confirmationName||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Phone Number:"}),e.jsx("span",{className:"text-gray-900",children:r.latestPayment?.confirmationPhone||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payment Reference:"}),e.jsx("span",{className:"text-gray-900 font-mono text-xs",children:r.latestPayment?.paymentReference||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Transfer Amount:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:r.latestPayment?.amount?`${r.latestPayment.amount} RWF`:"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Confirmation Date:"}),e.jsx("span",{className:"text-gray-900",children:r.latestPayment?.confirmationDate?new Date(r.latestPayment.confirmationDate).toLocaleDateString():"Not specified"})]})]}),r.latestPayment?.adminNotes&&r.latestPayment.adminNotes!=="No additional notes"&&e.jsxs("div",{className:"mt-4 bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-2",children:"Additional Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:r.latestPayment.adminNotes})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-purple-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsx("span",{className:"text-purple-600 font-medium block mb-1",children:"Payment Type:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:r.latestPayment?.paymentType?.replace("_"," ")||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsx("span",{className:"text-purple-600 font-medium block mb-1",children:"Payment Status:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:r.latestPayment?.status||"Not specified"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Action ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"action",value:"approve",checked:O.action==="approve",onChange:t=>he({...O,action:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Approve"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Approve the payment"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"action",value:"reject",checked:O.action==="reject",onChange:t=>he({...O,action:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Reject"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Reject the payment"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:O.notes,onChange:t=>he({...O,notes:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:"Add any additional notes for the payment approval..."})]}),Tt&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:Tt}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(q,{type:"button",variant:"outline",onClick:lt,disabled:at,children:"Cancel"}),e.jsx(q,{type:"submit",variant:"primary",disabled:at,className:"bg-green-600 hover:bg-green-700",children:at?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):"Submit Approval"})]})]})}),ge&&r&&e.jsx(ce,{isOpen:ge,onClose:x?void 0:()=>I(!1),title:`${qr(Ce)}`,className:"max-w-2xl",children:e.jsxs("div",{className:"space-y-6 relative",children:[x&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Processing your request..."}),e.jsx("div",{className:"text-xs text-gray-500 text-center max-w-xs",children:"This may take a few moments as we send notifications and update the system."})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Request Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Request ID:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["#",r.id]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:"ml-2",children:e.jsx(Zt,{status:r.status})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Employer:"}),e.jsx("span",{className:"ml-2 font-medium",children:r.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Candidate:"}),e.jsx("span",{className:"ml-2 font-medium",children:r.candidateName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Created:"}),e.jsx("span",{className:"ml-2",children:new Date(r.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Company:"}),e.jsx("span",{className:"ml-2 font-medium",children:r.companyName})]})]})]}),e.jsx(Xr,{currentStatus:r.status}),Rr(Ce),N&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Qt,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:N})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(q,{variant:"outline",onClick:()=>I(!1),disabled:x,children:"Cancel"}),Tr(Ce)]})]})}),e.jsx(Wr,{position:"top-right"})]})},gs=Object.freeze(Object.defineProperty({__proto__:null,default:ts},Symbol.toStringTag,{value:"Module"}));export{ts as E,ht as N,Zr as S,ps as a,Jt as b,Qr as c,gs as d,us as g,Yt as h,ms as u};
