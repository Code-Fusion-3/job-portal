import{j as e,ay as Se,az as Be,aw as ge,af as Pe,ae as fe,aY as be,aI as He,r as i,ax as We,aZ as et,aT as Ve,aU as Oe,aQ as Ae,b3 as tt,b4 as st,b5 as at,aK as Fe,aW as he,aL as Ee,b6 as ze,ai as rt,b7 as lt,ac as Ge,aj as nt,b8 as ye,b9 as it,ba as ot,aR as J,bb as ct,bc as dt,bd as mt,be as ne,bf as ie,ag as Te,bg as ut,bh as xt,bi as Ye,bj as z,bk as gt,aJ as ht,bl as Le,bm as $e,bn as pt,bo as ft,aO as bt,bp as yt,av as Me,aH as jt}from"./vendor-react-BGn7VswH.js";import{B as L,d as Ie,L as te,C as K,u as Qe,c as Nt,A as vt}from"./index-C7FXNmYZ.js";import{a as oe,R as wt}from"./ReportsPage-QHFX3M1e.js";import{a as Xe}from"./useJobSeekers-ByDi2qhY.js";import{g as Je,u as Ze,E as Ct,S as we,a as kt,b as St,c as Pt,h as Et}from"./EmployerRequestsPage-UQZi-vo4.js";import{a as At,b as Dt}from"./useCategories-BQOel4QK.js";import{m as Ce}from"./vendor-motion-DwrKfzy9.js";import{B as R}from"./Badge-BQeAVSNL.js";import{A as qe}from"./Avatar-2tQtliHc.js";import{M as ke}from"./Modal-DL9fvMFM.js";import Rt from"./JobSeekersPage-CC0wtPRN.js";import{D as Ke}from"./DataTable-D4gQs-in.js";import{c as xe}from"./contactService-GEVaopzV.js";import Lt from"./JobCategoriesPage-CWAWS5r7.js";import{a as $t}from"./vendor-router-BywwqvzY.js";import"./vendor-gsap-B4nt0ofr.js";import"./categoryService-DUfVhcAa.js";import"./useApprovalManagement-D0DtTUSO.js";import"./StatusBadge-oETaPpAp.js";const Mt=({isConnected:t,lastUpdate:l,onRefresh:d,showLastUpdate:r=!0,className:o=""})=>e.jsx("div",{className:`flex items-center space-x-2 text-sm ${o}`,children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Ce.div,{animate:{scale:t?[1,1.2,1]:1,opacity:t?1:.5},transition:{duration:2,repeat:t?1/0:0,ease:"easeInOut"}})})}),Ft=({request:t,onContactEmployer:l,onViewDetails:d,getStatusColor:r,getPriorityColor:o,compact:h=!1})=>{if(!t)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No request data available"});const v=t.name||t.employerName||"Unknown Employer",g=t.companyName||"Unknown Company",u=t.status||"pending",x=t.priority||"normal",b=t.message||"No message provided",w=t.email||"",p=t.phoneNumber||"",C=t.createdAt||new Date().toISOString(),S=t.selectedUser||t.hasSelectedCandidate,T=t.requestedCandidate,f=t.selectedUser;let P="No candidate selected",M=null;return S&&f?.profile?(P=`${f.profile.firstName} ${f.profile.lastName}`,M=f):T?.profile&&(P=`${T.profile.firstName} ${T.profile.lastName}`,M=T),h?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:v}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:g})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{variant:"outline",size:"xs",className:r?r(u):"bg-gray-100 text-gray-800",children:Je(u)}),e.jsx(R,{variant:"outline",size:"xs",className:o?o(x):"bg-gray-100 text-gray-800",children:x})]})]}),e.jsxs("div",{className:"mt-2",children:[S?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"✓ Selected:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:P})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"⏳ Requesting:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:P})]}),M?.profile?.skills&&e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-xs text-gray-700",children:M.profile.skills})]})]})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:v}),e.jsx("p",{className:"text-sm text-gray-600",children:g})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{variant:"outline",size:"sm",className:r?r(u):"bg-gray-100 text-gray-800",children:Je(u)}),e.jsx(R,{variant:"outline",size:"sm",className:o?o(x):"bg-gray-100 text-gray-800",children:x})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:b}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[w&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:w})]}),p&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{children:p})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Candidate Information"}),S?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"✓ Selected Candidate:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:P})]}),M?.profile?.skills&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-sm text-gray-700",children:M.profile.skills})]}),M?.profile?.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Experience: "}),e.jsx("span",{className:"text-sm text-gray-700",children:M.profile.experience})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No candidate selected yet"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(C).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[l&&e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>l(t),children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Contact"]}),d&&e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>d(t),children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})},Tt=({jobSeeker:t,onViewDetails:l,getCategoryColor:d,compact:r=!1})=>{if(!t)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No job seeker data available"});const h=(d||(v=>{const g={JavaScript:"bg-yellow-100 text-yellow-800",React:"bg-blue-100 text-blue-800","Node.js":"bg-green-100 text-green-800",Python:"bg-blue-100 text-blue-800",Django:"bg-green-100 text-green-800",PostgreSQL:"bg-blue-100 text-blue-800",AWS:"bg-orange-100 text-orange-800",Docker:"bg-blue-100 text-blue-800",Git:"bg-red-100 text-red-800",Java:"bg-orange-100 text-orange-800",Cooking:"bg-red-100 text-red-800",Housekeeping:"bg-purple-100 text-purple-800",Childcare:"bg-pink-100 text-pink-800",Gardening:"bg-emerald-100 text-emerald-800",Cleaning:"bg-gray-100 text-gray-800",Driving:"bg-indigo-100 text-indigo-800",Teaching:"bg-yellow-100 text-yellow-800",Nursing:"bg-rose-100 text-rose-800",Construction:"bg-amber-100 text-amber-800",Agriculture:"bg-lime-100 text-lime-800",Technology:"bg-blue-100 text-blue-800",Healthcare:"bg-green-100 text-green-800",Education:"bg-purple-100 text-purple-800",Manufacturing:"bg-red-100 text-red-800",Services:"bg-gray-100 text-gray-800",General:"bg-gray-100 text-gray-800","Job Seeker":"bg-gray-100 text-gray-800",default:"bg-gray-100 text-gray-800"};return g[v]||g.default}))(t?.category||"General");return r?e.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(qe,{src:t?.avatar,alt:t?.name||"Job Seeker",size:"sm",fallback:t?.name||"JS",fallbackSrc:Ie}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:t?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:t?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(R,{variant:"outline",size:"xs",className:h,children:t?.category||"General"}),e.jsx("span",{className:"text-xs text-gray-500",children:t?.location||"Unknown"})]}),t?.approvalStatus&&e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${t.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":t.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[t.approvalStatus==="approved"?e.jsx(Pe,{className:"w-3 h-3"}):t.approvalStatus==="rejected"?e.jsx(fe,{className:"w-3 h-3"}):e.jsx(be,{className:"w-3 h-3"}),t.approvalStatus==="approved"?"Verified":t.approvalStatus==="rejected"?"Rejected":"Pending"]})}),t?.category&&t.category.includes(",")&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[t.category.split(",").slice(0,3).map((v,g)=>e.jsx("span",{className:"inline-block px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:v.trim()},g)),t.category.split(",").length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",t.category.split(",").length-3," more"]})]})]})]}):e.jsxs("div",{className:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(qe,{src:t?.avatar,alt:t?.name||"Job Seeker",size:"md",fallback:t?.name||"JS",fallbackSrc:Ie}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:t?.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:t?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:t?.location||"Unknown"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t?.experience||"0"," years"]}),e.jsx(R,{variant:"outline",size:"sm",className:h,children:t?.category||"General"})]}),t?.approvalStatus&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${t.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":t.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[t.approvalStatus==="approved"?e.jsx(Pe,{className:"w-3.5 h-3.5"}):t.approvalStatus==="rejected"?e.jsx(fe,{className:"w-3.5 h-3.5"}):e.jsx(be,{className:"w-3.5 h-3.5"}),t.approvalStatus==="approved"?"Verified Profile":t.approvalStatus==="rejected"?"Profile Rejected":"Under Review"]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["Daily: ",t?.dailyRate?.toLocaleString()||"0"," frw"]}),e.jsxs("span",{children:["Monthly: ",t?.monthlyRate?.toLocaleString()||"0"," frw"]})]})]}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>l?.(t),title:"View Details",children:e.jsx(ge,{className:"w-4 h-4"})})]})},Ut=({logo:t="J",title:l="Admin Panel",subtitle:d="Job Portal Management"})=>e.jsx("div",{className:"flex items-center justify-between p-5 border-b border-slate-200 bg-slate-50/60",children:e.jsxs("div",{className:"flex items-center space-x-2.5",children:[e.jsx("div",{className:"w-9 h-9 bg-red-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-base",children:t})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-slate-800 text-base",children:l}),e.jsx("span",{className:"text-xs text-slate-500",children:d})]})]})}),zt=({searchValue:t="",onSearchChange:l,placeholder:d="Search..."})=>e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:d,value:t,onChange:r=>l?.(r.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-md text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-200"})]})}),It=({item:t,isActive:l,onClick:d})=>{const[r,o]=i.useState(!1),v={Home:ze,Users:Ee,MessageSquare:he,Briefcase:Fe,BarChart3:at,Settings:st,TestTube:tt,User:Ae,FileText:Oe,Calendar:Ve,Star:et,MapPin:We,Mail:Se,Phone:Be}[t.icon]||ze,g=()=>{t.subItems?o(!r):d(t.id)},u=x=>{d(x)};return e.jsxs("li",{children:[e.jsxs("button",{onClick:g,className:`
          relative w-full flex items-center space-x-2.5 px-3 py-2.5 rounded-md text-left transition-all duration-200 group
          ${l?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
        `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx(v,{className:`
              h-4.5 w-4.5 flex-shrink-0
              ${l?"text-red-600":"text-slate-500 group-hover:text-slate-700"}
            `})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:`text-sm ${l?"font-medium":"font-normal"}`,children:t.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[t.badge&&e.jsx("span",{className:`
                px-1.5 py-0.5 text-xs font-medium rounded-full
                ${l?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}
              `,children:t.badge}),t.subItems&&e.jsx("div",{className:"flex items-center",children:r?e.jsx(rt,{className:"w-4 h-4 text-slate-500"}):e.jsx(lt,{className:"w-4 h-4 text-slate-500"})})]})]})]}),t.subItems&&r&&e.jsx("ul",{className:"ml-6 mt-1 space-y-0.5",children:t.subItems.map(x=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>u(x.id),className:`
                  relative w-full flex items-center space-x-2.5 px-3 py-2 rounded-md text-left transition-all duration-200 group
                  ${l===x.id?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
                `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx("div",{className:`
                    w-1.5 h-1.5 rounded-full
                    ${l===x.id?"bg-red-600":"bg-slate-400 group-hover:bg-slate-600"}
                  `})}),e.jsx("span",{className:`text-sm ${l===x.id?"font-medium":"font-normal"}`,children:x.label})]})},x.id))})]})},Jt=({navigationItems:t,activeItem:l,onItemClick:d})=>e.jsx("nav",{className:"flex-1 px-3 py-2 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:t.map(r=>e.jsx(It,{item:r,isActive:l===r.id,onClick:d},r.id))})}),qt=({sidebarOpen:t,setSidebarOpen:l,navigationItems:d,activeTab:r,setActiveTab:o,user:h,onLogout:v,className:g=""})=>{const[u,x]=i.useState("");i.useEffect(()=>{const C=()=>{window.innerWidth>=768?l(!0):l(!1)};return C(),window.addEventListener("resize",C),()=>window.removeEventListener("resize",C)},[l]);const b=()=>{l(!t)},w=C=>{o(C),window.innerWidth<768&&l(!1)},p=C=>{x(C)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,className:"fixed top-6 left-6 z-50 p-3 rounded-lg bg-white shadow-md border border-slate-100 md:hidden hover:bg-slate-50 transition-all duration-200","aria-label":"Toggle sidebar",children:t?e.jsx(Ge,{className:"h-5 w-5 text-slate-600"}):e.jsx(nt,{className:"h-5 w-5 text-slate-600"})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300",onClick:b}),e.jsxs("div",{className:`
          fixed top-0 left-0 h-full bg-white border-r border-slate-200 z-40 transition-all duration-300 ease-in-out flex flex-col w-64 md:w-80 md:sticky md:top-0 md:h-screen md:left-0 md:static
          ${t?"translate-x-0":"-translate-x-full"}
          md:translate-x-0 md:static md:z-auto
          ${g}
        `,children:[e.jsx(Ut,{logo:"J",title:"Admin Panel",subtitle:"Job Portal Management"}),e.jsx(zt,{searchValue:u,onSearchChange:p,placeholder:"Search..."}),e.jsx(Jt,{navigationItems:d,activeItem:r,onItemClick:w})]})]})},_t=({user:t,onLogout:l,onSearch:d,onFilter:r,searchTerm:o="",onRefresh:h})=>e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 md:px-6 py-4 sticky top-0 z-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome back, ",t?.firstName||t?.email||"Admin"]})]})}),e.jsx("div",{className:"flex-1 max-w-md mx-4 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search...",value:o,onChange:v=>d?.(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[h&&e.jsx(L,{variant:"ghost",size:"sm",onClick:h,title:"Refresh data",children:e.jsx(ye,{className:"w-5 h-5"})}),e.jsx(L,{variant:"ghost",size:"sm",children:e.jsx(it,{className:"w-5 h-5"})}),e.jsx("div",{className:"relative",children:e.jsxs(L,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Ae,{className:"w-4 h-4 text-red-600"})}),e.jsx("span",{className:"hidden md:block text-sm font-medium",children:t?.firstName||t?.email||"Admin"})]})}),e.jsx(L,{variant:"outline",size:"sm",onClick:l,className:"hidden md:block",children:"Logout"})]})]})}),Bt=()=>mt.create({page:{flexDirection:"column",backgroundColor:"#ffffff",padding:15,fontSize:9},header:{marginBottom:10,borderBottom:"2 solid #3b82f6",paddingBottom:5},title:{fontSize:24,fontWeight:"bold",color:"#1f2937",marginBottom:2},subtitle:{fontSize:16,color:"#6b7280",marginBottom:2},dateRange:{fontSize:12,color:"#9ca3af",marginBottom:6},table:{display:"table",width:"auto",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,borderColor:"#e5e7eb"},tableRow:{margin:"auto",flexDirection:"row"},tableColHeader:{width:"auto",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#3b82f6",backgroundColor:"#3b82f6",padding:1,minHeight:18,justifyContent:"center",alignItems:"center"},tableCol:{width:"1",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#e5e7eb",padding:1,minHeight:5,justifyContent:"center",alignItems:"center"},tableCellHeader:{margin:"2",fontSize:11,fontWeight:"bold",color:"#ffffff",textAlign:"center"},tableCell:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"center"},tableCellLeft:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"left"},footer:{position:"absolute",bottom:15,left:15,right:15,textAlign:"center",color:"#6b7280",fontSize:8,borderTop:"1 solid #e5e7eb",paddingTop:5},pageNumber:{position:"absolute",bottom:15,right:15,color:"#6b7280",fontSize:8},alternateRow:{backgroundColor:"#f9fafb"}}),Ht=(t,l,d,r)=>{const o=Bt(),h=r.title||Yt(t);r.subtitle||`${h.toLowerCase()}`;const v=r.dateRange||`Export Date: ${new Date().toLocaleDateString()}`,g=Qt(t,d);return J.createElement(ct,{},J.createElement(dt,{size:"A4",orientation:"landscape",style:o.page},[J.createElement(ne,{key:"header",style:o.header},[J.createElement(ie,{key:"title",style:o.title},"Job Portal System"),J.createElement(ie,{key:"subtitle",style:o.subtitle},h),J.createElement(ie,{key:"dateRange",style:o.dateRange},v)]),J.createElement(ne,{key:"table",style:o.table},[J.createElement(ne,{key:"header-row",style:o.tableRow},g.map((u,x)=>J.createElement(ne,{key:`header-${x}`,style:[o.tableColHeader,{width:_e(u.key)}]},J.createElement(ie,{style:o.tableCellHeader},u.label)))),...l.map((u,x)=>J.createElement(ne,{key:`row-${x}`,style:[o.tableRow,x%2===1?o.alternateRow:{}]},g.map((b,w)=>J.createElement(ne,{key:`cell-${x}-${w}`,style:[o.tableCol,{width:_e(b.key)}]},J.createElement(ie,{style:Vt(b.key)},Xt(u,b,t))))))]),J.createElement(ne,{key:"footer",style:o.footer},J.createElement(ie,{},`Generated by Job Portal System • Total records: ${l.length}`)),J.createElement(ie,{key:"pageNumber",style:o.pageNumber,render:({pageNumber:u,totalPages:x})=>`Page ${u} of ${x}`})]))},Wt=async(t,l,d,r={})=>{try{if(!l||!Array.isArray(l)||l.length===0)throw new Error("No table data provided");if(!d||!Array.isArray(d)||d.length===0)throw new Error("No columns provided");const o=Ht(t,l,d,r);return await ot(o).toBlob()}catch(o){throw console.error("Error generating react-pdf:",o),new Error(`Failed to generate PDF report: ${o.message}`)}},_e=(t,l)=>t==="jobseeker_info"?"40%":t==="employer_info"||t==="candidate_info"||t==="job_details"?"30%":{name:"20%",email:"25%",phone:"15%",location:"20%",category:"20%",experience:"15%",status:"12%",priority:"12%",demand:"12%",count:"10%",percentage:"10%",createdAt:"15%",registeredAt:"15%",employerName:"20%",companyName:"20%",candidateName:"20%",candidateEmail:"20%",candidateContact:"15%",position:"20%",monthlyRate:"15%",contactEmail:"20%"}[t]||"15%",Vt=t=>["jobseeker_info","employer_info","candidate_info","job_details","name","email","location","category","position","companyName","employerName","candidateName","candidateEmail"].includes(t)?{textAlign:"left"}:{textAlign:"center"},Ot=(t,l)=>!t&&t!==0?"N/A":l==="status"||l==="priority"||l==="demand"?Gt(t):l==="percentage"?`${t}%`:l==="monthlyRate"&&t!=="Not specified"?t:typeof t=="string"&&t.length>30?t.substring(0,27)+"...":t,Gt=t=>t?{Active:"Active",Inactive:"Inactive",pending:"Pending",in_progress:"In Progress",completed:"Completed",urgent:"Urgent",high:"High",normal:"Normal",low:"Low",High:"High",Medium:"Medium",Low:"Low"}[t]||t:"N/A",Yt=t=>({"job-seekers":"Job Seekers Report","employer-requests":"Employer Requests Report",categories:"Job Categories Report",locations:"Location Distribution Report",skills:"Skills Analysis Report"})[t]||"Table Report",Qt=(t,l)=>t==="job-seekers"?[{key:"jobseeker_info",label:"Job Seeker Info",subColumns:["name","email","phone","location"]},{key:"job_details",label:"Job Details",subColumns:["category","experience"]},{key:"registeredAt",label:"Registration Date",subColumns:["registeredAt"]},{key:"status",label:"Status",subColumns:["status"]}]:t==="employer-requests"?[{key:"employer_info",label:"Employer Info",subColumns:["employerName","companyName","employerEmail"]},{key:"candidate_info",label:"Candidate Info",subColumns:["candidateName","candidateEmail","candidateContact"]},{key:"job_details",label:"Job Details",subColumns:["category","monthlyRate","status","priority"]},{key:"createdAt",label:"Request Date",subColumns:["createdAt"]}]:t==="categories"?[{key:"category",label:"Category",subColumns:["category"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:t==="locations"?[{key:"location",label:"Location",subColumns:["location"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:t==="skills"?[{key:"skill",label:"Skill",subColumns:["skill"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:l.map(d=>({key:d.key,label:d.label,subColumns:[d.key]})),Xt=(t,l,d)=>{if(!l.subColumns||l.subColumns.length===1){const o=l.subColumns?l.subColumns[0]:l.key;return Ot(t[o],o)}const r=l.subColumns.map(o=>{const h=t[o];return!h||h==="Not provided"||h==="Not specified"||h==="Unknown"?null:h}).filter(Boolean);return r.length===0?"N/A":r.length===1?r[0]:l.key==="jobseeker_info"?`${r[0]}
${r[1]}
${r[2]}
${r[3]}`:l.key==="employer_info"?`${r[0]}
${r[1]}
${r[2]||"N/A"}`:l.key==="candidate_info"?`${r[0]}
${r[1]}
${r[2]||"N/A"}`:l.key==="job_details"?d==="job-seekers"?`${r[0]}
${r[1]}`:d==="employer-requests"?`${r[0]}
${r[1]}
${r[2]}
${r[3]}`:r.join(`
`):r.join(`
`)},Zt=async(t,l)=>{try{const d=URL.createObjectURL(t),r=document.createElement("a");return r.href=d,r.download=l,r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(d),!0}catch(d){return console.error("Error saving PDF:",d),!1}},Kt=(t,l,d)=>{try{const r=l.map(x=>x.label).join(","),o=t.map(x=>l.map(b=>{const w=x[b.key];return typeof w=="string"&&(w.includes(",")||w.includes('"'))?`"${w.replace(/"/g,'""')}"`:w||""}).join(",")),h=[r,...o].join(`
`),v=new Blob([h],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a"),u=URL.createObjectURL(v);return g.setAttribute("href",u),g.setAttribute("download",d),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g),!0}catch(r){return console.error("Error exporting CSV:",r),!1}},es=(t,l,d)=>{try{let r='<table border="1">';r+="<tr>",l.forEach(g=>{r+=`<th style="background-color: #3b82f6; color: white; padding: 8px; text-align: center; font-weight: bold;">${g.label}</th>`}),r+="</tr>",t.forEach(g=>{r+="<tr>",l.forEach(u=>{const x=g[u.key]||"";r+=`<td style="padding: 6px; border: 1px solid #e5e7eb;">${x}</td>`}),r+="</tr>"}),r+="</table>";const o=new Blob([r],{type:"application/vnd.ms-excel"}),h=document.createElement("a"),v=URL.createObjectURL(o);return h.setAttribute("href",v),h.setAttribute("download",d.replace(".xlsx",".html")),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h),!0}catch(r){return console.error("Error exporting Excel:",r),!1}},ts=()=>{const{t}=Te(),[l,d]=i.useState("30"),[r,o]=i.useState(!1),[h,v]=i.useState(null),[g,u]=i.useState(!0),[x,b]=i.useState(""),[w,p]=i.useState(null),[C,S]=i.useState("job-seekers"),[T,f]=i.useState(""),[P,M]=i.useState("pdf"),{jobSeekers:$,loading:W,error:Q,fetchJobSeekers:I}=Xe({autoFetch:!0,itemsPerPage:1e3}),{requests:X,loading:j,error:y,fetchRequests:N}=Ze({autoFetch:!0,itemsPerPage:1e3}),{categories:D,loading:U,error:V,fetchCategories:ee}=At({includeAdmin:!0,autoFetch:!0});i.useEffect(()=>{ae()},[l]);const ae=async()=>{try{u(!0),b("");const[n,s]=await Promise.all([oe.getAnalytics({period:l}),oe.getDashboardStats()]);n.success?v(n.data):b(n.error||"Failed to load analytics data"),s.success&&p(s.data)}catch(n){console.error("Error loading report data:",n),b("Network error. Please try again.")}finally{u(!1)}},Y=[{value:"7",label:"Last 7 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days"},{value:"365",label:"Last Year"}],m=[{value:"job-seekers",label:"Job Seekers",icon:Ee},{value:"employer-requests",label:"Employer Requests",icon:he},{value:"categories",label:"Categories",icon:Fe},{value:"locations",label:"Locations",icon:We},{value:"skills",label:"Skills",icon:ut}],c=async n=>{o(!0);try{const s=ue(n),a=re(n);if(!s||s.length===0)return z.error("No data available for export"),!1;const F=new Date().toISOString().split("T")[0],k=`table-report-${n}-${F}`;let O=!1;switch(P){case"pdf":const je={title:G(n),subtitle:`Comprehensive data table for ${G(n).toLowerCase()}`,dateRange:`Last ${l} days (${new Date(Date.now()-parseInt(l)*24*60*60*1e3).toLocaleDateString()} - ${new Date().toLocaleDateString()})`};try{const le=await Wt(n,s,a,je),A=`${k}.pdf`;O=await Zt(le,A)}catch(le){return console.error("PDF generation error:",le),z.error(`PDF generation failed: ${le.message}`),!1}O?z.success(`${G(n)} exported successfully as PDF!`):z.error("Failed to save PDF file");break;case"csv":const Ne=`${k}.csv`;O=Kt(s,a,Ne),O?z.success(`${G(n)} exported successfully as CSV!`):z.error("Failed to save CSV file");break;case"excel":const ve=`${k}.xlsx`;O=es(s,a,ve),O?z.success(`${G(n)} exported successfully as Excel!`):z.error("Failed to save Excel file");break;default:return z.error("Unsupported export format"),!1}return O}catch(s){return console.error("Error exporting report:",s),z.error("Error generating export report. Please try again."),!1}finally{o(!1)}},q=async()=>{o(!0);try{await Promise.all([ae(),I(),N(),ee()])}catch(n){console.error("Error refreshing data:",n),b("Failed to refresh data. Please try again.")}finally{o(!1)}},_=()=>!$||$.length===0?[]:$.map(n=>({id:n.id,name:`${n.profile?.firstName||n.firstName||n.name||"Unknown"} ${n.profile?.lastName||n.lastName||""}`,email:n.email||n.profile?.email||"Not provided",phone:n.profile?.contactNumber||n.contactNumber||n.phone||"Not provided",location:n.profile?.location||n.location||n.city||"Not specified",category:n.profile?.jobCategory?.name_en||n.jobCategory?.name_en||n.category||"Not specified",experience:n.profile?.experienceLevel||n.experienceLevel||n.experience||"Not specified",registeredAt:n.registeredAt||n.createdAt?new Date(n.registeredAt||n.createdAt).toLocaleDateString():"Unknown",status:n.status||"Active"})),ce=()=>{if(!X||X.length===0)return[];const n=s=>{if(!s||s==="Not specified")return"Not specified";if(typeof s=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(s);if(typeof s=="string"){const a=parseFloat(s);return isNaN(a)?s:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(a)}return"Not specified"};return X.map(s=>({id:s.id,employerName:s.name||s.employerName||s.employer?.name||"Unknown",companyName:s.companyName||s.employer?.company||"Private",candidateName:s.requestedCandidate&&`${s.requestedCandidate.profile?.firstName||""} ${s.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:s.requestedCandidate?.profile?.skills||s.position||s.jobTitle||"General",status:s.status||"pending",priority:s.priority||"normal",monthlyRate:n(s.requestedCandidate?.profile?.monthlyRate),createdAt:s.createdAt?new Date(s.createdAt).toLocaleDateString():"Unknown",contactEmail:s.email||s.employerContact?.email||s.employer?.email||"Not provided",lastContactDate:s.updatedAt,isCompleted:s.status==="completed",category:s.requestedCandidate?.profile?.jobCategory?.name_en||"General",candidateExperience:s.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:s.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:s.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:s.requestedCandidate?.profile?.location||"Not specified",candidateCity:s.requestedCandidate?.profile?.city||"Not specified",candidateCountry:s.requestedCandidate?.profile?.country||"Not specified",candidateContact:s.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:s.requestedCandidate?.email||"Not specified",candidateLanguages:s.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:s.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:s.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:s.requestedCandidate?.profile?.description||"Not specified",candidateGender:s.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:s.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:s.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:s.requestedCandidate?.profile?.references||"Not specified",message:s.message||"",_backendData:s}))},de=()=>{if(!D||D.length===0)return[];const n={};return $?.forEach(s=>{const a=s.profile?.jobCategory?.name_en||s.jobCategory?.name_en||s.category||"Uncategorized";n[a]=(n[a]||0)+1}),D.map(s=>{const a=n[s.name_en]||0,F=$?.length||1,k=Math.round(a/F*100);return{id:s.id,name:s.name_en||s.name,count:a,percentage:k,status:"Active"}})},me=()=>{if(!$||$.length===0)return[];const n={};return $.forEach(s=>{const a=s.profile?.location||s.location||s.city||"Unknown";n[a]=(n[a]||0)+1}),Object.entries(n).map(([s,a])=>{const F=$.length,k=Math.round(a/F*100);return{id:s,name:s,count:a,percentage:k,status:"Active"}}).sort((s,a)=>a.count-s.count)},pe=()=>{if(!$||$.length===0)return[];const n={};return $.forEach(s=>{const a=s.profile?.skills||s.skills||"";a&&a.split(",").map(k=>k.trim()).filter(k=>k).forEach(k=>{n[k]=(n[k]||0)+1})}),Object.entries(n).map(([s,a])=>{const F=$.length,k=Math.round(a/F*100),O=a>F*.3?"High":a>F*.1?"Medium":"Low";return{id:s,name:s,count:a,percentage:k,demand:O}}).sort((s,a)=>a.count-s.count)},re=n=>{switch(n){case"job-seekers":return[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"location",label:"Location",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"experience",label:"Experience",sortable:!0},{key:"registeredAt",label:"Registered",sortable:!0},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(R,{variant:s.status==="Active"?"success":"warning",children:s.status})}];case"employer-requests":return[{key:"employerName",label:"Employer Name",sortable:!0},{key:"companyName",label:"Company",sortable:!0},{key:"contactEmail",label:"Employer Email",sortable:!0},{key:"candidateName",label:"Candidate Name",sortable:!0},{key:"candidateEmail",label:"Candidate Email",sortable:!0},{key:"candidateContact",label:"Candidate Phone",sortable:!0},{key:"position",label:"Position/Skills",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"monthlyRate",label:"Monthly Rate",sortable:!0},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(R,{variant:s.status==="completed"?"success":s.status==="in_progress"?"warning":s.status==="pending"?"info":"danger",children:s.status.replace("_"," ")})},{key:"priority",label:"Priority",sortable:!0,render:s=>e.jsx(R,{variant:s.priority==="urgent"?"danger":s.priority==="high"?"warning":s.priority==="normal"?"info":"secondary",children:s.priority})},{key:"createdAt",label:"Created",sortable:!0}];case"categories":return[{key:"name",label:"Category Name",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:s=>e.jsxs("span",{children:[s.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(R,{variant:"success",children:s.status})}];case"locations":return[{key:"name",label:"Location",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:s=>e.jsxs("span",{children:[s.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(R,{variant:"success",children:s.status})}];case"skills":return[{key:"name",label:"Skill Name",sortable:!0},{key:"count",label:"Count",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:s=>e.jsxs("span",{children:[s.percentage,"%"]})},{key:"demand",label:"Demand Level",sortable:!0,render:s=>e.jsx(R,{variant:s.demand==="High"?"success":s.demand==="Medium"?"warning":"info",children:s.demand})}];default:return[]}},ue=n=>{switch(n){case"job-seekers":return _();case"employer-requests":return ce();case"categories":return de();case"locations":return me();case"skills":return pe();default:return[]}},G=n=>{const s=m.find(a=>a.value===n);return s?s.label:"Report"};return g||W||j||U?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(te,{size:"lg",text:"Loading table reports..."})}):x||Q||y||V?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Oe,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Table Reports"}),e.jsx("p",{className:"text-red-600 mb-4",children:x||Q||y||V}),e.jsxs(L,{onClick:q,variant:"outline",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Table Reports"})})}),e.jsx(K,{className:"",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsx("select",{value:l,onChange:n=>d(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Y.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]})}),m.map(n=>{const s=n.icon,a=C===n.value;return e.jsx("button",{onClick:()=>S(n.value),className:`p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md ${a?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 hover:border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(s,{className:`w-6 h-6 ${a?"text-blue-600":"text-gray-500"}`}),e.jsx("span",{className:"text-sm font-medium text-center",children:n.label})]})},n.value)})]})}),C&&e.jsxs(K,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:G(C)}),e.jsxs("p",{className:"text-gray-600",children:["Comprehensive data table for ",G(C).toLowerCase()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:P,onChange:n=>M(n.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"excel",children:"Excel"})]}),e.jsxs(L,{onClick:()=>c(C),disabled:r,className:"flex items-center gap-2",children:[e.jsx(xt,{className:"w-3 h-3"}),r?"Exporting...":`Export ${P.toUpperCase()}`]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(L,{onClick:q,variant:"outline",disabled:r,className:"flex items-center gap-2",children:[e.jsx(ye,{className:`w-3 h-3 ${r?"animate-spin":""}`}),r?"Refreshing...":"Refresh"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(Ke,{columns:re(C),data:ue(C),pagination:!0,itemsPerPage:15,searchTerm:T,onSearchChange:f,className:"w-full"})})]}),e.jsx(Ye,{position:"top-right"})]})},ss=(t={})=>{const{autoFetch:l=!1,itemsPerPage:d=10,page:r=1,searchTerm:o="",status:h="",category:v=""}=t,[g,u]=i.useState([]),[x,b]=i.useState(!1),[w,p]=i.useState(""),[C,S]=i.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[T,f]=i.useState(null),P=i.useCallback(async(j={})=>{b(!0),p("");try{const y={page:j.page||r,limit:j.itemsPerPage||d,search:j.searchTerm||o,status:j.status||h,category:j.category||v,...j},N=await xe.getAllContacts(y);N.success?(u(Array.isArray(N.data.contacts)?N.data.contacts:[]),N.data.pagination&&S(N.data.pagination),N.data.statistics&&f(N.data.statistics)):p(N.error)}catch(y){p("Failed to fetch contact messages"),console.error("Error fetching contact messages:",y)}finally{b(!1)}},[r,d,o,h,v]),M=i.useCallback(async j=>{b(!0),p("");try{const y=await xe.getMessageById(j);return y.success?y.data:(p(y.error),null)}catch(y){return p("Failed to fetch contact message"),console.error("Error fetching contact message:",y),null}finally{b(!1)}},[]),$=i.useCallback(async(j,y)=>{b(!0),p("");try{const N=await xe.respondToMessage(j,y);return N.success?(await P(),N):(p(N.error),N)}catch{return p("Failed to respond to message"),{success:!1,error:"Failed to respond to message"}}finally{b(!1)}},[P]),W=i.useCallback(async j=>{try{const y=await xe.markAsRead(j);return y.success?(u(N=>N.map(D=>D.id===j?{...D,isRead:!0}:D)),y):(p(y.error),y)}catch(y){return p("Failed to mark message as read"),console.error("Error marking message as read:",y),{success:!1,error:"Failed to mark message as read"}}},[]),Q=i.useCallback(async j=>{try{const y=await xe.deleteMessage(j);return y.success?(u(N=>N.filter(D=>D.id!==j)),y):(p(y.error),y)}catch(y){return p("Failed to delete message"),console.error("Error deleting message:",y),{success:!1,error:"Failed to delete message"}}},[]),I=i.useCallback(async()=>{try{const j=await xe.getStatistics();return j.success?(f(j.data),j.data):(p(j.error),null)}catch(j){return p("Failed to fetch statistics"),console.error("Error fetching statistics:",j),null}},[]),X=i.useCallback(()=>P(),[P]);return i.useEffect(()=>{l&&(P(),I())},[l,P,I]),{messages:g,loading:x,error:w,pagination:C,statistics:T,fetchMessages:P,fetchMessageById:M,respondToMessage:$,markAsRead:W,deleteMessage:Q,fetchStatistics:I,refreshMessages:X}},as=()=>{const{t}=Te(),[l,d]=i.useState(""),[r,o]=i.useState(""),[h,v]=i.useState(""),[g,u]=i.useState(null),[x,b]=i.useState(!1),[w,p]=i.useState(!1),[C,S]=i.useState(!1),[T,f]=i.useState({subject:"",message:""}),[P,M]=i.useState(!1),{messages:$,loading:W,error:Q,statistics:I,fetchMessages:X,respondToMessage:j,markAsRead:y,deleteMessage:N,refreshMessages:D}=ss({autoFetch:!0,itemsPerPage:15}),[U,V]=i.useState(1),ee=15,Y=(Array.isArray($)?$.map(a=>({...a,createdAt:a.createdAt||""})):[]).filter(a=>{const F=!l||a.status===l,k=!r||a.category===r,O=!h||a.priority===h;return F&&k&&O}),m=Math.ceil(Y.length/ee),c=Y.slice((U-1)*ee,U*ee),q=(a,F)=>{u(F),b(!0)};i.useEffect(()=>{X({status:l,category:r,priority:h})},[l,r,h]);const _=async a=>{u(a),b(!0),a.isRead||await y(a.id)},ce=a=>{u(a),f({subject:`Re: ${a.subject}`,message:""}),p(!0)},de=a=>{u(a),S(!0)},me=async a=>{if(a.preventDefault(),!localStorage.getItem("job_portal_token")){z.error("You are not logged in. Please log in again."),window.location.href="/login";return}if(!T.subject.trim()||!T.message.trim()){z.error("Please fill in both subject and message");return}if(g&&g.status==="responded"){z.error("This message has already been responded to. You cannot reply again."),p(!1);return}M(!0);try{const k=await j(g.id,T);k.success?(z.success("Response sent successfully!"),p(!1),f({subject:"",message:""}),u(null)):z.error(k.error||"Failed to send response")}catch{z.error("Failed to send response. Please try again.")}finally{M(!1)}},pe=async()=>{(await N(g.id)).success?(z.success("Message deleted successfully!"),S(!1),u(null)):z.error("Failed to delete message")},re=a=>{switch(a){case"unread":return e.jsx(R,{variant:"warning",children:"Unread"});case"read":return e.jsx(R,{variant:"info",children:"Read"});case"responded":return e.jsx(R,{variant:"success",children:"Responded"});case"archived":return e.jsx(R,{variant:"secondary",children:"Archived"});default:return e.jsx(R,{variant:"outline",children:a})}},ue=a=>{switch(a){case"low":return e.jsx(R,{variant:"secondary",children:"Low"});case"normal":return e.jsx(R,{variant:"info",children:"Normal"});case"high":return e.jsx(R,{variant:"warning",children:"High"});case"urgent":return e.jsx(R,{variant:"danger",children:"Urgent"});default:return e.jsx(R,{variant:"outline",children:a})}},G=a=>{switch(a){case"general":return e.jsx(R,{variant:"info",children:"General"});case"support":return e.jsx(R,{variant:"warning",children:"Support"});case"feedback":return e.jsx(R,{variant:"success",children:"Feedback"});case"complaint":return e.jsx(R,{variant:"danger",children:"Complaint"});default:return e.jsx(R,{variant:"outline",children:a})}},n=[{key:"name",label:"Name",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:a.name})]})},{key:"email",label:"Email",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:a.email})]})},{key:"subject",label:"Subject",sortable:!0,render:a=>e.jsx("div",{className:"max-w-xs truncate",title:a.subject,children:a.subject})},{key:"category",label:"Category",sortable:!0,render:a=>G(a.category)},{key:"priority",label:"Priority",sortable:!0,render:a=>ue(a.priority)},{key:"status",label:"Status",sortable:!0,render:a=>re(a.status)},{key:"submittedAt",label:"Date",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:new Date(a.createdAt).toLocaleDateString()})]})}],s=a=>[{key:"view",label:"View",icon:ge,onClick:()=>_(a),variant:"outline"},{key:"reply",label:"Reply",icon:Le,onClick:()=>{a.status==="responded"?z.error("This message has already been responded to."):ce(a)},variant:"primary",disabled:a.status==="responded"},{key:"delete",label:"Delete",icon:$e,onClick:()=>de(a),variant:"danger"}];return W&&$.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(te,{size:"lg",text:"Loading contact messages..."})}):Q&&$.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(fe,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Contact Messages"}),e.jsx("p",{className:"text-red-600 mb-4",children:Q}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Authentication Issue:"})," This error usually means you need to log in again or your session has expired."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsxs(L,{onClick:D,variant:"outline",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsx(L,{onClick:()=>window.location.href="/login",variant:"primary",children:"Go to Login"})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-gray-600",children:"Manage and respond to contact form submissions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(L,{onClick:D,variant:"outline",disabled:W,className:"flex items-center gap-2",children:[e.jsx(ye,{className:`w-4 h-4 ${W?"animate-spin":""}`}),W?"Refreshing...":"Refresh"]})})]}),I&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(he,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:I.total||0})]})]})}),e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(be,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Unread Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:I.unread||0})]})]})}),e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Pe,{className:"w-6 h-6 text-green-600"})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:I.responded||0})})]})}),e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(gt,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Archived"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:I.archived||0})]})]})})]}),e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:l,onChange:a=>d(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"unread",children:"Unread"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"responded",children:"Responded"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:r,onChange:a=>o(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"feedback",children:"Feedback"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{value:h,onChange:a=>v(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(L,{onClick:()=>{d(""),o(""),v("")},variant:"outline",className:"w-full",children:[e.jsx(ht,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})})]})}),e.jsx(Ke,{columns:n,data:c,pagination:!0,itemsPerPage:ee,actionButtons:s,onRowAction:q,className:"w-full"}),m>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx(L,{variant:"outline",size:"sm",onClick:()=>V(U-1),disabled:U===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",U," of ",m]}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>V(U+1),disabled:U===m,children:"Next"})]}),e.jsx(ke,{isOpen:x,onClose:()=>b(!1),title:"View Message",maxWidth:"max-w-2xl",children:g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:g.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:g.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("p",{className:"text-gray-900",children:g.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("div",{children:G(g.category)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{children:re(g.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(g.createdAt).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:g.message})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(L,{onClick:()=>{b(!1),ce(g)},variant:"primary",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Reply"]}),e.jsx(L,{onClick:()=>b(!1),variant:"outline",children:"Close"})]})]})}),e.jsx(ke,{isOpen:w,onClose:()=>p(!1),title:"Reply to Message",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:me,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:T.subject,onChange:a=>f(F=>({...F,subject:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:T.message,onChange:a=>f(F=>({...F,message:a.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Type your response...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(L,{type:"button",onClick:()=>p(!1),variant:"outline",disabled:P,children:"Cancel"}),e.jsx(L,{type:"submit",variant:"primary",disabled:P,children:P?e.jsxs("span",{className:"flex items-center",children:[e.jsx(te,{size:"sm",className:"mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Send Reply"]})})]})]})}),e.jsx(Ye,{position:"top-right"}),e.jsx(ke,{isOpen:C,onClose:()=>S(!1),title:"Delete Message",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($e,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Message"}),e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to delete this message? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(L,{onClick:()=>S(!1),variant:"outline",children:"Cancel"}),e.jsxs(L,{onClick:pe,variant:"danger",children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})},rs=({loadingTime:t,apiCalls:l,cacheHits:d,errors:r,showDetails:o=!1})=>{const[h,v]=i.useState(!1);if(i.useEffect(()=>{const x=setTimeout(()=>{(t>2e3||r.length>0)&&v(!0)},2e3);return()=>clearTimeout(x)},[t,r.length]),!h)return null;const u=t<1e3?{status:"excellent",color:"text-green-600",bg:"bg-green-50"}:t<2e3?{status:"good",color:"text-blue-600",bg:"bg-blue-50"}:t<5e3?{status:"fair",color:"text-yellow-600",bg:"bg-yellow-50"}:{status:"poor",color:"text-red-600",bg:"bg-red-50"};return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 ${u.bg} border rounded-lg shadow-lg p-4 max-w-sm transition-all duration-300`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`font-semibold ${u.color}`,children:"Performance Monitor"}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(be,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["Load Time: ",e.jsxs("span",{className:u.color,children:[t,"ms"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pt,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["API Calls: ",l]})]}),d>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ft,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:["Cache Hits: ",d]})]}),r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{children:["Errors: ",r.length]})]})]}),o&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:u.color,children:u.status})]}),e.jsxs("div",{children:["Performance: ",t<1e3?"🚀":t<2e3?"⚡":t<5e3?"🐌":"🐌🐌"]})]})})]})},ls=()=>{const{user:t,updateUser:l}=Qe(),[d,r]=i.useState("profile"),[o,h]=i.useState(!1),[v,g]=i.useState(!0),[u,x]=i.useState({type:"",text:""}),[b,w]=i.useState({startTime:Date.now(),loadingTime:0,apiCalls:0,cacheHits:0,errors:[]}),[p,C]=i.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:""}),[S,T]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[f,P]=i.useState({}),[M,$]=i.useState(!1),[W,Q]=i.useState(!1),[I,X]=i.useState(!1),j=i.useMemo(()=>[{id:"profile",label:"Profile",icon:Ae},{id:"security",label:"Security",icon:bt}],[]),y=i.useCallback(async()=>{try{g(!0),w(c=>({...c,apiCalls:c.apiCalls+1})),console.log("🔄 Loading admin profile...");const m=await oe.getAdminProfile();if(console.log("📊 Admin profile result:",m),m.success){const c=m.data;console.log("👤 Admin data received:",c),C({firstName:c.firstName||c.profile?.firstName||"",lastName:c.lastName||c.profile?.lastName||"",email:c.email||"",phone:c.phone||c.phoneNumber||c.profile?.phoneNumber||"",location:c.location||c.city||c.profile?.city||"",bio:c.bio||c.profile?.bio||""}),m.fromCache&&w(q=>({...q,cacheHits:q.cacheHits+1}))}else console.warn("⚠️ Failed to load admin profile from API, using user context data"),console.warn("❌ API Error:",m.error),t&&(console.log("👤 Falling back to user context data:",t),C({firstName:t.profile?.firstName||t.firstName||"",lastName:t.profile?.lastName||t.lastName||"",email:t.email||"",phone:t.profile?.phoneNumber||t.phoneNumber||"",location:t.profile?.city||t.city||"",bio:t.profile?.bio||t.bio||""})),w(c=>({...c,errors:[...c.errors,m.error||"Failed to load admin profile"]}))}catch(m){console.error("💥 Error loading admin profile:",m),t&&(console.log("👤 Falling back to user context data on error:",t),C({firstName:t.profile?.firstName||t.firstName||"",lastName:t.profile?.lastName||t.lastName||"",email:t.email||"",phone:t.profile?.phoneNumber||t.phoneNumber||"",location:t.profile?.city||t.city||"",bio:t.profile?.bio||t.bio||""})),w(c=>({...c,errors:[...c.errors,"Network error loading admin profile"]}))}finally{g(!1)}},[t]);i.useEffect(()=>{const c=Date.now()-b.startTime;w(q=>({...q,loadingTime:c}))},[v]),i.useEffect(()=>{y()},[y]);const N=i.useCallback(m=>{const{name:c,value:q}=m.target;C(_=>({..._,[c]:q})),f[c]&&P(_=>({..._,[c]:""}))},[f]),D=i.useCallback(m=>{const{name:c,value:q}=m.target;T(_=>({..._,[c]:q})),f[c]&&P(_=>({..._,[c]:""}))},[f]),U=i.useCallback(()=>{const m={};return p.firstName.trim()||(m.firstName="First name is required"),p.lastName.trim()||(m.lastName="Last name is required"),p.email.trim()?/\S+@\S+\.\S+/.test(p.email)||(m.email="Email is invalid"):m.email="Email is required",p.phone&&!/^\+?[\d\s\-\(\)]+$/.test(p.phone)&&(m.phone="Phone number is invalid"),P(m),Object.keys(m).length===0},[p]),V=i.useCallback(()=>{const m={};return S.currentPassword||(m.currentPassword="Current password is required"),S.newPassword?S.newPassword.length<8&&(m.newPassword="Password must be at least 8 characters"):m.newPassword="New password is required",S.newPassword!==S.confirmPassword&&(m.confirmPassword="Passwords do not match"),P(m),Object.keys(m).length===0},[S]),ee=i.useCallback(async()=>{if(U())try{h(!0),w(c=>({...c,apiCalls:c.apiCalls+1}));const m=await oe.updateAdminProfile(p);m.success?(x({type:"success",text:"Profile updated successfully!"}),l&&l({...t,...p}),setTimeout(()=>x({type:"",text:""}),3e3)):(x({type:"error",text:m.error||"Failed to update profile"}),w(c=>({...c,errors:[...c.errors,m.error||"Profile update failed"]})))}catch{x({type:"error",text:"Network error. Please try again."}),w(c=>({...c,errors:[...c.errors,"Network error during profile update"]}))}finally{h(!1)}},[p,U,l,t]),ae=i.useCallback(async()=>{if(V())try{h(!0),w(c=>({...c,apiCalls:c.apiCalls+1}));const m=await oe.changeAdminPassword({currentPassword:S.currentPassword,newPassword:S.newPassword});m.success?(x({type:"success",text:"Password changed successfully!"}),T({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>x({type:"",text:""}),3e3)):(x({type:"error",text:m.error||"Failed to change password"}),w(c=>({...c,errors:[...c.errors,m.error||"Password change failed"]})))}catch{x({type:"error",text:"Network error. Please try again."}),w(c=>({...c,errors:[...c.errors,"Network error during password change"]}))}finally{h(!1)}},[S,V]),Y=i.useMemo(()=>u.text?e.jsxs(Ce.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center space-x-2 ${u.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[u.type==="success"?e.jsx(Pe,{className:"w-5 h-5"}):e.jsx(fe,{className:"w-5 h-5"}),e.jsx("span",{children:u.text}),e.jsx("button",{onClick:()=>x({type:"",text:""}),className:"ml-auto hover:opacity-70 transition-opacity",children:e.jsx(Ge,{className:"w-4 h-4"})})]}):null,[u]);return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(te,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your profile and system settings"})]})}),Y,e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:j.map(m=>{const c=m.icon;return e.jsxs("button",{onClick:()=>r(m.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${d===m.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{children:m.label})]},m.id)})})}),e.jsxs("div",{className:"mt-6",children:[d==="profile"&&e.jsx(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(K,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:p.firstName,onChange:N,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.firstName?"border-red-300":"border-gray-300"}`}),f.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:p.lastName,onChange:N,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.lastName?"border-red-300":"border-gray-300"}`}),f.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:p.email,onChange:N,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.email?"border-red-300":"border-gray-300"}`}),f.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:p.phone,onChange:N,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.phone?"border-red-300":"border-gray-300"}`}),f.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:p.location,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{name:"bio",value:p.bio,onChange:N,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"Tell us about yourself..."})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(L,{variant:"primary",onClick:ee,disabled:o,children:[o?e.jsx(te,{size:"sm"}):e.jsx(yt,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})})}),d==="security"&&e.jsx(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs(K,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:M?"text":"password",name:"currentPassword",value:S.currentPassword,onChange:D,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.currentPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>$(!M),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:M?e.jsx(Me,{className:"w-4 h-4 text-gray-400"}):e.jsx(ge,{className:"w-4 h-4 text-gray-400"})})]}),f.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:W?"text":"password",name:"newPassword",value:S.newPassword,onChange:D,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.newPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>Q(!W),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:W?e.jsx(Me,{className:"w-4 h-4 text-gray-400"}):e.jsx(ge,{className:"w-4 h-4 text-gray-400"})})]}),f.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:I?"text":"password",name:"confirmPassword",value:S.confirmPassword,onChange:D,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.confirmPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>X(!I),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:I?e.jsx(Me,{className:"w-4 h-4 text-gray-400"}):e.jsx(ge,{className:"w-4 h-4 text-gray-400"})})]}),f.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.confirmPassword})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(L,{variant:"primary",onClick:ae,disabled:o,children:[o?e.jsx(te,{size:"sm"}):e.jsx(jt,{className:"w-4 h-4 mr-2"}),"Change Password"]})})]})]})})]})]}),e.jsx(rs,{loadingTime:b.loadingTime,apiCalls:b.apiCalls,cacheHits:b.cacheHits,errors:b.errors,showDetails:!0})]})},ks=()=>{const{t}=Te(),{user:l,logout:d}=Qe(),r=$t(),{liveData:o,lastUpdate:h,isConnected:v,manualRefresh:g,addNotification:u}=Nt(),[x,b]=i.useState("dashboard"),[w,p]=i.useState(!0),[C,S]=i.useState(null),[T,f]=i.useState(!1),[P,M]=i.useState(""),[$,W]=i.useState(""),[Q,I]=i.useState(null),[X,j]=i.useState(!0),[y,N]=i.useState(null),[D,U]=i.useState("all"),{jobSeekers:V,loading:ee,fetchJobSeekers:ae}=Xe({autoFetch:!1,itemsPerPage:5}),{requests:Y,loading:m,fetchRequests:c}=Ze({autoFetch:!1}),{fetchCategories:q}=Dt({autoFetch:!1}),_=async()=>{try{j(!0),N(null);const s=await oe.getDashboardStats();s.success?I(s.data):N("Failed to load dashboard statistics"),await Promise.all([ae(),c(),q()])}catch(s){N("Failed to load dashboard data"),console.error("Dashboard load error:",s)}finally{j(!1)}},ce=async()=>{try{j(!0),await _(),u({message:"Dashboard refreshed successfully",type:"success",duration:3e3})}catch{N("Failed to refresh dashboard data"),u({message:"Failed to refresh dashboard",type:"error",duration:5e3})}finally{j(!1)}};i.useEffect(()=>{o.dashboard&&I(o.dashboard),o.requests,o.jobSeekers},[o]);const de=()=>{d(),r("/")},me=s=>{S(s),M(s.adminNotes||""),f(!0)},pe=async(s,a,F)=>{try{const k=await oe.updateRequestStatus(s,{status:a,adminNotes:F});k.success?(await c(),f(!1),S(null),M(""),u({message:`Request ${a==="completed"?"marked as completed":"status updated"} successfully!`,type:"success",duration:5e3})):u({message:`Error: ${k.error}`,type:"error",duration:5e3})}catch(k){u({message:"Failed to update request status",type:"error",duration:5e3}),console.error("Request update error:",k)}},re=s=>{W(s)},ue=()=>{};if(i.useEffect(()=>{_()},[]),X)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(te,{size:"lg",text:"Loading Dashboard..."})});if(y)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Dashboard Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:y}),e.jsx(L,{onClick:_,className:"w-full",children:"Retry"})]})});const G=()=>{const s=Q||{},a=s.data||s,F=A=>{if(!Array.isArray(A))return[];const B={};return A.forEach(E=>{E.profile?.skills&&E.profile.skills.split(",").map(Z=>Z.trim()).forEach(Z=>{B[Z]=(B[Z]||0)+1})}),Object.entries(B).map(([E,H])=>({name:E,count:H})).sort((E,H)=>H.count-E.count).slice(0,5)},k=(A,B=0)=>{if(B===0)return A>0?{change:"+100%",changeType:"increase"}:{change:"0%",changeType:"neutral"};const E=(A-B)/B*100,H=E>=0?`+${Math.round(E)}%`:`${Math.round(E)}%`,Z=E>0?"increase":E<0?"decrease":"neutral";return{change:H,changeType:Z}},O=(A,B=7)=>{const E=new Date,H=new Date(E.getTime()-B*24*60*60*1e3),Z=new Date(E.getTime()-B*2*24*60*60*1e3),De=A.filter(Re=>new Date(Re.createdAt)>=H).length,se=A.filter(Re=>{const Ue=new Date(Re.createdAt);return Ue>=Z&&Ue<H}).length;return k(De,se)},je=O(V||[]),Ne=O(Y||[]),ve=k((Y||[]).filter(A=>A.status==="pending").length,Math.max(1,Math.floor((Y||[]).filter(A=>A.status==="pending").length*.8))),le=k(a.overview?.totalCategories||a.totalCategories||0,Math.max(1,Math.floor((a.overview?.totalCategories||a.totalCategories||0)*.9)));return F(V||[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx(Mt,{isConnected:v,lastUpdate:h,onRefresh:g,className:"text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 ",children:[e.jsx(we,{title:"Total Job Seekers",value:a.overview?.totalJobSeekers||a.totalJobSeekers||0,icon:Ee,change:je.change,changeType:je.changeType,color:"text-blue-600",bgColor:"bg-blue-100",description:"Active job seekers",index:0,trendPeriod:"7 days"}),e.jsx(we,{title:"Employer Requests",value:a.overview?.totalEmployerRequests||a.totalEmployerRequests||0,icon:he,change:Ne.change,changeType:Ne.changeType,color:"text-green-600",bgColor:"bg-green-100",description:"Total requests",index:1,trendPeriod:"7 days"}),e.jsx(we,{title:"Pending Requests",value:a.overview?.pendingEmployerRequests||a.pendingEmployerRequests||0,icon:be,change:ve.change,changeType:ve.changeType,color:"text-orange-600",bgColor:"bg-orange-100",description:"Awaiting review",index:2,trendPeriod:"7 days"}),e.jsx(we,{title:"Categories",value:a.overview?.totalCategories||a.totalCategories||0,icon:Fe,change:le.change,changeType:le.changeType,color:"text-purple-600",bgColor:"bg-purple-100",description:"Job categories",index:3,showTrend:!1})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(K,{title:"Latest Job Seekers",subtitle:"Most recently registered candidates (showing latest 5)",children:ee?e.jsx(te,{size:"md",text:"Loading job seekers..."}):(a.recentActivity?.recentJobSeekers||V||[]).length>0?e.jsx("div",{className:"space-y-3",children:(a.recentActivity?.recentJobSeekers||V||[]).slice(0,5).map((A,B)=>{const E=(V||[]).find(se=>se.id===A.id)||A,H=E?.profile?.photo||E?.avatar||E?.photo||null,De=(se=>se?/^https?:\/\//i.test(se)?se:`${vt.BASE_URL}/${se.replace(/^\//,"")}`:null)(H);return e.jsx(Tt,{jobSeeker:{id:A.id,name:A.name||`${A?.profile?.firstName||""} ${A?.profile?.lastName||""}`.trim()||"Unknown",title:"Job Seeker",category:A.skills?.split(",")[0]||"General",avatar:De,location:A.location||A?.profile?.location||"Unknown",dailyRate:A.dailyRate,monthlyRate:A.monthlyRate},onViewDetails:me,getCategoryColor:kt,compact:!0},A.id||B)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ee,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent job seekers"})]})}),e.jsxs(K,{title:"Latest Employer Requests",subtitle:"Most recent job requests with candidate details (showing latest 5)",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx("button",{onClick:()=>U("all"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${D==="all"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>U("pending"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${D==="pending"?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Pending"}),e.jsx("button",{onClick:()=>U("in_progress"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${D==="in_progress"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"In Progress"}),e.jsx("button",{onClick:()=>U("approved"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${D==="approved"?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Approved"}),e.jsx("button",{onClick:()=>U("completed"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${D==="completed"?"bg-purple-100 text-purple-800 border-purple-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Completed"}),e.jsx("button",{onClick:()=>U("cancelled"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${D==="cancelled"?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Cancelled"})]})}),m?e.jsx(te,{size:"md",text:"Loading requests..."}):(Y||[]).length>0?e.jsx("div",{className:"space-y-3",children:(()=>{const B=(Y||[]).filter(E=>{if(D==="all")return!0;const H=E.status?.toLowerCase()||"pending",Z=D.toLowerCase();return H===Z}).slice(0,5);return B.length===0&&D!=="all"?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(he,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),e.jsxs("p",{className:"text-sm",children:["No ",D," requests found"]})]}):B.map((E,H)=>e.jsx(Ft,{request:{...E,companyName:E.companyName||"Individual Employer",status:E.status||"pending",priority:E.priority||"normal",selectedUser:E.selectedUser||null,requestedCandidate:E.requestedCandidate||null},onContactEmployer:Et,onViewDetails:me,getStatusColor:Pt,getPriorityColor:St,compact:!0},E.id||H))})()}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(he,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent requests"})]})]})]})]})},n=()=>{switch(x){case"dashboard":return G();case"job-seekers":return e.jsx(Rt,{});case"requests":return e.jsx(Ct,{});case"contact-messages":return e.jsx(as,{});case"categories":return e.jsx(Lt,{});case"reports-statistics":return e.jsx(wt,{});case"reports-tables":return e.jsx(ts,{});case"settings":return e.jsx(ls,{});default:return G()}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(_t,{user:l,onLogout:de,onSearch:re,onFilter:ue,searchTerm:$,onRefresh:ce}),e.jsxs("div",{className:"flex",children:[e.jsx(qt,{sidebarOpen:w,setSidebarOpen:p,navigationItems:[{id:"dashboard",label:"Dashboard",icon:"Home"},{id:"job-seekers",label:"Job Seekers",icon:"Users"},{id:"requests",label:"Employer Requests",icon:"MessageSquare"},{id:"contact-messages",label:"Contact Messages",icon:"Mail"},{id:"categories",label:"Categories",icon:"Briefcase"},{id:"reports",label:"Reports",icon:"BarChart3",subItems:[{id:"reports-statistics",label:"Statistics Reports"},{id:"reports-tables",label:"Table Reports"}]},{id:"settings",label:"Settings",icon:"Settings"}],activeTab:x,setActiveTab:b,user:l,onLogout:de}),e.jsx("div",{className:"flex-1 transition-all duration-300 ml-0",children:e.jsx("div",{className:"p-4 lg:p-6",children:n()})})]}),T&&C&&e.jsx(ke,{isOpen:T,onClose:()=>f(!1),title:"Update Request Status",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:C.status,onChange:s=>S({...C,status:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes"}),e.jsx("textarea",{value:P,onChange:s=>M(s.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Add notes about this request..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(L,{onClick:()=>f(!1),variant:"outline",children:"Cancel"}),e.jsx(L,{onClick:()=>pe(C.id,C.status,P),className:"bg-red-600 hover:bg-red-700",children:"Update Status"})]})]})})]})};export{ks as default};
