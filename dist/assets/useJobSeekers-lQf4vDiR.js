import{r as o}from"./vendor-react-BksKsjF4.js";import{j as w}from"./index-BX8mTCKY.js";const M=(S={})=>{const{initialPage:E=1,itemsPerPage:d=10,autoFetch:x=!0,includePrivate:L=!1}=S,[y,N]=o.useState([]),[F,u]=o.useState(!1),[v,l]=o.useState(null),[c,g]=o.useState(E),[m,O]=o.useState(""),[h,$]=o.useState({gender:"",location:"",skills:"",experienceLevel:"",availability:""}),[f,B]=o.useState("createdAt"),[C,T]=o.useState("desc"),k=o.useCallback(async()=>{u(!0),l(null);try{const s=L?await w.getAllJobSeekers():await w.getPublicJobSeekers();s.success?N(s.data||[]):(console.error("❌ API Error:",s.error),l(s.error||"Failed to fetch job seekers"))}catch(s){console.error("💥 Fetch error:",s),l("An error occurred while fetching job seekers")}finally{u(!1)}},[L]),V=o.useCallback(async(s,t=null)=>{u(!0),l(null);try{const e=await w.createJobSeeker(s,t);return e.success?(await k(),{success:!0,data:e.data}):(console.error("❌ Create error:",e.error),l(e.error||"Failed to create job seeker"),{success:!1,error:e.error})}catch(e){const r="An error occurred while creating job seeker";return console.error("💥 Create error:",e),l(r),{success:!1,error:r}}finally{u(!1)}},[k]),D=o.useCallback(async(s,t,e=null)=>{u(!0),l(null);try{const r=await w.updateJobSeeker(s,t,e);return r.success?(N(a=>a.map(i=>{if(i.id===s){const n={...i};if(r.data.email&&(n.email=r.data.email),r.data.createdAt&&(n.createdAt=r.data.createdAt),r.data.updatedAt&&(n.updatedAt=r.data.updatedAt),r.data.profile)n.profile={...i.profile,...r.data.profile};else if(r.data.user)r.data.user.profile&&(n.profile={...i.profile,...r.data.user.profile});else{const J=["firstName","lastName","contactNumber","description","skills","gender","dateOfBirth","idNumber","maritalStatus","location","city","country","references","experience","monthlyRate","jobCategoryId","jobCategory"];n.profile||(n.profile={}),J.forEach(j=>{r.data[j]!==void 0&&(n.profile[j]=r.data[j])})}return n}return i})),{success:!0,data:r.data}):(console.error("❌ Update error:",r.error),l(r.error||"Failed to update job seeker"),{success:!1,error:r.error})}catch(r){const a="An error occurred while updating job seeker";return console.error("💥 Update error:",r),l(a),{success:!1,error:a}}finally{u(!1)}},[]),U=o.useCallback(async s=>{u(!0),l(null);try{const t=await w.deleteJobSeeker(s);return t.success?(N(e=>e.filter(r=>r.id!==s)),{success:!0}):(console.error("❌ Delete error:",t.error),l(t.error||"Failed to delete job seeker"),{success:!1,error:t.error})}catch(t){const e="An error occurred while deleting job seeker";return console.error("💥 Delete error:",t),l(e),{success:!1,error:e}}finally{u(!1)}},[]),P=o.useMemo(()=>{let s=[...y];if(m){const t=m.toLowerCase();s=s.filter(e=>{const r=e.profile?.firstName||e.firstName||"",a=e.profile?.lastName||e.lastName||"",i=e.email||"",n=e.profile?.skills||e.skills||"",J=e.profile?.location||e.location||"";return r.toLowerCase().includes(t)||a.toLowerCase().includes(t)||i.toLowerCase().includes(t)||n.toLowerCase().includes(t)||J.toLowerCase().includes(t)})}return Object.entries(h).forEach(([t,e])=>{e&&(s=s.filter(r=>{const a=r.profile?.[t]||r[t];return Array.isArray(a)?a.some(i=>i.toLowerCase().includes(e.toLowerCase())):a?.toLowerCase().includes(e.toLowerCase())}))}),s.sort((t,e)=>{let r,a;return f==="name"?(r=`${t.profile?.firstName||t.firstName||""} ${t.profile?.lastName||t.lastName||""}`,a=`${e.profile?.firstName||e.firstName||""} ${e.profile?.lastName||e.lastName||""}`):(r=t[f]||t.profile?.[f]||"",a=e[f]||e.profile?.[f]||""),C==="asc"?r>a?1:-1:r<a?1:-1}),s},[y,m,h,f,C]),p=P.length,b=Math.ceil(p/d),A=(c-1)*d,I=A+d,R=P.slice(A,I),q=o.useCallback(s=>{g(Math.max(1,Math.min(s,b)))},[b]),z=o.useCallback(()=>{c<b&&g(c+1)},[c,b]),G=o.useCallback(()=>{c>1&&g(c-1)},[c]);o.useEffect(()=>{g(1)},[m,h,f,C]),o.useEffect(()=>{x&&k()},[k,x]),o.useEffect(()=>{l(null)},[m,h]);const H=o.useMemo(()=>{const s=(c-1)*d,t=Math.min(s+d,p);return{showing:t-s,from:s+1,to:t,total:p}},[c,p,d]);return{jobSeekers:R,allJobSeekers:y,filteredJobSeekers:P,loading:F,error:v,currentPage:c,totalPages:b,totalItems:p,itemsPerPage:d,searchTerm:m,filters:h,sortBy:f,sortOrder:C,fetchJobSeekers:k,createJobSeeker:V,updateJobSeeker:D,deleteJobSeeker:U,goToPage:q,nextPage:z,prevPage:G,setCurrentPage:g,setSearchTerm:O,setFilters:$,setSortBy:B,setSortOrder:T,hasNextPage:c<b,hasPrevPage:c>1,startIndex:A+1,endIndex:Math.min(I,p),pageInfo:H}},W=(S={})=>M({...S,includePrivate:!1}),X=(S={})=>M({...S,includePrivate:!0});export{X as a,W as u};
