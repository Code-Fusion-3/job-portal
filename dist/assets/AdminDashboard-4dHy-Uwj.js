import{j as e,g as Ee,P as He,e as ye,a as ze,C as Me,_ as Le,S as os,r as o,f as Ge,$ as ps,J as cs,O as ds,x as ke,a5 as fs,a6 as bs,a7 as ys,s as De,V as we,U as Ue,a8 as ss,d as js,a9 as Ns,X as xe,M as vs,a0 as Re,aa as ws,ab as Cs,H as Q,ac as ks,ad as Ss,ae as Ps,af as he,ag as pe,c as We,ah as As,ai as Es,aj as Ve,ak as F,a2 as Ms,q as Ls,al as Je,am as ie,an as Ds,Z as Rs,v as $s,ao as ms,E as Fe,p as Ts,ap as fe,aq as Oe,ar as Fs,a3 as be,as as zs,at as Us,au as Ae,av as Is,F as _s,h as qs,T as Bs,k as Js,D as ts,y as Os,z as Hs,b as Gs}from"./vendor-react-DCVpIq7q.js";import{B as C,d as as,L as oe,C as V,u as xs,A as ne,e as Ws}from"./index-DRNx2Vuk.js";import{a as je,R as Vs}from"./ReportsPage-DwRRlLta.js";import{a as us}from"./useJobSeekers-oWaccR3b.js";import{g as rs,u as gs,E as Ys,S as Te,a as Xs,b as Qs,c as Zs,h as Ks}from"./EmployerRequestsPage-BCsnQTsE.js";import{a as et,b as st}from"./useCategories-B6SFosiw.js";import{m as Ne}from"./vendor-motion-BnaYlrdq.js";import{B as z}from"./Badge-CBal7hbk.js";import{A as ls}from"./Avatar-CWT3j43R.js";import{M as Ce}from"./Modal-iVsMiAJb.js";import tt from"./JobSeekersPage-DA0eR_7u.js";import{D as hs}from"./DataTable-6CYA6ZtK.js";import{c as ve}from"./contactService-BwuKMAUQ.js";import at from"./JobCategoriesPage-11ICO-p2.js";import{a as ns}from"./adminProfileService-BfjcBcoS.js";import"./vendor-common-BZD0eUgH.js";import"./vendor-gsap-lnFyu4_T.js";import"./messagingService-DQfYQY1_.js";import"./endpoints-CXiMw_A_.js";import"./categoryService-BZJziUCR.js";import"./useApprovalManagement-DuKNcoaF.js";import"./StatusBadge-DZmcurE5.js";const rt=({isConnected:s,lastUpdate:c,onRefresh:b,showLastUpdate:n=!0,className:g=""})=>e.jsx("div",{className:`flex items-center space-x-2 text-sm ${g}`,children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Ne.div,{animate:{scale:s?[1,1.2,1]:1,opacity:s?1:.5},transition:{duration:2,repeat:s?1/0:0,ease:"easeInOut"}})})}),lt=({request:s,onContactEmployer:c,onViewDetails:b,getStatusColor:n,getPriorityColor:g,compact:w=!1})=>{if(!s)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No request data available"});const k=s.name||s.employerName||"Unknown Employer",u=s.companyName||"Unknown Company",m=s.status||"pending",j=s.priority||"normal",P=s.message||"No message provided",A=s.email||"",v=s.phoneNumber||"",E=s.createdAt||new Date().toISOString(),f=s.selectedUser||s.hasSelectedCandidate,L=s.requestedCandidate,x=s.selectedUser;let S="No candidate selected",R=null;return f&&x?.profile?(S=`${x.profile.firstName} ${x.profile.lastName}`,R=x):L?.profile&&(S=`${L.profile.firstName} ${L.profile.lastName}`,R=L),w?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:k}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:u})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{variant:"outline",size:"xs",className:n?n(m):"bg-gray-100 text-gray-800",children:rs(m)}),e.jsx(z,{variant:"outline",size:"xs",className:g?g(j):"bg-gray-100 text-gray-800",children:j})]})]}),e.jsxs("div",{className:"mt-2",children:[f?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"✓ Selected:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:S})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"⏳ Requesting:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:S})]}),R?.profile?.skills&&e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-xs text-gray-700",children:R.profile.skills})]})]})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:k}),e.jsx("p",{className:"text-sm text-gray-600",children:u})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{variant:"outline",size:"sm",className:n?n(m):"bg-gray-100 text-gray-800",children:rs(m)}),e.jsx(z,{variant:"outline",size:"sm",className:g?g(j):"bg-gray-100 text-gray-800",children:j})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:P}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[A&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:A})]}),v&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(He,{className:"w-4 h-4"}),e.jsx("span",{children:v})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Candidate Information"}),f?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"✓ Selected Candidate:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:S})]}),R?.profile?.skills&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-sm text-gray-700",children:R.profile.skills})]}),R?.profile?.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Experience: "}),e.jsx("span",{className:"text-sm text-gray-700",children:R.profile.experience})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No candidate selected yet"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(E).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>c(s),children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Contact"]}),b&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>b(s),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})},nt=({jobSeeker:s,onViewDetails:c,getCategoryColor:b,compact:n=!1})=>{if(!s)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No job seeker data available"});const w=(b||(k=>{const u={JavaScript:"bg-yellow-100 text-yellow-800",React:"bg-blue-100 text-blue-800","Node.js":"bg-green-100 text-green-800",Python:"bg-blue-100 text-blue-800",Django:"bg-green-100 text-green-800",PostgreSQL:"bg-blue-100 text-blue-800",AWS:"bg-orange-100 text-orange-800",Docker:"bg-blue-100 text-blue-800",Git:"bg-red-100 text-red-800",Java:"bg-orange-100 text-orange-800",Cooking:"bg-red-100 text-red-800",Housekeeping:"bg-purple-100 text-purple-800",Childcare:"bg-pink-100 text-pink-800",Gardening:"bg-emerald-100 text-emerald-800",Cleaning:"bg-gray-100 text-gray-800",Driving:"bg-indigo-100 text-indigo-800",Teaching:"bg-yellow-100 text-yellow-800",Nursing:"bg-rose-100 text-rose-800",Construction:"bg-amber-100 text-amber-800",Agriculture:"bg-lime-100 text-lime-800",Technology:"bg-blue-100 text-blue-800",Healthcare:"bg-green-100 text-green-800",Education:"bg-purple-100 text-purple-800",Manufacturing:"bg-red-100 text-red-800",Services:"bg-gray-100 text-gray-800",General:"bg-gray-100 text-gray-800","Job Seeker":"bg-gray-100 text-gray-800",default:"bg-gray-100 text-gray-800"};return u[k]||u.default}))(s?.category||"General");return n?e.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ls,{src:s?.avatar,alt:s?.name||"Job Seeker",size:"sm",fallback:s?.name||"JS",fallbackSrc:as}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:s?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:s?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(z,{variant:"outline",size:"xs",className:w,children:s?.category||"General"}),e.jsx("span",{className:"text-xs text-gray-500",children:s?.location||"Unknown"})]}),s?.approvalStatus&&e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${s.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":s.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[s.approvalStatus==="approved"?e.jsx(ze,{className:"w-3 h-3"}):s.approvalStatus==="rejected"?e.jsx(Me,{className:"w-3 h-3"}):e.jsx(Le,{className:"w-3 h-3"}),s.approvalStatus==="approved"?"Verified":s.approvalStatus==="rejected"?"Rejected":"Pending"]})}),s?.category&&s.category.includes(",")&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[s.category.split(",").slice(0,3).map((k,u)=>e.jsx("span",{className:"inline-block px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:k.trim()},u)),s.category.split(",").length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.category.split(",").length-3," more"]})]})]})]}):e.jsxs("div",{className:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ls,{src:s?.avatar,alt:s?.name||"Job Seeker",size:"md",fallback:s?.name||"JS",fallbackSrc:as}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:s?.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s?.location||"Unknown"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s?.experience||"0"," years"]}),e.jsx(z,{variant:"outline",size:"sm",className:w,children:s?.category||"General"})]}),s?.approvalStatus&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${s.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":s.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[s.approvalStatus==="approved"?e.jsx(ze,{className:"w-3.5 h-3.5"}):s.approvalStatus==="rejected"?e.jsx(Me,{className:"w-3.5 h-3.5"}):e.jsx(Le,{className:"w-3.5 h-3.5"}),s.approvalStatus==="approved"?"Verified Profile":s.approvalStatus==="rejected"?"Profile Rejected":"Under Review"]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["Daily: ",s?.dailyRate?.toLocaleString()||"0"," frw"]}),e.jsxs("span",{children:["Monthly: ",s?.monthlyRate?.toLocaleString()||"0"," frw"]})]})]}),e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>c?.(s),title:"View Details",children:e.jsx(ye,{className:"w-4 h-4"})})]})},it=({logo:s="J",title:c="Admin Panel",subtitle:b="Job Portal Management"})=>e.jsx("div",{className:"flex items-center justify-between p-5 border-b border-slate-200 bg-slate-50/60",children:e.jsxs("div",{className:"flex items-center space-x-2.5",children:[e.jsx("div",{className:"w-9 h-9 bg-red-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-base",children:s})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-slate-800 text-base",children:c}),e.jsx("span",{className:"text-xs text-slate-500",children:b})]})]})}),ot=({searchValue:s="",onSearchChange:c,placeholder:b="Search..."})=>e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:b,value:s,onChange:n=>c?.(n.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-md text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-200"})]})}),ct=({item:s,isActive:c,onClick:b})=>{const[n,g]=o.useState(!1),k={Home:ss,Users:Ue,MessageSquare:we,Briefcase:De,BarChart3:ys,Settings:bs,TestTube:fs,User:ke,FileText:ds,Calendar:cs,Star:ps,MapPin:Ge,Mail:Ee,Phone:He}[s.icon]||ss,u=()=>{s.subItems?g(!n):b(s.id)},m=j=>{b(j)};return e.jsxs("li",{children:[e.jsxs("button",{onClick:u,className:`
          relative w-full flex items-center space-x-2.5 px-3 py-2.5 rounded-md text-left transition-all duration-200 group
          ${c?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
        `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx(k,{className:`
              h-4.5 w-4.5 flex-shrink-0
              ${c?"text-red-600":"text-slate-500 group-hover:text-slate-700"}
            `})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:`text-sm ${c?"font-medium":"font-normal"}`,children:s.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.badge&&e.jsx("span",{className:`
                px-1.5 py-0.5 text-xs font-medium rounded-full
                ${c?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}
              `,children:s.badge}),s.subItems&&e.jsx("div",{className:"flex items-center",children:n?e.jsx(js,{className:"w-4 h-4 text-slate-500"}):e.jsx(Ns,{className:"w-4 h-4 text-slate-500"})})]})]})]}),s.subItems&&n&&e.jsx("ul",{className:"ml-6 mt-1 space-y-0.5",children:s.subItems.map(j=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>m(j.id),className:`
                  relative w-full flex items-center space-x-2.5 px-3 py-2 rounded-md text-left transition-all duration-200 group
                  ${c===j.id?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
                `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx("div",{className:`
                    w-1.5 h-1.5 rounded-full
                    ${c===j.id?"bg-red-600":"bg-slate-400 group-hover:bg-slate-600"}
                  `})}),e.jsx("span",{className:`text-sm ${c===j.id?"font-medium":"font-normal"}`,children:j.label})]})},j.id))})]})},dt=({navigationItems:s,activeItem:c,onItemClick:b})=>e.jsx("nav",{className:"flex-1 px-3 py-2 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:s.map(n=>e.jsx(ct,{item:n,isActive:c===n.id,onClick:b},n.id))})}),mt=({sidebarOpen:s,setSidebarOpen:c,navigationItems:b,activeTab:n,setActiveTab:g,user:w,onLogout:k,className:u=""})=>{const[m,j]=o.useState("");o.useEffect(()=>{const E=()=>{window.innerWidth>=768?c(!0):c(!1)};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[c]);const P=()=>{c(!s)},A=E=>{g(E),window.innerWidth<768&&c(!1)},v=E=>{j(E)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:P,className:"fixed top-6 left-6 z-50 p-3 rounded-lg bg-white shadow-md border border-slate-100 md:hidden hover:bg-slate-50 transition-all duration-200","aria-label":"Toggle sidebar",children:s?e.jsx(xe,{className:"h-5 w-5 text-slate-600"}):e.jsx(vs,{className:"h-5 w-5 text-slate-600"})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300",onClick:P}),e.jsxs("div",{className:`
          fixed top-0 left-0 h-full bg-white border-r border-slate-200 z-40 transition-all duration-300 ease-in-out flex flex-col w-64 md:w-80 md:sticky md:top-0 md:h-screen md:left-0 md:static
          ${s?"translate-x-0":"-translate-x-full"}
          md:translate-x-0 md:static md:z-auto
          ${u}
        `,children:[e.jsx(it,{logo:"J",title:"Admin Panel",subtitle:"Job Portal Management"}),e.jsx(ot,{searchValue:m,onSearchChange:v,placeholder:"Search..."}),e.jsx(dt,{navigationItems:b,activeItem:n,onItemClick:A})]})]})},xt=({user:s,onLogout:c,onSearch:b,onFilter:n,searchTerm:g="",onRefresh:w})=>e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 md:px-6 py-4 sticky top-0 z-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome back, ",s?.firstName||s?.email||"Admin"]})]})}),e.jsx("div",{className:"flex-1 max-w-md mx-4 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search...",value:g,onChange:k=>b?.(k.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[w&&e.jsx(C,{variant:"ghost",size:"sm",onClick:w,title:"Refresh data",children:e.jsx(Re,{className:"w-5 h-5"})}),e.jsx(C,{variant:"ghost",size:"sm",children:e.jsx(ws,{className:"w-5 h-5"})}),e.jsx("div",{className:"relative",children:e.jsxs(C,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-4 h-4 text-red-600"})}),e.jsx("span",{className:"hidden md:block text-sm font-medium",children:s?.firstName||s?.email||"Admin"})]})}),e.jsx(C,{variant:"outline",size:"sm",onClick:c,className:"hidden md:block",children:"Logout"})]})]})}),ut=()=>Ps.create({page:{flexDirection:"column",backgroundColor:"#ffffff",padding:15,fontSize:9},header:{marginBottom:10,borderBottom:"2 solid #3b82f6",paddingBottom:5},title:{fontSize:24,fontWeight:"bold",color:"#1f2937",marginBottom:2},subtitle:{fontSize:16,color:"#6b7280",marginBottom:2},dateRange:{fontSize:12,color:"#9ca3af",marginBottom:6},table:{display:"table",width:"auto",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,borderColor:"#e5e7eb"},tableRow:{margin:"auto",flexDirection:"row"},tableColHeader:{width:"auto",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#3b82f6",backgroundColor:"#3b82f6",padding:1,minHeight:18,justifyContent:"center",alignItems:"center"},tableCol:{width:"1",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#e5e7eb",padding:1,minHeight:5,justifyContent:"center",alignItems:"center"},tableCellHeader:{margin:"2",fontSize:11,fontWeight:"bold",color:"#ffffff",textAlign:"center"},tableCell:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"center"},tableCellLeft:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"left"},footer:{position:"absolute",bottom:15,left:15,right:15,textAlign:"center",color:"#6b7280",fontSize:8,borderTop:"1 solid #e5e7eb",paddingTop:5},pageNumber:{position:"absolute",bottom:15,right:15,color:"#6b7280",fontSize:8},alternateRow:{backgroundColor:"#f9fafb"}}),gt=(s,c,b,n)=>{const g=ut(),w=n.title||yt(s);n.subtitle||`${w.toLowerCase()}`;const k=n.dateRange||`Export Date: ${new Date().toLocaleDateString()}`,u=jt(s,b);return Q.createElement(ks,{},Q.createElement(Ss,{size:"A4",orientation:"landscape",style:g.page},[Q.createElement(he,{key:"header",style:g.header},[Q.createElement(pe,{key:"title",style:g.title},"Job Portal System"),Q.createElement(pe,{key:"subtitle",style:g.subtitle},w),Q.createElement(pe,{key:"dateRange",style:g.dateRange},k)]),Q.createElement(he,{key:"table",style:g.table},[Q.createElement(he,{key:"header-row",style:g.tableRow},u.map((m,j)=>Q.createElement(he,{key:`header-${j}`,style:[g.tableColHeader,{width:is(m.key)}]},Q.createElement(pe,{style:g.tableCellHeader},m.label)))),...c.map((m,j)=>Q.createElement(he,{key:`row-${j}`,style:[g.tableRow,j%2===1?g.alternateRow:{}]},u.map((P,A)=>Q.createElement(he,{key:`cell-${j}-${A}`,style:[g.tableCol,{width:is(P.key)}]},Q.createElement(pe,{style:pt(P.key)},Nt(m,P,s))))))]),Q.createElement(he,{key:"footer",style:g.footer},Q.createElement(pe,{},`Generated by Job Portal System • Total records: ${c.length}`)),Q.createElement(pe,{key:"pageNumber",style:g.pageNumber,render:({pageNumber:m,totalPages:j})=>`Page ${m} of ${j}`})]))},ht=async(s,c,b,n={})=>{try{if(!c||!Array.isArray(c)||c.length===0)throw new Error("No table data provided");if(!b||!Array.isArray(b)||b.length===0)throw new Error("No columns provided");const g=gt(s,c,b,n);return await Cs(g).toBlob()}catch(g){throw console.error("Error generating react-pdf:",g),new Error(`Failed to generate PDF report: ${g.message}`)}},is=(s,c)=>s==="jobseeker_info"?"40%":s==="employer_info"||s==="candidate_info"||s==="job_details"?"30%":{name:"20%",email:"25%",phone:"15%",location:"20%",category:"20%",experience:"15%",status:"12%",priority:"12%",demand:"12%",count:"10%",percentage:"10%",createdAt:"15%",registeredAt:"15%",employerName:"20%",companyName:"20%",candidateName:"20%",candidateEmail:"20%",candidateContact:"15%",position:"20%",monthlyRate:"15%",contactEmail:"20%"}[s]||"15%",pt=s=>["jobseeker_info","employer_info","candidate_info","job_details","name","email","location","category","position","companyName","employerName","candidateName","candidateEmail"].includes(s)?{textAlign:"left"}:{textAlign:"center"},ft=(s,c)=>!s&&s!==0?"N/A":c==="status"||c==="priority"||c==="demand"?bt(s):c==="percentage"?`${s}%`:c==="monthlyRate"&&s!=="Not specified"?s:typeof s=="string"&&s.length>30?s.substring(0,27)+"...":s,bt=s=>s?{Active:"Active",Inactive:"Inactive",pending:"Pending",in_progress:"In Progress",completed:"Completed",urgent:"Urgent",high:"High",normal:"Normal",low:"Low",High:"High",Medium:"Medium",Low:"Low"}[s]||s:"N/A",yt=s=>({"job-seekers":"Job Seekers Report","employer-requests":"Employer Requests Report",categories:"Job Categories Report",locations:"Location Distribution Report",skills:"Skills Analysis Report"})[s]||"Table Report",jt=(s,c)=>s==="job-seekers"?[{key:"jobseeker_info",label:"Job Seeker Info",subColumns:["name","email","phone","location"]},{key:"job_details",label:"Job Details",subColumns:["category","experience"]},{key:"registeredAt",label:"Registration Date",subColumns:["registeredAt"]},{key:"status",label:"Status",subColumns:["status"]}]:s==="employer-requests"?[{key:"employer_info",label:"Employer Info",subColumns:["employerName","companyName","employerEmail"]},{key:"candidate_info",label:"Candidate Info",subColumns:["candidateName","candidateEmail","candidateContact"]},{key:"job_details",label:"Job Details",subColumns:["category","monthlyRate","status","priority"]},{key:"createdAt",label:"Request Date",subColumns:["createdAt"]}]:s==="categories"?[{key:"category",label:"Category",subColumns:["category"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:s==="locations"?[{key:"location",label:"Location",subColumns:["location"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:s==="skills"?[{key:"skill",label:"Skill",subColumns:["skill"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:c.map(b=>({key:b.key,label:b.label,subColumns:[b.key]})),Nt=(s,c,b)=>{if(!c.subColumns||c.subColumns.length===1){const g=c.subColumns?c.subColumns[0]:c.key;return ft(s[g],g)}const n=c.subColumns.map(g=>{const w=s[g];return!w||w==="Not provided"||w==="Not specified"||w==="Unknown"?null:w}).filter(Boolean);return n.length===0?"N/A":n.length===1?n[0]:c.key==="jobseeker_info"?`${n[0]}
${n[1]}
${n[2]}
${n[3]}`:c.key==="employer_info"?`${n[0]}
${n[1]}
${n[2]||"N/A"}`:c.key==="candidate_info"?`${n[0]}
${n[1]}
${n[2]||"N/A"}`:c.key==="job_details"?b==="job-seekers"?`${n[0]}
${n[1]}`:b==="employer-requests"?`${n[0]}
${n[1]}
${n[2]}
${n[3]}`:n.join(`
`):n.join(`
`)},vt=async(s,c)=>{try{const b=URL.createObjectURL(s),n=document.createElement("a");return n.href=b,n.download=c,n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(b),!0}catch(b){return console.error("Error saving PDF:",b),!1}},wt=(s,c,b)=>{try{const n=c.map(j=>j.label).join(","),g=s.map(j=>c.map(P=>{const A=j[P.key];return typeof A=="string"&&(A.includes(",")||A.includes('"'))?`"${A.replace(/"/g,'""')}"`:A||""}).join(",")),w=[n,...g].join(`
`),k=new Blob([w],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),m=URL.createObjectURL(k);return u.setAttribute("href",m),u.setAttribute("download",b),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u),!0}catch(n){return console.error("Error exporting CSV:",n),!1}},Ct=(s,c,b)=>{try{let n='<table border="1">';n+="<tr>",c.forEach(u=>{n+=`<th style="background-color: #3b82f6; color: white; padding: 8px; text-align: center; font-weight: bold;">${u.label}</th>`}),n+="</tr>",s.forEach(u=>{n+="<tr>",c.forEach(m=>{const j=u[m.key]||"";n+=`<td style="padding: 6px; border: 1px solid #e5e7eb;">${j}</td>`}),n+="</tr>"}),n+="</table>";const g=new Blob([n],{type:"application/vnd.ms-excel"}),w=document.createElement("a"),k=URL.createObjectURL(g);return w.setAttribute("href",k),w.setAttribute("download",b.replace(".xlsx",".html")),w.style.visibility="hidden",document.body.appendChild(w),w.click(),document.body.removeChild(w),!0}catch(n){return console.error("Error exporting Excel:",n),!1}},kt=()=>{const{t:s}=We(),[c,b]=o.useState("30"),[n,g]=o.useState(!1),[w,k]=o.useState(null),[u,m]=o.useState(!0),[j,P]=o.useState(""),[A,v]=o.useState(null),[E,f]=o.useState("job-seekers"),[L,x]=o.useState(""),[S,R]=o.useState("pdf"),{jobSeekers:$,loading:q,error:Z,fetchJobSeekers:B}=us({autoFetch:!0,itemsPerPage:1e3}),{requests:t,loading:a,error:l,fetchRequests:h}=gs({autoFetch:!0,itemsPerPage:1e3}),{categories:M,loading:D,error:G,fetchCategories:se}=et({includeAdmin:!0,autoFetch:!0});o.useEffect(()=>{p()},[c]);const p=async()=>{try{m(!0),P("");const[d,r]=await Promise.all([je.getAnalytics({period:c}),je.getDashboardStats()]);d.success?k(d.data):P(d.error||"Failed to load analytics data"),r.success&&v(r.data)}catch(d){console.error("Error loading report data:",d),P("Network error. Please try again.")}finally{m(!1)}},I=[{value:"7",label:"Last 7 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days"},{value:"365",label:"Last Year"}],N=[{value:"job-seekers",label:"Job Seekers",icon:Ue},{value:"employer-requests",label:"Employer Requests",icon:we},{value:"categories",label:"Categories",icon:De},{value:"locations",label:"Locations",icon:Ge},{value:"skills",label:"Skills",icon:As}],y=async d=>{g(!0);try{const r=ge(d),i=ue(d);if(!r||r.length===0)return F.error("No data available for export"),!1;const O=new Date().toISOString().split("T")[0],J=`table-report-${d}-${O}`;let te=!1;switch(S){case"pdf":const Ie={title:ae(d),subtitle:`Comprehensive data table for ${ae(d).toLowerCase()}`,dateRange:`Last ${c} days (${new Date(Date.now()-parseInt(c)*24*60*60*1e3).toLocaleDateString()} - ${new Date().toLocaleDateString()})`};try{const _=await ht(d,r,i,Ie),H=`${J}.pdf`;te=await vt(_,H)}catch(_){return console.error("PDF generation error:",_),F.error(`PDF generation failed: ${_.message}`),!1}te?F.success(`${ae(d)} exported successfully as PDF!`):F.error("Failed to save PDF file");break;case"csv":const $e=`${J}.csv`;te=wt(r,i,$e),te?F.success(`${ae(d)} exported successfully as CSV!`):F.error("Failed to save CSV file");break;case"excel":const _e=`${J}.xlsx`;te=Ct(r,i,_e),te?F.success(`${ae(d)} exported successfully as Excel!`):F.error("Failed to save Excel file");break;default:return F.error("Unsupported export format"),!1}return te}catch(r){return console.error("Error exporting report:",r),F.error("Error generating export report. Please try again."),!1}finally{g(!1)}},W=async()=>{g(!0);try{await Promise.all([p(),B(),h(),se()])}catch(d){console.error("Error refreshing data:",d),P("Failed to refresh data. Please try again.")}finally{g(!1)}},Y=()=>!$||$.length===0?[]:$.map(d=>({id:d.id,name:`${d.profile?.firstName||d.firstName||d.name||"Unknown"} ${d.profile?.lastName||d.lastName||""}`,email:d.email||d.profile?.email||"Not provided",phone:d.profile?.contactNumber||d.contactNumber||d.phone||"Not provided",location:d.profile?.location||d.location||d.city||"Not specified",category:d.profile?.jobCategory?.name_en||d.jobCategory?.name_en||d.category||"Not specified",experience:d.profile?.experienceLevel||d.experienceLevel||d.experience||"Not specified",registeredAt:d.registeredAt||d.createdAt?new Date(d.registeredAt||d.createdAt).toLocaleDateString():"Unknown",status:d.status||"Active"})),le=()=>{if(!t||t.length===0)return[];const d=r=>{if(!r||r==="Not specified")return"Not specified";if(typeof r=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(r);if(typeof r=="string"){const i=parseFloat(r);return isNaN(i)?r:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(i)}return"Not specified"};return t.map(r=>({id:r.id,employerName:r.name||r.employerName||r.employer?.name||"Unknown",companyName:r.companyName||r.employer?.company||"Private",candidateName:r.requestedCandidate&&`${r.requestedCandidate.profile?.firstName||""} ${r.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:r.requestedCandidate?.profile?.skills||r.position||r.jobTitle||"General",status:r.status||"pending",priority:r.priority||"normal",monthlyRate:d(r.requestedCandidate?.profile?.monthlyRate),createdAt:r.createdAt?new Date(r.createdAt).toLocaleDateString():"Unknown",contactEmail:r.email||r.employerContact?.email||r.employer?.email||"Not provided",lastContactDate:r.updatedAt,isCompleted:r.status==="completed",category:r.requestedCandidate?.profile?.jobCategory?.name_en||"General",candidateExperience:r.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:r.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:r.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:r.requestedCandidate?.profile?.location||"Not specified",candidateCity:r.requestedCandidate?.profile?.city||"Not specified",candidateCountry:r.requestedCandidate?.profile?.country||"Not specified",candidateContact:r.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:r.requestedCandidate?.email||"Not specified",candidateLanguages:r.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:r.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:r.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:r.requestedCandidate?.profile?.description||"Not specified",candidateGender:r.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:r.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:r.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:r.requestedCandidate?.profile?.references||"Not specified",message:r.message||"",_backendData:r}))},Se=()=>{if(!M||M.length===0)return[];const d={};return $?.forEach(r=>{const i=r.profile?.jobCategory?.name_en||r.jobCategory?.name_en||r.category||"Uncategorized";d[i]=(d[i]||0)+1}),M.map(r=>{const i=d[r.name_en]||0,O=$?.length||1,J=Math.round(i/O*100);return{id:r.id,name:r.name_en||r.name,count:i,percentage:J,status:"Active"}})},Pe=()=>{if(!$||$.length===0)return[];const d={};return $.forEach(r=>{const i=r.profile?.location||r.location||r.city||"Unknown";d[i]=(d[i]||0)+1}),Object.entries(d).map(([r,i])=>{const O=$.length,J=Math.round(i/O*100);return{id:r,name:r,count:i,percentage:J,status:"Active"}}).sort((r,i)=>i.count-r.count)},ce=()=>{if(!$||$.length===0)return[];const d={};return $.forEach(r=>{const i=r.profile?.skills||r.skills||"";i&&i.split(",").map(J=>J.trim()).filter(J=>J).forEach(J=>{d[J]=(d[J]||0)+1})}),Object.entries(d).map(([r,i])=>{const O=$.length,J=Math.round(i/O*100),te=i>O*.3?"High":i>O*.1?"Medium":"Low";return{id:r,name:r,count:i,percentage:J,demand:te}}).sort((r,i)=>i.count-r.count)},ue=d=>{switch(d){case"job-seekers":return[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"location",label:"Location",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"experience",label:"Experience",sortable:!0},{key:"registeredAt",label:"Registered",sortable:!0},{key:"status",label:"Status",sortable:!0,render:r=>e.jsx(z,{variant:r.status==="Active"?"success":"warning",children:r.status})}];case"employer-requests":return[{key:"employerName",label:"Employer Name",sortable:!0},{key:"companyName",label:"Company",sortable:!0},{key:"contactEmail",label:"Employer Email",sortable:!0},{key:"candidateName",label:"Candidate Name",sortable:!0},{key:"candidateEmail",label:"Candidate Email",sortable:!0},{key:"candidateContact",label:"Candidate Phone",sortable:!0},{key:"position",label:"Position/Skills",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"monthlyRate",label:"Monthly Rate",sortable:!0},{key:"status",label:"Status",sortable:!0,render:r=>e.jsx(z,{variant:r.status==="completed"?"success":r.status==="in_progress"?"warning":r.status==="pending"?"info":"danger",children:r.status.replace("_"," ")})},{key:"priority",label:"Priority",sortable:!0,render:r=>e.jsx(z,{variant:r.priority==="urgent"?"danger":r.priority==="high"?"warning":r.priority==="normal"?"info":"secondary",children:r.priority})},{key:"createdAt",label:"Created",sortable:!0}];case"categories":return[{key:"name",label:"Category Name",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:r=>e.jsxs("span",{children:[r.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:r=>e.jsx(z,{variant:"success",children:r.status})}];case"locations":return[{key:"name",label:"Location",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:r=>e.jsxs("span",{children:[r.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:r=>e.jsx(z,{variant:"success",children:r.status})}];case"skills":return[{key:"name",label:"Skill Name",sortable:!0},{key:"count",label:"Count",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:r=>e.jsxs("span",{children:[r.percentage,"%"]})},{key:"demand",label:"Demand Level",sortable:!0,render:r=>e.jsx(z,{variant:r.demand==="High"?"success":r.demand==="Medium"?"warning":"info",children:r.demand})}];default:return[]}},ge=d=>{switch(d){case"job-seekers":return Y();case"employer-requests":return le();case"categories":return Se();case"locations":return Pe();case"skills":return ce();default:return[]}},ae=d=>{const r=N.find(i=>i.value===d);return r?r.label:"Report"};return u||q||a||D?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(oe,{size:"lg",text:"Loading table reports..."})}):j||Z||l||G?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ds,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Table Reports"}),e.jsx("p",{className:"text-red-600 mb-4",children:j||Z||l||G}),e.jsxs(C,{onClick:W,variant:"outline",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Table Reports"})})}),e.jsx(V,{className:"",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsx("select",{value:c,onChange:d=>b(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:I.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]})}),N.map(d=>{const r=d.icon,i=E===d.value;return e.jsx("button",{onClick:()=>f(d.value),className:`p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md ${i?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 hover:border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(r,{className:`w-6 h-6 ${i?"text-blue-600":"text-gray-500"}`}),e.jsx("span",{className:"text-sm font-medium text-center",children:d.label})]})},d.value)})]})}),E&&e.jsxs(V,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:ae(E)}),e.jsxs("p",{className:"text-gray-600",children:["Comprehensive data table for ",ae(E).toLowerCase()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:S,onChange:d=>R(d.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"excel",children:"Excel"})]}),e.jsxs(C,{onClick:()=>y(E),disabled:n,className:"flex items-center gap-2",children:[e.jsx(Es,{className:"w-3 h-3"}),n?"Exporting...":`Export ${S.toUpperCase()}`]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(C,{onClick:W,variant:"outline",disabled:n,className:"flex items-center gap-2",children:[e.jsx(Re,{className:`w-3 h-3 ${n?"animate-spin":""}`}),n?"Refreshing...":"Refresh"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(hs,{columns:ue(E),data:ge(E),pagination:!0,itemsPerPage:15,searchTerm:L,onSearchChange:x,className:"w-full"})})]}),e.jsx(Ve,{position:"top-right"})]})},St=(s={})=>{const{autoFetch:c=!1,itemsPerPage:b=10,page:n=1,searchTerm:g="",status:w="",category:k=""}=s,[u,m]=o.useState([]),[j,P]=o.useState(!1),[A,v]=o.useState(""),[E,f]=o.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[L,x]=o.useState(null),S=o.useCallback(async(a={})=>{P(!0),v("");try{const l={page:a.page||n,limit:a.itemsPerPage||b,search:a.searchTerm||g,status:a.status||w,category:a.category||k,...a},h=await ve.getAllContacts(l);h.success?(m(Array.isArray(h.data.contacts)?h.data.contacts:[]),h.data.pagination&&f(h.data.pagination),h.data.statistics&&x(h.data.statistics)):v(h.error)}catch(l){v("Failed to fetch contact messages"),console.error("Error fetching contact messages:",l)}finally{P(!1)}},[n,b,g,w,k]),R=o.useCallback(async a=>{P(!0),v("");try{const l=await ve.getMessageById(a);return l.success?l.data:(v(l.error),null)}catch(l){return v("Failed to fetch contact message"),console.error("Error fetching contact message:",l),null}finally{P(!1)}},[]),$=o.useCallback(async(a,l)=>{P(!0),v("");try{const h=await ve.respondToMessage(a,l);return h.success?(await S(),h):(v(h.error),h)}catch{return v("Failed to respond to message"),{success:!1,error:"Failed to respond to message"}}finally{P(!1)}},[S]),q=o.useCallback(async a=>{try{const l=await ve.markAsRead(a);return l.success?(m(h=>h.map(M=>M.id===a?{...M,isRead:!0}:M)),l):(v(l.error),l)}catch(l){return v("Failed to mark message as read"),console.error("Error marking message as read:",l),{success:!1,error:"Failed to mark message as read"}}},[]),Z=o.useCallback(async a=>{try{const l=await ve.deleteMessage(a);return l.success?(m(h=>h.filter(M=>M.id!==a)),l):(v(l.error),l)}catch(l){return v("Failed to delete message"),console.error("Error deleting message:",l),{success:!1,error:"Failed to delete message"}}},[]),B=o.useCallback(async()=>{try{const a=await ve.getStatistics();return a.success?(x(a.data),a.data):(v(a.error),null)}catch(a){return v("Failed to fetch statistics"),console.error("Error fetching statistics:",a),null}},[]),t=o.useCallback(()=>S(),[S]);return o.useEffect(()=>{c&&(S(),B())},[c,S,B]),{messages:u,loading:j,error:A,pagination:E,statistics:L,fetchMessages:S,fetchMessageById:R,respondToMessage:$,markAsRead:q,deleteMessage:Z,fetchStatistics:B,refreshMessages:t}},Pt=()=>{const{t:s}=We(),[c,b]=o.useState(""),[n,g]=o.useState(""),[w,k]=o.useState(""),[u,m]=o.useState(null),[j,P]=o.useState(!1),[A,v]=o.useState(!1),[E,f]=o.useState(!1),[L,x]=o.useState({subject:"",message:""}),[S,R]=o.useState(!1),{messages:$,loading:q,error:Z,statistics:B,fetchMessages:t,respondToMessage:a,markAsRead:l,deleteMessage:h,refreshMessages:M}=St({autoFetch:!0,itemsPerPage:15}),[D,G]=o.useState(1),se=15,I=(Array.isArray($)?$.map(i=>({...i,createdAt:i.createdAt||""})):[]).filter(i=>{const O=!c||i.status===c,J=!n||i.category===n,te=!w||i.priority===w;return O&&J&&te}),N=Math.ceil(I.length/se),y=I.slice((D-1)*se,D*se),W=(i,O)=>{m(O),P(!0)};o.useEffect(()=>{t({status:c,category:n,priority:w})},[c,n,w]);const Y=async i=>{m(i),P(!0),i.isRead||await l(i.id)},le=i=>{m(i),x({subject:`Re: ${i.subject}`,message:""}),v(!0)},Se=i=>{m(i),f(!0)},Pe=async i=>{if(i.preventDefault(),!localStorage.getItem("job_portal_token")){F.error("You are not logged in. Please log in again."),window.location.href="/login";return}if(!L.subject.trim()||!L.message.trim()){F.error("Please fill in both subject and message");return}if(u&&u.status==="responded"){F.error("This message has already been responded to. You cannot reply again."),v(!1);return}R(!0);try{const J=await a(u.id,L);J.success?(F.success("Response sent successfully!"),v(!1),x({subject:"",message:""}),m(null)):F.error(J.error||"Failed to send response")}catch{F.error("Failed to send response. Please try again.")}finally{R(!1)}},ce=async()=>{(await h(u.id)).success?(F.success("Message deleted successfully!"),f(!1),m(null)):F.error("Failed to delete message")},ue=i=>{switch(i){case"unread":return e.jsx(z,{variant:"warning",children:"Unread"});case"read":return e.jsx(z,{variant:"info",children:"Read"});case"responded":return e.jsx(z,{variant:"success",children:"Responded"});case"archived":return e.jsx(z,{variant:"secondary",children:"Archived"});default:return e.jsx(z,{variant:"outline",children:i})}},ge=i=>{switch(i){case"low":return e.jsx(z,{variant:"secondary",children:"Low"});case"normal":return e.jsx(z,{variant:"info",children:"Normal"});case"high":return e.jsx(z,{variant:"warning",children:"High"});case"urgent":return e.jsx(z,{variant:"danger",children:"Urgent"});default:return e.jsx(z,{variant:"outline",children:i})}},ae=i=>{switch(i){case"general":return e.jsx(z,{variant:"info",children:"General"});case"support":return e.jsx(z,{variant:"warning",children:"Support"});case"feedback":return e.jsx(z,{variant:"success",children:"Feedback"});case"complaint":return e.jsx(z,{variant:"danger",children:"Complaint"});default:return e.jsx(z,{variant:"outline",children:i})}},d=[{key:"name",label:"Name",sortable:!0,render:i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:i.name})]})},{key:"email",label:"Email",sortable:!0,render:i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:i.email})]})},{key:"subject",label:"Subject",sortable:!0,render:i=>e.jsx("div",{className:"max-w-xs truncate",title:i.subject,children:i.subject})},{key:"category",label:"Category",sortable:!0,render:i=>ae(i.category)},{key:"priority",label:"Priority",sortable:!0,render:i=>ge(i.priority)},{key:"status",label:"Status",sortable:!0,render:i=>ue(i.status)},{key:"submittedAt",label:"Date",sortable:!0,render:i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cs,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:new Date(i.createdAt).toLocaleDateString()})]})}],r=i=>[{key:"view",label:"View",icon:ye,onClick:()=>Y(i),variant:"outline"},{key:"reply",label:"Reply",icon:Je,onClick:()=>{i.status==="responded"?F.error("This message has already been responded to."):le(i)},variant:"primary",disabled:i.status==="responded"},{key:"delete",label:"Delete",icon:ie,onClick:()=>Se(i),variant:"danger"}];return q&&$.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(oe,{size:"lg",text:"Loading contact messages..."})}):Z&&$.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Me,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Contact Messages"}),e.jsx("p",{className:"text-red-600 mb-4",children:Z}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Authentication Issue:"})," This error usually means you need to log in again or your session has expired."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsxs(C,{onClick:M,variant:"outline",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsx(C,{onClick:()=>window.location.href="/login",variant:"primary",children:"Go to Login"})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-gray-600",children:"Manage and respond to contact form submissions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(C,{onClick:M,variant:"outline",disabled:q,className:"flex items-center gap-2",children:[e.jsx(Re,{className:`w-4 h-4 ${q?"animate-spin":""}`}),q?"Refreshing...":"Refresh"]})})]}),B&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(we,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.total||0})]})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(Le,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Unread Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.unread||0})]})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ze,{className:"w-6 h-6 text-green-600"})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:B.responded||0})})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ms,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Archived"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.archived||0})]})]})})]}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:c,onChange:i=>b(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"unread",children:"Unread"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"responded",children:"Responded"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:n,onChange:i=>g(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"feedback",children:"Feedback"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{value:w,onChange:i=>k(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(C,{onClick:()=>{b(""),g(""),k("")},variant:"outline",className:"w-full",children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})})]})}),e.jsx(hs,{columns:d,data:y,pagination:!0,itemsPerPage:se,actionButtons:r,onRowAction:W,className:"w-full"}),N>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>G(D-1),disabled:D===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",D," of ",N]}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>G(D+1),disabled:D===N,children:"Next"})]}),e.jsx(Ce,{isOpen:j,onClose:()=>P(!1),title:"View Message",maxWidth:"max-w-2xl",children:u&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:u.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:u.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("p",{className:"text-gray-900",children:u.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("div",{children:ae(u.category)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{children:ue(u.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(u.createdAt).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:u.message})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(C,{onClick:()=>{P(!1),le(u)},variant:"primary",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Reply"]}),e.jsx(C,{onClick:()=>P(!1),variant:"outline",children:"Close"})]})]})}),e.jsx(Ce,{isOpen:A,onClose:()=>v(!1),title:"Reply to Message",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:Pe,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:L.subject,onChange:i=>x(O=>({...O,subject:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:L.message,onChange:i=>x(O=>({...O,message:i.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Type your response...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{type:"button",onClick:()=>v(!1),variant:"outline",disabled:S,children:"Cancel"}),e.jsx(C,{type:"submit",variant:"primary",disabled:S,children:S?e.jsxs("span",{className:"flex items-center",children:[e.jsx(oe,{size:"sm",className:"mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Send Reply"]})})]})]})}),e.jsx(Ve,{position:"top-right"}),e.jsx(Ce,{isOpen:E,onClose:()=>f(!1),title:"Delete Message",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ie,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Message"}),e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to delete this message? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{onClick:()=>f(!1),variant:"outline",children:"Cancel"}),e.jsxs(C,{onClick:ce,variant:"danger",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})},At=({loadingTime:s,apiCalls:c,cacheHits:b,errors:n,showDetails:g=!1})=>{const[w,k]=o.useState(!1);if(o.useEffect(()=>{const j=setTimeout(()=>{(s>2e3||n.length>0)&&k(!0)},2e3);return()=>clearTimeout(j)},[s,n.length]),!w)return null;const m=s<1e3?{status:"excellent",color:"text-green-600",bg:"bg-green-50"}:s<2e3?{status:"good",color:"text-blue-600",bg:"bg-blue-50"}:s<5e3?{status:"fair",color:"text-yellow-600",bg:"bg-yellow-50"}:{status:"poor",color:"text-red-600",bg:"bg-red-50"};return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 ${m.bg} border rounded-lg shadow-lg p-4 max-w-sm transition-all duration-300`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`font-semibold ${m.color}`,children:"Performance Monitor"}),e.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["Load Time: ",e.jsxs("span",{className:m.color,children:[s,"ms"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["API Calls: ",c]})]}),b>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:["Cache Hits: ",b]})]}),n.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{children:["Errors: ",n.length]})]})]}),g&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:m.color,children:m.status})]}),e.jsxs("div",{children:["Performance: ",s<1e3?"🚀":s<2e3?"⚡":s<5e3?"🐌":"🐌🐌"]})]})})]})},Et=()=>{const{user:s,updateUser:c}=xs(),[b,n]=o.useState("profile"),[g,w]=o.useState(!1),[k,u]=o.useState(!0),[m,j]=o.useState({type:"",text:""}),[P,A]=o.useState({startTime:Date.now(),loadingTime:0,apiCalls:0,cacheHits:0,errors:[]}),[v,E]=o.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:""}),[f,L]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[x,S]=o.useState({}),[R,$]=o.useState(!1),[q,Z]=o.useState(!1),[B,t]=o.useState(!1),a=o.useMemo(()=>[{id:"profile",label:"Profile",icon:ke},{id:"security",label:"Security",icon:$s}],[]),l=o.useCallback(async()=>{try{u(!0),A(y=>({...y,apiCalls:y.apiCalls+1})),console.log("🔄 Loading admin profile...");const N=await je.getAdminProfile();if(console.log("📊 Admin profile result:",N),N.success){const y=N.data;console.log("👤 Admin data received:",y),E({firstName:y.firstName||y.profile?.firstName||"",lastName:y.lastName||y.profile?.lastName||"",email:y.email||"",phone:y.phone||y.phoneNumber||y.profile?.phoneNumber||"",location:y.location||y.city||y.profile?.city||"",bio:y.bio||y.profile?.bio||""}),N.fromCache&&A(W=>({...W,cacheHits:W.cacheHits+1}))}else console.warn("⚠️ Failed to load admin profile from API, using user context data"),console.warn("❌ API Error:",N.error),s&&(console.log("👤 Falling back to user context data:",s),E({firstName:s.profile?.firstName||s.firstName||"",lastName:s.profile?.lastName||s.lastName||"",email:s.email||"",phone:s.profile?.phoneNumber||s.phoneNumber||"",location:s.profile?.city||s.city||"",bio:s.profile?.bio||s.bio||""})),A(y=>({...y,errors:[...y.errors,N.error||"Failed to load admin profile"]}))}catch(N){console.error("💥 Error loading admin profile:",N),s&&(console.log("👤 Falling back to user context data on error:",s),E({firstName:s.profile?.firstName||s.firstName||"",lastName:s.profile?.lastName||s.lastName||"",email:s.email||"",phone:s.profile?.phoneNumber||s.phoneNumber||"",location:s.profile?.city||s.city||"",bio:s.profile?.bio||s.bio||""})),A(y=>({...y,errors:[...y.errors,"Network error loading admin profile"]}))}finally{u(!1)}},[s]);o.useEffect(()=>{const y=Date.now()-P.startTime;A(W=>({...W,loadingTime:y}))},[k]),o.useEffect(()=>{l()},[l]);const h=o.useCallback(N=>{const{name:y,value:W}=N.target;E(Y=>({...Y,[y]:W})),x[y]&&S(Y=>({...Y,[y]:""}))},[x]),M=o.useCallback(N=>{const{name:y,value:W}=N.target;L(Y=>({...Y,[y]:W})),x[y]&&S(Y=>({...Y,[y]:""}))},[x]),D=o.useCallback(()=>{const N={};return v.firstName.trim()||(N.firstName="First name is required"),v.lastName.trim()||(N.lastName="Last name is required"),v.email.trim()?/\S+@\S+\.\S+/.test(v.email)||(N.email="Email is invalid"):N.email="Email is required",v.phone&&v.phone.replace(/\D/g,"").length<9&&(N.phone="Phone number must be at least 9 digits"),S(N),Object.keys(N).length===0},[v]),G=o.useCallback(()=>{const N={};return f.currentPassword||(N.currentPassword="Current password is required"),f.newPassword?f.newPassword.length<8&&(N.newPassword="Password must be at least 8 characters"):N.newPassword="New password is required",f.newPassword!==f.confirmPassword&&(N.confirmPassword="Passwords do not match"),S(N),Object.keys(N).length===0},[f]),se=o.useCallback(async()=>{if(D())try{w(!0),A(y=>({...y,apiCalls:y.apiCalls+1}));const N=await je.updateAdminProfile(v);N.success?(j({type:"success",text:"Profile updated successfully!"}),c&&c({...s,...v}),setTimeout(()=>j({type:"",text:""}),3e3)):(j({type:"error",text:N.error||"Failed to update profile"}),A(y=>({...y,errors:[...y.errors,N.error||"Profile update failed"]})))}catch{j({type:"error",text:"Network error. Please try again."}),A(y=>({...y,errors:[...y.errors,"Network error during profile update"]}))}finally{w(!1)}},[v,D,c,s]),p=o.useCallback(async()=>{if(G())try{w(!0),A(y=>({...y,apiCalls:y.apiCalls+1}));const N=await je.changeAdminPassword({currentPassword:f.currentPassword,newPassword:f.newPassword});N.success?(j({type:"success",text:"Password changed successfully!"}),L({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>j({type:"",text:""}),3e3)):(j({type:"error",text:N.error||"Failed to change password"}),A(y=>({...y,errors:[...y.errors,N.error||"Password change failed"]})))}catch{j({type:"error",text:"Network error. Please try again."}),A(y=>({...y,errors:[...y.errors,"Network error during password change"]}))}finally{w(!1)}},[f,G]),I=o.useMemo(()=>m.text?e.jsxs(Ne.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center space-x-2 ${m.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[m.type==="success"?e.jsx(ze,{className:"w-5 h-5"}):e.jsx(Me,{className:"w-5 h-5"}),e.jsx("span",{children:m.text}),e.jsx("button",{onClick:()=>j({type:"",text:""}),className:"ml-auto hover:opacity-70 transition-opacity",children:e.jsx(xe,{className:"w-4 h-4"})})]}):null,[m]);return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your profile and system settings"})]})}),I,e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:a.map(N=>{const y=N.icon;return e.jsxs("button",{onClick:()=>n(N.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${b===N.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:N.label})]},N.id)})})}),e.jsxs("div",{className:"mt-6",children:[b==="profile"&&e.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(V,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:v.firstName,onChange:h,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.firstName?"border-red-300":"border-gray-300"}`}),x.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:v.lastName,onChange:h,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.lastName?"border-red-300":"border-gray-300"}`}),x.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:v.email,onChange:h,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.email?"border-red-300":"border-gray-300"}`}),x.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:v.phone,onChange:h,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.phone?"border-red-300":"border-gray-300"}`}),x.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:v.location,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{name:"bio",value:v.bio,onChange:h,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"Tell us about yourself..."})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(C,{variant:"primary",onClick:se,disabled:g,children:[g?e.jsx(oe,{size:"sm"}):e.jsx(ms,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})})}),b==="security"&&e.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs(V,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:R?"text":"password",name:"currentPassword",value:f.currentPassword,onChange:M,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.currentPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>$(!R),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:R?e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ye,{className:"w-4 h-4 text-gray-400"})})]}),x.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:q?"text":"password",name:"newPassword",value:f.newPassword,onChange:M,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.newPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>Z(!q),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:q?e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ye,{className:"w-4 h-4 text-gray-400"})})]}),x.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:B?"text":"password",name:"confirmPassword",value:f.confirmPassword,onChange:M,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${x.confirmPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>t(!B),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:B?e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ye,{className:"w-4 h-4 text-gray-400"})})]}),x.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.confirmPassword})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(C,{variant:"primary",onClick:p,disabled:g,children:[g?e.jsx(oe,{size:"sm"}):e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Change Password"]})})]})]})})]})]}),e.jsx(At,{loadingTime:P.loadingTime,apiCalls:P.apiCalls,cacheHits:P.cacheHits,errors:P.errors,showDetails:!0})]})},Mt=()=>{const[s,c]=o.useState([]),[b,n]=o.useState(!0),[g,w]=o.useState(""),[k,u]=o.useState(!1),[m,j]=o.useState(!1),[P,A]=o.useState(!1),[v,E]=o.useState(null),[f,L]=o.useState({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0}),[x,S]=o.useState(!1),[R,$]=o.useState(!1),q=o.useCallback(async()=>{try{n(!0),w("");const p=await fetch(`${ne.BASE_URL}/payment-methods/admin/all`,{headers:{Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`}});if(p.ok){const I=await p.json();c(I.paymentMethods||[])}else{const I=await p.json();w(I.error||"Failed to fetch payment methods")}}catch(p){console.error("Error fetching payment methods:",p),w("Network error. Please try again.")}finally{n(!1)}},[]);o.useEffect(()=>{q()},[q]);const Z=()=>{L({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0})},B=()=>{Z(),u(!0)},t=p=>{E(p),L({name:p.name,type:p.type,accountName:p.accountName,accountNumber:p.accountNumber,bankName:p.bankName||"",sortOrder:p.sortOrder,isActive:p.isActive}),j(!0)},a=p=>{E(p),A(!0)},l=()=>{u(!1),j(!1),A(!1),E(null),Z()},h=async p=>{if(p.preventDefault(),!f.name||!f.type||!f.accountName||!f.accountNumber){F.error("Please fill in all required fields");return}try{S(!0);const I=m?`${ne.BASE_URL}/payment-methods/${v.id}`:`${ne.BASE_URL}/payment-methods`,y=await fetch(I,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify(f)}),W=await y.json();if(y.ok){const Y=m?"updated":"created";F.success(`Payment method ${Y} successfully!`),l(),q()}else F.error(W.error||`Failed to ${m?"update":"create"} payment method`)}catch(I){console.error("Error submitting payment method:",I),F.error("Network error. Please try again.")}finally{S(!1)}},M=async()=>{if(v)try{S(!0);const p=await fetch(`${ne.BASE_URL}/payment-methods/${v.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`}});if(p.ok)F.success("Payment method deleted successfully!"),l(),q();else{const I=await p.json();F.error(I.error||"Failed to delete payment method")}}catch(p){console.error("Error deleting payment method:",p),F.error("Network error. Please try again.")}finally{S(!1)}},D=async p=>{try{const I=await fetch(`${ne.BASE_URL}/payment-methods/${p.id}/toggle`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`}});if(I.ok)F.success(`Payment method ${p.isActive?"deactivated":"activated"} successfully!`),q();else{const N=await I.json();F.error(N.error||"Failed to toggle payment method status")}}catch(I){console.error("Error toggling payment method status:",I),F.error("Network error. Please try again.")}},G=p=>{switch(p){case"mobile_money":return e.jsx(Us,{className:"h-4 w-4"});case"bank_transfer":return e.jsx(zs,{className:"h-4 w-4"});case"cash":return e.jsx(Oe,{className:"h-4 w-4"});default:return e.jsx(Oe,{className:"h-4 w-4"})}},se=p=>{switch(p){case"mobile_money":return"Mobile Money";case"bank_transfer":return"Bank Transfer";case"cash":return"Cash";default:return p}};return b?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(oe,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Methods"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage payment methods for employer requests"})]}),e.jsxs(C,{onClick:B,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(fe,{className:"h-5 w-5 mr-2"}),"Add Payment Method"]})]})}),g&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-800",children:g})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Payment Methods (",s.length,")"]})}),s.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Oe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No payment methods found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first payment method to get started"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:s.map((p,I)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 cursor-move",disabled:R,children:e.jsx(Fs,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-gray-500",children:G(p.type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:p.name}),e.jsx(z,{variant:p.isActive?"success":"secondary",className:"ml-2",children:p.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",se(p.type),p.bankName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Bank:"})," ",p.bankName]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Account:"})," ",p.accountName,e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Number:"})," ",p.accountNumber]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>D(p),className:p.isActive?"text-orange-600 hover:text-orange-700":"text-green-600 hover:text-green-700",children:p.isActive?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Activate"]})}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>t(p),children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>a(p),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})},p.id))})]})]}),(k||m)&&e.jsx(Ce,{isOpen:k||m,onClose:l,title:m?"Edit Payment Method":"Add Payment Method",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Method Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.name,onChange:p=>L({...f,name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., MTN MOMO, Airtel Money, Bank of Rwanda",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:f.type,onChange:p=>L({...f,type:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Holder Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.accountName,onChange:p=>L({...f,accountName:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Job Portal, Company Name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Number/Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.accountNumber,onChange:p=>L({...f,accountNumber:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 0788123456, 1234567890",required:!0})]}),f.type==="bank_transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:f.bankName,onChange:p=>L({...f,bankName:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Bank of Rwanda, Equity Bank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",value:f.sortOrder,onChange:p=>L({...f,sortOrder:parseInt(p.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lower numbers appear first in the list"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:f.isActive,onChange:p=>L({...f,isActive:p.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active (available for payments)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{type:"button",variant:"outline",onClick:l,disabled:x,children:"Cancel"}),e.jsx(C,{type:"submit",variant:"primary",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),m?"Updating...":"Creating..."]}):m?"Update Method":"Create Method"})]})]})}),P&&v&&e.jsx(Ce,{isOpen:P,onClose:l,title:"Delete Payment Method",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-700",children:["Are you sure you want to delete the payment method ",e.jsxs("strong",{children:['"',v.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone. If this method is being used by existing payments, it cannot be deleted."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{variant:"outline",onClick:l,disabled:x,children:"Cancel"}),e.jsx(C,{variant:"danger",onClick:M,disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):"Delete Method"})]})]})}),e.jsx(Ve,{})]})},Lt=()=>{const[s,c]=o.useState(!1),[b,n]=o.useState(!1),[g,w]=o.useState(null),[k,u]=o.useState({personal:{name:"",title:"",location:"",email:"",phone:"",aboutMe:"",github:"",facebook:"",linkedin:"",twitter:"",instagram:""},skills:{frontend:[],backend:[],database:[],devops:[],design:[],management:[]},experience:[],education:[],certifications:[],projects:[]}),[m,j]=o.useState(null);o.useEffect(()=>{A()},[]);const P=t=>t?(t.projects&&Array.isArray(t.projects)?t.projects=t.projects.map(a=>({...a,tech:Array.isArray(a.tech)?a.tech:typeof a.tech=="string"?a.tech.split(",").map(l=>l.trim()).filter(l=>l):[]})):t.projects||(t.projects=[]),t.experience&&Array.isArray(t.experience)?t.experience=t.experience.map(a=>({...a,achievements:Array.isArray(a.achievements)?a.achievements:[]})):t.experience||(t.experience=[]),t.skills&&typeof t.skills=="object"?Object.keys(t.skills).forEach(a=>{Array.isArray(t.skills[a])||(t.skills[a]=[])}):t.skills||(t.skills={frontend:[],backend:[],database:[],devops:[],design:[],management:[]}),t.education||(t.education=[]),t.certifications||(t.certifications=[]),t.personal||(t.personal={}),console.log("✅ AdminProfileManagement: Data normalized successfully:",t),t):(console.warn("⚠️ AdminProfileManagement: No data received, using defaults"),{personal:{},skills:{frontend:[],backend:[],database:[],devops:[],design:[],management:[]},experience:[],education:[],certifications:[],projects:[]}),A=async(t=0)=>{try{c(!0),w(null),console.log("🔍 AdminProfileManagement: Loading profile data...");const l=await ns.getPublicProfile();console.log("✅ AdminProfileManagement: Profile data loaded:",l);const h=P(l);console.log("🔍 AdminProfileManagement: Setting normalized profile data:",h),u(h)}catch(l){if(console.error("❌ AdminProfileManagement: Error loading profile data:",l),t<2){console.log(`🔄 Retrying profile load... (${t+1}/2)`),setTimeout(()=>{A(t+1)},2e3*(t+1));return}w("Failed to load profile data after multiple attempts. Please try again."),Ae.error("Failed to load profile data")}finally{c(!1)}},v=async()=>{try{n(!0),console.log("🔍 AdminProfileManagement: Saving profile data...");try{await ns.updateProfile(k),Ae.success("Profile updated successfully!"),j(null),console.log("✅ AdminProfileManagement: Profile saved successfully")}catch(t){if(console.error("❌ AdminProfileManagement: Update failed, trying to create new profile..."),t.response?.status===404)Ae.info("Creating new profile..."),await A(),Ae.success("Profile created successfully!");else throw t}}catch(t){console.error("❌ AdminProfileManagement: Error saving profile data:",t),Ae.error("Failed to save profile data. Please check your authentication.")}finally{n(!1)}},E=(t,a)=>{u(l=>({...l,[t]:[...l[t]||[],a]}))},f=(t,a,l)=>{u(h=>({...h,[t]:h[t].map((M,D)=>D===a?l:M)}))},L=(t,a)=>{u(l=>({...l,[t]:l[t].filter((h,M)=>M!==a)}))};if(s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading profile data..."})]})});if(!k)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Profile Data Not Available"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load profile data. Please try refreshing the page."}),e.jsx("button",{onClick:A,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})});const x=k.personal||{},S=k.skills||{},R=k.experience||[],$=k.education||[],q=k.certifications||[],B=(k.projects||[]||[]).map(t=>{try{return{...t,tech:Array.isArray(t.tech)?t.tech:typeof t.tech=="string"?t.tech.split(",").map(a=>a.trim()).filter(a=>a):[]}}catch(a){return console.error("❌ AdminProfileManagement: Error processing project:",t,a),{...t,tech:[]}}});return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(Ne.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Profile Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your professional profile and platform information"})]}),g&&e.jsx(Ne.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Profile"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:g}),e.jsx("button",{onClick:A,className:"mt-2 text-sm text-red-600 hover:text-red-500 font-medium",children:"Try Again"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-blue-600"}),"Personal Information"]}),e.jsx(C,{onClick:()=>j(m==="personal"?null:"personal"),variant:"outline",size:"sm",children:m==="personal"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="personal"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:x.name,onChange:t=>u(a=>({...a,personal:{...a.personal,name:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:x.title,onChange:t=>u(a=>({...a,personal:{...a.personal,title:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:x.location,onChange:t=>u(a=>({...a,personal:{...a.personal,location:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:x.email,onChange:t=>u(a=>({...a,personal:{...a.personal,email:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:x.phone,onChange:t=>u(a=>({...a,personal:{...a.personal,phone:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GitHub"}),e.jsx("input",{type:"text",value:x.github,onChange:t=>u(a=>({...a,personal:{...a.personal,github:t.target.value}})),placeholder:"github.com/username",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Facebook"}),e.jsx("input",{type:"text",value:x.facebook,onChange:t=>u(a=>({...a,personal:{...a.personal,facebook:t.target.value}})),placeholder:"facebook.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn"}),e.jsx("input",{type:"text",value:x.linkedin,onChange:t=>u(a=>({...a,personal:{...a.personal,linkedin:t.target.value}})),placeholder:"linkedin.com/in/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Twitter/X"}),e.jsx("input",{type:"text",value:x.twitter,onChange:t=>u(a=>({...a,personal:{...a.personal,twitter:t.target.value}})),placeholder:"twitter.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instagram"}),e.jsx("input",{type:"text",value:x.instagram,onChange:t=>u(a=>({...a,personal:{...a.personal,instagram:t.target.value}})),placeholder:"instagram.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"About Me"}),e.jsx("textarea",{value:x.aboutMe,onChange:t=>u(a=>({...a,personal:{...a.personal,aboutMe:t.target.value}})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:x.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:x.title})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ge,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:x.location})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:x.email})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:x.phone})]}),x.github&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Is,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:x.github})]}),x.facebook&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_s,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-gray-700",children:x.facebook})]}),x.linkedin&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qs,{className:"w-4 h-4 text-blue-700"}),e.jsx("span",{className:"text-gray-700",children:x.linkedin})]}),x.twitter&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bs,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-gray-700",children:x.twitter})]}),x.instagram&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Js,{className:"w-4 h-4 text-pink-600"}),e.jsx("span",{className:"text-gray-700",children:x.instagram})]}),x.aboutMe&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsx("p",{className:"text-gray-700 text-sm",children:x.aboutMe})})]})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ts,{className:"w-5 h-5 text-blue-600"}),"Skills"]}),e.jsx(C,{onClick:()=>j(m==="skills"?null:"skills"),variant:"outline",size:"sm",children:m==="skills"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="skills"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Add New Skill Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Category name (e.g., Design, Marketing, Languages)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm",onKeyPress:t=>{if(t.key==="Enter"&&t.target.value.trim()){const a=t.target.value.trim().toLowerCase();S[a]||(u(l=>({...l,skills:{...l.skills,[a]:[]}})),t.target.value="")}}}),e.jsxs(C,{onClick:t=>{const a=t.target.previousElementSibling,l=a.value.trim().toLowerCase();l&&!S[l]&&(u(h=>({...h,skills:{...h.skills,[l]:[]}})),a.value="")},variant:"outline",size:"sm",className:"whitespace-nowrap",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Category"]})]})]}),Object.entries(S).map(([t,a])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",value:t,onChange:l=>{const h=l.target.value.trim().toLowerCase();if(h&&h!==t){const M={...S};M[h]=M[t],delete M[t],u(D=>({...D,skills:M}))}},className:"font-semibold text-gray-800 capitalize bg-transparent border-b border-transparent hover:border-gray-300 focus:border-blue-500 focus:outline-none px-1 py-1",placeholder:"Category name"})}),e.jsx(C,{onClick:()=>{if(Object.keys(S).length>1){const l={...S};delete l[t],u(h=>({...h,skills:l}))}},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",disabled:Object.keys(S).length<=1,children:e.jsx(ie,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"space-y-2",children:[a.map((l,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:M=>{const D=[...a];D[h]=M.target.value,u(G=>({...G,skills:{...G.skills,[t]:D}}))},placeholder:"Skill name",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx(C,{onClick:()=>{const M=a.filter((D,G)=>G!==h);u(D=>({...D,skills:{...D.skills,[t]:M}}))},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(ie,{className:"w-3 h-3"})})]},h)),e.jsxs(C,{onClick:()=>{const l=[...a,""];u(h=>({...h,skills:{...h.skills,[t]:l}}))},variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Skill"]})]})]},t))]}):e.jsx("div",{className:"space-y-4",children:Object.entries(S).map(([t,a])=>e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2 capitalize",children:t}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((l,h)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:l},h))})]},t))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-blue-600"}),"Professional Experience"]}),e.jsx(C,{onClick:()=>j(m==="experience"?null:"experience"),variant:"outline",size:"sm",children:m==="experience"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="experience"?e.jsxs("div",{className:"space-y-4",children:[R.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.position,onChange:l=>f("experience",a,{...t,position:l.target.value}),placeholder:"Job Position",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.company,onChange:l=>f("experience",a,{...t,company:l.target.value}),placeholder:"Company Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.period,onChange:l=>f("experience",a,{...t,period:l.target.value}),placeholder:"Employment Period (e.g., 2020-2023)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("textarea",{value:t.description,onChange:l=>f("experience",a,{...t,description:l.target.value}),placeholder:"Job Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Achievements (one per line)"}),e.jsx("textarea",{value:t.achievements?t.achievements.join(`
`):"",onChange:l=>f("experience",a,{...t,achievements:l.target.value.split(`
`).filter(h=>h.trim())}),placeholder:"List your key achievements...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs(C,{onClick:()=>L("experience",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove Experience"]})]},a)),e.jsxs(C,{onClick:()=>E("experience",{position:"",company:"",period:"",description:"",achievements:[]}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Experience"]})]}):e.jsx("div",{className:"space-y-4",children:R.length>0?R.map((t,a)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.position}),e.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t.period})]}),e.jsx("h4",{className:"text-md font-medium text-blue-600 mb-2",children:t.company}),e.jsx("p",{className:"text-gray-700 mb-3 leading-relaxed",children:t.description}),t.achievements&&t.achievements.length>0&&e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.achievements.map((l,h)=>e.jsx("li",{className:"text-sm text-gray-600",children:l},h))})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No experience added yet."})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Os,{className:"w-5 h-5 text-blue-600"}),"Education"]}),e.jsx(C,{onClick:()=>j(m==="education"?null:"education"),variant:"outline",size:"sm",children:m==="education"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="education"?e.jsxs("div",{className:"space-y-4",children:[$.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.degree,onChange:l=>f("education",a,{...t,degree:l.target.value}),placeholder:"Degree/Qualification",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.school,onChange:l=>f("education",a,{...t,school:l.target.value}),placeholder:"School/University",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.period,onChange:l=>f("education",a,{...t,period:l.target.value}),placeholder:"Study Period (e.g., 2016-2020)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("textarea",{value:t.description,onChange:l=>f("education",a,{...t,description:l.target.value}),placeholder:"Description of your studies",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(C,{onClick:()=>L("education",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove Education"]})]},a)),e.jsxs(C,{onClick:()=>E("education",{degree:"",school:"",period:"",description:""}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Education"]})]}):e.jsx("div",{className:"space-y-4",children:$.length>0?$.map((t,a)=>e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.degree}),e.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t.period})]}),e.jsx("h4",{className:"text-md font-medium text-green-600 mb-1",children:t.school}),e.jsx("p",{className:"text-gray-700 text-sm",children:t.description})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No education added yet."})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Hs,{className:"w-5 h-5 text-blue-600"}),"Certifications"]}),e.jsx(C,{onClick:()=>j(m==="certifications"?null:"certifications"),variant:"outline",size:"sm",children:m==="certifications"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="certifications"?e.jsxs("div",{className:"space-y-4",children:[q.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 space-y-2",children:[e.jsx("input",{type:"text",value:t.name,onChange:l=>f("certifications",a,{...t,name:l.target.value}),placeholder:"Certification Name",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx("input",{type:"text",value:t.issuer,onChange:l=>f("certifications",a,{...t,issuer:l.target.value}),placeholder:"Issuing Organization",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx("input",{type:"text",value:t.year,onChange:l=>f("certifications",a,{...t,year:l.target.value}),placeholder:"Year",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsxs(C,{onClick:()=>L("certifications",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove"]})]},a)),e.jsxs(C,{onClick:()=>E("certifications",{name:"",issuer:"",year:""}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Certification"]})]}):e.jsx("div",{className:"space-y-3",children:q.length>0?q.map((t,a)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-3",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.issuer," • ",t.year]})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No certifications added yet."})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ts,{className:"w-5 h-5 text-blue-600"}),"Key Projects"]}),e.jsx(C,{onClick:()=>j(m==="projects"?null:"projects"),variant:"outline",size:"sm",children:m==="projects"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="projects"?e.jsxs("div",{className:"space-y-4",children:[B.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.name,onChange:l=>f("projects",a,{...t,name:l.target.value}),placeholder:"Project Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs("select",{value:t.status,onChange:l=>f("projects",a,{...t,status:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"development",children:"Development"}),e.jsx("option",{value:"completed",children:"Completed"})]}),e.jsx("textarea",{value:t.description,onChange:l=>f("projects",a,{...t,description:l.target.value}),placeholder:"Project Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:Array.isArray(t.tech)?t.tech.join(", "):t.tech,onChange:l=>f("projects",a,{...t,tech:l.target.value.split(",").map(h=>h.trim()).filter(h=>h)}),placeholder:"Technologies (comma-separated)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(C,{onClick:()=>L("projects",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove Project"]})]},a)),e.jsxs(C,{onClick:()=>E("projects",{name:"",status:"development",description:"",tech:[]}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Project"]})]}):e.jsx("div",{className:"space-y-4",children:B.length>0?B.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="live"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]}),e.jsx("p",{className:"text-gray-700 mb-3 text-sm leading-relaxed",children:t.description}),t.tech&&Array.isArray(t.tech)&&t.tech.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tech.map((l,h)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:l},h))})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No projects added yet."})})]})]})]}),e.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 text-center",children:e.jsx(C,{onClick:v,disabled:b,className:"px-8 py-3 text-lg",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ms,{className:"w-5 h-5 mr-2"}),"Save All Changes"]})})})]})})},ea=()=>{const{t:s}=We(),{user:c,logout:b}=xs(),n=Gs(),{liveData:g,lastUpdate:w,isConnected:k,manualRefresh:u,addNotification:m}=Ws(),[j,P]=o.useState("dashboard"),[A,v]=o.useState(!0),[E,f]=o.useState(null),[L,x]=o.useState(!1),[S,R]=o.useState(""),[$,q]=o.useState(""),[Z,B]=o.useState(null),[t,a]=o.useState(!0),[l,h]=o.useState(null),[M,D]=o.useState("all"),[G,se]=o.useState(!1),[p,I]=o.useState(!1),[N,y]=o.useState(!1),[W,Y]=o.useState(!1),{jobSeekers:le,loading:Se,fetchJobSeekers:Pe}=us({autoFetch:!1,itemsPerPage:5}),{requests:ce,loading:ue,fetchRequests:ge}=gs({autoFetch:!1}),{fetchCategories:ae}=st({autoFetch:!1}),d=async(_=0)=>{try{a(!0),h(null),console.log(`🔄 Loading dashboard data sequentially... (attempt ${_+1})`);try{se(!0),console.log("📊 Loading dashboard statistics...");const X=await je.getDashboardStats();X.success?(B(X.data),console.log("✅ Dashboard statistics loaded")):console.warn("⚠️ Failed to load dashboard statistics")}catch(X){console.error("❌ Error loading dashboard statistics:",X)}finally{se(!1)}try{I(!0),console.log("👥 Loading job seekers data..."),await Pe(),console.log("✅ Job seekers data loaded")}catch(X){console.error("❌ Error loading job seekers:",X)}finally{I(!1)}try{y(!0),console.log("📝 Loading employer requests..."),await ge(),console.log("✅ Employer requests loaded")}catch(X){console.error("❌ Error loading employer requests:",X)}finally{y(!1)}try{Y(!0),console.log("🏷️ Loading job categories..."),await ae(),console.log("✅ Job categories loaded")}catch(X){console.error("❌ Error loading job categories:",X)}finally{Y(!1)}console.log("✅ Dashboard data loading completed")}catch(X){if(console.error("❌ Critical error in dashboard loading:",X),_<2){console.log(`🔄 Retrying dashboard load... (${_+1}/2)`),setTimeout(()=>{d(_+1)},2e3*(_+1));return}h("Failed to load dashboard data after multiple attempts. Please refresh the page."),m({message:"Dashboard failed to load. Please refresh.",type:"error",duration:1e4})}finally{a(!1)}},r=async()=>{try{a(!0),await d(),m({message:"Dashboard refreshed successfully",type:"success",duration:3e3})}catch{h("Failed to refresh dashboard data"),m({message:"Failed to refresh dashboard",type:"error",duration:5e3})}finally{a(!1)}};o.useEffect(()=>{g.dashboard&&B(g.dashboard),g.requests,g.jobSeekers},[g]);const i=()=>{b(),n("/")},O=_=>{f(_),R(_.adminNotes||""),x(!0)},J=async(_,H,X)=>{try{const de=await je.updateRequestStatus(_,{status:H,adminNotes:X});de.success?(await ge(),x(!1),f(null),R(""),m({message:`Request ${H==="completed"?"marked as completed":"status updated"} successfully!`,type:"success",duration:5e3})):m({message:`Error: ${de.error}`,type:"error",duration:5e3})}catch(de){m({message:"Failed to update request status",type:"error",duration:5e3}),console.error("Request update error:",de)}},te=_=>{q(_)},Ie=()=>{};if(o.useEffect(()=>{d()},[]),t)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(oe,{size:"lg",text:"Loading Dashboard..."})});if(l)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Dashboard Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:l}),e.jsx(C,{onClick:d,className:"w-full",children:"Retry"})]})});const $e=()=>{const _=Z||{},H=_.data||_,X=U=>{if(!Array.isArray(U))return[];const K={};return U.forEach(T=>{T.profile?.skills&&T.profile.skills.split(",").map(re=>re.trim()).forEach(re=>{K[re]=(K[re]||0)+1})}),Object.entries(K).map(([T,ee])=>({name:T,count:ee})).sort((T,ee)=>ee.count-T.count).slice(0,5)},de=(U,K=0)=>{if(K===0)return U>0?{change:"+100%",changeType:"increase"}:{change:"0%",changeType:"neutral"};const T=(U-K)/K*100,ee=T>=0?`+${Math.round(T)}%`:`${Math.round(T)}%`,re=T>0?"increase":T<0?"decrease":"neutral";return{change:ee,changeType:re}},Ye=(U,K=7)=>{const T=new Date,ee=new Date(T.getTime()-K*24*60*60*1e3),re=new Date(T.getTime()-K*2*24*60*60*1e3),qe=U.filter(Be=>new Date(Be.createdAt)>=ee).length,me=U.filter(Be=>{const es=new Date(Be.createdAt);return es>=re&&es<ee}).length;return de(qe,me)},Xe=Ye(le||[]),Qe=Ye(ce||[]),Ze=de((ce||[]).filter(U=>U.status==="pending").length,Math.max(1,Math.floor((ce||[]).filter(U=>U.status==="pending").length*.8))),Ke=de(H.overview?.totalCategories||H.totalCategories||0,Math.max(1,Math.floor((H.overview?.totalCategories||H.totalCategories||0)*.9)));return X(le||[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,disabled:t,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})}),e.jsx(rt,{isConnected:k,lastUpdate:w,onRefresh:u,className:"text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 ",children:[e.jsx(Te,{title:"Total Job Seekers",value:H.overview?.totalJobSeekers||H.totalJobSeekers||0,icon:Ue,change:Xe.change,changeType:Xe.changeType,color:"text-blue-600",bgColor:"bg-blue-100",description:"Active job seekers",index:0,trendPeriod:"7 days",loading:G}),e.jsx(Te,{title:"Employer Requests",value:H.overview?.totalEmployerRequests||H.totalEmployerRequests||0,icon:we,change:Qe.change,changeType:Qe.changeType,color:"text-green-600",bgColor:"bg-green-100",description:"Total requests",index:1,trendPeriod:"7 days",loading:N}),e.jsx(Te,{title:"Pending Requests",value:H.overview?.pendingEmployerRequests||H.pendingEmployerRequests||0,icon:Le,change:Ze.change,changeType:Ze.changeType,color:"text-orange-600",bgColor:"bg-orange-100",description:"Awaiting review",index:2,trendPeriod:"7 days",loading:N}),e.jsx(Te,{title:"Categories",value:H.overview?.totalCategories||H.totalCategories||0,icon:De,change:Ke.change,changeType:Ke.changeType,color:"text-purple-600",bgColor:"bg-purple-100",description:"Job categories",index:3,showTrend:!1,loading:W})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(V,{title:"Latest Job Seekers",subtitle:"Most recently registered candidates (showing latest 5)",children:Se?e.jsx(oe,{size:"md",text:"Loading job seekers..."}):(H.recentActivity?.recentJobSeekers||le||[]).length>0?e.jsx("div",{className:"space-y-3",children:(H.recentActivity?.recentJobSeekers||le||[]).slice(0,5).map((U,K)=>{const T=(le||[]).find(me=>me.id===U.id)||U,ee=T?.profile?.photo||T?.avatar||T?.photo||null,qe=(me=>me?/^https?:\/\//i.test(me)?me:`${ne.BASE_URL}/${me.replace(/^\//,"")}`:null)(ee);return e.jsx(nt,{jobSeeker:{id:U.id,name:U.name||`${U?.profile?.firstName||""} ${U?.profile?.lastName||""}`.trim()||"Unknown",title:"Job Seeker",category:U.skills?.split(",")[0]||"General",avatar:qe,location:U.location||U?.profile?.location||"Unknown",dailyRate:U.dailyRate,monthlyRate:U.monthlyRate},onViewDetails:O,getCategoryColor:Xs,compact:!0},U.id||K)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ue,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent job seekers"})]})}),e.jsxs(V,{title:"Latest Employer Requests",subtitle:"Most recent job requests with candidate details (showing latest 5)",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx("button",{onClick:()=>D("all"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${M==="all"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>D("pending"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${M==="pending"?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Pending"}),e.jsx("button",{onClick:()=>D("in_progress"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${M==="in_progress"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"In Progress"}),e.jsx("button",{onClick:()=>D("approved"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${M==="approved"?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Approved"}),e.jsx("button",{onClick:()=>D("completed"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${M==="completed"?"bg-purple-100 text-purple-800 border-purple-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Completed"})]})}),ue?e.jsx(oe,{size:"md",text:"Loading requests..."}):(ce||[]).length>0?e.jsx("div",{className:"space-y-3",children:(()=>{const K=(ce||[]).filter(T=>{if(M==="all")return!0;const ee=T.status?.toLowerCase()||"pending",re=M.toLowerCase();return ee===re}).slice(0,5);return K.length===0&&M!=="all"?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(we,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),e.jsxs("p",{className:"text-sm",children:["No ",M," requests found"]})]}):K.map((T,ee)=>e.jsx(lt,{request:{...T,companyName:T.companyName||"Individual Employer",status:T.status||"pending",priority:T.priority||"normal",selectedUser:T.selectedUser||null,requestedCandidate:T.requestedCandidate||null},onContactEmployer:Ks,onViewDetails:O,getStatusColor:Zs,getPriorityColor:Qs,compact:!0},T.id||ee))})()}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(we,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent requests"})]})]})]})]})},_e=()=>{switch(j){case"dashboard":return $e();case"job-seekers":return e.jsx(tt,{});case"requests":return e.jsx(Ys,{});case"contact-messages":return e.jsx(Pt,{});case"categories":return e.jsx(at,{});case"reports-statistics":return e.jsx(Vs,{});case"reports-tables":return e.jsx(kt,{});case"settings":return e.jsx(Et,{});case"payment-methods":return e.jsx(Mt,{});case"profile":return e.jsx(Lt,{});default:return $e()}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(xt,{user:c,onLogout:i,onSearch:te,onFilter:Ie,searchTerm:$,onRefresh:r}),e.jsxs("div",{className:"flex",children:[e.jsx(mt,{sidebarOpen:A,setSidebarOpen:v,navigationItems:[{id:"dashboard",label:"Dashboard",icon:"Home"},{id:"job-seekers",label:"Job Seekers",icon:"Users"},{id:"requests",label:"Employer Requests",icon:"MessageSquare"},{id:"contact-messages",label:"Contact Messages",icon:"Mail"},{id:"categories",label:"Categories",icon:"Briefcase"},{id:"reports",label:"Reports",icon:"BarChart3",subItems:[{id:"reports-statistics",label:"Statistics Reports"},{id:"reports-tables",label:"Table Reports"}]},{id:"settings",label:"Settings",icon:"Settings"},{id:"payment-methods",label:"Payment Methods",icon:"CreditCard"},{id:"profile",label:"Profile",icon:"Shield"}],activeTab:j,setActiveTab:P,user:c,onLogout:i}),e.jsx("div",{className:"flex-1 transition-all duration-300 ml-0",children:e.jsx("div",{className:"p-4 lg:p-6",children:_e()})})]}),L&&E&&e.jsx(Ce,{isOpen:L,onClose:()=>x(!1),title:"Update Request Status",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:E.status,onChange:_=>f({...E,status:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes"}),e.jsx("textarea",{value:S,onChange:_=>R(_.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Add notes about this request..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{onClick:()=>x(!1),variant:"outline",children:"Cancel"}),e.jsx(C,{onClick:()=>J(E.id,E.status,S),className:"bg-red-600 hover:bg-red-700",children:"Update Status"})]})]})})]})};export{ea as default};
