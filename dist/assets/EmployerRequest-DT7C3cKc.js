import{c as $,r as u,j as e,Q as P,x as F,g as L,V as U,W as D,Y as T,a as E,f as W,s as A,_ as M,$ as z,L as H}from"./vendor-react-BksKsjF4.js";import{B as Y,u as O,H as w,L as _,F as q,C as G,j as J}from"./index-BzccmGOD.js";import{B as C}from"./BackButton-Cbilqc8s.js";import{F as k}from"./FormInput-BmH9yLCQ.js";import{m as f}from"./vendor-motion-DGjYdUW3.js";import{B}from"./Badge-BvinhsTB.js";import{A as Q}from"./Avatar-RDIauMxJ.js";import{j as R}from"./jobseekerBackground-BLVGbC9a.js";import"./vendor-common-BZD0eUgH.js";import"./vendor-gsap-lnFyu4_T.js";const V=({jobSeekerId:r=null,jobSeekerName:i=null,onSuccess:y=()=>{},onError:S=()=>{},className:I="",...s})=>{const{t:l}=$(),[t,p]=u.useState({employerName:"",companyName:"",email:"",phone:"",message:"",jobSeekerId:r||"",priority:"normal"}),[b,j]=u.useState(!1),[c,N]=u.useState({});u.useEffect(()=>{if(r&&r!==t.jobSeekerId&&p(o=>({...o,jobSeekerId:r})),!r&&!t.jobSeekerId){const d=new URLSearchParams(window.location.search).get("id")||window.location.pathname.split("/").pop();if(d&&d!=="undefined"&&d!=="null"){let h=d;typeof d=="string"&&d.startsWith("JS")&&(h=parseInt(d.replace(/^JS/,""),10)),p(m=>({...m,jobSeekerId:h}))}}if(r&&typeof r=="string"&&r.startsWith("JS")){const o=parseInt(r.replace(/^JS/,""),10);!isNaN(o)&&o!==t.jobSeekerId&&p(d=>({...d,jobSeekerId:o}))}},[r,t.jobSeekerId]);const a=o=>{const{name:d,value:h}=o.target;p(m=>({...m,[d]:h})),c[d]&&N(m=>({...m,[d]:""}))},n=()=>{const o={};return t.employerName.trim()||(o.employerName="Name is required"),t.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||(o.email="Please enter a valid email address"):o.email="Email is required",t.message.trim()?t.message.trim().length<10&&(o.message="Message must be at least 10 characters long"):o.message="Message is required",(!t.jobSeekerId||t.jobSeekerId==="")&&(o.general="Candidate ID is missing. This is required to submit the request. Please refresh the page and try again."),N(o),Object.keys(o).length===0},v=async o=>{if(o.preventDefault(),!!n()){j(!0);try{const h="https://job-portal-backend-cfk4.onrender.com/employer/request",m={name:t.employerName,companyName:t.companyName,email:t.email,phoneNumber:t.phone,message:t.message,requestedCandidateId:(()=>{let x=t.jobSeekerId;return typeof x=="string"&&x.startsWith("JS")?parseInt(x.replace(/^JS/,""),10):typeof x=="number"?x:parseInt(x,10)})(),priority:t.priority};if(isNaN(m.requestedCandidateId)||!m.requestedCandidateId)throw new Error("Invalid candidate ID. Please refresh the page and try again.");const g=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!g.ok){const x=await g.text();throw new Error(`Request failed: ${g.status} ${g.statusText}`)}const K=await g.json();y(),p({employerName:"",companyName:"",email:"",phone:"",message:"",jobSeekerId:r||"",priority:"normal"})}catch(d){S(d)}finally{j(!1)}}};return e.jsxs("div",{className:`bg-white rounded-xl shadow-sm border p-6 ${I}`,...s,children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(P,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:l("employerRequest.title","Request Candidate")}),e.jsx("p",{className:"text-gray-600",children:i?l("employerRequest.subtitleWithName","Request to connect with {{name}}",{name:i}):l("employerRequest.subtitle","Send a request to connect with this candidate")})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:l("employerRequest.priority","Priority")}),e.jsxs("select",{id:"priority",name:"priority",className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200",value:t.priority,onChange:a,required:!0,children:[e.jsx("option",{value:"low",children:l("employerRequest.priorityLow","Low")}),e.jsx("option",{value:"normal",children:l("employerRequest.priorityNormal","Normal")}),e.jsx("option",{value:"high",children:l("employerRequest.priorityHigh","High")})]})]}),c.general&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-red-600 text-sm font-medium",children:c.general}),e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This form requires a valid candidate ID to submit. Please contact support if this issue persists."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{id:"employerName",name:"employerName",label:l("employerRequest.employerName","Your Name"),placeholder:l("employerRequest.employerNamePlaceholder","Enter your full name"),value:t.employerName,onChange:a,error:c.employerName,icon:F,required:!0}),e.jsx(k,{id:"companyName",name:"companyName",label:l("employerRequest.companyName","Company Name"),placeholder:l("employerRequest.companyNamePlaceholder","Enter company name (optional)"),value:t.companyName,onChange:a,error:c.companyName,icon:P})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{id:"email",name:"email",type:"email",label:l("employerRequest.email","Email Address"),placeholder:l("employerRequest.emailPlaceholder","Enter your email"),value:t.email,onChange:a,error:c.email,icon:L,required:!0}),e.jsx(k,{id:"phone",name:"phone",type:"tel",label:l("employerRequest.phone","Phone Number"),placeholder:l("employerRequest.phonePlaceholder","Enter your phone number (optional)"),value:t.phone,onChange:a,error:c.phone,icon:U})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:[l("employerRequest.message","Message"),e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("textarea",{id:"message",name:"message",rows:4,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 ${c.message?"border-red-300":"border-gray-300"}`,placeholder:l("employerRequest.messagePlaceholder","Tell us about your requirements and why you're interested in this candidate..."),value:t.message,onChange:a,required:!0}),c.message&&e.jsx(f.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-1 text-sm text-red-600",children:c.message})]}),e.jsx(Y,{type:"submit",variant:"primary",size:"lg",className:"w-full flex items-center justify-center gap-2",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l("employerRequest.sending","Sending request...")]}):e.jsxs(e.Fragment,{children:[l("employerRequest.sendRequest","Send Request"),e.jsx(D,{className:"w-5 h-5"})]})}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:l("employerRequest.disclaimer","Your request will be sent to our admin team for review. We'll get back to you within 24 hours.")})]})]})},ce=()=>{const{t:r}=$(),{id:i}=T(),{user:y}=O(),[S,I]=u.useState(!1),[s,l]=u.useState(null),[t,p]=u.useState(!0),[b,j]=u.useState(null);u.useEffect(()=>{(async()=>{try{p(!0);let n;if(!y)n=await J.getPublicJobSeekerById(i);else{let v=i;typeof i=="string"&&i.startsWith("JS")&&(v=parseInt(i.replace(/^JS/,""),10)),n=await J.getJobSeekerById(v)}n&&n.success&&n.data?l(n.data):(console.error("Failed to fetch job seeker:",n),l(null))}catch(n){console.error("Error fetching job seeker:",n),j(n),l(null)}finally{p(!1)}})()},[i,y]);const c=()=>{I(!0)},N=a=>{console.error("Request failed:",a)};return t?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(w,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(_,{size:"lg",text:r("employerRequest.loading.candidateInfo")})}),e.jsx(q,{})]}):b?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(w,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:r("employerRequest.errors.loadingProfile")}),e.jsx("p",{className:"text-gray-600 mb-6",children:r("employerRequest.error.message","Failed to load job seeker profile.")}),e.jsx(C,{to:"/job-seekers",text:"Back to Job Seekers"})]})})}),e.jsx(q,{})]}):S?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(w,{}),e.jsx("div",{className:"pt-16 pb-8",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(E,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:r("employerRequest.success.title","Request Sent Successfully!")}),e.jsx("p",{className:"text-gray-600 mb-8 text-lg leading-relaxed",children:r("employerRequest.success.message","Your request has been sent to our admin team. We'll review it and get back to you within 24 hours.")}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6 mb-8",children:[e.jsx("h3",{className:"font-semibold text-green-800 mb-2",children:r("employerRequest.success.whatHappensNext")}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsxs("li",{children:["• ",r("employerRequest.success.emailConfirmation")]}),e.jsxs("li",{children:["• ",r("employerRequest.success.contactNextSteps")]}),e.jsxs("li",{children:["• ",r("employerRequest.fullDetail.content")]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(C,{to:`/view-profile/${i}`,text:r("employerRequest.success.backToProfile","Back to Profile"),className:"inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold"})})]})})}),e.jsx(q,{})]}):e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(w,{}),e.jsx("div",{className:"pt-16 pb-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"relative backdrop-blur-sm mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{to:`/view-profile/${i}`,text:r("employerRequest.backToProfile","Back to Profile"),className:"text-white hover:text-gray-200"}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 mt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(U,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:r("employerRequest.hero.title")}),e.jsx("p",{className:"text-gray-600 text-lg",children:r("employerRequest.hero.subtitle")})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(G,{className:"p-8 bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg border-0 sticky top-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:r("employerRequest.candidateInfo","Candidate Information")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center pb-6 border-b border-gray-200",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx(Q,{src:s?.profile?.photo,alt:s?.profile?.firstName+" "+s?.profile?.lastName,size:"xl",fallback:s?.profile?.firstName+" "+s?.profile?.lastName,className:"w-20 h-20 ring-4 ring-white shadow-lg"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})})]}),e.jsxs("h3",{className:"font-bold text-xl text-gray-900 mt-4",children:[s?.profile?.firstName?s.profile.firstName.charAt(0)+"*".repeat(s.profile.firstName.length-1):""," ",s?.profile?.lastName?s.profile.lastName.charAt(0)+"*".repeat(s.profile.lastName.length-1):""]}),e.jsx(B,{variant:"primary",size:"lg",className:"mt-2 bg-blue-500 text-white border-0",children:s?.profile?.jobCategory?.name_en||r("employerRequest.candidate.jobSeeker")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(W,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.location")}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.location||(s?.profile?.city?s.profile.city:"")||r("employerRequest.candidate.locationNotSpecified")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(A,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.experience")}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.experience||r("employerRequest.candidate.notSpecified")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(M,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.availability")}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.availability||r("employerRequest.candidate.notSpecified")})]})]}),s?.profile?.monthlyRate&&e.jsx("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-xl",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.monthlyRate")}),e.jsx("p",{className:"text-sm font-semibold text-blue-600",children:s.profile.monthlyRate})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(z,{className:"w-4 h-4 text-orange-500"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:r("employerRequest.candidate.skillsExpertise")})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s?.profile?.skills?s.profile.skills.split(",").map((a,n)=>e.jsx(B,{variant:"outline",size:"sm",className:"px-3 py-1 text-xs font-medium border-gray-200 text-gray-700 bg-gray-50",children:a.trim()},n)):e.jsx("span",{className:"text-gray-400 text-sm",children:r("employerRequest.candidate.noSkillsListed")})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx(H,{to:`/view-profile/${i}`,className:"block w-full text-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-xl transition-colors",children:r("employerRequest.candidate.viewFullProfile")})})]})]})})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},children:e.jsx(V,{jobSeekerId:(()=>{let a=null;if(console.log("=== DEBUG: Calculating jobSeekerId ==="),console.log("URL id parameter:",i),console.log("jobSeeker object:",s),console.log("jobSeeker.id:",s?.id),console.log("jobSeeker.profile?.userId:",s?.profile?.userId),console.log("jobSeeker.userId:",s?.userId),s?.id&&s.id!=="undefined"&&s.id!=="null")a=s.id,console.log("Using jobSeeker.id:",a);else if(s?.profile?.userId&&s.profile.userId!=="undefined"&&s.profile.userId!=="null")a=s.profile.userId,console.log("Using jobSeeker.profile.userId:",a);else if(s?.userId&&s.userId!=="undefined"&&s.userId!=="null")a=s.userId,console.log("Using jobSeeker.userId:",a);else if(i&&i!=="undefined"&&i!=="null")if(typeof i=="string"&&i.startsWith("JS")){const n=parseInt(i.replace(/^JS/,""),10);isNaN(n)?(a=i,console.log("Using URL id parameter as fallback (JS format):",a)):(a=n,console.log("Converted JS prefix to numeric ID:",a))}else a=i,console.log("Using URL id parameter as fallback:",a);return!a||a==="undefined"||a==="null"||a===""?(console.error("❌ No valid candidate ID found!"),console.error("Available data:",{urlId:i,jobSeekerId:s?.id,profileUserId:s?.profile?.userId,userId:s?.userId})):console.log("✅ Final candidateId:",a),a})(),jobSeekerName:s?.profile?`${s.profile.firstName} ${s.profile.lastName}`:s.name,onSuccess:c,onError:N})})})]})]})}),e.jsx(q,{})]})};export{ce as default};
