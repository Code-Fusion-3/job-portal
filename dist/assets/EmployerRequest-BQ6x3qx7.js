import{c as $,r as d,j as e,W as E,z as L,h as T,Y as D,_ as A,$ as W,a as B,g as z,B as H,a0 as M,a1 as Y,L as O}from"./vendor-react-BrVnDVka.js";import{B as U,b as _,H as v,L as G,F as w,C as K,j as J}from"./index-B0JOCH5G.js";import{B as C}from"./BackButton-BdeJ09zV.js";import{F as q}from"./FormInput-Jr4qA49s.js";import{m as y}from"./vendor-motion-DiEA6HXZ.js";import{B as F}from"./Badge-Dl8LIe_9.js";import{A as Q}from"./Avatar-D2uxOurZ.js";import{j as R}from"./jobseekerBackground-BLVGbC9a.js";import"./vendor-common-BZD0eUgH.js";import"./vendor-gsap-lnFyu4_T.js";const V=({jobSeekerId:r=null,jobSeekerName:l=null,onSuccess:b=()=>{},onError:k=()=>{},className:S="",...p})=>{const{t:a}=$(),[s,c]=d.useState({employerName:"",companyName:"",email:"",phone:"",message:"",jobSeekerId:r||"",priority:"normal"}),[j,g]=d.useState(!1),[o,N]=d.useState({});d.useEffect(()=>{if(r&&r!==s.jobSeekerId){c(t=>({...t,jobSeekerId:r}));return}if(!r&&!s.jobSeekerId){const n=new URLSearchParams(window.location.search).get("id")||window.location.pathname.split("/").pop();if(n&&n!=="undefined"&&n!=="null"){let h=n;typeof n=="string"&&n.startsWith("JS")&&(h=parseInt(n.replace(/^JS/,""),10)),c(m=>({...m,jobSeekerId:h}))}}if(r&&typeof r=="string"&&r.startsWith("JS")){const t=parseInt(r.replace(/^JS/,""),10);!isNaN(t)&&t!==s.jobSeekerId&&c(n=>({...n,jobSeekerId:t}))}},[r]);const u=t=>{const{name:n,value:h}=t.target;c(m=>({...m,[n]:h})),o[n]&&N(m=>({...m,[n]:""}))},I=()=>{const t={};return s.employerName.trim()||(t.employerName="Name is required"),s.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)||(t.email="Please enter a valid email address"):t.email="Email is required",s.message.trim()?s.message.trim().length<10&&(t.message="Message must be at least 10 characters long"):t.message="Message is required",(!s.jobSeekerId||s.jobSeekerId==="")&&(t.general="Candidate ID is missing. This is required to submit the request. Please refresh the page and try again."),N(t),Object.keys(t).length===0},i=async t=>{if(t.preventDefault(),!!I()){g(!0);try{const h="https://job-portal-backend.excellusi.com/employer/request",m={name:s.employerName,companyName:s.companyName,email:s.email,phoneNumber:s.phone,message:s.message,requestedCandidateId:(()=>{let x=s.jobSeekerId;return typeof x=="string"&&x.startsWith("JS")?parseInt(x.replace(/^JS/,""),10):typeof x=="number"?x:parseInt(x,10)})(),priority:s.priority};if(isNaN(m.requestedCandidateId)||!m.requestedCandidateId)throw new Error("Invalid candidate ID. Please refresh the page and try again.");const f=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!f.ok){const x=await f.text();throw new Error(`Request failed: ${f.status} ${f.statusText}`)}const P=await f.json();console.log("Request submission login response:",P.loginCredentials||"no data returned"),b(P.loginCredentials||null),c({employerName:"",companyName:"",email:"",phone:"",message:"",jobSeekerId:r||"",priority:"normal"})}catch(n){k(n)}finally{g(!1)}}};return e.jsxs("div",{className:`bg-white rounded-xl shadow-sm border p-6 ${S}`,...p,children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:a("employerRequest.title","Request Candidate")}),e.jsx("p",{className:"text-gray-600",children:l?a("employerRequest.subtitleWithName","Request to connect with {{name}}",{name:l}):a("employerRequest.subtitle","Send a request to connect with this candidate")})]}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:a("employerRequest.priority","Priority")}),e.jsxs("select",{id:"priority",name:"priority",className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200",value:s.priority,onChange:u,required:!0,children:[e.jsx("option",{value:"low",children:a("employerRequest.priorityLow","Low")}),e.jsx("option",{value:"normal",children:a("employerRequest.priorityNormal","Normal")}),e.jsx("option",{value:"high",children:a("employerRequest.priorityHigh","High")})]})]}),o.general&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-red-600 text-sm font-medium",children:o.general}),e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This form requires a valid candidate ID to submit. Please contact support if this issue persists."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(q,{id:"employerName",name:"employerName",label:a("employerRequest.employerName","Your Name"),placeholder:a("employerRequest.employerNamePlaceholder","Enter your full name"),value:s.employerName,onChange:u,error:o.employerName,icon:L,required:!0}),e.jsx(q,{id:"companyName",name:"companyName",label:a("employerRequest.companyName","Company Name"),placeholder:a("employerRequest.companyNamePlaceholder","Enter company name (optional)"),value:s.companyName,onChange:u,error:o.companyName,icon:E})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(q,{id:"email",name:"email",type:"email",label:a("employerRequest.email","Email Address"),placeholder:a("employerRequest.emailPlaceholder","Enter your email"),value:s.email,onChange:u,error:o.email,icon:T,required:!0}),e.jsx(q,{id:"phone",name:"phone",type:"tel",label:a("employerRequest.phone","Phone Number"),placeholder:a("employerRequest.phonePlaceholder","Enter your phone number (optional)"),value:s.phone,onChange:u,error:o.phone,icon:D})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:[a("employerRequest.message","Message"),e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("textarea",{id:"message",name:"message",rows:4,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 ${o.message?"border-red-300":"border-gray-300"}`,placeholder:a("employerRequest.messagePlaceholder","Tell us about your requirements and why you're interested in this candidate..."),value:s.message,onChange:u,required:!0}),o.message&&e.jsx(y.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-1 text-sm text-red-600",children:o.message})]}),e.jsx(U,{type:"submit",variant:"primary",size:"lg",className:"w-full flex items-center justify-center gap-2",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a("employerRequest.sending","Sending request...")]}):e.jsxs(e.Fragment,{children:[a("employerRequest.sendRequest","Send Request"),e.jsx(A,{className:"w-5 h-5"})]})}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:a("employerRequest.disclaimer","Your request will be sent to our admin team for review. We'll get back to you within 24 hours.")})]})]})},ce=()=>{const{t:r}=$(),{id:l}=W(),{user:b}=_(),[k,S]=d.useState(!1),[p,a]=d.useState(null),[s,c]=d.useState(null),[j,g]=d.useState(!0),[o,N]=d.useState(null);d.useEffect(()=>{(async()=>{try{g(!0);let t;if(!b)t=await J.getPublicJobSeekerById(l);else{let n=l;typeof l=="string"&&l.startsWith("JS")&&(n=parseInt(l.replace(/^JS/,""),10)),t=await J.getJobSeekerById(n)}t&&t.success&&t.data?c(t.data):(console.error("Failed to fetch job seeker:",t),c(null))}catch(t){console.error("Error fetching job seeker:",t),N(t),c(null)}finally{g(!1)}})()},[l,b]);const u=i=>{S(!0),a(i)},I=i=>{console.error("Request failed:",i)};return j?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(v,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(G,{size:"lg",text:r("employerRequest.loading.candidateInfo")})}),e.jsx(w,{})]}):o?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(v,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(B,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:r("employerRequest.errors.loadingProfile")}),e.jsx("p",{className:"text-gray-600 mb-6",children:r("employerRequest.error.message","Failed to load job seeker profile.")}),e.jsx(C,{to:"/job-seekers",text:"Back to Job Seekers"})]})})}),e.jsx(w,{})]}):k?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(v,{}),e.jsx("div",{className:"pt-20 pb-12 flex flex-col items-center justify-center min-h-[80vh]",children:e.jsxs(y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl px-8 py-12 max-w-xl w-full text-center border border-green-100",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-green-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg mb-4",children:e.jsx(B,{className:"w-14 h-14 text-white"})}),e.jsx("h1",{className:"text-4xl font-extrabold text-green-700 mb-2 tracking-tight",children:r("employerRequest.success.title","Request Submitted!")}),e.jsx("p",{className:"text-lg text-gray-700 font-medium mb-2",children:r("employerRequest.success.message","Thank you for your interest. Our team will review your request and respond within 24 hours.")})]}),p&&e.jsxs("div",{className:"bg-gradient-to-br from-green-100 to-blue-100 border border-green-200 rounded-2xl p-6 mb-8 flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"inline-block bg-green-600 text-white rounded-full px-3 py-1 text-xs font-semibold",children:"New Account"}),e.jsx("span",{className:"text-green-700 font-semibold",children:"Login Credentials"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-green-300 shadow-sm w-full max-w-xs text-left mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"font-bold text-green-800 w-20",children:"Email:"}),e.jsx("span",{className:"text-green-900 break-all",children:p.email})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-bold text-green-800 w-20",children:"Password:"}),e.jsx("span",{className:"text-green-900 break-all",children:p.password})]})]}),e.jsx("p",{className:"text-xs text-green-700 mt-3",children:p.message||"Please save these credentials. You will need them to access your employer dashboard."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-2xl p-6 mb-8 text-left",children:[e.jsxs("h3",{className:"font-semibold text-blue-800 mb-2 text-lg flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-blue-500 rounded-full"}),r("employerRequest.success.whatHappensNext","What Happens Next?")]}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 pl-4 list-disc",children:[e.jsx("li",{children:r("employerRequest.success.emailConfirmation","You will receive an email confirmation with further details.")}),e.jsx("li",{children:r("employerRequest.success.contactNextSteps","Our team may contact you for additional information if needed.")}),e.jsx("li",{children:r("employerRequest.fullDetail.content","You can track your request status after logging in.")})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col items-center",children:[e.jsx(C,{to:"/employer/login",text:r("employerRequest.success.loginToDashboard","Login to Access Dashboard"),className:"inline-block bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white px-8 py-3 rounded-2xl font-bold text-lg shadow-md transition-colors duration-200"}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"For your security, please do not share your credentials with anyone."})]})]})}),e.jsx(w,{})]}):e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${R})`},children:[e.jsx(v,{}),e.jsx("div",{className:"pt-16 pb-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"relative backdrop-blur-sm mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{to:`/view-profile/${l}`,text:r("employerRequest.backToProfile","Back to Profile"),className:"text-white hover:text-gray-200"}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 mt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(D,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:r("employerRequest.hero.title")}),e.jsx("p",{className:"text-gray-600 text-lg",children:r("employerRequest.hero.subtitle")})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(K,{className:"p-8 bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg border-0 sticky top-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(L,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:r("employerRequest.candidateInfo","Candidate Information")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center pb-6 border-b border-gray-200",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx(Q,{src:s?.profile?.photo,alt:s?.profile?.firstName+" "+s?.profile?.lastName,size:"xl",fallback:s?.profile?.firstName+" "+s?.profile?.lastName,className:"w-20 h-20 ring-4 ring-white shadow-lg"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})})]}),e.jsxs("h3",{className:"font-bold text-xl text-gray-900 mt-4",children:[s?.profile?.firstName?s.profile.firstName.charAt(0)+"*".repeat(s.profile.firstName.length-1):""," ",s?.profile?.lastName?s.profile.lastName.charAt(0)+"*".repeat(s.profile.lastName.length-1):""]}),e.jsx(F,{variant:"primary",size:"lg",className:"mt-2 bg-blue-500 text-white border-0",children:s?.profile?.jobCategory?.name_en||r("employerRequest.candidate.jobSeeker")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(z,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.location")}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.location||(s?.profile?.city?s.profile.city:"")||r("employerRequest.candidate.locationNotSpecified")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(H,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.experience")}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.experience||r("employerRequest.candidate.notSpecified")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(M,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.availability")}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.availability||r("employerRequest.candidate.notSpecified")})]})]}),s?.profile?.monthlyRate&&e.jsx("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-xl",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r("employerRequest.candidate.monthlyRate")}),e.jsx("p",{className:"text-sm font-semibold text-blue-600",children:s.profile.monthlyRate})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Y,{className:"w-4 h-4 text-orange-500"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:r("employerRequest.candidate.skillsExpertise")})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s?.profile?.skills?s.profile.skills.split(",").map((i,t)=>e.jsx(F,{variant:"outline",size:"sm",className:"px-3 py-1 text-xs font-medium border-gray-200 text-gray-700 bg-gray-50",children:i.trim()},t)):e.jsx("span",{className:"text-gray-400 text-sm",children:r("employerRequest.candidate.noSkillsListed")})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx(O,{to:`/view-profile/${l}`,className:"block w-full text-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-xl transition-colors",children:r("employerRequest.candidate.viewFullProfile")})})]})]})})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},children:e.jsx(V,{jobSeekerId:(()=>{let i=null;if(s?.id&&s.id!=="undefined"&&s.id!=="null")i=s.id;else if(s?.profile?.userId&&s.profile.userId!=="undefined"&&s.profile.userId!=="null")i=s.profile.userId;else if(s?.userId&&s.userId!=="undefined"&&s.userId!=="null")i=s.userId;else if(l&&l!=="undefined"&&l!=="null")if(typeof l=="string"&&l.startsWith("JS")){const t=parseInt(l.replace(/^JS/,""),10);isNaN(t)?i=l:i=t}else i=l;return(!i||i==="undefined"||i==="null"||i==="")&&(console.error("❌ No valid candidate ID found!"),console.error("Available data:",{urlId:l,jobSeekerId:s?.id,profileUserId:s?.profile?.userId,userId:s?.userId})),i})(),jobSeekerName:s?.profile?`${s.profile.firstName} ${s.profile.lastName}`:s.name,onSuccess:u,onError:I})})})]})]})}),e.jsx(w,{})]})};export{ce as default};
