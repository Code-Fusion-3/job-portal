import{j as e,g as Ee,P as We,e as ce,a as Me,C as ye,a0 as je,S as Ge,r as n,f as Ve,a1 as st,O as Ye,V as Xe,x as Re,a7 as at,a8 as rt,a9 as lt,s as Ue,Y as pe,U as De,aa as Be,d as nt,ab as ot,X as Ze,M as it,a2 as Ne,ac as ct,ad as dt,K as W,ae as mt,af as ut,ag as xt,ah as oe,ai as ie,c as Ie,aj as gt,ak as ht,al as ze,am as R,a4 as pt,q as ft,an as Fe,ao as Se,ap as bt,Z as yt,v as jt,aq as Nt,E as Pe,p as vt,ar as wt,as as Te,at as Ct,a5 as kt,au as St,av as Pt,b as At}from"./vendor-react-BkwhrffK.js";import{B as P,d as qe,L as ae,C as te,u as Qe,A as se,e as Et}from"./index-BwJdDrjx.js";import{a as de,R as Mt}from"./ReportsPage-D2JD3vUw.js";import{a as Ke}from"./useJobSeekers-BoL8J6I2.js";import{g as Je,u as et,E as Dt,S as ke,a as Rt,b as Lt,c as $t,h as Ft}from"./EmployerRequestsPage-C1uhOfmY.js";import{a as Tt,b as Ut}from"./useCategories-sOSLjpJi.js";import{m as Ae}from"./vendor-motion-CuEGWhdi.js";import{B as T}from"./Badge-p12a0enm.js";import{A as Oe}from"./Avatar-ejjI39mx.js";import{M as fe}from"./Modal-D8dq9gsi.js";import It from"./JobSeekersPage-B8FhLktB.js";import{D as tt}from"./DataTable-CItc7P9l.js";import{c as he}from"./contactService-nF5_-AFm.js";import zt from"./JobCategoriesPage-BdW4OynS.js";import"./vendor-common-BZD0eUgH.js";import"./vendor-gsap-lnFyu4_T.js";import"./messagingService-HckjbePF.js";import"./endpoints-CXiMw_A_.js";import"./categoryService-n484xWdK.js";import"./useApprovalManagement-CtLffP8F.js";import"./StatusBadge-DD9XEp3_.js";const _t=({isConnected:t,lastUpdate:l,onRefresh:m,showLastUpdate:r=!0,className:i=""})=>e.jsx("div",{className:`flex items-center space-x-2 text-sm ${i}`,children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Ae.div,{animate:{scale:t?[1,1.2,1]:1,opacity:t?1:.5},transition:{duration:2,repeat:t?1/0:0,ease:"easeInOut"}})})}),Bt=({request:t,onContactEmployer:l,onViewDetails:m,getStatusColor:r,getPriorityColor:i,compact:b=!1})=>{if(!t)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No request data available"});const v=t.name||t.employerName||"Unknown Employer",p=t.companyName||"Unknown Company",u=t.status||"pending",g=t.priority||"normal",N=t.message||"No message provided",S=t.email||"",h=t.phoneNumber||"",w=t.createdAt||new Date().toISOString(),y=t.selectedUser||t.hasSelectedCandidate,M=t.requestedCandidate,f=t.selectedUser;let A="No candidate selected",U=null;return y&&f?.profile?(A=`${f.profile.firstName} ${f.profile.lastName}`,U=f):M?.profile&&(A=`${M.profile.firstName} ${M.profile.lastName}`,U=M),b?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:v}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:p})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{variant:"outline",size:"xs",className:r?r(u):"bg-gray-100 text-gray-800",children:Je(u)}),e.jsx(T,{variant:"outline",size:"xs",className:i?i(g):"bg-gray-100 text-gray-800",children:g})]})]}),e.jsxs("div",{className:"mt-2",children:[y?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"✓ Selected:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"⏳ Requesting:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A})]}),U?.profile?.skills&&e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-xs text-gray-700",children:U.profile.skills})]})]})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:v}),e.jsx("p",{className:"text-sm text-gray-600",children:p})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{variant:"outline",size:"sm",className:r?r(u):"bg-gray-100 text-gray-800",children:Je(u)}),e.jsx(T,{variant:"outline",size:"sm",className:i?i(g):"bg-gray-100 text-gray-800",children:g})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:N}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[S&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:S})]}),h&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{children:h})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Candidate Information"}),y?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"✓ Selected Candidate:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A})]}),U?.profile?.skills&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-sm text-gray-700",children:U.profile.skills})]}),U?.profile?.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Experience: "}),e.jsx("span",{className:"text-sm text-gray-700",children:U.profile.experience})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No candidate selected yet"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(w).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[l&&e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>l(t),children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Contact"]}),m&&e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>m(t),children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})},qt=({jobSeeker:t,onViewDetails:l,getCategoryColor:m,compact:r=!1})=>{if(!t)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No job seeker data available"});const b=(m||(v=>{const p={JavaScript:"bg-yellow-100 text-yellow-800",React:"bg-blue-100 text-blue-800","Node.js":"bg-green-100 text-green-800",Python:"bg-blue-100 text-blue-800",Django:"bg-green-100 text-green-800",PostgreSQL:"bg-blue-100 text-blue-800",AWS:"bg-orange-100 text-orange-800",Docker:"bg-blue-100 text-blue-800",Git:"bg-red-100 text-red-800",Java:"bg-orange-100 text-orange-800",Cooking:"bg-red-100 text-red-800",Housekeeping:"bg-purple-100 text-purple-800",Childcare:"bg-pink-100 text-pink-800",Gardening:"bg-emerald-100 text-emerald-800",Cleaning:"bg-gray-100 text-gray-800",Driving:"bg-indigo-100 text-indigo-800",Teaching:"bg-yellow-100 text-yellow-800",Nursing:"bg-rose-100 text-rose-800",Construction:"bg-amber-100 text-amber-800",Agriculture:"bg-lime-100 text-lime-800",Technology:"bg-blue-100 text-blue-800",Healthcare:"bg-green-100 text-green-800",Education:"bg-purple-100 text-purple-800",Manufacturing:"bg-red-100 text-red-800",Services:"bg-gray-100 text-gray-800",General:"bg-gray-100 text-gray-800","Job Seeker":"bg-gray-100 text-gray-800",default:"bg-gray-100 text-gray-800"};return p[v]||p.default}))(t?.category||"General");return r?e.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Oe,{src:t?.avatar,alt:t?.name||"Job Seeker",size:"sm",fallback:t?.name||"JS",fallbackSrc:qe}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:t?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:t?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(T,{variant:"outline",size:"xs",className:b,children:t?.category||"General"}),e.jsx("span",{className:"text-xs text-gray-500",children:t?.location||"Unknown"})]}),t?.approvalStatus&&e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${t.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":t.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[t.approvalStatus==="approved"?e.jsx(Me,{className:"w-3 h-3"}):t.approvalStatus==="rejected"?e.jsx(ye,{className:"w-3 h-3"}):e.jsx(je,{className:"w-3 h-3"}),t.approvalStatus==="approved"?"Verified":t.approvalStatus==="rejected"?"Rejected":"Pending"]})}),t?.category&&t.category.includes(",")&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[t.category.split(",").slice(0,3).map((v,p)=>e.jsx("span",{className:"inline-block px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:v.trim()},p)),t.category.split(",").length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",t.category.split(",").length-3," more"]})]})]})]}):e.jsxs("div",{className:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Oe,{src:t?.avatar,alt:t?.name||"Job Seeker",size:"md",fallback:t?.name||"JS",fallbackSrc:qe}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:t?.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:t?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:t?.location||"Unknown"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t?.experience||"0"," years"]}),e.jsx(T,{variant:"outline",size:"sm",className:b,children:t?.category||"General"})]}),t?.approvalStatus&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${t.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":t.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[t.approvalStatus==="approved"?e.jsx(Me,{className:"w-3.5 h-3.5"}):t.approvalStatus==="rejected"?e.jsx(ye,{className:"w-3.5 h-3.5"}):e.jsx(je,{className:"w-3.5 h-3.5"}),t.approvalStatus==="approved"?"Verified Profile":t.approvalStatus==="rejected"?"Profile Rejected":"Under Review"]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["Daily: ",t?.dailyRate?.toLocaleString()||"0"," frw"]}),e.jsxs("span",{children:["Monthly: ",t?.monthlyRate?.toLocaleString()||"0"," frw"]})]})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>l?.(t),title:"View Details",children:e.jsx(ce,{className:"w-4 h-4"})})]})},Jt=({logo:t="J",title:l="Admin Panel",subtitle:m="Job Portal Management"})=>e.jsx("div",{className:"flex items-center justify-between p-5 border-b border-slate-200 bg-slate-50/60",children:e.jsxs("div",{className:"flex items-center space-x-2.5",children:[e.jsx("div",{className:"w-9 h-9 bg-red-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-base",children:t})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-slate-800 text-base",children:l}),e.jsx("span",{className:"text-xs text-slate-500",children:m})]})]})}),Ot=({searchValue:t="",onSearchChange:l,placeholder:m="Search..."})=>e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:m,value:t,onChange:r=>l?.(r.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-md text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-200"})]})}),Ht=({item:t,isActive:l,onClick:m})=>{const[r,i]=n.useState(!1),v={Home:Be,Users:De,MessageSquare:pe,Briefcase:Ue,BarChart3:lt,Settings:rt,TestTube:at,User:Re,FileText:Xe,Calendar:Ye,Star:st,MapPin:Ve,Mail:Ee,Phone:We}[t.icon]||Be,p=()=>{t.subItems?i(!r):m(t.id)},u=g=>{m(g)};return e.jsxs("li",{children:[e.jsxs("button",{onClick:p,className:`
          relative w-full flex items-center space-x-2.5 px-3 py-2.5 rounded-md text-left transition-all duration-200 group
          ${l?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
        `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx(v,{className:`
              h-4.5 w-4.5 flex-shrink-0
              ${l?"text-red-600":"text-slate-500 group-hover:text-slate-700"}
            `})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:`text-sm ${l?"font-medium":"font-normal"}`,children:t.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[t.badge&&e.jsx("span",{className:`
                px-1.5 py-0.5 text-xs font-medium rounded-full
                ${l?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}
              `,children:t.badge}),t.subItems&&e.jsx("div",{className:"flex items-center",children:r?e.jsx(nt,{className:"w-4 h-4 text-slate-500"}):e.jsx(ot,{className:"w-4 h-4 text-slate-500"})})]})]})]}),t.subItems&&r&&e.jsx("ul",{className:"ml-6 mt-1 space-y-0.5",children:t.subItems.map(g=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>u(g.id),className:`
                  relative w-full flex items-center space-x-2.5 px-3 py-2 rounded-md text-left transition-all duration-200 group
                  ${l===g.id?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
                `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx("div",{className:`
                    w-1.5 h-1.5 rounded-full
                    ${l===g.id?"bg-red-600":"bg-slate-400 group-hover:bg-slate-600"}
                  `})}),e.jsx("span",{className:`text-sm ${l===g.id?"font-medium":"font-normal"}`,children:g.label})]})},g.id))})]})},Wt=({navigationItems:t,activeItem:l,onItemClick:m})=>e.jsx("nav",{className:"flex-1 px-3 py-2 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:t.map(r=>e.jsx(Ht,{item:r,isActive:l===r.id,onClick:m},r.id))})}),Gt=({sidebarOpen:t,setSidebarOpen:l,navigationItems:m,activeTab:r,setActiveTab:i,user:b,onLogout:v,className:p=""})=>{const[u,g]=n.useState("");n.useEffect(()=>{const w=()=>{window.innerWidth>=768?l(!0):l(!1)};return w(),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[l]);const N=()=>{l(!t)},S=w=>{i(w),window.innerWidth<768&&l(!1)},h=w=>{g(w)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:N,className:"fixed top-6 left-6 z-50 p-3 rounded-lg bg-white shadow-md border border-slate-100 md:hidden hover:bg-slate-50 transition-all duration-200","aria-label":"Toggle sidebar",children:t?e.jsx(Ze,{className:"h-5 w-5 text-slate-600"}):e.jsx(it,{className:"h-5 w-5 text-slate-600"})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300",onClick:N}),e.jsxs("div",{className:`
          fixed top-0 left-0 h-full bg-white border-r border-slate-200 z-40 transition-all duration-300 ease-in-out flex flex-col w-64 md:w-80 md:sticky md:top-0 md:h-screen md:left-0 md:static
          ${t?"translate-x-0":"-translate-x-full"}
          md:translate-x-0 md:static md:z-auto
          ${p}
        `,children:[e.jsx(Jt,{logo:"J",title:"Admin Panel",subtitle:"Job Portal Management"}),e.jsx(Ot,{searchValue:u,onSearchChange:h,placeholder:"Search..."}),e.jsx(Wt,{navigationItems:m,activeItem:r,onItemClick:S})]})]})},Vt=({user:t,onLogout:l,onSearch:m,onFilter:r,searchTerm:i="",onRefresh:b})=>e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 md:px-6 py-4 sticky top-0 z-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome back, ",t?.firstName||t?.email||"Admin"]})]})}),e.jsx("div",{className:"flex-1 max-w-md mx-4 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search...",value:i,onChange:v=>m?.(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[b&&e.jsx(P,{variant:"ghost",size:"sm",onClick:b,title:"Refresh data",children:e.jsx(Ne,{className:"w-5 h-5"})}),e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(ct,{className:"w-5 h-5"})}),e.jsx("div",{className:"relative",children:e.jsxs(P,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Re,{className:"w-4 h-4 text-red-600"})}),e.jsx("span",{className:"hidden md:block text-sm font-medium",children:t?.firstName||t?.email||"Admin"})]})}),e.jsx(P,{variant:"outline",size:"sm",onClick:l,className:"hidden md:block",children:"Logout"})]})]})}),Yt=()=>xt.create({page:{flexDirection:"column",backgroundColor:"#ffffff",padding:15,fontSize:9},header:{marginBottom:10,borderBottom:"2 solid #3b82f6",paddingBottom:5},title:{fontSize:24,fontWeight:"bold",color:"#1f2937",marginBottom:2},subtitle:{fontSize:16,color:"#6b7280",marginBottom:2},dateRange:{fontSize:12,color:"#9ca3af",marginBottom:6},table:{display:"table",width:"auto",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,borderColor:"#e5e7eb"},tableRow:{margin:"auto",flexDirection:"row"},tableColHeader:{width:"auto",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#3b82f6",backgroundColor:"#3b82f6",padding:1,minHeight:18,justifyContent:"center",alignItems:"center"},tableCol:{width:"1",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#e5e7eb",padding:1,minHeight:5,justifyContent:"center",alignItems:"center"},tableCellHeader:{margin:"2",fontSize:11,fontWeight:"bold",color:"#ffffff",textAlign:"center"},tableCell:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"center"},tableCellLeft:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"left"},footer:{position:"absolute",bottom:15,left:15,right:15,textAlign:"center",color:"#6b7280",fontSize:8,borderTop:"1 solid #e5e7eb",paddingTop:5},pageNumber:{position:"absolute",bottom:15,right:15,color:"#6b7280",fontSize:8},alternateRow:{backgroundColor:"#f9fafb"}}),Xt=(t,l,m,r)=>{const i=Yt(),b=r.title||ts(t);r.subtitle||`${b.toLowerCase()}`;const v=r.dateRange||`Export Date: ${new Date().toLocaleDateString()}`,p=ss(t,m);return W.createElement(mt,{},W.createElement(ut,{size:"A4",orientation:"landscape",style:i.page},[W.createElement(oe,{key:"header",style:i.header},[W.createElement(ie,{key:"title",style:i.title},"Job Portal System"),W.createElement(ie,{key:"subtitle",style:i.subtitle},b),W.createElement(ie,{key:"dateRange",style:i.dateRange},v)]),W.createElement(oe,{key:"table",style:i.table},[W.createElement(oe,{key:"header-row",style:i.tableRow},p.map((u,g)=>W.createElement(oe,{key:`header-${g}`,style:[i.tableColHeader,{width:He(u.key)}]},W.createElement(ie,{style:i.tableCellHeader},u.label)))),...l.map((u,g)=>W.createElement(oe,{key:`row-${g}`,style:[i.tableRow,g%2===1?i.alternateRow:{}]},p.map((N,S)=>W.createElement(oe,{key:`cell-${g}-${S}`,style:[i.tableCol,{width:He(N.key)}]},W.createElement(ie,{style:Qt(N.key)},as(u,N,t))))))]),W.createElement(oe,{key:"footer",style:i.footer},W.createElement(ie,{},`Generated by Job Portal System • Total records: ${l.length}`)),W.createElement(ie,{key:"pageNumber",style:i.pageNumber,render:({pageNumber:u,totalPages:g})=>`Page ${u} of ${g}`})]))},Zt=async(t,l,m,r={})=>{try{if(!l||!Array.isArray(l)||l.length===0)throw new Error("No table data provided");if(!m||!Array.isArray(m)||m.length===0)throw new Error("No columns provided");const i=Xt(t,l,m,r);return await dt(i).toBlob()}catch(i){throw console.error("Error generating react-pdf:",i),new Error(`Failed to generate PDF report: ${i.message}`)}},He=(t,l)=>t==="jobseeker_info"?"40%":t==="employer_info"||t==="candidate_info"||t==="job_details"?"30%":{name:"20%",email:"25%",phone:"15%",location:"20%",category:"20%",experience:"15%",status:"12%",priority:"12%",demand:"12%",count:"10%",percentage:"10%",createdAt:"15%",registeredAt:"15%",employerName:"20%",companyName:"20%",candidateName:"20%",candidateEmail:"20%",candidateContact:"15%",position:"20%",monthlyRate:"15%",contactEmail:"20%"}[t]||"15%",Qt=t=>["jobseeker_info","employer_info","candidate_info","job_details","name","email","location","category","position","companyName","employerName","candidateName","candidateEmail"].includes(t)?{textAlign:"left"}:{textAlign:"center"},Kt=(t,l)=>!t&&t!==0?"N/A":l==="status"||l==="priority"||l==="demand"?es(t):l==="percentage"?`${t}%`:l==="monthlyRate"&&t!=="Not specified"?t:typeof t=="string"&&t.length>30?t.substring(0,27)+"...":t,es=t=>t?{Active:"Active",Inactive:"Inactive",pending:"Pending",in_progress:"In Progress",completed:"Completed",urgent:"Urgent",high:"High",normal:"Normal",low:"Low",High:"High",Medium:"Medium",Low:"Low"}[t]||t:"N/A",ts=t=>({"job-seekers":"Job Seekers Report","employer-requests":"Employer Requests Report",categories:"Job Categories Report",locations:"Location Distribution Report",skills:"Skills Analysis Report"})[t]||"Table Report",ss=(t,l)=>t==="job-seekers"?[{key:"jobseeker_info",label:"Job Seeker Info",subColumns:["name","email","phone","location"]},{key:"job_details",label:"Job Details",subColumns:["category","experience"]},{key:"registeredAt",label:"Registration Date",subColumns:["registeredAt"]},{key:"status",label:"Status",subColumns:["status"]}]:t==="employer-requests"?[{key:"employer_info",label:"Employer Info",subColumns:["employerName","companyName","employerEmail"]},{key:"candidate_info",label:"Candidate Info",subColumns:["candidateName","candidateEmail","candidateContact"]},{key:"job_details",label:"Job Details",subColumns:["category","monthlyRate","status","priority"]},{key:"createdAt",label:"Request Date",subColumns:["createdAt"]}]:t==="categories"?[{key:"category",label:"Category",subColumns:["category"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:t==="locations"?[{key:"location",label:"Location",subColumns:["location"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:t==="skills"?[{key:"skill",label:"Skill",subColumns:["skill"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:l.map(m=>({key:m.key,label:m.label,subColumns:[m.key]})),as=(t,l,m)=>{if(!l.subColumns||l.subColumns.length===1){const i=l.subColumns?l.subColumns[0]:l.key;return Kt(t[i],i)}const r=l.subColumns.map(i=>{const b=t[i];return!b||b==="Not provided"||b==="Not specified"||b==="Unknown"?null:b}).filter(Boolean);return r.length===0?"N/A":r.length===1?r[0]:l.key==="jobseeker_info"?`${r[0]}
${r[1]}
${r[2]}
${r[3]}`:l.key==="employer_info"?`${r[0]}
${r[1]}
${r[2]||"N/A"}`:l.key==="candidate_info"?`${r[0]}
${r[1]}
${r[2]||"N/A"}`:l.key==="job_details"?m==="job-seekers"?`${r[0]}
${r[1]}`:m==="employer-requests"?`${r[0]}
${r[1]}
${r[2]}
${r[3]}`:r.join(`
`):r.join(`
`)},rs=async(t,l)=>{try{const m=URL.createObjectURL(t),r=document.createElement("a");return r.href=m,r.download=l,r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(m),!0}catch(m){return console.error("Error saving PDF:",m),!1}},ls=(t,l,m)=>{try{const r=l.map(g=>g.label).join(","),i=t.map(g=>l.map(N=>{const S=g[N.key];return typeof S=="string"&&(S.includes(",")||S.includes('"'))?`"${S.replace(/"/g,'""')}"`:S||""}).join(",")),b=[r,...i].join(`
`),v=new Blob([b],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a"),u=URL.createObjectURL(v);return p.setAttribute("href",u),p.setAttribute("download",m),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p),!0}catch(r){return console.error("Error exporting CSV:",r),!1}},ns=(t,l,m)=>{try{let r='<table border="1">';r+="<tr>",l.forEach(p=>{r+=`<th style="background-color: #3b82f6; color: white; padding: 8px; text-align: center; font-weight: bold;">${p.label}</th>`}),r+="</tr>",t.forEach(p=>{r+="<tr>",l.forEach(u=>{const g=p[u.key]||"";r+=`<td style="padding: 6px; border: 1px solid #e5e7eb;">${g}</td>`}),r+="</tr>"}),r+="</table>";const i=new Blob([r],{type:"application/vnd.ms-excel"}),b=document.createElement("a"),v=URL.createObjectURL(i);return b.setAttribute("href",v),b.setAttribute("download",m.replace(".xlsx",".html")),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b),!0}catch(r){return console.error("Error exporting Excel:",r),!1}},os=()=>{const{t}=Ie(),[l,m]=n.useState("30"),[r,i]=n.useState(!1),[b,v]=n.useState(null),[p,u]=n.useState(!0),[g,N]=n.useState(""),[S,h]=n.useState(null),[w,y]=n.useState("job-seekers"),[M,f]=n.useState(""),[A,U]=n.useState("pdf"),{jobSeekers:I,loading:_,error:Y,fetchJobSeekers:B}=Ke({autoFetch:!0,itemsPerPage:1e3}),{requests:Z,loading:C,error:j,fetchRequests:k}=et({autoFetch:!0,itemsPerPage:1e3}),{categories:L,loading:q,error:H,fetchCategories:K}=Tt({includeAdmin:!0,autoFetch:!0});n.useEffect(()=>{c()},[l]);const c=async()=>{try{u(!0),N("");const[o,s]=await Promise.all([de.getAnalytics({period:l}),de.getDashboardStats()]);o.success?v(o.data):N(o.error||"Failed to load analytics data"),s.success&&h(s.data)}catch(o){console.error("Error loading report data:",o),N("Network error. Please try again.")}finally{u(!1)}},$=[{value:"7",label:"Last 7 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days"},{value:"365",label:"Last Year"}],x=[{value:"job-seekers",label:"Job Seekers",icon:De},{value:"employer-requests",label:"Employer Requests",icon:pe},{value:"categories",label:"Categories",icon:Ue},{value:"locations",label:"Locations",icon:Ve},{value:"skills",label:"Skills",icon:gt}],d=async o=>{i(!0);try{const s=ge(o),a=le(o);if(!s||s.length===0)return R.error("No data available for export"),!1;const z=new Date().toISOString().split("T")[0],E=`table-report-${o}-${z}`;let X=!1;switch(A){case"pdf":const ve={title:Q(o),subtitle:`Comprehensive data table for ${Q(o).toLowerCase()}`,dateRange:`Last ${l} days (${new Date(Date.now()-parseInt(l)*24*60*60*1e3).toLocaleDateString()} - ${new Date().toLocaleDateString()})`};try{const ne=await Zt(o,s,a,ve),F=`${E}.pdf`;X=await rs(ne,F)}catch(ne){return console.error("PDF generation error:",ne),R.error(`PDF generation failed: ${ne.message}`),!1}X?R.success(`${Q(o)} exported successfully as PDF!`):R.error("Failed to save PDF file");break;case"csv":const we=`${E}.csv`;X=ls(s,a,we),X?R.success(`${Q(o)} exported successfully as CSV!`):R.error("Failed to save CSV file");break;case"excel":const Ce=`${E}.xlsx`;X=ns(s,a,Ce),X?R.success(`${Q(o)} exported successfully as Excel!`):R.error("Failed to save Excel file");break;default:return R.error("Unsupported export format"),!1}return X}catch(s){return console.error("Error exporting report:",s),R.error("Error generating export report. Please try again."),!1}finally{i(!1)}},J=async()=>{i(!0);try{await Promise.all([c(),B(),k(),K()])}catch(o){console.error("Error refreshing data:",o),N("Failed to refresh data. Please try again.")}finally{i(!1)}},O=()=>!I||I.length===0?[]:I.map(o=>({id:o.id,name:`${o.profile?.firstName||o.firstName||o.name||"Unknown"} ${o.profile?.lastName||o.lastName||""}`,email:o.email||o.profile?.email||"Not provided",phone:o.profile?.contactNumber||o.contactNumber||o.phone||"Not provided",location:o.profile?.location||o.location||o.city||"Not specified",category:o.profile?.jobCategory?.name_en||o.jobCategory?.name_en||o.category||"Not specified",experience:o.profile?.experienceLevel||o.experienceLevel||o.experience||"Not specified",registeredAt:o.registeredAt||o.createdAt?new Date(o.registeredAt||o.createdAt).toLocaleDateString():"Unknown",status:o.status||"Active"})),me=()=>{if(!Z||Z.length===0)return[];const o=s=>{if(!s||s==="Not specified")return"Not specified";if(typeof s=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(s);if(typeof s=="string"){const a=parseFloat(s);return isNaN(a)?s:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(a)}return"Not specified"};return Z.map(s=>({id:s.id,employerName:s.name||s.employerName||s.employer?.name||"Unknown",companyName:s.companyName||s.employer?.company||"Private",candidateName:s.requestedCandidate&&`${s.requestedCandidate.profile?.firstName||""} ${s.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:s.requestedCandidate?.profile?.skills||s.position||s.jobTitle||"General",status:s.status||"pending",priority:s.priority||"normal",monthlyRate:o(s.requestedCandidate?.profile?.monthlyRate),createdAt:s.createdAt?new Date(s.createdAt).toLocaleDateString():"Unknown",contactEmail:s.email||s.employerContact?.email||s.employer?.email||"Not provided",lastContactDate:s.updatedAt,isCompleted:s.status==="completed",category:s.requestedCandidate?.profile?.jobCategory?.name_en||"General",candidateExperience:s.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:s.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:s.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:s.requestedCandidate?.profile?.location||"Not specified",candidateCity:s.requestedCandidate?.profile?.city||"Not specified",candidateCountry:s.requestedCandidate?.profile?.country||"Not specified",candidateContact:s.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:s.requestedCandidate?.email||"Not specified",candidateLanguages:s.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:s.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:s.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:s.requestedCandidate?.profile?.description||"Not specified",candidateGender:s.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:s.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:s.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:s.requestedCandidate?.profile?.references||"Not specified",message:s.message||"",_backendData:s}))},ue=()=>{if(!L||L.length===0)return[];const o={};return I?.forEach(s=>{const a=s.profile?.jobCategory?.name_en||s.jobCategory?.name_en||s.category||"Uncategorized";o[a]=(o[a]||0)+1}),L.map(s=>{const a=o[s.name_en]||0,z=I?.length||1,E=Math.round(a/z*100);return{id:s.id,name:s.name_en||s.name,count:a,percentage:E,status:"Active"}})},xe=()=>{if(!I||I.length===0)return[];const o={};return I.forEach(s=>{const a=s.profile?.location||s.location||s.city||"Unknown";o[a]=(o[a]||0)+1}),Object.entries(o).map(([s,a])=>{const z=I.length,E=Math.round(a/z*100);return{id:s,name:s,count:a,percentage:E,status:"Active"}}).sort((s,a)=>a.count-s.count)},be=()=>{if(!I||I.length===0)return[];const o={};return I.forEach(s=>{const a=s.profile?.skills||s.skills||"";a&&a.split(",").map(E=>E.trim()).filter(E=>E).forEach(E=>{o[E]=(o[E]||0)+1})}),Object.entries(o).map(([s,a])=>{const z=I.length,E=Math.round(a/z*100),X=a>z*.3?"High":a>z*.1?"Medium":"Low";return{id:s,name:s,count:a,percentage:E,demand:X}}).sort((s,a)=>a.count-s.count)},le=o=>{switch(o){case"job-seekers":return[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"location",label:"Location",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"experience",label:"Experience",sortable:!0},{key:"registeredAt",label:"Registered",sortable:!0},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(T,{variant:s.status==="Active"?"success":"warning",children:s.status})}];case"employer-requests":return[{key:"employerName",label:"Employer Name",sortable:!0},{key:"companyName",label:"Company",sortable:!0},{key:"contactEmail",label:"Employer Email",sortable:!0},{key:"candidateName",label:"Candidate Name",sortable:!0},{key:"candidateEmail",label:"Candidate Email",sortable:!0},{key:"candidateContact",label:"Candidate Phone",sortable:!0},{key:"position",label:"Position/Skills",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"monthlyRate",label:"Monthly Rate",sortable:!0},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(T,{variant:s.status==="completed"?"success":s.status==="in_progress"?"warning":s.status==="pending"?"info":"danger",children:s.status.replace("_"," ")})},{key:"priority",label:"Priority",sortable:!0,render:s=>e.jsx(T,{variant:s.priority==="urgent"?"danger":s.priority==="high"?"warning":s.priority==="normal"?"info":"secondary",children:s.priority})},{key:"createdAt",label:"Created",sortable:!0}];case"categories":return[{key:"name",label:"Category Name",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:s=>e.jsxs("span",{children:[s.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(T,{variant:"success",children:s.status})}];case"locations":return[{key:"name",label:"Location",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:s=>e.jsxs("span",{children:[s.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:s=>e.jsx(T,{variant:"success",children:s.status})}];case"skills":return[{key:"name",label:"Skill Name",sortable:!0},{key:"count",label:"Count",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:s=>e.jsxs("span",{children:[s.percentage,"%"]})},{key:"demand",label:"Demand Level",sortable:!0,render:s=>e.jsx(T,{variant:s.demand==="High"?"success":s.demand==="Medium"?"warning":"info",children:s.demand})}];default:return[]}},ge=o=>{switch(o){case"job-seekers":return O();case"employer-requests":return me();case"categories":return ue();case"locations":return xe();case"skills":return be();default:return[]}},Q=o=>{const s=x.find(a=>a.value===o);return s?s.label:"Report"};return p||_||C||q?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(ae,{size:"lg",text:"Loading table reports..."})}):g||Y||j||H?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Xe,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Table Reports"}),e.jsx("p",{className:"text-red-600 mb-4",children:g||Y||j||H}),e.jsxs(P,{onClick:J,variant:"outline",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Table Reports"})})}),e.jsx(te,{className:"",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsx("select",{value:l,onChange:o=>m(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:$.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]})}),x.map(o=>{const s=o.icon,a=w===o.value;return e.jsx("button",{onClick:()=>y(o.value),className:`p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md ${a?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 hover:border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(s,{className:`w-6 h-6 ${a?"text-blue-600":"text-gray-500"}`}),e.jsx("span",{className:"text-sm font-medium text-center",children:o.label})]})},o.value)})]})}),w&&e.jsxs(te,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:Q(w)}),e.jsxs("p",{className:"text-gray-600",children:["Comprehensive data table for ",Q(w).toLowerCase()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:A,onChange:o=>U(o.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"excel",children:"Excel"})]}),e.jsxs(P,{onClick:()=>d(w),disabled:r,className:"flex items-center gap-2",children:[e.jsx(ht,{className:"w-3 h-3"}),r?"Exporting...":`Export ${A.toUpperCase()}`]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(P,{onClick:J,variant:"outline",disabled:r,className:"flex items-center gap-2",children:[e.jsx(Ne,{className:`w-3 h-3 ${r?"animate-spin":""}`}),r?"Refreshing...":"Refresh"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(tt,{columns:le(w),data:ge(w),pagination:!0,itemsPerPage:15,searchTerm:M,onSearchChange:f,className:"w-full"})})]}),e.jsx(ze,{position:"top-right"})]})},is=(t={})=>{const{autoFetch:l=!1,itemsPerPage:m=10,page:r=1,searchTerm:i="",status:b="",category:v=""}=t,[p,u]=n.useState([]),[g,N]=n.useState(!1),[S,h]=n.useState(""),[w,y]=n.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[M,f]=n.useState(null),A=n.useCallback(async(C={})=>{N(!0),h("");try{const j={page:C.page||r,limit:C.itemsPerPage||m,search:C.searchTerm||i,status:C.status||b,category:C.category||v,...C},k=await he.getAllContacts(j);k.success?(u(Array.isArray(k.data.contacts)?k.data.contacts:[]),k.data.pagination&&y(k.data.pagination),k.data.statistics&&f(k.data.statistics)):h(k.error)}catch(j){h("Failed to fetch contact messages"),console.error("Error fetching contact messages:",j)}finally{N(!1)}},[r,m,i,b,v]),U=n.useCallback(async C=>{N(!0),h("");try{const j=await he.getMessageById(C);return j.success?j.data:(h(j.error),null)}catch(j){return h("Failed to fetch contact message"),console.error("Error fetching contact message:",j),null}finally{N(!1)}},[]),I=n.useCallback(async(C,j)=>{N(!0),h("");try{const k=await he.respondToMessage(C,j);return k.success?(await A(),k):(h(k.error),k)}catch{return h("Failed to respond to message"),{success:!1,error:"Failed to respond to message"}}finally{N(!1)}},[A]),_=n.useCallback(async C=>{try{const j=await he.markAsRead(C);return j.success?(u(k=>k.map(L=>L.id===C?{...L,isRead:!0}:L)),j):(h(j.error),j)}catch(j){return h("Failed to mark message as read"),console.error("Error marking message as read:",j),{success:!1,error:"Failed to mark message as read"}}},[]),Y=n.useCallback(async C=>{try{const j=await he.deleteMessage(C);return j.success?(u(k=>k.filter(L=>L.id!==C)),j):(h(j.error),j)}catch(j){return h("Failed to delete message"),console.error("Error deleting message:",j),{success:!1,error:"Failed to delete message"}}},[]),B=n.useCallback(async()=>{try{const C=await he.getStatistics();return C.success?(f(C.data),C.data):(h(C.error),null)}catch(C){return h("Failed to fetch statistics"),console.error("Error fetching statistics:",C),null}},[]),Z=n.useCallback(()=>A(),[A]);return n.useEffect(()=>{l&&(A(),B())},[l,A,B]),{messages:p,loading:g,error:S,pagination:w,statistics:M,fetchMessages:A,fetchMessageById:U,respondToMessage:I,markAsRead:_,deleteMessage:Y,fetchStatistics:B,refreshMessages:Z}},cs=()=>{const{t}=Ie(),[l,m]=n.useState(""),[r,i]=n.useState(""),[b,v]=n.useState(""),[p,u]=n.useState(null),[g,N]=n.useState(!1),[S,h]=n.useState(!1),[w,y]=n.useState(!1),[M,f]=n.useState({subject:"",message:""}),[A,U]=n.useState(!1),{messages:I,loading:_,error:Y,statistics:B,fetchMessages:Z,respondToMessage:C,markAsRead:j,deleteMessage:k,refreshMessages:L}=is({autoFetch:!0,itemsPerPage:15}),[q,H]=n.useState(1),K=15,$=(Array.isArray(I)?I.map(a=>({...a,createdAt:a.createdAt||""})):[]).filter(a=>{const z=!l||a.status===l,E=!r||a.category===r,X=!b||a.priority===b;return z&&E&&X}),x=Math.ceil($.length/K),d=$.slice((q-1)*K,q*K),J=(a,z)=>{u(z),N(!0)};n.useEffect(()=>{Z({status:l,category:r,priority:b})},[l,r,b]);const O=async a=>{u(a),N(!0),a.isRead||await j(a.id)},me=a=>{u(a),f({subject:`Re: ${a.subject}`,message:""}),h(!0)},ue=a=>{u(a),y(!0)},xe=async a=>{if(a.preventDefault(),!localStorage.getItem("job_portal_token")){R.error("You are not logged in. Please log in again."),window.location.href="/login";return}if(!M.subject.trim()||!M.message.trim()){R.error("Please fill in both subject and message");return}if(p&&p.status==="responded"){R.error("This message has already been responded to. You cannot reply again."),h(!1);return}U(!0);try{const E=await C(p.id,M);E.success?(R.success("Response sent successfully!"),h(!1),f({subject:"",message:""}),u(null)):R.error(E.error||"Failed to send response")}catch{R.error("Failed to send response. Please try again.")}finally{U(!1)}},be=async()=>{(await k(p.id)).success?(R.success("Message deleted successfully!"),y(!1),u(null)):R.error("Failed to delete message")},le=a=>{switch(a){case"unread":return e.jsx(T,{variant:"warning",children:"Unread"});case"read":return e.jsx(T,{variant:"info",children:"Read"});case"responded":return e.jsx(T,{variant:"success",children:"Responded"});case"archived":return e.jsx(T,{variant:"secondary",children:"Archived"});default:return e.jsx(T,{variant:"outline",children:a})}},ge=a=>{switch(a){case"low":return e.jsx(T,{variant:"secondary",children:"Low"});case"normal":return e.jsx(T,{variant:"info",children:"Normal"});case"high":return e.jsx(T,{variant:"warning",children:"High"});case"urgent":return e.jsx(T,{variant:"danger",children:"Urgent"});default:return e.jsx(T,{variant:"outline",children:a})}},Q=a=>{switch(a){case"general":return e.jsx(T,{variant:"info",children:"General"});case"support":return e.jsx(T,{variant:"warning",children:"Support"});case"feedback":return e.jsx(T,{variant:"success",children:"Feedback"});case"complaint":return e.jsx(T,{variant:"danger",children:"Complaint"});default:return e.jsx(T,{variant:"outline",children:a})}},o=[{key:"name",label:"Name",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:a.name})]})},{key:"email",label:"Email",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:a.email})]})},{key:"subject",label:"Subject",sortable:!0,render:a=>e.jsx("div",{className:"max-w-xs truncate",title:a.subject,children:a.subject})},{key:"category",label:"Category",sortable:!0,render:a=>Q(a.category)},{key:"priority",label:"Priority",sortable:!0,render:a=>ge(a.priority)},{key:"status",label:"Status",sortable:!0,render:a=>le(a.status)},{key:"submittedAt",label:"Date",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ye,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:new Date(a.createdAt).toLocaleDateString()})]})}],s=a=>[{key:"view",label:"View",icon:ce,onClick:()=>O(a),variant:"outline"},{key:"reply",label:"Reply",icon:Fe,onClick:()=>{a.status==="responded"?R.error("This message has already been responded to."):me(a)},variant:"primary",disabled:a.status==="responded"},{key:"delete",label:"Delete",icon:Se,onClick:()=>ue(a),variant:"danger"}];return _&&I.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(ae,{size:"lg",text:"Loading contact messages..."})}):Y&&I.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ye,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Contact Messages"}),e.jsx("p",{className:"text-red-600 mb-4",children:Y}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Authentication Issue:"})," This error usually means you need to log in again or your session has expired."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsxs(P,{onClick:L,variant:"outline",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsx(P,{onClick:()=>window.location.href="/login",variant:"primary",children:"Go to Login"})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-gray-600",children:"Manage and respond to contact form submissions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(P,{onClick:L,variant:"outline",disabled:_,className:"flex items-center gap-2",children:[e.jsx(Ne,{className:`w-4 h-4 ${_?"animate-spin":""}`}),_?"Refreshing...":"Refresh"]})})]}),B&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(te,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(pe,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.total||0})]})]})}),e.jsx(te,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(je,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Unread Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.unread||0})]})]})}),e.jsx(te,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Me,{className:"w-6 h-6 text-green-600"})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:B.responded||0})})]})}),e.jsx(te,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(pt,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Archived"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.archived||0})]})]})})]}),e.jsx(te,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:l,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"unread",children:"Unread"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"responded",children:"Responded"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:r,onChange:a=>i(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"feedback",children:"Feedback"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{value:b,onChange:a=>v(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(P,{onClick:()=>{m(""),i(""),v("")},variant:"outline",className:"w-full",children:[e.jsx(ft,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})})]})}),e.jsx(tt,{columns:o,data:d,pagination:!0,itemsPerPage:K,actionButtons:s,onRowAction:J,className:"w-full"}),x>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>H(q-1),disabled:q===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",q," of ",x]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>H(q+1),disabled:q===x,children:"Next"})]}),e.jsx(fe,{isOpen:g,onClose:()=>N(!1),title:"View Message",maxWidth:"max-w-2xl",children:p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:p.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:p.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("p",{className:"text-gray-900",children:p.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("div",{children:Q(p.category)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{children:le(p.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(p.createdAt).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:p.message})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(P,{onClick:()=>{N(!1),me(p)},variant:"primary",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Reply"]}),e.jsx(P,{onClick:()=>N(!1),variant:"outline",children:"Close"})]})]})}),e.jsx(fe,{isOpen:S,onClose:()=>h(!1),title:"Reply to Message",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:xe,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:M.subject,onChange:a=>f(z=>({...z,subject:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:M.message,onChange:a=>f(z=>({...z,message:a.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Type your response...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(P,{type:"button",onClick:()=>h(!1),variant:"outline",disabled:A,children:"Cancel"}),e.jsx(P,{type:"submit",variant:"primary",disabled:A,children:A?e.jsxs("span",{className:"flex items-center",children:[e.jsx(ae,{size:"sm",className:"mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Send Reply"]})})]})]})}),e.jsx(ze,{position:"top-right"}),e.jsx(fe,{isOpen:w,onClose:()=>y(!1),title:"Delete Message",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Se,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Message"}),e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to delete this message? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(P,{onClick:()=>y(!1),variant:"outline",children:"Cancel"}),e.jsxs(P,{onClick:be,variant:"danger",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})},ds=({loadingTime:t,apiCalls:l,cacheHits:m,errors:r,showDetails:i=!1})=>{const[b,v]=n.useState(!1);if(n.useEffect(()=>{const g=setTimeout(()=>{(t>2e3||r.length>0)&&v(!0)},2e3);return()=>clearTimeout(g)},[t,r.length]),!b)return null;const u=t<1e3?{status:"excellent",color:"text-green-600",bg:"bg-green-50"}:t<2e3?{status:"good",color:"text-blue-600",bg:"bg-blue-50"}:t<5e3?{status:"fair",color:"text-yellow-600",bg:"bg-yellow-50"}:{status:"poor",color:"text-red-600",bg:"bg-red-50"};return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 ${u.bg} border rounded-lg shadow-lg p-4 max-w-sm transition-all duration-300`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`font-semibold ${u.color}`,children:"Performance Monitor"}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["Load Time: ",e.jsxs("span",{className:u.color,children:[t,"ms"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bt,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["API Calls: ",l]})]}),m>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(yt,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:["Cache Hits: ",m]})]}),r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{children:["Errors: ",r.length]})]})]}),i&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:u.color,children:u.status})]}),e.jsxs("div",{children:["Performance: ",t<1e3?"🚀":t<2e3?"⚡":t<5e3?"🐌":"🐌🐌"]})]})})]})},ms=()=>{const{user:t,updateUser:l}=Qe(),[m,r]=n.useState("profile"),[i,b]=n.useState(!1),[v,p]=n.useState(!0),[u,g]=n.useState({type:"",text:""}),[N,S]=n.useState({startTime:Date.now(),loadingTime:0,apiCalls:0,cacheHits:0,errors:[]}),[h,w]=n.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:""}),[y,M]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[f,A]=n.useState({}),[U,I]=n.useState(!1),[_,Y]=n.useState(!1),[B,Z]=n.useState(!1),C=n.useMemo(()=>[{id:"profile",label:"Profile",icon:Re},{id:"security",label:"Security",icon:jt}],[]),j=n.useCallback(async()=>{try{p(!0),S(d=>({...d,apiCalls:d.apiCalls+1})),console.log("🔄 Loading admin profile...");const x=await de.getAdminProfile();if(console.log("📊 Admin profile result:",x),x.success){const d=x.data;console.log("👤 Admin data received:",d),w({firstName:d.firstName||d.profile?.firstName||"",lastName:d.lastName||d.profile?.lastName||"",email:d.email||"",phone:d.phone||d.phoneNumber||d.profile?.phoneNumber||"",location:d.location||d.city||d.profile?.city||"",bio:d.bio||d.profile?.bio||""}),x.fromCache&&S(J=>({...J,cacheHits:J.cacheHits+1}))}else console.warn("⚠️ Failed to load admin profile from API, using user context data"),console.warn("❌ API Error:",x.error),t&&(console.log("👤 Falling back to user context data:",t),w({firstName:t.profile?.firstName||t.firstName||"",lastName:t.profile?.lastName||t.lastName||"",email:t.email||"",phone:t.profile?.phoneNumber||t.phoneNumber||"",location:t.profile?.city||t.city||"",bio:t.profile?.bio||t.bio||""})),S(d=>({...d,errors:[...d.errors,x.error||"Failed to load admin profile"]}))}catch(x){console.error("💥 Error loading admin profile:",x),t&&(console.log("👤 Falling back to user context data on error:",t),w({firstName:t.profile?.firstName||t.firstName||"",lastName:t.profile?.lastName||t.lastName||"",email:t.email||"",phone:t.profile?.phoneNumber||t.phoneNumber||"",location:t.profile?.city||t.city||"",bio:t.profile?.bio||t.bio||""})),S(d=>({...d,errors:[...d.errors,"Network error loading admin profile"]}))}finally{p(!1)}},[t]);n.useEffect(()=>{const d=Date.now()-N.startTime;S(J=>({...J,loadingTime:d}))},[v]),n.useEffect(()=>{j()},[j]);const k=n.useCallback(x=>{const{name:d,value:J}=x.target;w(O=>({...O,[d]:J})),f[d]&&A(O=>({...O,[d]:""}))},[f]),L=n.useCallback(x=>{const{name:d,value:J}=x.target;M(O=>({...O,[d]:J})),f[d]&&A(O=>({...O,[d]:""}))},[f]),q=n.useCallback(()=>{const x={};return h.firstName.trim()||(x.firstName="First name is required"),h.lastName.trim()||(x.lastName="Last name is required"),h.email.trim()?/\S+@\S+\.\S+/.test(h.email)||(x.email="Email is invalid"):x.email="Email is required",h.phone&&h.phone.replace(/\D/g,"").length<9&&(x.phone="Phone number must be at least 9 digits"),A(x),Object.keys(x).length===0},[h]),H=n.useCallback(()=>{const x={};return y.currentPassword||(x.currentPassword="Current password is required"),y.newPassword?y.newPassword.length<8&&(x.newPassword="Password must be at least 8 characters"):x.newPassword="New password is required",y.newPassword!==y.confirmPassword&&(x.confirmPassword="Passwords do not match"),A(x),Object.keys(x).length===0},[y]),K=n.useCallback(async()=>{if(q())try{b(!0),S(d=>({...d,apiCalls:d.apiCalls+1}));const x=await de.updateAdminProfile(h);x.success?(g({type:"success",text:"Profile updated successfully!"}),l&&l({...t,...h}),setTimeout(()=>g({type:"",text:""}),3e3)):(g({type:"error",text:x.error||"Failed to update profile"}),S(d=>({...d,errors:[...d.errors,x.error||"Profile update failed"]})))}catch{g({type:"error",text:"Network error. Please try again."}),S(d=>({...d,errors:[...d.errors,"Network error during profile update"]}))}finally{b(!1)}},[h,q,l,t]),c=n.useCallback(async()=>{if(H())try{b(!0),S(d=>({...d,apiCalls:d.apiCalls+1}));const x=await de.changeAdminPassword({currentPassword:y.currentPassword,newPassword:y.newPassword});x.success?(g({type:"success",text:"Password changed successfully!"}),M({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>g({type:"",text:""}),3e3)):(g({type:"error",text:x.error||"Failed to change password"}),S(d=>({...d,errors:[...d.errors,x.error||"Password change failed"]})))}catch{g({type:"error",text:"Network error. Please try again."}),S(d=>({...d,errors:[...d.errors,"Network error during password change"]}))}finally{b(!1)}},[y,H]),$=n.useMemo(()=>u.text?e.jsxs(Ae.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center space-x-2 ${u.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[u.type==="success"?e.jsx(Me,{className:"w-5 h-5"}):e.jsx(ye,{className:"w-5 h-5"}),e.jsx("span",{children:u.text}),e.jsx("button",{onClick:()=>g({type:"",text:""}),className:"ml-auto hover:opacity-70 transition-opacity",children:e.jsx(Ze,{className:"w-4 h-4"})})]}):null,[u]);return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ae,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your profile and system settings"})]})}),$,e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:C.map(x=>{const d=x.icon;return e.jsxs("button",{onClick:()=>r(x.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${m===x.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{children:x.label})]},x.id)})})}),e.jsxs("div",{className:"mt-6",children:[m==="profile"&&e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(te,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:h.firstName,onChange:k,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.firstName?"border-red-300":"border-gray-300"}`}),f.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:h.lastName,onChange:k,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.lastName?"border-red-300":"border-gray-300"}`}),f.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:h.email,onChange:k,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.email?"border-red-300":"border-gray-300"}`}),f.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:h.phone,onChange:k,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.phone?"border-red-300":"border-gray-300"}`}),f.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:h.location,onChange:k,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{name:"bio",value:h.bio,onChange:k,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"Tell us about yourself..."})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(P,{variant:"primary",onClick:K,disabled:i,children:[i?e.jsx(ae,{size:"sm"}):e.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})})}),m==="security"&&e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs(te,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:U?"text":"password",name:"currentPassword",value:y.currentPassword,onChange:L,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.currentPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>I(!U),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:U?e.jsx(Pe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ce,{className:"w-4 h-4 text-gray-400"})})]}),f.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:_?"text":"password",name:"newPassword",value:y.newPassword,onChange:L,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.newPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>Y(!_),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:_?e.jsx(Pe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ce,{className:"w-4 h-4 text-gray-400"})})]}),f.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:B?"text":"password",name:"confirmPassword",value:y.confirmPassword,onChange:L,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${f.confirmPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>Z(!B),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:B?e.jsx(Pe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ce,{className:"w-4 h-4 text-gray-400"})})]}),f.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.confirmPassword})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(P,{variant:"primary",onClick:c,disabled:i,children:[i?e.jsx(ae,{size:"sm"}):e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Change Password"]})})]})]})})]})]}),e.jsx(ds,{loadingTime:N.loadingTime,apiCalls:N.apiCalls,cacheHits:N.cacheHits,errors:N.errors,showDetails:!0})]})},us=()=>{const[t,l]=n.useState([]),[m,r]=n.useState(!0),[i,b]=n.useState(""),[v,p]=n.useState(!1),[u,g]=n.useState(!1),[N,S]=n.useState(!1),[h,w]=n.useState(null),[y,M]=n.useState({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0}),[f,A]=n.useState(!1),[U,I]=n.useState(!1),_=n.useCallback(async()=>{try{r(!0),b("");const c=await fetch(`${se.BASE_URL}/payment-methods/admin/all`,{headers:{Authorization:`Bearer ${localStorage.getItem(se.AUTH_CONFIG.tokenKey)}`}});if(c.ok){const $=await c.json();l($.paymentMethods||[])}else{const $=await c.json();b($.error||"Failed to fetch payment methods")}}catch(c){console.error("Error fetching payment methods:",c),b("Network error. Please try again.")}finally{r(!1)}},[]);n.useEffect(()=>{_()},[_]);const Y=()=>{M({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0})},B=()=>{Y(),p(!0)},Z=c=>{w(c),M({name:c.name,type:c.type,accountName:c.accountName,accountNumber:c.accountNumber,bankName:c.bankName||"",sortOrder:c.sortOrder,isActive:c.isActive}),g(!0)},C=c=>{w(c),S(!0)},j=()=>{p(!1),g(!1),S(!1),w(null),Y()},k=async c=>{if(c.preventDefault(),!y.name||!y.type||!y.accountName||!y.accountNumber){R.error("Please fill in all required fields");return}try{A(!0);const $=u?`${se.BASE_URL}/payment-methods/${h.id}`:`${se.BASE_URL}/payment-methods`,d=await fetch($,{method:u?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(se.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify(y)}),J=await d.json();if(d.ok){const O=u?"updated":"created";R.success(`Payment method ${O} successfully!`),j(),_()}else R.error(J.error||`Failed to ${u?"update":"create"} payment method`)}catch($){console.error("Error submitting payment method:",$),R.error("Network error. Please try again.")}finally{A(!1)}},L=async()=>{if(h)try{A(!0);const c=await fetch(`${se.BASE_URL}/payment-methods/${h.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem(se.AUTH_CONFIG.tokenKey)}`}});if(c.ok)R.success("Payment method deleted successfully!"),j(),_();else{const $=await c.json();R.error($.error||"Failed to delete payment method")}}catch(c){console.error("Error deleting payment method:",c),R.error("Network error. Please try again.")}finally{A(!1)}},q=async c=>{try{const $=await fetch(`${se.BASE_URL}/payment-methods/${c.id}/toggle`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem(se.AUTH_CONFIG.tokenKey)}`}});if($.ok)R.success(`Payment method ${c.isActive?"deactivated":"activated"} successfully!`),_();else{const x=await $.json();R.error(x.error||"Failed to toggle payment method status")}}catch($){console.error("Error toggling payment method status:",$),R.error("Network error. Please try again.")}},H=c=>{switch(c){case"mobile_money":return e.jsx(Pt,{className:"h-4 w-4"});case"bank_transfer":return e.jsx(St,{className:"h-4 w-4"});case"cash":return e.jsx(Te,{className:"h-4 w-4"});default:return e.jsx(Te,{className:"h-4 w-4"})}},K=c=>{switch(c){case"mobile_money":return"Mobile Money";case"bank_transfer":return"Bank Transfer";case"cash":return"Cash";default:return c}};return m?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(ae,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Methods"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage payment methods for employer requests"})]}),e.jsxs(P,{onClick:B,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(wt,{className:"h-5 w-5 mr-2"}),"Add Payment Method"]})]})}),i&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-800",children:i})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Payment Methods (",t.length,")"]})}),t.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Te,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No payment methods found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first payment method to get started"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:t.map((c,$)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 cursor-move",disabled:U,children:e.jsx(Ct,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-gray-500",children:H(c.type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:c.name}),e.jsx(T,{variant:c.isActive?"success":"secondary",className:"ml-2",children:c.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",K(c.type),c.bankName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Bank:"})," ",c.bankName]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Account:"})," ",c.accountName,e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Number:"})," ",c.accountNumber]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>q(c),className:c.isActive?"text-orange-600 hover:text-orange-700":"text-green-600 hover:text-green-700",children:c.isActive?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"Activate"]})}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>Z(c),children:[e.jsx(kt,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>C(c),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})},c.id))})]})]}),(v||u)&&e.jsx(fe,{isOpen:v||u,onClose:j,title:u?"Edit Payment Method":"Add Payment Method",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Method Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.name,onChange:c=>M({...y,name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., MTN MOMO, Airtel Money, Bank of Rwanda",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y.type,onChange:c=>M({...y,type:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Holder Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.accountName,onChange:c=>M({...y,accountName:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Job Portal, Company Name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Number/Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.accountNumber,onChange:c=>M({...y,accountNumber:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 0788123456, 1234567890",required:!0})]}),y.type==="bank_transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:y.bankName,onChange:c=>M({...y,bankName:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Bank of Rwanda, Equity Bank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",value:y.sortOrder,onChange:c=>M({...y,sortOrder:parseInt(c.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lower numbers appear first in the list"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:y.isActive,onChange:c=>M({...y,isActive:c.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active (available for payments)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(P,{type:"button",variant:"outline",onClick:j,disabled:f,children:"Cancel"}),e.jsx(P,{type:"submit",variant:"primary",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),u?"Updating...":"Creating..."]}):u?"Update Method":"Create Method"})]})]})}),N&&h&&e.jsx(fe,{isOpen:N,onClose:j,title:"Delete Payment Method",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-700",children:["Are you sure you want to delete the payment method ",e.jsxs("strong",{children:['"',h.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone. If this method is being used by existing payments, it cannot be deleted."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(P,{variant:"outline",onClick:j,disabled:f,children:"Cancel"}),e.jsx(P,{variant:"danger",onClick:L,disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):"Delete Method"})]})]})}),e.jsx(ze,{})]})},$s=()=>{const{t}=Ie(),{user:l,logout:m}=Qe(),r=At(),{liveData:i,lastUpdate:b,isConnected:v,manualRefresh:p,addNotification:u}=Et(),[g,N]=n.useState("dashboard"),[S,h]=n.useState(!0),[w,y]=n.useState(null),[M,f]=n.useState(!1),[A,U]=n.useState(""),[I,_]=n.useState(""),[Y,B]=n.useState(null),[Z,C]=n.useState(!0),[j,k]=n.useState(null),[L,q]=n.useState("all"),{jobSeekers:H,loading:K,fetchJobSeekers:c}=Ke({autoFetch:!1,itemsPerPage:5}),{requests:$,loading:x,fetchRequests:d}=et({autoFetch:!1}),{fetchCategories:J}=Ut({autoFetch:!1}),O=async()=>{try{C(!0),k(null);const s=await de.getDashboardStats();s.success?B(s.data):k("Failed to load dashboard statistics"),await Promise.all([c(),d(),J()])}catch(s){k("Failed to load dashboard data"),console.error("Dashboard load error:",s)}finally{C(!1)}},me=async()=>{try{C(!0),await O(),u({message:"Dashboard refreshed successfully",type:"success",duration:3e3})}catch{k("Failed to refresh dashboard data"),u({message:"Failed to refresh dashboard",type:"error",duration:5e3})}finally{C(!1)}};n.useEffect(()=>{i.dashboard&&B(i.dashboard),i.requests,i.jobSeekers},[i]);const ue=()=>{m(),r("/")},xe=s=>{y(s),U(s.adminNotes||""),f(!0)},be=async(s,a,z)=>{try{const E=await de.updateRequestStatus(s,{status:a,adminNotes:z});E.success?(await d(),f(!1),y(null),U(""),u({message:`Request ${a==="completed"?"marked as completed":"status updated"} successfully!`,type:"success",duration:5e3})):u({message:`Error: ${E.error}`,type:"error",duration:5e3})}catch(E){u({message:"Failed to update request status",type:"error",duration:5e3}),console.error("Request update error:",E)}},le=s=>{_(s)},ge=()=>{};if(n.useEffect(()=>{O()},[]),Z)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(ae,{size:"lg",text:"Loading Dashboard..."})});if(j)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Dashboard Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:j}),e.jsx(P,{onClick:O,className:"w-full",children:"Retry"})]})});const Q=()=>{const s=Y||{},a=s.data||s,z=F=>{if(!Array.isArray(F))return[];const G={};return F.forEach(D=>{D.profile?.skills&&D.profile.skills.split(",").map(ee=>ee.trim()).forEach(ee=>{G[ee]=(G[ee]||0)+1})}),Object.entries(G).map(([D,V])=>({name:D,count:V})).sort((D,V)=>V.count-D.count).slice(0,5)},E=(F,G=0)=>{if(G===0)return F>0?{change:"+100%",changeType:"increase"}:{change:"0%",changeType:"neutral"};const D=(F-G)/G*100,V=D>=0?`+${Math.round(D)}%`:`${Math.round(D)}%`,ee=D>0?"increase":D<0?"decrease":"neutral";return{change:V,changeType:ee}},X=(F,G=7)=>{const D=new Date,V=new Date(D.getTime()-G*24*60*60*1e3),ee=new Date(D.getTime()-G*2*24*60*60*1e3),Le=F.filter($e=>new Date($e.createdAt)>=V).length,re=F.filter($e=>{const _e=new Date($e.createdAt);return _e>=ee&&_e<V}).length;return E(Le,re)},ve=X(H||[]),we=X($||[]),Ce=E(($||[]).filter(F=>F.status==="pending").length,Math.max(1,Math.floor(($||[]).filter(F=>F.status==="pending").length*.8))),ne=E(a.overview?.totalCategories||a.totalCategories||0,Math.max(1,Math.floor((a.overview?.totalCategories||a.totalCategories||0)*.9)));return z(H||[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx(_t,{isConnected:v,lastUpdate:b,onRefresh:p,className:"text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 ",children:[e.jsx(ke,{title:"Total Job Seekers",value:a.overview?.totalJobSeekers||a.totalJobSeekers||0,icon:De,change:ve.change,changeType:ve.changeType,color:"text-blue-600",bgColor:"bg-blue-100",description:"Active job seekers",index:0,trendPeriod:"7 days"}),e.jsx(ke,{title:"Employer Requests",value:a.overview?.totalEmployerRequests||a.totalEmployerRequests||0,icon:pe,change:we.change,changeType:we.changeType,color:"text-green-600",bgColor:"bg-green-100",description:"Total requests",index:1,trendPeriod:"7 days"}),e.jsx(ke,{title:"Pending Requests",value:a.overview?.pendingEmployerRequests||a.pendingEmployerRequests||0,icon:je,change:Ce.change,changeType:Ce.changeType,color:"text-orange-600",bgColor:"bg-orange-100",description:"Awaiting review",index:2,trendPeriod:"7 days"}),e.jsx(ke,{title:"Categories",value:a.overview?.totalCategories||a.totalCategories||0,icon:Ue,change:ne.change,changeType:ne.changeType,color:"text-purple-600",bgColor:"bg-purple-100",description:"Job categories",index:3,showTrend:!1})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(te,{title:"Latest Job Seekers",subtitle:"Most recently registered candidates (showing latest 5)",children:K?e.jsx(ae,{size:"md",text:"Loading job seekers..."}):(a.recentActivity?.recentJobSeekers||H||[]).length>0?e.jsx("div",{className:"space-y-3",children:(a.recentActivity?.recentJobSeekers||H||[]).slice(0,5).map((F,G)=>{const D=(H||[]).find(re=>re.id===F.id)||F,V=D?.profile?.photo||D?.avatar||D?.photo||null,Le=(re=>re?/^https?:\/\//i.test(re)?re:`${se.BASE_URL}/${re.replace(/^\//,"")}`:null)(V);return e.jsx(qt,{jobSeeker:{id:F.id,name:F.name||`${F?.profile?.firstName||""} ${F?.profile?.lastName||""}`.trim()||"Unknown",title:"Job Seeker",category:F.skills?.split(",")[0]||"General",avatar:Le,location:F.location||F?.profile?.location||"Unknown",dailyRate:F.dailyRate,monthlyRate:F.monthlyRate},onViewDetails:xe,getCategoryColor:Rt,compact:!0},F.id||G)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(De,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent job seekers"})]})}),e.jsxs(te,{title:"Latest Employer Requests",subtitle:"Most recent job requests with candidate details (showing latest 5)",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx("button",{onClick:()=>q("all"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${L==="all"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>q("pending"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${L==="pending"?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Pending"}),e.jsx("button",{onClick:()=>q("in_progress"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${L==="in_progress"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"In Progress"}),e.jsx("button",{onClick:()=>q("approved"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${L==="approved"?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Approved"}),e.jsx("button",{onClick:()=>q("completed"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${L==="completed"?"bg-purple-100 text-purple-800 border-purple-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Completed"})]})}),x?e.jsx(ae,{size:"md",text:"Loading requests..."}):($||[]).length>0?e.jsx("div",{className:"space-y-3",children:(()=>{const G=($||[]).filter(D=>{if(L==="all")return!0;const V=D.status?.toLowerCase()||"pending",ee=L.toLowerCase();return V===ee}).slice(0,5);return G.length===0&&L!=="all"?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(pe,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),e.jsxs("p",{className:"text-sm",children:["No ",L," requests found"]})]}):G.map((D,V)=>e.jsx(Bt,{request:{...D,companyName:D.companyName||"Individual Employer",status:D.status||"pending",priority:D.priority||"normal",selectedUser:D.selectedUser||null,requestedCandidate:D.requestedCandidate||null},onContactEmployer:Ft,onViewDetails:xe,getStatusColor:$t,getPriorityColor:Lt,compact:!0},D.id||V))})()}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent requests"})]})]})]})]})},o=()=>{switch(g){case"dashboard":return Q();case"job-seekers":return e.jsx(It,{});case"requests":return e.jsx(Dt,{});case"contact-messages":return e.jsx(cs,{});case"categories":return e.jsx(zt,{});case"reports-statistics":return e.jsx(Mt,{});case"reports-tables":return e.jsx(os,{});case"settings":return e.jsx(ms,{});case"payment-methods":return e.jsx(us,{});default:return Q()}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Vt,{user:l,onLogout:ue,onSearch:le,onFilter:ge,searchTerm:I,onRefresh:me}),e.jsxs("div",{className:"flex",children:[e.jsx(Gt,{sidebarOpen:S,setSidebarOpen:h,navigationItems:[{id:"dashboard",label:"Dashboard",icon:"Home"},{id:"job-seekers",label:"Job Seekers",icon:"Users"},{id:"requests",label:"Employer Requests",icon:"MessageSquare"},{id:"contact-messages",label:"Contact Messages",icon:"Mail"},{id:"categories",label:"Categories",icon:"Briefcase"},{id:"reports",label:"Reports",icon:"BarChart3",subItems:[{id:"reports-statistics",label:"Statistics Reports"},{id:"reports-tables",label:"Table Reports"}]},{id:"settings",label:"Settings",icon:"Settings"},{id:"payment-methods",label:"Payment Methods",icon:"CreditCard"}],activeTab:g,setActiveTab:N,user:l,onLogout:ue}),e.jsx("div",{className:"flex-1 transition-all duration-300 ml-0",children:e.jsx("div",{className:"p-4 lg:p-6",children:o()})})]}),M&&w&&e.jsx(fe,{isOpen:M,onClose:()=>f(!1),title:"Update Request Status",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:w.status,onChange:s=>y({...w,status:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes"}),e.jsx("textarea",{value:A,onChange:s=>U(s.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Add notes about this request..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(P,{onClick:()=>f(!1),variant:"outline",children:"Cancel"}),e.jsx(P,{onClick:()=>be(w.id,w.status,A),className:"bg-red-600 hover:bg-red-700",children:"Update Status"})]})]})})]})};export{$s as default};
