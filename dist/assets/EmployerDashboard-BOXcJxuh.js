import{j as e,r as i}from"./vendor-react-P9HPe7xp.js";import{aW as z,aN as ae,bV as be,b0 as A,bs as fe,aY as k,aZ as le,ac as je,bq as Y,ad as Ne,aG as ve,aH as we,bj as Pe,bW as w}from"./vendor-common-QxmXWwBZ.js";import{A as S,b as T,u as Se}from"./index-DLQthGki.js";import{M as Ae}from"./Modal-Bn_LXPBB.js";import{E as P}from"./endpoints-CXiMw_A_.js";import{m as re}from"./messagingService-9e3db8N5.js";import{m as ne}from"./vendor-motion-Dcrv-VGC.js";import"./vendor-router-DtDQR2uf.js";import"./vendor-gsap-lnFyu4_T.js";const ke=({isOpen:_,onClose:n,selectedRequest:t,messages:m,newMessage:f,setNewMessage:a,sendMessage:x,messagingLoading:D,paymentHistory:d,loadingPaymentHistory:I,getStatusColor:C,getPriorityColor:u,getProgressColor:U,getProgressPercentage:h})=>t?e.jsx(Ae,{isOpen:_,onClose:n,title:`Request Details - #${t.id}`,maxWidth:"max-w-6xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(z,{className:"h-5 w-5 mr-2 text-blue-600"}),"Request Information"]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${C(t.status)}`,children:t.status?t.status.replace("_"," ").replace(/\b\w/g,r=>r.toUpperCase()):"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Priority"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${u(t.priority)}`,children:t.priority?t.priority.charAt(0).toUpperCase()+t.priority.slice(1):"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Progress"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${U(h(t))}`,style:{width:`${h(t)}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[h(t),"%"]})]})]})]})})]}),t.candidate&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 mr-2 text-blue-600"}),"Candidate Information"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4 pb-4 border-b border-gray-200",children:[t.candidate.photo?e.jsx("img",{src:t.candidate.photo.startsWith("http")?t.candidate.photo:`${S.BASE_URL}/${t.candidate.photo.replace(/^\//,"")}`,alt:t.candidate.name,className:"w-16 h-16 rounded-full object-cover border-2 border-gray-200",onError:r=>{r.target.src="/api/placeholder/64/64"}}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx(ae,{className:"h-8 w-8 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-gray-900",children:t.candidate.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.candidate.skills}),e.jsx("p",{className:"text-sm font-medium text-green-600",children:t.candidate.monthlyRate})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Experience"}),e.jsx("p",{className:"text-gray-900",children:t.candidate.experience})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Location"}),e.jsx("p",{className:"text-gray-900",children:typeof t.candidate.location=="object"?`${t.candidate.location.city||""}, ${t.candidate.location.country||""}`.replace(/^,\s*|,\s*$/g,""):t.candidate.location||"Not specified"})]}),t.candidate.contactNumber&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Contact"}),e.jsx("p",{className:"text-gray-900",children:t.candidate.contactNumber})]}),t.candidate.email&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:t.candidate.email})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Access Control"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Image Access"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.imageAccessGranted?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.imageAccessGranted?"Granted":"Not Granted"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Contact Access"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.contactAccessGranted?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.contactAccessGranted?"Granted":"Not Granted"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Access Level"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.candidate?.accessLevel==="full"?"bg-green-100 text-green-800":t.candidate?.accessLevel==="photo"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.candidate?.accessLevel==="full"?"Full Access":t.candidate?.accessLevel==="photo"?"Photo Access":"No Access"})]})]})]})]})]}),t.paymentRequired&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(be,{className:"h-5 w-5 mr-2 text-blue-600"}),"Payment History"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Amount Required"}),e.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[t.paymentAmount," ",t.paymentCurrency]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Due Date"}),e.jsx("p",{className:"text-gray-900",children:t.paymentDueDate?new Date(t.paymentDueDate).toLocaleDateString():"Not specified"})]}),t.paymentDescription&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"text-gray-900",children:t.paymentDescription})]})]}),I?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(A,{className:"animate-spin h-6 w-6 text-blue-500 mx-auto"}),e.jsx("p",{className:"text-gray-600",children:"Loading payment history..."})]}):d.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(fe,{className:"h-10 w-10 text-gray-400 mx-auto"}),e.jsx("p",{className:"text-gray-600",children:"No payments made yet for this request."})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-700",children:"All Payments"}),d.map((r,j)=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Amount"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:r.payment?.amount&&r.payment?.currency?`${r.payment.amount} ${r.payment.currency}`:"Not specified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r.payment?.status==="completed"?"bg-green-100 text-green-800":r.payment?.status==="pending"?"bg-yellow-100 text-yellow-800":r.payment?.status==="approved"?"bg-blue-100 text-blue-800":r.payment?.status==="confirmed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.payment?.status?r.payment.status.charAt(0).toUpperCase()+r.payment.status.slice(1):"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.payment?.createdAt?new Date(r.payment.createdAt).toLocaleDateString():"Not specified"})]})]}),r.payment?.confirmationName&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Confirmed by:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:r.payment.confirmationName})]}),r.payment?.confirmationPhone&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Phone:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:r.payment.confirmationPhone})]})]})}),r.payment?.status==="confirmed"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Waiting for Admin Approval"}),e.jsx("p",{className:"mt-1 text-sm text-blue-700",children:"Your payment has been confirmed and is now waiting for admin approval. If this takes longer than expected, please message the admin or call for assistance."})]})]})})})]},r.id||j))]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(k,{className:"h-5 w-5 mr-2 text-blue-600"}),"Messages"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[D?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(A,{className:"animate-spin h-6 w-6 text-blue-500 mx-auto"}),e.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]}):m.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(k,{className:"h-10 w-10 text-gray-400 mx-auto"}),e.jsx("p",{className:"text-gray-600",children:"No messages yet for this request."})]}):e.jsx("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:m.map(r=>e.jsx("div",{className:`flex ${r.fromAdmin?"justify-start":"justify-end"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${r.fromAdmin?"bg-white text-gray-900 border border-gray-200":"bg-blue-600 text-white"}`,children:[e.jsx("div",{className:"text-sm",children:r.content}),e.jsx("div",{className:`text-xs mt-1 ${r.fromAdmin?"text-gray-500":"text-blue-100"}`,children:new Date(r.createdAt).toLocaleString()})]})},r.id))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:f,onChange:r=>a(r.target.value),placeholder:"Type your message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyPress:r=>r.key==="Enter"&&x()}),e.jsxs("button",{onClick:x,disabled:!f.trim()||D,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:"Send"})]})]})})]})]})]})}):null;class De{async getDashboardData(){try{console.log("🔍 employerDashboardService.getDashboardData called"),console.log("🔍 API endpoint:",P.EMPLOYER.DASHBOARD),console.log("🔍 Auth token:",localStorage.getItem("job_portal_token"));const n=await T.get(P.EMPLOYER.DASHBOARD);return console.log("✅ API response:",n),n}catch(n){throw console.error("❌ employerDashboardService.getDashboardData error:",n),console.error("❌ Error response:",n.response),n}}async getRequestDetails(n){try{return(await T.get(P.EMPLOYER.GET_REQUEST_BY_ID(n))).data}catch(t){throw console.error("Error getting request details:",t),t}}async updateRequestStatus(n,t){try{return(await T.put(P.EMPLOYER.GET_REQUEST_BY_ID(n),{status:t})).data}catch(m){throw console.error("Error updating request status:",m),m}}async getRequestStats(){try{return(await T.get(P.EMPLOYER.GET_REQUESTS+"/stats")).data}catch(n){throw console.error("Error getting request stats:",n),n}}}const Ce=new De,Fe=()=>{const{user:_}=Se(),[n,t]=i.useState(null),[m,f]=i.useState(!0),[a,x]=i.useState(null),[D,d]=i.useState([]),[I,C]=i.useState(!1),[u,U]=i.useState("all"),[h,r]=i.useState(""),[j,W]=i.useState(!1),[ie,K]=i.useState(!1),[B,y]=i.useState([]),[N,v]=i.useState(""),[F,E]=i.useState(!1),[oe,Q]=i.useState(!1),[o,g]=i.useState({confirmationName:"",confirmationPhone:"",paymentReference:"",transferAmount:"",transferDate:"",notes:""}),[G,V]=i.useState(!1),[J,b]=i.useState(""),[Z,O]=i.useState(""),M=async()=>{try{f(!0);const s=await Ce.getDashboardData();t(s)}catch(s){console.error("❌ Error fetching dashboard data:",s),console.error("❌ Error details:",{message:s.message,status:s.response?.status,statusText:s.response?.statusText,data:s.response?.data}),w.error("Failed to load dashboard data")}finally{f(!1)}},L=async s=>{E(!0);try{const l=localStorage.getItem("job_portal_token");if(console.log("Token found:",!!l,l?"exists":"missing"),!l){console.error("No authentication token found"),y([]);return}const c=await fetch(`${S.BASE_URL}/messaging/request/${s}`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(console.log("Response status:",c.status),c.ok){const p=await c.json();y(p.messages||[])}else console.error("Failed to fetch messages, status:",c.status),y([])}catch(l){console.error("Error fetching messages:",l),y([])}finally{E(!1)}},ce=async s=>{C(!0);try{const l=localStorage.getItem("job_portal_token"),c=await fetch(`${S.BASE_URL}/payments/details/${s}`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(c.ok){const p=await c.json();d(p?[p]:[])}else console.error("Failed to fetch payment history, using latestPayment if available"),console.log("selectedRequest:",a),console.log("latestPayment:",a?.latestPayment),a?.latestPayment?(console.log("Setting paymentHistory with latestPayment:",a.latestPayment),d([a.latestPayment])):(console.log("No latestPayment found, setting empty array"),d([]))}catch(l){console.error("Error fetching payment history:",l),console.log("selectedRequest in catch:",a),console.log("latestPayment in catch:",a?.latestPayment),a?.latestPayment?(console.log("Setting paymentHistory with latestPayment in catch:",a.latestPayment),d([a.latestPayment])):(console.log("No latestPayment found in catch, setting empty array"),d([]))}finally{C(!1)}},R=async()=>{if(!(!N.trim()||!a))try{E(!0),await re.sendMessage(a.id,{content:N.trim(),messageType:"text"}),v(""),await L(a.id),w.success("Message sent successfully")}catch(s){console.error("Error sending message:",s),w.error("Failed to send message")}finally{E(!1)}},de=async s=>{x(s),W(!0),await L(s.id)},X=()=>{W(!1),x(null),y([]),v("")},me=()=>{K(!1),x(null),y([]),v(""),d([])},xe=(s,l)=>{s.target===s.currentTarget&&X()},he=async()=>{if(a)try{await re.markMessagesAsRead(a.id),await L(a.id)}catch(s){console.error("Error marking messages as read:",s)}},ge=s=>{x(s),K(!0),L(s.id),ce(s.id)};i.useEffect(()=>{M()},[]),i.useEffect(()=>{j&&a&&he()},[j,a]);const pe=s=>{x(s),Q(!0),g({confirmationName:"",confirmationPhone:"",paymentReference:"",transferAmount:"",transferDate:"",notes:""}),b(""),O("")},$=()=>{Q(!1),g({confirmationName:"",confirmationPhone:"",paymentReference:"",transferAmount:"",transferDate:"",notes:""}),b(""),O("")},ue=async s=>{if(s.preventDefault(),!o.confirmationName||!o.confirmationPhone){b("Please provide your name and phone number");return}try{V(!0),b("");const l=await fetch(`${S.BASE_URL}/payment-confirmations/confirm`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(S.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({paymentId:a.latestPayment?.id,confirmationName:o.confirmationName,confirmationPhone:o.confirmationPhone,paymentReference:o.paymentReference,transferAmount:a.paymentAmount,transferDate:o.transferDate,notes:o.notes})}),c=await l.json();if(l.ok)w.success("Payment confirmation submitted successfully!"),$(),M(),g({confirmationName:"",confirmationPhone:"",paymentReference:"",transferAmount:"",transferDate:"",notes:""}),O("Payment confirmation submitted successfully!");else{const p=c.error||"Failed to submit payment confirmation";b(p),w.error(p)}}catch(l){console.error("Error submitting payment confirmation:",l),b("Network error. Please try again.")}finally{V(!1)}},H=n?.requests?.filter(s=>{const l=u==="all"||s.status===u,c=s.candidate?.name?.toLowerCase().includes(h.toLowerCase())||s.candidate?.skills?.toLowerCase().includes(h.toLowerCase());return l&&c})||[],q=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"reviewing":return"bg-blue-100 text-blue-800 border-blue-200";case"payment_required":return"bg-orange-100 text-orange-800 border-orange-200";case"payment_confirmed":return"bg-purple-100 text-purple-800 border-purple-200";case"approved":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ee=s=>{switch(s){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"normal":return"bg-blue-100 text-blue-800 border-blue-200";case"low":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},se=s=>{switch(s.status){case"pending":return 20;case"reviewing":return 40;case"payment_required":return 60;case"payment_confirmed":return 80;case"approved":return 90;case"completed":return 100;default:return 0}},te=s=>s>=80?"bg-green-500":s>=60?"bg-blue-500":s>=40?"bg-yellow-500":"bg-red-500";if(m)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(A,{className:"animate-spin h-12 w-12 text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})});if(!n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(je,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"}),e.jsx("button",{onClick:M,className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Try Again"})]})});const ye=[{title:"Total Requests",value:n.stats.totalRequests,icon:z,color:"bg-blue-500"},{title:"Pending Payments",value:n.stats.paymentRequired,icon:Y,color:"bg-yellow-500"},{title:"Approved Requests",value:n.stats.approvedRequests,icon:Ne,color:"bg-green-500"},{title:"Unread Messages",value:n.stats.unreadMessages,icon:k,color:"bg-purple-500"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Employer Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Welcome back, ",n.employer?.name||"Employer","! Manage your job seeker requests and payments"]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:M,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Refresh"})]})})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:ye.map((s,l)=>e.jsx(ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},className:"bg-white rounded-xl shadow-sm border p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:s.value})]}),e.jsx("div",{className:`${s.color} p-3 rounded-lg`,children:e.jsx(s.icon,{className:"h-6 w-6 text-white"})})]})},s.title))}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search candidates or skills...",value:h,onChange:s=>r(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:u,onChange:s=>U(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"reviewing",children:"Reviewing"}),e.jsx("option",{value:"payment_required",children:"Payment Required"}),e.jsx("option",{value:"payment_confirmed",children:"Payment Confirmed"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsxs("span",{children:[H.length," of ",n.stats.totalRequests," requests"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Your Requests"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Candidate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Skills & Experience"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(s=>{const l=se(s);return e.jsxs(ne.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.candidate?.name||"N/A"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Requested ",new Date(s.createdAt).toLocaleDateString()]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.candidate?.skills||"Not specified"}),e.jsx("div",{className:"text-sm text-gray-500",children:s.candidate?.experienceLevel||"Not specified"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${q(s.status)}`,children:s.status.replace("_"," ").replace(/\b\w/g,c=>c.toUpperCase())})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${ee(s.priority)}`,children:s.priority.charAt(0).toUpperCase()+s.priority.slice(1)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:`h-2 rounded-full ${te(l)}`,style:{width:`${l}%`}})}),e.jsxs("span",{className:"text-sm text-gray-500",children:[l,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>de(s),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-md text-xs transition-colors flex items-center space-x-1",children:[e.jsx(k,{className:"h-3 w-3"}),e.jsx("span",{children:"Message"})]}),e.jsx("button",{onClick:()=>ge(s),className:"text-blue-600 hover:text-blue-900 text-xs",children:"View Details"}),s.status==="payment_required"&&s.paymentRequired&&e.jsxs("button",{onClick:()=>pe(s),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-md text-xs transition-colors flex items-center space-x-1",children:[e.jsx(Y,{className:"h-3 w-3"}),e.jsx("span",{children:"Confirm Payment"})]})]})})]},s.id)})})]})})]}),H.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No requests found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:h||u!=="all"?"Try adjusting your search or filters.":"Get started by submitting your first job seeker request."})]})]}),j&&a&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center z-40 p-4",onClick:s=>xe(s),children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"}),e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50 rounded-t-xl",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Messages - Request #",a.id]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.candidate?.name||"N/A"," • ",a.status]})]}),e.jsxs("button",{onClick:X,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-gray-50",children:F?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"animate-spin h-8 w-8 text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]}):B.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Start the conversation!"})]}):B.map(s=>e.jsx("div",{className:`flex ${s.fromAdmin?"justify-start":"justify-end"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg shadow-sm ${s.fromAdmin?"bg-white text-gray-900 border border-gray-200":"bg-blue-600 text-white"}`,children:[e.jsx("div",{className:"text-sm",children:s.content}),e.jsx("div",{className:`text-xs mt-1 ${s.fromAdmin?"text-gray-500":"text-blue-100"}`,children:new Date(s.createdAt).toLocaleString()})]})},s.id))}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-white rounded-b-xl",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:N,onChange:s=>v(s.target.value),placeholder:"Type your message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyPress:s=>s.key==="Enter"&&R()}),e.jsxs("button",{onClick:R,disabled:!N.trim()||F,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:"Send"})]})]})})]})]}),e.jsx(ke,{isOpen:ie&&a,onClose:me,selectedRequest:a,messages:B,newMessage:N,setNewMessage:v,sendMessage:R,messagingLoading:F,paymentHistory:D,loadingPaymentHistory:I,getStatusColor:q,getPriorityColor:ee,getProgressColor:te,getProgressPercentage:se}),oe&&a&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center z-40 p-4",onClick:s=>s.target===s.currentTarget&&$(),children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"}),e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-2xl flex flex-col border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50 rounded-t-xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Confirm Payment - Request #",a.id]}),e.jsxs("button",{onClick:$,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsx("div",{className:"flex-1 p-6 bg-gray-50",children:e.jsxs("form",{onSubmit:ue,className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:"Payment Details:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Amount:"}),e.jsxs("span",{className:"text-blue-900 font-semibold",children:[a.paymentAmount," ",a.paymentCurrency]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Description:"}),e.jsx("span",{className:"text-blue-900",children:a.paymentDescription||"Payment for candidate access"})]}),a.latestPayment?.paymentMethod&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Payment Method:"}),e.jsx("span",{className:"text-blue-900",children:a.latestPayment.paymentMethod.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Account Name:"}),e.jsx("span",{className:"text-blue-900",children:a.latestPayment.paymentMethod.accountName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Account Number:"}),e.jsx("span",{className:"text-blue-900 font-mono",children:a.latestPayment.paymentMethod.accountNumber})]}),a.latestPayment.paymentMethod.bankName&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Bank:"}),e.jsx("span",{className:"text-blue-900",children:a.latestPayment.paymentMethod.bankName})]})]}),!a.latestPayment?.paymentMethod&&e.jsx("div",{className:"text-amber-700 text-xs bg-amber-50 p-2 rounded border border-amber-200",children:"⚠️ Payment method details not available. Please contact admin for payment instructions."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Your Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.confirmationName,onChange:s=>g({...o,confirmationName:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"As shown on transfer",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:o.confirmationPhone,onChange:s=>g({...o,confirmationPhone:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+250123456789",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Reference"}),e.jsx("input",{type:"text",value:o.paymentReference,onChange:s=>g({...o,paymentReference:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"MTN123456 or transfer ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transfer Amount (Admin Requested)"}),e.jsx("input",{type:"number",value:a.paymentAmount||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 cursor-not-allowed",placeholder:"5000",min:"0",step:"100",readOnly:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This amount cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transfer Date"}),e.jsx("input",{type:"date",value:o.transferDate,onChange:s=>g({...o,transferDate:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",max:new Date().toISOString().split("T")[0]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:o.notes,onChange:s=>g({...o,notes:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:"Any additional information about your payment..."})]}),J&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:J}),Z&&e.jsx("div",{className:"text-sm text-green-600 bg-green-50 p-3 rounded-lg border border-green-200",children:Z}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:$,disabled:G,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:G,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg disabled:opacity-50 flex items-center space-x-2",children:G?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:"Confirm Payment"})]})})]})]})})]})]}),e.jsx(Pe,{position:"top-right"})]})};export{Fe as default};
