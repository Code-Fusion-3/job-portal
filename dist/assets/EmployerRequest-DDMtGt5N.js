import{ag as L,r as u,j as e,aV as C,aQ as F,ay as U,aW as $,aX as D,af as E,ax as W,aK as T,aY as A,aZ as M,a_ as z}from"./vendor-react-CtYtWwv0.js";import{c as Y,L as H}from"./vendor-router-sNuBhaUK.js";import{B as O,u as V,H as w,L as _,F as S,C as G,j as J}from"./index-n9net970.js";import{B as P}from"./BackButton-Wt-YD-lN.js";import{F as k}from"./FormInput-DBl6HTCk.js";import{m as f}from"./vendor-motion-B1EvosFv.js";import{B}from"./Badge-__rCq1df.js";import{A as K}from"./Avatar-DTmCuHhk.js";import{j as I}from"./jobseekerBackground-BLVGbC9a.js";import"./vendor-gsap-B4nt0ofr.js";const Q=({jobSeekerId:o=null,jobSeekerName:l=null,onSuccess:b=()=>{},onError:q=()=>{},className:R="",...s})=>{const{t}=L(),[a,x]=u.useState({employerName:"",companyName:"",email:"",phone:"",message:"",jobSeekerId:o||"",priority:"normal"}),[y,j]=u.useState(!1),[c,N]=u.useState({});u.useEffect(()=>{if(o&&o!==a.jobSeekerId&&x(i=>({...i,jobSeekerId:o})),!o&&!a.jobSeekerId){const d=new URLSearchParams(window.location.search).get("id")||window.location.pathname.split("/").pop();if(d&&d!=="undefined"&&d!=="null"){let h=d;typeof d=="string"&&d.startsWith("JS")&&(h=parseInt(d.replace(/^JS/,""),10)),x(m=>({...m,jobSeekerId:h}))}}if(o&&typeof o=="string"&&o.startsWith("JS")){const i=parseInt(o.replace(/^JS/,""),10);!isNaN(i)&&i!==a.jobSeekerId&&x(d=>({...d,jobSeekerId:i}))}},[o,a.jobSeekerId]);const r=i=>{const{name:d,value:h}=i.target;x(m=>({...m,[d]:h})),c[d]&&N(m=>({...m,[d]:""}))},n=()=>{const i={};return a.employerName.trim()||(i.employerName="Name is required"),a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)||(i.email="Please enter a valid email address"):i.email="Email is required",a.phone.trim()?/^\+?[1-9]\d{1,14}$/.test(a.phone.replace(/\s/g,""))||(i.phone="Please enter a valid phone number"):i.phone="Phone number is required",a.message.trim()?a.message.trim().length<10&&(i.message="Message must be at least 10 characters long"):i.message="Message is required",(!a.jobSeekerId||a.jobSeekerId==="")&&(i.general="Candidate ID is missing. This is required to submit the request. Please refresh the page and try again."),N(i),Object.keys(i).length===0},v=async i=>{if(i.preventDefault(),!!n()){j(!0);try{const h="https://job-portal-backend-cfk4.onrender.com/employer/request",m={name:a.employerName,companyName:a.companyName,email:a.email,phoneNumber:a.phone,message:a.message,requestedCandidateId:(()=>{let p=a.jobSeekerId;return typeof p=="string"&&p.startsWith("JS")?parseInt(p.replace(/^JS/,""),10):typeof p=="number"?p:parseInt(p,10)})(),priority:a.priority};if(isNaN(m.requestedCandidateId)||!m.requestedCandidateId)throw new Error("Invalid candidate ID. Please refresh the page and try again.");const g=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!g.ok){const p=await g.text();throw new Error(`Request failed: ${g.status} ${g.statusText}`)}const X=await g.json();b(),x({employerName:"",companyName:"",email:"",phone:"",message:"",jobSeekerId:o||"",priority:"normal"})}catch(d){q(d)}finally{j(!1)}}};return e.jsxs("div",{className:`bg-white rounded-xl shadow-sm border p-6 ${R}`,...s,children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(C,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:t("employerRequest.title","Request Candidate")}),e.jsx("p",{className:"text-gray-600",children:l?t("employerRequest.subtitleWithName","Request to connect with {{name}}",{name:l}):t("employerRequest.subtitle","Send a request to connect with this candidate")})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:t("employerRequest.priority","Priority")}),e.jsxs("select",{id:"priority",name:"priority",className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200",value:a.priority,onChange:r,required:!0,children:[e.jsx("option",{value:"low",children:t("employerRequest.priorityLow","Low")}),e.jsx("option",{value:"normal",children:t("employerRequest.priorityNormal","Normal")}),e.jsx("option",{value:"high",children:t("employerRequest.priorityHigh","High")})]})]}),c.general&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-red-600 text-sm font-medium",children:c.general}),e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"This form requires a valid candidate ID to submit. Please contact support if this issue persists."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{id:"employerName",name:"employerName",label:t("employerRequest.employerName","Your Name"),placeholder:t("employerRequest.employerNamePlaceholder","Enter your full name"),value:a.employerName,onChange:r,error:c.employerName,icon:F,required:!0}),e.jsx(k,{id:"companyName",name:"companyName",label:t("employerRequest.companyName","Company Name"),placeholder:t("employerRequest.companyNamePlaceholder","Enter company name (optional)"),value:a.companyName,onChange:r,error:c.companyName,icon:C})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{id:"email",name:"email",type:"email",label:t("employerRequest.email","Email Address"),placeholder:t("employerRequest.emailPlaceholder","Enter your email"),value:a.email,onChange:r,error:c.email,icon:U,required:!0}),e.jsx(k,{id:"phone",name:"phone",type:"tel",label:t("employerRequest.phone","Phone Number"),placeholder:t("employerRequest.phonePlaceholder","Enter your phone number"),value:a.phone,onChange:r,error:c.phone,icon:$,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:[t("employerRequest.message","Message"),e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("textarea",{id:"message",name:"message",rows:4,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 ${c.message?"border-red-300":"border-gray-300"}`,placeholder:t("employerRequest.messagePlaceholder","Tell us about your requirements and why you're interested in this candidate..."),value:a.message,onChange:r,required:!0}),c.message&&e.jsx(f.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-1 text-sm text-red-600",children:c.message})]}),e.jsx(O,{type:"submit",variant:"primary",size:"lg",className:"w-full flex items-center justify-center gap-2",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t("employerRequest.sending","Sending request...")]}):e.jsxs(e.Fragment,{children:[t("employerRequest.sendRequest","Send Request"),e.jsx(D,{className:"w-5 h-5"})]})}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:t("employerRequest.disclaimer","Your request will be sent to our admin team for review. We'll get back to you within 24 hours.")})]})]})},me=()=>{const{t:o}=L(),{id:l}=Y(),{user:b}=V(),[q,R]=u.useState(!1),[s,t]=u.useState(null),[a,x]=u.useState(!0),[y,j]=u.useState(null);u.useEffect(()=>{(async()=>{try{x(!0);let n;if(!b)n=await J.getPublicJobSeekerById(l);else{let v=l;typeof l=="string"&&l.startsWith("JS")&&(v=parseInt(l.replace(/^JS/,""),10)),n=await J.getJobSeekerById(v)}n&&n.success&&n.data?t(n.data):(console.error("Failed to fetch job seeker:",n),t(null))}catch(n){console.error("Error fetching job seeker:",n),j(n),t(null)}finally{x(!1)}})()},[l,b]);const c=()=>{R(!0)},N=r=>{console.error("Request failed:",r)};return a?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${I})`},children:[e.jsx(w,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(_,{size:"lg",text:"Loading candidate information..."})}),e.jsx(S,{})]}):y?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${I})`},children:[e.jsx(w,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Profile"}),e.jsx("p",{className:"text-gray-600 mb-6",children:o("employerRequest.error.message","Failed to load job seeker profile.")}),e.jsx(P,{to:"/job-seekers",text:"Back to Job Seekers"})]})})}),e.jsx(S,{})]}):q?e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${I})`},children:[e.jsx(w,{}),e.jsx("div",{className:"pt-16 pb-8",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(E,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:o("employerRequest.success.title","Request Sent Successfully!")}),e.jsx("p",{className:"text-gray-600 mb-8 text-lg leading-relaxed",children:o("employerRequest.success.message","Your request has been sent to our admin team. We'll review it and get back to you within 24 hours.")}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6 mb-8",children:[e.jsx("h3",{className:"font-semibold text-green-800 mb-2",children:"What happens next?"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:"• Our team will review your request within 24 hours"}),e.jsx("li",{children:"• You'll receive an email confirmation"}),e.jsx("li",{children:"• We'll contact you to discuss next steps"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(P,{to:`/view-profile/${l}`,text:o("employerRequest.success.backToProfile","Back to Profile"),className:"inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold"})})]})})}),e.jsx(S,{})]}):e.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-fixed",style:{backgroundImage:`url(${I})`},children:[e.jsx(w,{}),e.jsx("div",{className:"pt-16 pb-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"relative backdrop-blur-sm mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{to:`/view-profile/${l}`,text:o("employerRequest.backToProfile","Back to Profile"),className:"text-white hover:text-gray-200"}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 mt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Request Candidate"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Fill out the form below to request this candidate for your position"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(G,{className:"p-8 bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg border-0 sticky top-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o("employerRequest.candidateInfo","Candidate Information")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center pb-6 border-b border-gray-200",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx(K,{src:s?.profile?.photo,alt:s?.profile?.firstName+" "+s?.profile?.lastName,size:"xl",fallback:s?.profile?.firstName+" "+s?.profile?.lastName,className:"w-20 h-20 ring-4 ring-white shadow-lg"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})})]}),e.jsxs("h3",{className:"font-bold text-xl text-gray-900 mt-4",children:[s?.profile?.firstName?s.profile.firstName.charAt(0)+"*".repeat(s.profile.firstName.length-1):""," ",s?.profile?.lastName?s.profile.lastName.charAt(0)+"*".repeat(s.profile.lastName.length-1):""]}),e.jsx(B,{variant:"primary",size:"lg",className:"mt-2 bg-blue-500 text-white border-0",children:s?.profile?.jobCategory?.name_en||"Job Seeker"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(W,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Location"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.location||(s?.profile?.city?s.profile.city:"")||"Location not specified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(T,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Experience"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.experience||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(A,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Availability"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.profile?.availability||"Not specified"})]})]}),s?.profile?.monthlyRate&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-xl",children:[e.jsx(M,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Monthly Rate"}),e.jsx("p",{className:"text-sm font-semibold text-blue-600",children:s.profile.monthlyRate})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(z,{className:"w-4 h-4 text-orange-500"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Skills & Expertise"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s?.profile?.skills?s.profile.skills.split(",").map((r,n)=>e.jsx(B,{variant:"outline",size:"sm",className:"px-3 py-1 text-xs font-medium border-gray-200 text-gray-700 bg-gray-50",children:r.trim()},n)):e.jsx("span",{className:"text-gray-400 text-sm",children:"No skills listed"})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx(H,{to:`/view-profile/${l}`,className:"block w-full text-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-xl transition-colors",children:"View Full Profile"})})]})]})})}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:[e.jsx("div",{className:"text-xs text-yellow-800 font-medium mb-2",children:"Debug: Job Seeker Data"}),e.jsxs("div",{className:"text-xs text-yellow-700 space-y-1",children:[e.jsxs("div",{children:["URL ID: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:String(l)})]}),e.jsxs("div",{children:["jobSeeker exists: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:String(!!s)})]}),e.jsxs("div",{children:["jobSeeker.id: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:String(s?.id)})]}),e.jsxs("div",{children:["jobSeeker.profile?.userId: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:String(s?.profile?.userId)})]}),e.jsxs("div",{children:["jobSeeker.userId: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:String(s?.userId)})]})]})]}),e.jsx(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},children:e.jsx(Q,{jobSeekerId:(()=>{let r=null;if(console.log("=== DEBUG: Calculating jobSeekerId ==="),console.log("URL id parameter:",l),console.log("jobSeeker object:",s),console.log("jobSeeker.id:",s?.id),console.log("jobSeeker.profile?.userId:",s?.profile?.userId),console.log("jobSeeker.userId:",s?.userId),s?.id&&s.id!=="undefined"&&s.id!=="null")r=s.id,console.log("Using jobSeeker.id:",r);else if(s?.profile?.userId&&s.profile.userId!=="undefined"&&s.profile.userId!=="null")r=s.profile.userId,console.log("Using jobSeeker.profile.userId:",r);else if(s?.userId&&s.userId!=="undefined"&&s.userId!=="null")r=s.userId,console.log("Using jobSeeker.userId:",r);else if(l&&l!=="undefined"&&l!=="null")if(typeof l=="string"&&l.startsWith("JS")){const n=parseInt(l.replace(/^JS/,""),10);isNaN(n)?(r=l,console.log("Using URL id parameter as fallback (JS format):",r)):(r=n,console.log("Converted JS prefix to numeric ID:",r))}else r=l,console.log("Using URL id parameter as fallback:",r);return!r||r==="undefined"||r==="null"||r===""?(console.error("❌ No valid candidate ID found!"),console.error("Available data:",{urlId:l,jobSeekerId:s?.id,profileUserId:s?.profile?.userId,userId:s?.userId})):console.log("✅ Final candidateId:",r),r})(),jobSeekerName:s?.profile?`${s.profile.firstName} ${s.profile.lastName}`:s.name,onSuccess:c,onError:N})})]})]})]})}),e.jsx(S,{})]})};export{me as default};
