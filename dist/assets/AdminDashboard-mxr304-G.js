import{j as e,g as Ee,P as He,e as ye,a as ze,C as Me,_ as Le,S as os,r as i,f as Ge,$ as ps,J as cs,O as ds,x as ke,a5 as fs,a6 as bs,a7 as ys,s as De,V as we,U as Ue,a8 as ss,d as js,a9 as Ns,X as xe,M as vs,a0 as Re,aa as ws,ab as Cs,H as Q,ac as ks,ad as Ss,ae as Ps,af as he,ag as pe,c as We,ah as As,ai as Es,aj as Ve,ak as z,a2 as Ms,q as Ls,al as Je,am as ie,an as Ds,Z as Rs,v as $s,ao as ms,E as Fe,p as Ts,ap as fe,aq as Oe,ar as Fs,a3 as be,as as zs,at as Us,au as Ae,av as Is,F as _s,h as qs,T as Bs,k as Js,D as ts,y as Os,z as Hs,b as Gs}from"./vendor-react-DCVpIq7q.js";import{B as S,d as as,L as oe,C as V,u as xs,A as ne,e as Ws}from"./index--O0PxFH7.js";import{a as je,R as Vs}from"./ReportsPage-D15S1hLw.js";import{a as us}from"./useJobSeekers-Db1U7qgJ.js";import{g as rs,u as gs,E as Ys,S as Te,a as Xs,b as Qs,c as Zs,h as Ks}from"./EmployerRequestsPage-B5AXoTHt.js";import{a as et,b as st}from"./useCategories-BMQFW83G.js";import{m as Ne}from"./vendor-motion-BnaYlrdq.js";import{B as U}from"./Badge-CBal7hbk.js";import{A as ls}from"./Avatar-CWT3j43R.js";import{M as Ce}from"./Modal-CvcPQhfI.js";import tt from"./JobSeekersPage-BahB6LGv.js";import{D as hs}from"./DataTable-CR6rR5AC.js";import{c as ve}from"./contactService-Dm42TTEh.js";import at from"./JobCategoriesPage-CCqskdGu.js";import{a as ns}from"./adminProfileService-coVSKsX4.js";import"./vendor-common-BZD0eUgH.js";import"./vendor-gsap-lnFyu4_T.js";import"./messagingService-DTcJzHUc.js";import"./endpoints-CXiMw_A_.js";import"./categoryService-Bi6eNFrx.js";import"./useApprovalManagement-C3T2g443.js";import"./StatusBadge-DZmcurE5.js";const rt=({isConnected:s,lastUpdate:o,onRefresh:p,showLastUpdate:l=!0,className:u=""})=>e.jsx("div",{className:`flex items-center space-x-2 text-sm ${u}`,children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Ne.div,{animate:{scale:s?[1,1.2,1]:1,opacity:s?1:.5},transition:{duration:2,repeat:s?1/0:0,ease:"easeInOut"}})})}),lt=({request:s,onContactEmployer:o,onViewDetails:p,getStatusColor:l,getPriorityColor:u,compact:k=!1})=>{if(!s)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No request data available"});const E=s.name||s.employerName||"Unknown Employer",x=s.companyName||"Unknown Company",m=s.status||"pending",b=s.priority||"normal",M=s.message||"No message provided",D=s.email||"",N=s.phoneNumber||"",P=s.createdAt||new Date().toISOString(),C=s.selectedUser||s.hasSelectedCandidate,j=s.requestedCandidate,y=s.selectedUser;let L="No candidate selected",$=null;return C&&y?.profile?(L=`${y.profile.firstName} ${y.profile.lastName}`,$=y):j?.profile&&(L=`${j.profile.firstName} ${j.profile.lastName}`,$=j),k?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:E}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:x})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{variant:"outline",size:"xs",className:l?l(m):"bg-gray-100 text-gray-800",children:rs(m)}),e.jsx(U,{variant:"outline",size:"xs",className:u?u(b):"bg-gray-100 text-gray-800",children:b})]})]}),e.jsxs("div",{className:"mt-2",children:[C?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"✓ Selected:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:L})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"⏳ Requesting:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:L})]}),$?.profile?.skills&&e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-xs text-gray-700",children:$.profile.skills})]})]})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:E}),e.jsx("p",{className:"text-sm text-gray-600",children:x})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{variant:"outline",size:"sm",className:l?l(m):"bg-gray-100 text-gray-800",children:rs(m)}),e.jsx(U,{variant:"outline",size:"sm",className:u?u(b):"bg-gray-100 text-gray-800",children:b})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:M}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[D&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:D})]}),N&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(He,{className:"w-4 h-4"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Candidate Information"}),C?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"✓ Selected Candidate:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:L})]}),$?.profile?.skills&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-sm text-gray-700",children:$.profile.skills})]}),$?.profile?.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Experience: "}),e.jsx("span",{className:"text-sm text-gray-700",children:$.profile.experience})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No candidate selected yet"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(P).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>o(s),children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Contact"]}),p&&e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>p(s),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})},nt=({jobSeeker:s,onViewDetails:o,getCategoryColor:p,compact:l=!1})=>{if(!s)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No job seeker data available"});const k=(p||(E=>{const x={JavaScript:"bg-yellow-100 text-yellow-800",React:"bg-blue-100 text-blue-800","Node.js":"bg-green-100 text-green-800",Python:"bg-blue-100 text-blue-800",Django:"bg-green-100 text-green-800",PostgreSQL:"bg-blue-100 text-blue-800",AWS:"bg-orange-100 text-orange-800",Docker:"bg-blue-100 text-blue-800",Git:"bg-red-100 text-red-800",Java:"bg-orange-100 text-orange-800",Cooking:"bg-red-100 text-red-800",Housekeeping:"bg-purple-100 text-purple-800",Childcare:"bg-pink-100 text-pink-800",Gardening:"bg-emerald-100 text-emerald-800",Cleaning:"bg-gray-100 text-gray-800",Driving:"bg-indigo-100 text-indigo-800",Teaching:"bg-yellow-100 text-yellow-800",Nursing:"bg-rose-100 text-rose-800",Construction:"bg-amber-100 text-amber-800",Agriculture:"bg-lime-100 text-lime-800",Technology:"bg-blue-100 text-blue-800",Healthcare:"bg-green-100 text-green-800",Education:"bg-purple-100 text-purple-800",Manufacturing:"bg-red-100 text-red-800",Services:"bg-gray-100 text-gray-800",General:"bg-gray-100 text-gray-800","Job Seeker":"bg-gray-100 text-gray-800",default:"bg-gray-100 text-gray-800"};return x[E]||x.default}))(s?.category||"General");return l?e.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ls,{src:s?.avatar,alt:s?.name||"Job Seeker",size:"sm",fallback:s?.name||"JS",fallbackSrc:as}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:s?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:s?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(U,{variant:"outline",size:"xs",className:k,children:s?.category||"General"}),e.jsx("span",{className:"text-xs text-gray-500",children:s?.location||"Unknown"})]}),s?.approvalStatus&&e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${s.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":s.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[s.approvalStatus==="approved"?e.jsx(ze,{className:"w-3 h-3"}):s.approvalStatus==="rejected"?e.jsx(Me,{className:"w-3 h-3"}):e.jsx(Le,{className:"w-3 h-3"}),s.approvalStatus==="approved"?"Verified":s.approvalStatus==="rejected"?"Rejected":"Pending"]})}),s?.category&&s.category.includes(",")&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[s.category.split(",").slice(0,3).map((E,x)=>e.jsx("span",{className:"inline-block px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:E.trim()},x)),s.category.split(",").length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.category.split(",").length-3," more"]})]})]})]}):e.jsxs("div",{className:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ls,{src:s?.avatar,alt:s?.name||"Job Seeker",size:"md",fallback:s?.name||"JS",fallbackSrc:as}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:s?.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s?.location||"Unknown"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s?.experience||"0"," years"]}),e.jsx(U,{variant:"outline",size:"sm",className:k,children:s?.category||"General"})]}),s?.approvalStatus&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${s.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":s.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[s.approvalStatus==="approved"?e.jsx(ze,{className:"w-3.5 h-3.5"}):s.approvalStatus==="rejected"?e.jsx(Me,{className:"w-3.5 h-3.5"}):e.jsx(Le,{className:"w-3.5 h-3.5"}),s.approvalStatus==="approved"?"Verified Profile":s.approvalStatus==="rejected"?"Profile Rejected":"Under Review"]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["Daily: ",s?.dailyRate?.toLocaleString()||"0"," frw"]}),e.jsxs("span",{children:["Monthly: ",s?.monthlyRate?.toLocaleString()||"0"," frw"]})]})]}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>o?.(s),title:"View Details",children:e.jsx(ye,{className:"w-4 h-4"})})]})},it=({logo:s="J",title:o="Admin Panel",subtitle:p="Job Portal Management"})=>e.jsx("div",{className:"flex items-center justify-between p-5 border-b border-slate-200 bg-slate-50/60",children:e.jsxs("div",{className:"flex items-center space-x-2.5",children:[e.jsx("div",{className:"w-9 h-9 bg-red-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-base",children:s})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-slate-800 text-base",children:o}),e.jsx("span",{className:"text-xs text-slate-500",children:p})]})]})}),ot=({searchValue:s="",onSearchChange:o,placeholder:p="Search..."})=>e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:p,value:s,onChange:l=>o?.(l.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-md text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-200"})]})}),ct=({item:s,isActive:o,onClick:p})=>{const[l,u]=i.useState(!1),E={Home:ss,Users:Ue,MessageSquare:we,Briefcase:De,BarChart3:ys,Settings:bs,TestTube:fs,User:ke,FileText:ds,Calendar:cs,Star:ps,MapPin:Ge,Mail:Ee,Phone:He}[s.icon]||ss,x=()=>{s.subItems?u(!l):p(s.id)},m=b=>{p(b)};return e.jsxs("li",{children:[e.jsxs("button",{onClick:x,className:`
          relative w-full flex items-center space-x-2.5 px-3 py-2.5 rounded-md text-left transition-all duration-200 group
          ${o?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
        `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx(E,{className:`
              h-4.5 w-4.5 flex-shrink-0
              ${o?"text-red-600":"text-slate-500 group-hover:text-slate-700"}
            `})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:`text-sm ${o?"font-medium":"font-normal"}`,children:s.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.badge&&e.jsx("span",{className:`
                px-1.5 py-0.5 text-xs font-medium rounded-full
                ${o?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}
              `,children:s.badge}),s.subItems&&e.jsx("div",{className:"flex items-center",children:l?e.jsx(js,{className:"w-4 h-4 text-slate-500"}):e.jsx(Ns,{className:"w-4 h-4 text-slate-500"})})]})]})]}),s.subItems&&l&&e.jsx("ul",{className:"ml-6 mt-1 space-y-0.5",children:s.subItems.map(b=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>m(b.id),className:`
                  relative w-full flex items-center space-x-2.5 px-3 py-2 rounded-md text-left transition-all duration-200 group
                  ${o===b.id?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
                `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx("div",{className:`
                    w-1.5 h-1.5 rounded-full
                    ${o===b.id?"bg-red-600":"bg-slate-400 group-hover:bg-slate-600"}
                  `})}),e.jsx("span",{className:`text-sm ${o===b.id?"font-medium":"font-normal"}`,children:b.label})]})},b.id))})]})},dt=({navigationItems:s,activeItem:o,onItemClick:p})=>e.jsx("nav",{className:"flex-1 px-3 py-2 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:s.map(l=>e.jsx(ct,{item:l,isActive:o===l.id,onClick:p},l.id))})}),mt=({sidebarOpen:s,setSidebarOpen:o,navigationItems:p,activeTab:l,setActiveTab:u,user:k,onLogout:E,className:x=""})=>{const[m,b]=i.useState("");i.useEffect(()=>{const P=()=>{window.innerWidth>=768?o(!0):o(!1)};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[o]);const M=()=>{o(!s)},D=P=>{u(P),window.innerWidth<768&&o(!1)},N=P=>{b(P)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:M,className:"fixed top-6 left-6 z-50 p-3 rounded-lg bg-white shadow-md border border-slate-100 md:hidden hover:bg-slate-50 transition-all duration-200","aria-label":"Toggle sidebar",children:s?e.jsx(xe,{className:"h-5 w-5 text-slate-600"}):e.jsx(vs,{className:"h-5 w-5 text-slate-600"})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300",onClick:M}),e.jsxs("div",{className:`
          fixed top-0 left-0 h-full bg-white border-r border-slate-200 z-40 transition-all duration-300 ease-in-out flex flex-col w-64 md:w-80 md:sticky md:top-0 md:h-screen md:left-0 md:static
          ${s?"translate-x-0":"-translate-x-full"}
          md:translate-x-0 md:static md:z-auto
          ${x}
        `,children:[e.jsx(it,{logo:"J",title:"Admin Panel",subtitle:"Job Portal Management"}),e.jsx(ot,{searchValue:m,onSearchChange:N,placeholder:"Search..."}),e.jsx(dt,{navigationItems:p,activeItem:l,onItemClick:D})]})]})},xt=({user:s,onLogout:o,onSearch:p,onFilter:l,searchTerm:u="",onRefresh:k})=>e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 md:px-6 py-4 sticky top-0 z-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome back, ",s?.firstName||s?.email||"Admin"]})]})}),e.jsx("div",{className:"flex-1 max-w-md mx-4 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search...",value:u,onChange:E=>p?.(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[k&&e.jsx(S,{variant:"ghost",size:"sm",onClick:k,title:"Refresh data",children:e.jsx(Re,{className:"w-5 h-5"})}),e.jsx(S,{variant:"ghost",size:"sm",children:e.jsx(ws,{className:"w-5 h-5"})}),e.jsx("div",{className:"relative",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-4 h-4 text-red-600"})}),e.jsx("span",{className:"hidden md:block text-sm font-medium",children:s?.firstName||s?.email||"Admin"})]})}),e.jsx(S,{variant:"outline",size:"sm",onClick:o,className:"hidden md:block",children:"Logout"})]})]})}),ut=()=>Ps.create({page:{flexDirection:"column",backgroundColor:"#ffffff",padding:15,fontSize:9},header:{marginBottom:10,borderBottom:"2 solid #3b82f6",paddingBottom:5},title:{fontSize:24,fontWeight:"bold",color:"#1f2937",marginBottom:2},subtitle:{fontSize:16,color:"#6b7280",marginBottom:2},dateRange:{fontSize:12,color:"#9ca3af",marginBottom:6},table:{display:"table",width:"auto",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,borderColor:"#e5e7eb"},tableRow:{margin:"auto",flexDirection:"row"},tableColHeader:{width:"auto",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#3b82f6",backgroundColor:"#3b82f6",padding:1,minHeight:18,justifyContent:"center",alignItems:"center"},tableCol:{width:"1",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#e5e7eb",padding:1,minHeight:5,justifyContent:"center",alignItems:"center"},tableCellHeader:{margin:"2",fontSize:11,fontWeight:"bold",color:"#ffffff",textAlign:"center"},tableCell:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"center"},tableCellLeft:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"left"},footer:{position:"absolute",bottom:15,left:15,right:15,textAlign:"center",color:"#6b7280",fontSize:8,borderTop:"1 solid #e5e7eb",paddingTop:5},pageNumber:{position:"absolute",bottom:15,right:15,color:"#6b7280",fontSize:8},alternateRow:{backgroundColor:"#f9fafb"}}),gt=(s,o,p,l)=>{const u=ut(),k=l.title||yt(s);l.subtitle||`${k.toLowerCase()}`;const E=l.dateRange||`Export Date: ${new Date().toLocaleDateString()}`,x=jt(s,p);return Q.createElement(ks,{},Q.createElement(Ss,{size:"A4",orientation:"landscape",style:u.page},[Q.createElement(he,{key:"header",style:u.header},[Q.createElement(pe,{key:"title",style:u.title},"Job Portal System"),Q.createElement(pe,{key:"subtitle",style:u.subtitle},k),Q.createElement(pe,{key:"dateRange",style:u.dateRange},E)]),Q.createElement(he,{key:"table",style:u.table},[Q.createElement(he,{key:"header-row",style:u.tableRow},x.map((m,b)=>Q.createElement(he,{key:`header-${b}`,style:[u.tableColHeader,{width:is(m.key)}]},Q.createElement(pe,{style:u.tableCellHeader},m.label)))),...o.map((m,b)=>Q.createElement(he,{key:`row-${b}`,style:[u.tableRow,b%2===1?u.alternateRow:{}]},x.map((M,D)=>Q.createElement(he,{key:`cell-${b}-${D}`,style:[u.tableCol,{width:is(M.key)}]},Q.createElement(pe,{style:pt(M.key)},Nt(m,M,s))))))]),Q.createElement(he,{key:"footer",style:u.footer},Q.createElement(pe,{},`Generated by Job Portal System • Total records: ${o.length}`)),Q.createElement(pe,{key:"pageNumber",style:u.pageNumber,render:({pageNumber:m,totalPages:b})=>`Page ${m} of ${b}`})]))},ht=async(s,o,p,l={})=>{try{if(!o||!Array.isArray(o)||o.length===0)throw new Error("No table data provided");if(!p||!Array.isArray(p)||p.length===0)throw new Error("No columns provided");const u=gt(s,o,p,l);return await Cs(u).toBlob()}catch(u){throw console.error("Error generating react-pdf:",u),new Error(`Failed to generate PDF report: ${u.message}`)}},is=(s,o)=>s==="jobseeker_info"?"40%":s==="employer_info"||s==="candidate_info"||s==="job_details"?"30%":{name:"20%",email:"25%",phone:"15%",location:"20%",category:"20%",experience:"15%",status:"12%",priority:"12%",demand:"12%",count:"10%",percentage:"10%",createdAt:"15%",registeredAt:"15%",employerName:"20%",companyName:"20%",candidateName:"20%",candidateEmail:"20%",candidateContact:"15%",position:"20%",monthlyRate:"15%",contactEmail:"20%"}[s]||"15%",pt=s=>["jobseeker_info","employer_info","candidate_info","job_details","name","email","location","category","position","companyName","employerName","candidateName","candidateEmail"].includes(s)?{textAlign:"left"}:{textAlign:"center"},ft=(s,o)=>!s&&s!==0?"N/A":o==="status"||o==="priority"||o==="demand"?bt(s):o==="percentage"?`${s}%`:o==="monthlyRate"&&s!=="Not specified"?s:typeof s=="string"&&s.length>30?s.substring(0,27)+"...":s,bt=s=>s?{Active:"Active",Inactive:"Inactive",pending:"Pending",in_progress:"In Progress",completed:"Completed",urgent:"Urgent",high:"High",normal:"Normal",low:"Low",High:"High",Medium:"Medium",Low:"Low"}[s]||s:"N/A",yt=s=>({"job-seekers":"Job Seekers Report","employer-requests":"Employer Requests Report",categories:"Job Categories Report",locations:"Location Distribution Report",skills:"Skills Analysis Report"})[s]||"Table Report",jt=(s,o)=>s==="job-seekers"?[{key:"jobseeker_info",label:"Job Seeker Info",subColumns:["name","email","phone","location"]},{key:"job_details",label:"Job Details",subColumns:["category","experience"]},{key:"registeredAt",label:"Registration Date",subColumns:["registeredAt"]},{key:"status",label:"Status",subColumns:["status"]}]:s==="employer-requests"?[{key:"employer_info",label:"Employer Info",subColumns:["employerName","companyName","employerEmail"]},{key:"candidate_info",label:"Candidate Info",subColumns:["candidateName","candidateEmail","candidateContact"]},{key:"job_details",label:"Job Details",subColumns:["category","monthlyRate","status","priority"]},{key:"createdAt",label:"Request Date",subColumns:["createdAt"]}]:s==="categories"?[{key:"category",label:"Category",subColumns:["category"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:s==="locations"?[{key:"location",label:"Location",subColumns:["location"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:s==="skills"?[{key:"skill",label:"Skill",subColumns:["skill"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:o.map(p=>({key:p.key,label:p.label,subColumns:[p.key]})),Nt=(s,o,p)=>{if(!o.subColumns||o.subColumns.length===1){const u=o.subColumns?o.subColumns[0]:o.key;return ft(s[u],u)}const l=o.subColumns.map(u=>{const k=s[u];return!k||k==="Not provided"||k==="Not specified"||k==="Unknown"?null:k}).filter(Boolean);return l.length===0?"N/A":l.length===1?l[0]:o.key==="jobseeker_info"?`${l[0]}
${l[1]}
${l[2]}
${l[3]}`:o.key==="employer_info"?`${l[0]}
${l[1]}
${l[2]||"N/A"}`:o.key==="candidate_info"?`${l[0]}
${l[1]}
${l[2]||"N/A"}`:o.key==="job_details"?p==="job-seekers"?`${l[0]}
${l[1]}`:p==="employer-requests"?`${l[0]}
${l[1]}
${l[2]}
${l[3]}`:l.join(`
`):l.join(`
`)},vt=async(s,o)=>{try{const p=URL.createObjectURL(s),l=document.createElement("a");return l.href=p,l.download=o,l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(p),!0}catch(p){return console.error("Error saving PDF:",p),!1}},wt=(s,o,p)=>{try{const l=o.map(b=>b.label).join(","),u=s.map(b=>o.map(M=>{const D=b[M.key];return typeof D=="string"&&(D.includes(",")||D.includes('"'))?`"${D.replace(/"/g,'""')}"`:D||""}).join(",")),k=[l,...u].join(`
`),E=new Blob([k],{type:"text/csv;charset=utf-8;"}),x=document.createElement("a"),m=URL.createObjectURL(E);return x.setAttribute("href",m),x.setAttribute("download",p),x.style.visibility="hidden",document.body.appendChild(x),x.click(),document.body.removeChild(x),!0}catch(l){return console.error("Error exporting CSV:",l),!1}},Ct=(s,o,p)=>{try{let l='<table border="1">';l+="<tr>",o.forEach(x=>{l+=`<th style="background-color: #3b82f6; color: white; padding: 8px; text-align: center; font-weight: bold;">${x.label}</th>`}),l+="</tr>",s.forEach(x=>{l+="<tr>",o.forEach(m=>{const b=x[m.key]||"";l+=`<td style="padding: 6px; border: 1px solid #e5e7eb;">${b}</td>`}),l+="</tr>"}),l+="</table>";const u=new Blob([l],{type:"application/vnd.ms-excel"}),k=document.createElement("a"),E=URL.createObjectURL(u);return k.setAttribute("href",E),k.setAttribute("download",p.replace(".xlsx",".html")),k.style.visibility="hidden",document.body.appendChild(k),k.click(),document.body.removeChild(k),!0}catch(l){return console.error("Error exporting Excel:",l),!1}},kt=()=>{const{t:s}=We(),[o,p]=i.useState("30"),[l,u]=i.useState(!1),[k,E]=i.useState(null),[x,m]=i.useState(!0),[b,M]=i.useState(""),[D,N]=i.useState(null),[P,C]=i.useState("job-seekers"),[j,y]=i.useState(""),[L,$]=i.useState("pdf"),{jobSeekers:T,loading:B,error:t,fetchJobSeekers:r}=us({autoFetch:!0,itemsPerPage:1e3}),{requests:d,loading:g,error:w,fetchRequests:A}=gs({autoFetch:!0,itemsPerPage:1e3}),{categories:R,loading:H,error:te,fetchCategories:ee}=et({includeAdmin:!0,autoFetch:!0});i.useEffect(()=>{h()},[o]);const h=async()=>{try{m(!0),M("");const[c,a]=await Promise.all([je.getAnalytics({period:o}),je.getDashboardStats()]);c.success?E(c.data):M(c.error||"Failed to load analytics data"),a.success&&N(a.data)}catch(c){console.error("Error loading report data:",c),M("Network error. Please try again.")}finally{m(!1)}},_=[{value:"7",label:"Last 7 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days"},{value:"365",label:"Last Year"}],v=[{value:"job-seekers",label:"Job Seekers",icon:Ue},{value:"employer-requests",label:"Employer Requests",icon:we},{value:"categories",label:"Categories",icon:De},{value:"locations",label:"Locations",icon:Ge},{value:"skills",label:"Skills",icon:As}],f=async c=>{u(!0);try{const a=ge(c),n=ue(c);if(!a||a.length===0)return z.error("No data available for export"),!1;const O=new Date().toISOString().split("T")[0],J=`table-report-${c}-${O}`;let se=!1;switch(L){case"pdf":const Ie={title:ae(c),subtitle:`Comprehensive data table for ${ae(c).toLowerCase()}`,dateRange:`Last ${o} days (${new Date(Date.now()-parseInt(o)*24*60*60*1e3).toLocaleDateString()} - ${new Date().toLocaleDateString()})`};try{const q=await ht(c,a,n,Ie),G=`${J}.pdf`;se=await vt(q,G)}catch(q){return console.error("PDF generation error:",q),z.error(`PDF generation failed: ${q.message}`),!1}se?z.success(`${ae(c)} exported successfully as PDF!`):z.error("Failed to save PDF file");break;case"csv":const $e=`${J}.csv`;se=wt(a,n,$e),se?z.success(`${ae(c)} exported successfully as CSV!`):z.error("Failed to save CSV file");break;case"excel":const _e=`${J}.xlsx`;se=Ct(a,n,_e),se?z.success(`${ae(c)} exported successfully as Excel!`):z.error("Failed to save Excel file");break;default:return z.error("Unsupported export format"),!1}return se}catch(a){return console.error("Error exporting report:",a),z.error("Error generating export report. Please try again."),!1}finally{u(!1)}},W=async()=>{u(!0);try{await Promise.all([h(),r(),A(),ee()])}catch(c){console.error("Error refreshing data:",c),M("Failed to refresh data. Please try again.")}finally{u(!1)}},Y=()=>!T||T.length===0?[]:T.map(c=>({id:c.id,name:`${c.profile?.firstName||c.firstName||c.name||"Unknown"} ${c.profile?.lastName||c.lastName||""}`,email:c.email||c.profile?.email||"Not provided",phone:c.profile?.contactNumber||c.contactNumber||c.phone||"Not provided",location:c.profile?.location||c.location||c.city||"Not specified",category:c.profile?.jobCategory?.name_en||c.jobCategory?.name_en||c.category||"Not specified",experience:c.profile?.experienceLevel||c.experienceLevel||c.experience||"Not specified",registeredAt:c.registeredAt||c.createdAt?new Date(c.registeredAt||c.createdAt).toLocaleDateString():"Unknown",status:c.status||"Active"})),le=()=>{if(!d||d.length===0)return[];const c=a=>{if(!a||a==="Not specified")return"Not specified";if(typeof a=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(a);if(typeof a=="string"){const n=parseFloat(a);return isNaN(n)?a:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(n)}return"Not specified"};return d.map(a=>({id:a.id,employerName:a.name||a.employerName||a.employer?.name||"Unknown",companyName:a.companyName||a.employer?.company||"Private",candidateName:a.requestedCandidate&&`${a.requestedCandidate.profile?.firstName||""} ${a.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:a.requestedCandidate?.profile?.skills||a.position||a.jobTitle||"General",status:a.status||"pending",priority:a.priority||"normal",monthlyRate:c(a.requestedCandidate?.profile?.monthlyRate),createdAt:a.createdAt?new Date(a.createdAt).toLocaleDateString():"Unknown",contactEmail:a.email||a.employerContact?.email||a.employer?.email||"Not provided",lastContactDate:a.updatedAt,isCompleted:a.status==="completed",category:a.requestedCandidate?.profile?.jobCategory?.name_en||"General",candidateExperience:a.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:a.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:a.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:a.requestedCandidate?.profile?.location||"Not specified",candidateCity:a.requestedCandidate?.profile?.city||"Not specified",candidateCountry:a.requestedCandidate?.profile?.country||"Not specified",candidateContact:a.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:a.requestedCandidate?.email||"Not specified",candidateLanguages:a.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:a.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:a.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:a.requestedCandidate?.profile?.description||"Not specified",candidateGender:a.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:a.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:a.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:a.requestedCandidate?.profile?.references||"Not specified",message:a.message||"",_backendData:a}))},Se=()=>{if(!R||R.length===0)return[];const c={};return T?.forEach(a=>{const n=a.profile?.jobCategory?.name_en||a.jobCategory?.name_en||a.category||"Uncategorized";c[n]=(c[n]||0)+1}),R.map(a=>{const n=c[a.name_en]||0,O=T?.length||1,J=Math.round(n/O*100);return{id:a.id,name:a.name_en||a.name,count:n,percentage:J,status:"Active"}})},Pe=()=>{if(!T||T.length===0)return[];const c={};return T.forEach(a=>{const n=a.profile?.location||a.location||a.city||"Unknown";c[n]=(c[n]||0)+1}),Object.entries(c).map(([a,n])=>{const O=T.length,J=Math.round(n/O*100);return{id:a,name:a,count:n,percentage:J,status:"Active"}}).sort((a,n)=>n.count-a.count)},ce=()=>{if(!T||T.length===0)return[];const c={};return T.forEach(a=>{const n=a.profile?.skills||a.skills||"";n&&n.split(",").map(J=>J.trim()).filter(J=>J).forEach(J=>{c[J]=(c[J]||0)+1})}),Object.entries(c).map(([a,n])=>{const O=T.length,J=Math.round(n/O*100),se=n>O*.3?"High":n>O*.1?"Medium":"Low";return{id:a,name:a,count:n,percentage:J,demand:se}}).sort((a,n)=>n.count-a.count)},ue=c=>{switch(c){case"job-seekers":return[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"location",label:"Location",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"experience",label:"Experience",sortable:!0},{key:"registeredAt",label:"Registered",sortable:!0},{key:"status",label:"Status",sortable:!0,render:a=>e.jsx(U,{variant:a.status==="Active"?"success":"warning",children:a.status})}];case"employer-requests":return[{key:"employerName",label:"Employer Name",sortable:!0},{key:"companyName",label:"Company",sortable:!0},{key:"contactEmail",label:"Employer Email",sortable:!0},{key:"candidateName",label:"Candidate Name",sortable:!0},{key:"candidateEmail",label:"Candidate Email",sortable:!0},{key:"candidateContact",label:"Candidate Phone",sortable:!0},{key:"position",label:"Position/Skills",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"monthlyRate",label:"Monthly Rate",sortable:!0},{key:"status",label:"Status",sortable:!0,render:a=>e.jsx(U,{variant:a.status==="completed"?"success":a.status==="in_progress"?"warning":a.status==="pending"?"info":"danger",children:a.status.replace("_"," ")})},{key:"priority",label:"Priority",sortable:!0,render:a=>e.jsx(U,{variant:a.priority==="urgent"?"danger":a.priority==="high"?"warning":a.priority==="normal"?"info":"secondary",children:a.priority})},{key:"createdAt",label:"Created",sortable:!0}];case"categories":return[{key:"name",label:"Category Name",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:a=>e.jsxs("span",{children:[a.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:a=>e.jsx(U,{variant:"success",children:a.status})}];case"locations":return[{key:"name",label:"Location",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:a=>e.jsxs("span",{children:[a.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:a=>e.jsx(U,{variant:"success",children:a.status})}];case"skills":return[{key:"name",label:"Skill Name",sortable:!0},{key:"count",label:"Count",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:a=>e.jsxs("span",{children:[a.percentage,"%"]})},{key:"demand",label:"Demand Level",sortable:!0,render:a=>e.jsx(U,{variant:a.demand==="High"?"success":a.demand==="Medium"?"warning":"info",children:a.demand})}];default:return[]}},ge=c=>{switch(c){case"job-seekers":return Y();case"employer-requests":return le();case"categories":return Se();case"locations":return Pe();case"skills":return ce();default:return[]}},ae=c=>{const a=v.find(n=>n.value===c);return a?a.label:"Report"};return x||B||g||H?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(oe,{size:"lg",text:"Loading table reports..."})}):b||t||w||te?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ds,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Table Reports"}),e.jsx("p",{className:"text-red-600 mb-4",children:b||t||w||te}),e.jsxs(S,{onClick:W,variant:"outline",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Table Reports"})})}),e.jsx(V,{className:"",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsx("select",{value:o,onChange:c=>p(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:_.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]})}),v.map(c=>{const a=c.icon,n=P===c.value;return e.jsx("button",{onClick:()=>C(c.value),className:`p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md ${n?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 hover:border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(a,{className:`w-6 h-6 ${n?"text-blue-600":"text-gray-500"}`}),e.jsx("span",{className:"text-sm font-medium text-center",children:c.label})]})},c.value)})]})}),P&&e.jsxs(V,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:ae(P)}),e.jsxs("p",{className:"text-gray-600",children:["Comprehensive data table for ",ae(P).toLowerCase()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:L,onChange:c=>$(c.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"excel",children:"Excel"})]}),e.jsxs(S,{onClick:()=>f(P),disabled:l,className:"flex items-center gap-2",children:[e.jsx(Es,{className:"w-3 h-3"}),l?"Exporting...":`Export ${L.toUpperCase()}`]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(S,{onClick:W,variant:"outline",disabled:l,className:"flex items-center gap-2",children:[e.jsx(Re,{className:`w-3 h-3 ${l?"animate-spin":""}`}),l?"Refreshing...":"Refresh"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(hs,{columns:ue(P),data:ge(P),pagination:!0,itemsPerPage:15,searchTerm:j,onSearchChange:y,className:"w-full"})})]}),e.jsx(Ve,{position:"top-right"})]})},St=(s={})=>{const{autoFetch:o=!1,itemsPerPage:p=10,page:l=1,searchTerm:u="",status:k="",category:E=""}=s,[x,m]=i.useState([]),[b,M]=i.useState(!1),[D,N]=i.useState(""),[P,C]=i.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[j,y]=i.useState(null),L=i.useCallback(async(g={})=>{M(!0),N("");try{const w={page:g.page||l,limit:g.itemsPerPage||p,search:g.searchTerm||u,status:g.status||k,category:g.category||E,...g},A=await ve.getAllContacts(w);A.success?(m(Array.isArray(A.data.contacts)?A.data.contacts:[]),A.data.pagination&&C(A.data.pagination),A.data.statistics&&y(A.data.statistics)):N(A.error)}catch(w){N("Failed to fetch contact messages"),console.error("Error fetching contact messages:",w)}finally{M(!1)}},[l,p,u,k,E]),$=i.useCallback(async g=>{M(!0),N("");try{const w=await ve.getMessageById(g);return w.success?w.data:(N(w.error),null)}catch(w){return N("Failed to fetch contact message"),console.error("Error fetching contact message:",w),null}finally{M(!1)}},[]),T=i.useCallback(async(g,w)=>{M(!0),N("");try{const A=await ve.respondToMessage(g,w);return A.success?(await L(),A):(N(A.error),A)}catch{return N("Failed to respond to message"),{success:!1,error:"Failed to respond to message"}}finally{M(!1)}},[L]),B=i.useCallback(async g=>{try{const w=await ve.markAsRead(g);return w.success?(m(A=>A.map(R=>R.id===g?{...R,isRead:!0}:R)),w):(N(w.error),w)}catch(w){return N("Failed to mark message as read"),console.error("Error marking message as read:",w),{success:!1,error:"Failed to mark message as read"}}},[]),t=i.useCallback(async g=>{try{const w=await ve.deleteMessage(g);return w.success?(m(A=>A.filter(R=>R.id!==g)),w):(N(w.error),w)}catch(w){return N("Failed to delete message"),console.error("Error deleting message:",w),{success:!1,error:"Failed to delete message"}}},[]),r=i.useCallback(async()=>{try{const g=await ve.getStatistics();return g.success?(y(g.data),g.data):(N(g.error),null)}catch(g){return N("Failed to fetch statistics"),console.error("Error fetching statistics:",g),null}},[]),d=i.useCallback(()=>L(),[L]);return i.useEffect(()=>{o&&(L(),r())},[o,L,r]),{messages:x,loading:b,error:D,pagination:P,statistics:j,fetchMessages:L,fetchMessageById:$,respondToMessage:T,markAsRead:B,deleteMessage:t,fetchStatistics:r,refreshMessages:d}},Pt=()=>{const{t:s}=We(),[o,p]=i.useState(""),[l,u]=i.useState(""),[k,E]=i.useState(""),[x,m]=i.useState(null),[b,M]=i.useState(!1),[D,N]=i.useState(!1),[P,C]=i.useState(!1),[j,y]=i.useState({subject:"",message:""}),[L,$]=i.useState(!1),{messages:T,loading:B,error:t,statistics:r,fetchMessages:d,respondToMessage:g,markAsRead:w,deleteMessage:A,refreshMessages:R}=St({autoFetch:!0,itemsPerPage:15}),[H,te]=i.useState(1),ee=15,_=(Array.isArray(T)?T.map(n=>({...n,createdAt:n.createdAt||""})):[]).filter(n=>{const O=!o||n.status===o,J=!l||n.category===l,se=!k||n.priority===k;return O&&J&&se}),v=Math.ceil(_.length/ee),f=_.slice((H-1)*ee,H*ee),W=(n,O)=>{m(O),M(!0)};i.useEffect(()=>{d({status:o,category:l,priority:k})},[o,l,k]);const Y=async n=>{m(n),M(!0),n.isRead||await w(n.id)},le=n=>{m(n),y({subject:`Re: ${n.subject}`,message:""}),N(!0)},Se=n=>{m(n),C(!0)},Pe=async n=>{if(n.preventDefault(),!localStorage.getItem("job_portal_token")){z.error("You are not logged in. Please log in again."),window.location.href="/login";return}if(!j.subject.trim()||!j.message.trim()){z.error("Please fill in both subject and message");return}if(x&&x.status==="responded"){z.error("This message has already been responded to. You cannot reply again."),N(!1);return}$(!0);try{const J=await g(x.id,j);J.success?(z.success("Response sent successfully!"),N(!1),y({subject:"",message:""}),m(null)):z.error(J.error||"Failed to send response")}catch{z.error("Failed to send response. Please try again.")}finally{$(!1)}},ce=async()=>{(await A(x.id)).success?(z.success("Message deleted successfully!"),C(!1),m(null)):z.error("Failed to delete message")},ue=n=>{switch(n){case"unread":return e.jsx(U,{variant:"warning",children:"Unread"});case"read":return e.jsx(U,{variant:"info",children:"Read"});case"responded":return e.jsx(U,{variant:"success",children:"Responded"});case"archived":return e.jsx(U,{variant:"secondary",children:"Archived"});default:return e.jsx(U,{variant:"outline",children:n})}},ge=n=>{switch(n){case"low":return e.jsx(U,{variant:"secondary",children:"Low"});case"normal":return e.jsx(U,{variant:"info",children:"Normal"});case"high":return e.jsx(U,{variant:"warning",children:"High"});case"urgent":return e.jsx(U,{variant:"danger",children:"Urgent"});default:return e.jsx(U,{variant:"outline",children:n})}},ae=n=>{switch(n){case"general":return e.jsx(U,{variant:"info",children:"General"});case"support":return e.jsx(U,{variant:"warning",children:"Support"});case"feedback":return e.jsx(U,{variant:"success",children:"Feedback"});case"complaint":return e.jsx(U,{variant:"danger",children:"Complaint"});default:return e.jsx(U,{variant:"outline",children:n})}},c=[{key:"name",label:"Name",sortable:!0,render:n=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ke,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:n.name})]})},{key:"email",label:"Email",sortable:!0,render:n=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:n.email})]})},{key:"subject",label:"Subject",sortable:!0,render:n=>e.jsx("div",{className:"max-w-xs truncate",title:n.subject,children:n.subject})},{key:"category",label:"Category",sortable:!0,render:n=>ae(n.category)},{key:"priority",label:"Priority",sortable:!0,render:n=>ge(n.priority)},{key:"status",label:"Status",sortable:!0,render:n=>ue(n.status)},{key:"submittedAt",label:"Date",sortable:!0,render:n=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cs,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:new Date(n.createdAt).toLocaleDateString()})]})}],a=n=>[{key:"view",label:"View",icon:ye,onClick:()=>Y(n),variant:"outline"},{key:"reply",label:"Reply",icon:Je,onClick:()=>{n.status==="responded"?z.error("This message has already been responded to."):le(n)},variant:"primary",disabled:n.status==="responded"},{key:"delete",label:"Delete",icon:ie,onClick:()=>Se(n),variant:"danger"}];return B&&T.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(oe,{size:"lg",text:"Loading contact messages..."})}):t&&T.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Me,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Contact Messages"}),e.jsx("p",{className:"text-red-600 mb-4",children:t}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Authentication Issue:"})," This error usually means you need to log in again or your session has expired."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsxs(S,{onClick:R,variant:"outline",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsx(S,{onClick:()=>window.location.href="/login",variant:"primary",children:"Go to Login"})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-gray-600",children:"Manage and respond to contact form submissions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(S,{onClick:R,variant:"outline",disabled:B,className:"flex items-center gap-2",children:[e.jsx(Re,{className:`w-4 h-4 ${B?"animate-spin":""}`}),B?"Refreshing...":"Refresh"]})})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(we,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.total||0})]})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(Le,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Unread Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.unread||0})]})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ze,{className:"w-6 h-6 text-green-600"})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.responded||0})})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ms,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Archived"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.archived||0})]})]})})]}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:o,onChange:n=>p(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"unread",children:"Unread"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"responded",children:"Responded"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:l,onChange:n=>u(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"feedback",children:"Feedback"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{value:k,onChange:n=>E(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(S,{onClick:()=>{p(""),u(""),E("")},variant:"outline",className:"w-full",children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})})]})}),e.jsx(hs,{columns:c,data:f,pagination:!0,itemsPerPage:ee,actionButtons:a,onRowAction:W,className:"w-full"}),v>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>te(H-1),disabled:H===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",H," of ",v]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>te(H+1),disabled:H===v,children:"Next"})]}),e.jsx(Ce,{isOpen:b,onClose:()=>M(!1),title:"View Message",maxWidth:"max-w-2xl",children:x&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:x.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:x.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("p",{className:"text-gray-900",children:x.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("div",{children:ae(x.category)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{children:ue(x.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(x.createdAt).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:x.message})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(S,{onClick:()=>{M(!1),le(x)},variant:"primary",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Reply"]}),e.jsx(S,{onClick:()=>M(!1),variant:"outline",children:"Close"})]})]})}),e.jsx(Ce,{isOpen:D,onClose:()=>N(!1),title:"Reply to Message",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:Pe,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:j.subject,onChange:n=>y(O=>({...O,subject:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:j.message,onChange:n=>y(O=>({...O,message:n.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Type your response...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{type:"button",onClick:()=>N(!1),variant:"outline",disabled:L,children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",disabled:L,children:L?e.jsxs("span",{className:"flex items-center",children:[e.jsx(oe,{size:"sm",className:"mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Send Reply"]})})]})]})}),e.jsx(Ve,{position:"top-right"}),e.jsx(Ce,{isOpen:P,onClose:()=>C(!1),title:"Delete Message",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ie,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Message"}),e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to delete this message? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{onClick:()=>C(!1),variant:"outline",children:"Cancel"}),e.jsxs(S,{onClick:ce,variant:"danger",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})},At=({loadingTime:s,apiCalls:o,cacheHits:p,errors:l,showDetails:u=!1})=>{const[k,E]=i.useState(!1);if(i.useEffect(()=>{const b=setTimeout(()=>{(s>2e3||l.length>0)&&E(!0)},2e3);return()=>clearTimeout(b)},[s,l.length]),!k)return null;const m=s<1e3?{status:"excellent",color:"text-green-600",bg:"bg-green-50"}:s<2e3?{status:"good",color:"text-blue-600",bg:"bg-blue-50"}:s<5e3?{status:"fair",color:"text-yellow-600",bg:"bg-yellow-50"}:{status:"poor",color:"text-red-600",bg:"bg-red-50"};return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 ${m.bg} border rounded-lg shadow-lg p-4 max-w-sm transition-all duration-300`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`font-semibold ${m.color}`,children:"Performance Monitor"}),e.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["Load Time: ",e.jsxs("span",{className:m.color,children:[s,"ms"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["API Calls: ",o]})]}),p>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:["Cache Hits: ",p]})]}),l.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{children:["Errors: ",l.length]})]})]}),u&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:m.color,children:m.status})]}),e.jsxs("div",{children:["Performance: ",s<1e3?"🚀":s<2e3?"⚡":s<5e3?"🐌":"🐌🐌"]})]})})]})},Et=()=>{const{user:s,updateUser:o}=xs(),[p,l]=i.useState("profile"),[u,k]=i.useState(!1),[E,x]=i.useState(!0),[m,b]=i.useState({type:"",text:""}),[M,D]=i.useState({startTime:Date.now(),loadingTime:0,apiCalls:0,cacheHits:0,errors:[]}),[N,P]=i.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:""}),[C,j]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[y,L]=i.useState({}),[$,T]=i.useState(!1),[B,t]=i.useState(!1),[r,d]=i.useState(!1),g=i.useMemo(()=>[{id:"profile",label:"Profile",icon:ke},{id:"security",label:"Security",icon:$s}],[]),w=i.useCallback(async()=>{try{x(!0),D(f=>({...f,apiCalls:f.apiCalls+1})),console.log("🔄 Loading admin profile...");const v=await je.getAdminProfile();if(console.log("📊 Admin profile result:",v),v.success){const f=v.data;console.log("👤 Admin data received:",f),P({firstName:f.firstName||f.profile?.firstName||"",lastName:f.lastName||f.profile?.lastName||"",email:f.email||"",phone:f.phone||f.phoneNumber||f.profile?.phoneNumber||"",location:f.location||f.city||f.profile?.city||"",bio:f.bio||f.profile?.bio||""}),v.fromCache&&D(W=>({...W,cacheHits:W.cacheHits+1}))}else console.warn("⚠️ Failed to load admin profile from API, using user context data"),console.warn("❌ API Error:",v.error),s&&(console.log("👤 Falling back to user context data:",s),P({firstName:s.profile?.firstName||s.firstName||"",lastName:s.profile?.lastName||s.lastName||"",email:s.email||"",phone:s.profile?.phoneNumber||s.phoneNumber||"",location:s.profile?.city||s.city||"",bio:s.profile?.bio||s.bio||""})),D(f=>({...f,errors:[...f.errors,v.error||"Failed to load admin profile"]}))}catch(v){console.error("💥 Error loading admin profile:",v),s&&(console.log("👤 Falling back to user context data on error:",s),P({firstName:s.profile?.firstName||s.firstName||"",lastName:s.profile?.lastName||s.lastName||"",email:s.email||"",phone:s.profile?.phoneNumber||s.phoneNumber||"",location:s.profile?.city||s.city||"",bio:s.profile?.bio||s.bio||""})),D(f=>({...f,errors:[...f.errors,"Network error loading admin profile"]}))}finally{x(!1)}},[s]);i.useEffect(()=>{const f=Date.now()-M.startTime;D(W=>({...W,loadingTime:f}))},[E]),i.useEffect(()=>{w()},[w]);const A=i.useCallback(v=>{const{name:f,value:W}=v.target;P(Y=>({...Y,[f]:W})),y[f]&&L(Y=>({...Y,[f]:""}))},[y]),R=i.useCallback(v=>{const{name:f,value:W}=v.target;j(Y=>({...Y,[f]:W})),y[f]&&L(Y=>({...Y,[f]:""}))},[y]),H=i.useCallback(()=>{const v={};return N.firstName.trim()||(v.firstName="First name is required"),N.lastName.trim()||(v.lastName="Last name is required"),N.email.trim()?/\S+@\S+\.\S+/.test(N.email)||(v.email="Email is invalid"):v.email="Email is required",N.phone&&N.phone.replace(/\D/g,"").length<9&&(v.phone="Phone number must be at least 9 digits"),L(v),Object.keys(v).length===0},[N]),te=i.useCallback(()=>{const v={};return C.currentPassword||(v.currentPassword="Current password is required"),C.newPassword?C.newPassword.length<8&&(v.newPassword="Password must be at least 8 characters"):v.newPassword="New password is required",C.newPassword!==C.confirmPassword&&(v.confirmPassword="Passwords do not match"),L(v),Object.keys(v).length===0},[C]),ee=i.useCallback(async()=>{if(H())try{k(!0),D(f=>({...f,apiCalls:f.apiCalls+1}));const v=await je.updateAdminProfile(N);v.success?(b({type:"success",text:"Profile updated successfully!"}),o&&o({...s,...N}),setTimeout(()=>b({type:"",text:""}),3e3)):(b({type:"error",text:v.error||"Failed to update profile"}),D(f=>({...f,errors:[...f.errors,v.error||"Profile update failed"]})))}catch{b({type:"error",text:"Network error. Please try again."}),D(f=>({...f,errors:[...f.errors,"Network error during profile update"]}))}finally{k(!1)}},[N,H,o,s]),h=i.useCallback(async()=>{if(te())try{k(!0),D(f=>({...f,apiCalls:f.apiCalls+1}));const v=await je.changeAdminPassword({currentPassword:C.currentPassword,newPassword:C.newPassword});v.success?(b({type:"success",text:"Password changed successfully!"}),j({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>b({type:"",text:""}),3e3)):(b({type:"error",text:v.error||"Failed to change password"}),D(f=>({...f,errors:[...f.errors,v.error||"Password change failed"]})))}catch{b({type:"error",text:"Network error. Please try again."}),D(f=>({...f,errors:[...f.errors,"Network error during password change"]}))}finally{k(!1)}},[C,te]),_=i.useMemo(()=>m.text?e.jsxs(Ne.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center space-x-2 ${m.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[m.type==="success"?e.jsx(ze,{className:"w-5 h-5"}):e.jsx(Me,{className:"w-5 h-5"}),e.jsx("span",{children:m.text}),e.jsx("button",{onClick:()=>b({type:"",text:""}),className:"ml-auto hover:opacity-70 transition-opacity",children:e.jsx(xe,{className:"w-4 h-4"})})]}):null,[m]);return E?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your profile and system settings"})]})}),_,e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:g.map(v=>{const f=v.icon;return e.jsxs("button",{onClick:()=>l(v.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${p===v.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:v.label})]},v.id)})})}),e.jsxs("div",{className:"mt-6",children:[p==="profile"&&e.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(V,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:N.firstName,onChange:A,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.firstName?"border-red-300":"border-gray-300"}`}),y.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:N.lastName,onChange:A,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.lastName?"border-red-300":"border-gray-300"}`}),y.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:N.email,onChange:A,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.email?"border-red-300":"border-gray-300"}`}),y.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:N.phone,onChange:A,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.phone?"border-red-300":"border-gray-300"}`}),y.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:N.location,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{name:"bio",value:N.bio,onChange:A,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"Tell us about yourself..."})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(S,{variant:"primary",onClick:ee,disabled:u,children:[u?e.jsx(oe,{size:"sm"}):e.jsx(ms,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})})}),p==="security"&&e.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs(V,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:$?"text":"password",name:"currentPassword",value:C.currentPassword,onChange:R,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.currentPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>T(!$),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:$?e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ye,{className:"w-4 h-4 text-gray-400"})})]}),y.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:B?"text":"password",name:"newPassword",value:C.newPassword,onChange:R,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.newPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>t(!B),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:B?e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ye,{className:"w-4 h-4 text-gray-400"})})]}),y.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:C.confirmPassword,onChange:R,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${y.confirmPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>d(!r),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:r?e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ye,{className:"w-4 h-4 text-gray-400"})})]}),y.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.confirmPassword})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(S,{variant:"primary",onClick:h,disabled:u,children:[u?e.jsx(oe,{size:"sm"}):e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Change Password"]})})]})]})})]})]}),e.jsx(At,{loadingTime:M.loadingTime,apiCalls:M.apiCalls,cacheHits:M.cacheHits,errors:M.errors,showDetails:!0})]})},Mt=()=>{const[s,o]=i.useState([]),[p,l]=i.useState(!0),[u,k]=i.useState(""),[E,x]=i.useState(!1),[m,b]=i.useState(!1),[M,D]=i.useState(!1),[N,P]=i.useState(null),[C,j]=i.useState({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0}),[y,L]=i.useState(!1),[$,T]=i.useState(!1),B=i.useCallback(async()=>{try{l(!0),k("");const h=await fetch(`${ne.BASE_URL}/payment-methods/admin/all`,{headers:{Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`}});if(h.ok){const _=await h.json();o(_.paymentMethods||[])}else{const _=await h.json();k(_.error||"Failed to fetch payment methods")}}catch(h){console.error("Error fetching payment methods:",h),k("Network error. Please try again.")}finally{l(!1)}},[]);i.useEffect(()=>{B()},[B]);const t=()=>{j({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0})},r=()=>{t(),x(!0)},d=h=>{P(h),j({name:h.name,type:h.type,accountName:h.accountName,accountNumber:h.accountNumber,bankName:h.bankName||"",sortOrder:h.sortOrder,isActive:h.isActive}),b(!0)},g=h=>{P(h),D(!0)},w=()=>{x(!1),b(!1),D(!1),P(null),t()},A=async h=>{if(h.preventDefault(),!C.name||!C.type||!C.accountName||!C.accountNumber){z.error("Please fill in all required fields");return}try{L(!0);const _=m?`${ne.BASE_URL}/payment-methods/${N.id}`:`${ne.BASE_URL}/payment-methods`,f=await fetch(_,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify(C)}),W=await f.json();if(f.ok){const Y=m?"updated":"created";z.success(`Payment method ${Y} successfully!`),w(),B()}else z.error(W.error||`Failed to ${m?"update":"create"} payment method`)}catch(_){console.error("Error submitting payment method:",_),z.error("Network error. Please try again.")}finally{L(!1)}},R=async()=>{if(N)try{L(!0);const h=await fetch(`${ne.BASE_URL}/payment-methods/${N.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`}});if(h.ok)z.success("Payment method deleted successfully!"),w(),B();else{const _=await h.json();z.error(_.error||"Failed to delete payment method")}}catch(h){console.error("Error deleting payment method:",h),z.error("Network error. Please try again.")}finally{L(!1)}},H=async h=>{try{const _=await fetch(`${ne.BASE_URL}/payment-methods/${h.id}/toggle`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem(ne.AUTH_CONFIG.tokenKey)}`}});if(_.ok)z.success(`Payment method ${h.isActive?"deactivated":"activated"} successfully!`),B();else{const v=await _.json();z.error(v.error||"Failed to toggle payment method status")}}catch(_){console.error("Error toggling payment method status:",_),z.error("Network error. Please try again.")}},te=h=>{switch(h){case"mobile_money":return e.jsx(Us,{className:"h-4 w-4"});case"bank_transfer":return e.jsx(zs,{className:"h-4 w-4"});case"cash":return e.jsx(Oe,{className:"h-4 w-4"});default:return e.jsx(Oe,{className:"h-4 w-4"})}},ee=h=>{switch(h){case"mobile_money":return"Mobile Money";case"bank_transfer":return"Bank Transfer";case"cash":return"Cash";default:return h}};return p?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(oe,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Methods"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage payment methods for employer requests"})]}),e.jsxs(S,{onClick:r,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(fe,{className:"h-5 w-5 mr-2"}),"Add Payment Method"]})]})}),u&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-800",children:u})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Payment Methods (",s.length,")"]})}),s.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Oe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No payment methods found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first payment method to get started"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:s.map((h,_)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 cursor-move",disabled:$,children:e.jsx(Fs,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-gray-500",children:te(h.type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:h.name}),e.jsx(U,{variant:h.isActive?"success":"secondary",className:"ml-2",children:h.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",ee(h.type),h.bankName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Bank:"})," ",h.bankName]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Account:"})," ",h.accountName,e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Number:"})," ",h.accountNumber]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>H(h),className:h.isActive?"text-orange-600 hover:text-orange-700":"text-green-600 hover:text-green-700",children:h.isActive?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Activate"]})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>d(h),children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>g(h),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})},h.id))})]})]}),(E||m)&&e.jsx(Ce,{isOpen:E||m,onClose:w,title:m?"Edit Payment Method":"Add Payment Method",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Method Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:C.name,onChange:h=>j({...C,name:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., MTN MOMO, Airtel Money, Bank of Rwanda",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:C.type,onChange:h=>j({...C,type:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Holder Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:C.accountName,onChange:h=>j({...C,accountName:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Job Portal, Company Name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Number/Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:C.accountNumber,onChange:h=>j({...C,accountNumber:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 0788123456, 1234567890",required:!0})]}),C.type==="bank_transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:C.bankName,onChange:h=>j({...C,bankName:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Bank of Rwanda, Equity Bank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",value:C.sortOrder,onChange:h=>j({...C,sortOrder:parseInt(h.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lower numbers appear first in the list"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:C.isActive,onChange:h=>j({...C,isActive:h.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active (available for payments)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{type:"button",variant:"outline",onClick:w,disabled:y,children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),m?"Updating...":"Creating..."]}):m?"Update Method":"Create Method"})]})]})}),M&&N&&e.jsx(Ce,{isOpen:M,onClose:w,title:"Delete Payment Method",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-700",children:["Are you sure you want to delete the payment method ",e.jsxs("strong",{children:['"',N.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone. If this method is being used by existing payments, it cannot be deleted."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{variant:"outline",onClick:w,disabled:y,children:"Cancel"}),e.jsx(S,{variant:"danger",onClick:R,disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):"Delete Method"})]})]})}),e.jsx(Ve,{})]})},Lt=()=>{const[s,o]=i.useState(!1),[p,l]=i.useState(!1),[u,k]=i.useState(null),[E,x]=i.useState({personal:{name:"",title:"",location:"",email:"",phone:"",aboutMe:"",github:"",facebook:"",linkedin:"",twitter:"",instagram:""},skills:{frontend:[],backend:[],database:[],devops:[],design:[],management:[]},experience:[],education:[],certifications:[],projects:[]}),[m,b]=i.useState(null);i.useEffect(()=>{M()},[]);const M=async(t=0)=>{try{o(!0),k(null),console.log("🔍 AdminProfileManagement: Loading profile data...");const d=await ns.getPublicProfile();console.log("✅ AdminProfileManagement: Profile data loaded:",d),x(d)}catch(d){if(console.error("❌ AdminProfileManagement: Error loading profile data:",d),t<2){console.log(`🔄 Retrying profile load... (${t+1}/2)`),setTimeout(()=>{M(t+1)},2e3*(t+1));return}k("Failed to load profile data after multiple attempts. Please try again."),Ae.error("Failed to load profile data")}finally{o(!1)}},D=async()=>{try{l(!0),console.log("🔍 AdminProfileManagement: Saving profile data...");try{await ns.updateProfile(E),Ae.success("Profile updated successfully!"),b(null),console.log("✅ AdminProfileManagement: Profile saved successfully")}catch(t){if(console.error("❌ AdminProfileManagement: Update failed, trying to create new profile..."),t.response?.status===404)Ae.info("Creating new profile..."),await M(),Ae.success("Profile created successfully!");else throw t}}catch(t){console.error("❌ AdminProfileManagement: Error saving profile data:",t),Ae.error("Failed to save profile data. Please check your authentication.")}finally{l(!1)}},N=(t,r)=>{x(d=>({...d,[t]:[...d[t]||[],r]}))},P=(t,r,d)=>{x(g=>({...g,[t]:g[t].map((w,A)=>A===r?d:w)}))},C=(t,r)=>{x(d=>({...d,[t]:d[t].filter((g,w)=>w!==r)}))};if(s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading profile data..."})]})});if(!E)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Profile Data Not Available"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load profile data. Please try refreshing the page."}),e.jsx("button",{onClick:M,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})});const j=E.personal||{},y=E.skills||{},L=E.experience||[],$=E.education||[],T=E.certifications||[],B=E.projects||[];return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(Ne.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Profile Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your professional profile and platform information"})]}),u&&e.jsx(Ne.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Profile"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:u}),e.jsx("button",{onClick:M,className:"mt-2 text-sm text-red-600 hover:text-red-500 font-medium",children:"Try Again"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-blue-600"}),"Personal Information"]}),e.jsx(S,{onClick:()=>b(m==="personal"?null:"personal"),variant:"outline",size:"sm",children:m==="personal"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="personal"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:j.name,onChange:t=>x(r=>({...r,personal:{...r.personal,name:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:j.title,onChange:t=>x(r=>({...r,personal:{...r.personal,title:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:j.location,onChange:t=>x(r=>({...r,personal:{...r.personal,location:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:j.email,onChange:t=>x(r=>({...r,personal:{...r.personal,email:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:j.phone,onChange:t=>x(r=>({...r,personal:{...r.personal,phone:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GitHub"}),e.jsx("input",{type:"text",value:j.github,onChange:t=>x(r=>({...r,personal:{...r.personal,github:t.target.value}})),placeholder:"github.com/username",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Facebook"}),e.jsx("input",{type:"text",value:j.facebook,onChange:t=>x(r=>({...r,personal:{...r.personal,facebook:t.target.value}})),placeholder:"facebook.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn"}),e.jsx("input",{type:"text",value:j.linkedin,onChange:t=>x(r=>({...r,personal:{...r.personal,linkedin:t.target.value}})),placeholder:"linkedin.com/in/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Twitter/X"}),e.jsx("input",{type:"text",value:j.twitter,onChange:t=>x(r=>({...r,personal:{...r.personal,twitter:t.target.value}})),placeholder:"twitter.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instagram"}),e.jsx("input",{type:"text",value:j.instagram,onChange:t=>x(r=>({...r,personal:{...r.personal,instagram:t.target.value}})),placeholder:"instagram.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"About Me"}),e.jsx("textarea",{value:j.aboutMe,onChange:t=>x(r=>({...r,personal:{...r.personal,aboutMe:t.target.value}})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:j.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:j.title})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ge,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:j.location})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:j.email})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:j.phone})]}),j.github&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Is,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:j.github})]}),j.facebook&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_s,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-gray-700",children:j.facebook})]}),j.linkedin&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qs,{className:"w-4 h-4 text-blue-700"}),e.jsx("span",{className:"text-gray-700",children:j.linkedin})]}),j.twitter&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bs,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-gray-700",children:j.twitter})]}),j.instagram&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Js,{className:"w-4 h-4 text-pink-600"}),e.jsx("span",{className:"text-gray-700",children:j.instagram})]}),j.aboutMe&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsx("p",{className:"text-gray-700 text-sm",children:j.aboutMe})})]})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ts,{className:"w-5 h-5 text-blue-600"}),"Skills"]}),e.jsx(S,{onClick:()=>b(m==="skills"?null:"skills"),variant:"outline",size:"sm",children:m==="skills"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="skills"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Add New Skill Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Category name (e.g., Design, Marketing, Languages)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm",onKeyPress:t=>{if(t.key==="Enter"&&t.target.value.trim()){const r=t.target.value.trim().toLowerCase();y[r]||(x(d=>({...d,skills:{...d.skills,[r]:[]}})),t.target.value="")}}}),e.jsxs(S,{onClick:t=>{const r=t.target.previousElementSibling,d=r.value.trim().toLowerCase();d&&!y[d]&&(x(g=>({...g,skills:{...g.skills,[d]:[]}})),r.value="")},variant:"outline",size:"sm",className:"whitespace-nowrap",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Category"]})]})]}),Object.entries(y).map(([t,r])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",value:t,onChange:d=>{const g=d.target.value.trim().toLowerCase();if(g&&g!==t){const w={...y};w[g]=w[t],delete w[t],x(A=>({...A,skills:w}))}},className:"font-semibold text-gray-800 capitalize bg-transparent border-b border-transparent hover:border-gray-300 focus:border-blue-500 focus:outline-none px-1 py-1",placeholder:"Category name"})}),e.jsx(S,{onClick:()=>{if(Object.keys(y).length>1){const d={...y};delete d[t],x(g=>({...g,skills:d}))}},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",disabled:Object.keys(y).length<=1,children:e.jsx(ie,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"space-y-2",children:[r.map((d,g)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:d,onChange:w=>{const A=[...r];A[g]=w.target.value,x(R=>({...R,skills:{...R.skills,[t]:A}}))},placeholder:"Skill name",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx(S,{onClick:()=>{const w=r.filter((A,R)=>R!==g);x(A=>({...A,skills:{...A.skills,[t]:w}}))},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(ie,{className:"w-3 h-3"})})]},g)),e.jsxs(S,{onClick:()=>{const d=[...r,""];x(g=>({...g,skills:{...g.skills,[t]:d}}))},variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Skill"]})]})]},t))]}):e.jsx("div",{className:"space-y-4",children:Object.entries(y).map(([t,r])=>e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2 capitalize",children:t}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((d,g)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:d},g))})]},t))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-blue-600"}),"Professional Experience"]}),e.jsx(S,{onClick:()=>b(m==="experience"?null:"experience"),variant:"outline",size:"sm",children:m==="experience"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="experience"?e.jsxs("div",{className:"space-y-4",children:[L.map((t,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.position,onChange:d=>P("experience",r,{...t,position:d.target.value}),placeholder:"Job Position",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.company,onChange:d=>P("experience",r,{...t,company:d.target.value}),placeholder:"Company Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.period,onChange:d=>P("experience",r,{...t,period:d.target.value}),placeholder:"Employment Period (e.g., 2020-2023)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("textarea",{value:t.description,onChange:d=>P("experience",r,{...t,description:d.target.value}),placeholder:"Job Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Achievements (one per line)"}),e.jsx("textarea",{value:t.achievements?t.achievements.join(`
`):"",onChange:d=>P("experience",r,{...t,achievements:d.target.value.split(`
`).filter(g=>g.trim())}),placeholder:"List your key achievements...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs(S,{onClick:()=>C("experience",r),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove Experience"]})]},r)),e.jsxs(S,{onClick:()=>N("experience",{position:"",company:"",period:"",description:"",achievements:[]}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Experience"]})]}):e.jsx("div",{className:"space-y-4",children:L.length>0?L.map((t,r)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.position}),e.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t.period})]}),e.jsx("h4",{className:"text-md font-medium text-blue-600 mb-2",children:t.company}),e.jsx("p",{className:"text-gray-700 mb-3 leading-relaxed",children:t.description}),t.achievements&&t.achievements.length>0&&e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.achievements.map((d,g)=>e.jsx("li",{className:"text-sm text-gray-600",children:d},g))})]},r)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No experience added yet."})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Os,{className:"w-5 h-5 text-blue-600"}),"Education"]}),e.jsx(S,{onClick:()=>b(m==="education"?null:"education"),variant:"outline",size:"sm",children:m==="education"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="education"?e.jsxs("div",{className:"space-y-4",children:[$.map((t,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.degree,onChange:d=>P("education",r,{...t,degree:d.target.value}),placeholder:"Degree/Qualification",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.school,onChange:d=>P("education",r,{...t,school:d.target.value}),placeholder:"School/University",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.period,onChange:d=>P("education",r,{...t,period:d.target.value}),placeholder:"Study Period (e.g., 2016-2020)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("textarea",{value:t.description,onChange:d=>P("education",r,{...t,description:d.target.value}),placeholder:"Description of your studies",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(S,{onClick:()=>C("education",r),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove Education"]})]},r)),e.jsxs(S,{onClick:()=>N("education",{degree:"",school:"",period:"",description:""}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Education"]})]}):e.jsx("div",{className:"space-y-4",children:$.length>0?$.map((t,r)=>e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.degree}),e.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t.period})]}),e.jsx("h4",{className:"text-md font-medium text-green-600 mb-1",children:t.school}),e.jsx("p",{className:"text-gray-700 text-sm",children:t.description})]},r)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No education added yet."})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Hs,{className:"w-5 h-5 text-blue-600"}),"Certifications"]}),e.jsx(S,{onClick:()=>b(m==="certifications"?null:"certifications"),variant:"outline",size:"sm",children:m==="certifications"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="certifications"?e.jsxs("div",{className:"space-y-4",children:[T.map((t,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 space-y-2",children:[e.jsx("input",{type:"text",value:t.name,onChange:d=>P("certifications",r,{...t,name:d.target.value}),placeholder:"Certification Name",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx("input",{type:"text",value:t.issuer,onChange:d=>P("certifications",r,{...t,issuer:d.target.value}),placeholder:"Issuing Organization",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx("input",{type:"text",value:t.year,onChange:d=>P("certifications",r,{...t,year:d.target.value}),placeholder:"Year",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsxs(S,{onClick:()=>C("certifications",r),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove"]})]},r)),e.jsxs(S,{onClick:()=>N("certifications",{name:"",issuer:"",year:""}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Certification"]})]}):e.jsx("div",{className:"space-y-3",children:T.length>0?T.map((t,r)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-3",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.issuer," • ",t.year]})]},r)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No certifications added yet."})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ts,{className:"w-5 h-5 text-blue-600"}),"Key Projects"]}),e.jsx(S,{onClick:()=>b(m==="projects"?null:"projects"),variant:"outline",size:"sm",children:m==="projects"?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),m==="projects"?e.jsxs("div",{className:"space-y-4",children:[B.map((t,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.name,onChange:d=>P("projects",r,{...t,name:d.target.value}),placeholder:"Project Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs("select",{value:t.status,onChange:d=>P("projects",r,{...t,status:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"development",children:"Development"}),e.jsx("option",{value:"completed",children:"Completed"})]}),e.jsx("textarea",{value:t.description,onChange:d=>P("projects",r,{...t,description:d.target.value}),placeholder:"Project Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:Array.isArray(t.tech)?t.tech.join(", "):t.tech,onChange:d=>P("projects",r,{...t,tech:d.target.value.split(",").map(g=>g.trim()).filter(g=>g)}),placeholder:"Technologies (comma-separated)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(S,{onClick:()=>C("projects",r),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Remove Project"]})]},r)),e.jsxs(S,{onClick:()=>N("projects",{name:"",status:"development",description:"",tech:[]}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Add Project"]})]}):e.jsx("div",{className:"space-y-4",children:B.length>0?B.map((t,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="live"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]}),e.jsx("p",{className:"text-gray-700 mb-3 text-sm leading-relaxed",children:t.description}),t.tech&&t.tech.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tech.map((d,g)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:d},g))})]},r)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No projects added yet."})})]})]})]}),e.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 text-center",children:e.jsx(S,{onClick:D,disabled:p,className:"px-8 py-3 text-lg",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ms,{className:"w-5 h-5 mr-2"}),"Save All Changes"]})})})]})})},ea=()=>{const{t:s}=We(),{user:o,logout:p}=xs(),l=Gs(),{liveData:u,lastUpdate:k,isConnected:E,manualRefresh:x,addNotification:m}=Ws(),[b,M]=i.useState("dashboard"),[D,N]=i.useState(!0),[P,C]=i.useState(null),[j,y]=i.useState(!1),[L,$]=i.useState(""),[T,B]=i.useState(""),[t,r]=i.useState(null),[d,g]=i.useState(!0),[w,A]=i.useState(null),[R,H]=i.useState("all"),[te,ee]=i.useState(!1),[h,_]=i.useState(!1),[v,f]=i.useState(!1),[W,Y]=i.useState(!1),{jobSeekers:le,loading:Se,fetchJobSeekers:Pe}=us({autoFetch:!1,itemsPerPage:5}),{requests:ce,loading:ue,fetchRequests:ge}=gs({autoFetch:!1}),{fetchCategories:ae}=st({autoFetch:!1}),c=async(q=0)=>{try{g(!0),A(null),console.log(`🔄 Loading dashboard data sequentially... (attempt ${q+1})`);try{ee(!0),console.log("📊 Loading dashboard statistics...");const X=await je.getDashboardStats();X.success?(r(X.data),console.log("✅ Dashboard statistics loaded")):console.warn("⚠️ Failed to load dashboard statistics")}catch(X){console.error("❌ Error loading dashboard statistics:",X)}finally{ee(!1)}try{_(!0),console.log("👥 Loading job seekers data..."),await Pe(),console.log("✅ Job seekers data loaded")}catch(X){console.error("❌ Error loading job seekers:",X)}finally{_(!1)}try{f(!0),console.log("📝 Loading employer requests..."),await ge(),console.log("✅ Employer requests loaded")}catch(X){console.error("❌ Error loading employer requests:",X)}finally{f(!1)}try{Y(!0),console.log("🏷️ Loading job categories..."),await ae(),console.log("✅ Job categories loaded")}catch(X){console.error("❌ Error loading job categories:",X)}finally{Y(!1)}console.log("✅ Dashboard data loading completed")}catch(X){if(console.error("❌ Critical error in dashboard loading:",X),q<2){console.log(`🔄 Retrying dashboard load... (${q+1}/2)`),setTimeout(()=>{c(q+1)},2e3*(q+1));return}A("Failed to load dashboard data after multiple attempts. Please refresh the page."),m({message:"Dashboard failed to load. Please refresh.",type:"error",duration:1e4})}finally{g(!1)}},a=async()=>{try{g(!0),await c(),m({message:"Dashboard refreshed successfully",type:"success",duration:3e3})}catch{A("Failed to refresh dashboard data"),m({message:"Failed to refresh dashboard",type:"error",duration:5e3})}finally{g(!1)}};i.useEffect(()=>{u.dashboard&&r(u.dashboard),u.requests,u.jobSeekers},[u]);const n=()=>{p(),l("/")},O=q=>{C(q),$(q.adminNotes||""),y(!0)},J=async(q,G,X)=>{try{const de=await je.updateRequestStatus(q,{status:G,adminNotes:X});de.success?(await ge(),y(!1),C(null),$(""),m({message:`Request ${G==="completed"?"marked as completed":"status updated"} successfully!`,type:"success",duration:5e3})):m({message:`Error: ${de.error}`,type:"error",duration:5e3})}catch(de){m({message:"Failed to update request status",type:"error",duration:5e3}),console.error("Request update error:",de)}},se=q=>{B(q)},Ie=()=>{};if(i.useEffect(()=>{c()},[]),d)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(oe,{size:"lg",text:"Loading Dashboard..."})});if(w)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Dashboard Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:w}),e.jsx(S,{onClick:c,className:"w-full",children:"Retry"})]})});const $e=()=>{const q=t||{},G=q.data||q,X=I=>{if(!Array.isArray(I))return[];const Z={};return I.forEach(F=>{F.profile?.skills&&F.profile.skills.split(",").map(re=>re.trim()).forEach(re=>{Z[re]=(Z[re]||0)+1})}),Object.entries(Z).map(([F,K])=>({name:F,count:K})).sort((F,K)=>K.count-F.count).slice(0,5)},de=(I,Z=0)=>{if(Z===0)return I>0?{change:"+100%",changeType:"increase"}:{change:"0%",changeType:"neutral"};const F=(I-Z)/Z*100,K=F>=0?`+${Math.round(F)}%`:`${Math.round(F)}%`,re=F>0?"increase":F<0?"decrease":"neutral";return{change:K,changeType:re}},Ye=(I,Z=7)=>{const F=new Date,K=new Date(F.getTime()-Z*24*60*60*1e3),re=new Date(F.getTime()-Z*2*24*60*60*1e3),qe=I.filter(Be=>new Date(Be.createdAt)>=K).length,me=I.filter(Be=>{const es=new Date(Be.createdAt);return es>=re&&es<K}).length;return de(qe,me)},Xe=Ye(le||[]),Qe=Ye(ce||[]),Ze=de((ce||[]).filter(I=>I.status==="pending").length,Math.max(1,Math.floor((ce||[]).filter(I=>I.status==="pending").length*.8))),Ke=de(G.overview?.totalCategories||G.totalCategories||0,Math.max(1,Math.floor((G.overview?.totalCategories||G.totalCategories||0)*.9)));return X(le||[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:a,disabled:d,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:d?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})}),e.jsx(rt,{isConnected:E,lastUpdate:k,onRefresh:x,className:"text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 ",children:[e.jsx(Te,{title:"Total Job Seekers",value:G.overview?.totalJobSeekers||G.totalJobSeekers||0,icon:Ue,change:Xe.change,changeType:Xe.changeType,color:"text-blue-600",bgColor:"bg-blue-100",description:"Active job seekers",index:0,trendPeriod:"7 days",loading:te}),e.jsx(Te,{title:"Employer Requests",value:G.overview?.totalEmployerRequests||G.totalEmployerRequests||0,icon:we,change:Qe.change,changeType:Qe.changeType,color:"text-green-600",bgColor:"bg-green-100",description:"Total requests",index:1,trendPeriod:"7 days",loading:v}),e.jsx(Te,{title:"Pending Requests",value:G.overview?.pendingEmployerRequests||G.pendingEmployerRequests||0,icon:Le,change:Ze.change,changeType:Ze.changeType,color:"text-orange-600",bgColor:"bg-orange-100",description:"Awaiting review",index:2,trendPeriod:"7 days",loading:v}),e.jsx(Te,{title:"Categories",value:G.overview?.totalCategories||G.totalCategories||0,icon:De,change:Ke.change,changeType:Ke.changeType,color:"text-purple-600",bgColor:"bg-purple-100",description:"Job categories",index:3,showTrend:!1,loading:W})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(V,{title:"Latest Job Seekers",subtitle:"Most recently registered candidates (showing latest 5)",children:Se?e.jsx(oe,{size:"md",text:"Loading job seekers..."}):(G.recentActivity?.recentJobSeekers||le||[]).length>0?e.jsx("div",{className:"space-y-3",children:(G.recentActivity?.recentJobSeekers||le||[]).slice(0,5).map((I,Z)=>{const F=(le||[]).find(me=>me.id===I.id)||I,K=F?.profile?.photo||F?.avatar||F?.photo||null,qe=(me=>me?/^https?:\/\//i.test(me)?me:`${ne.BASE_URL}/${me.replace(/^\//,"")}`:null)(K);return e.jsx(nt,{jobSeeker:{id:I.id,name:I.name||`${I?.profile?.firstName||""} ${I?.profile?.lastName||""}`.trim()||"Unknown",title:"Job Seeker",category:I.skills?.split(",")[0]||"General",avatar:qe,location:I.location||I?.profile?.location||"Unknown",dailyRate:I.dailyRate,monthlyRate:I.monthlyRate},onViewDetails:O,getCategoryColor:Xs,compact:!0},I.id||Z)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ue,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent job seekers"})]})}),e.jsxs(V,{title:"Latest Employer Requests",subtitle:"Most recent job requests with candidate details (showing latest 5)",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx("button",{onClick:()=>H("all"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${R==="all"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>H("pending"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${R==="pending"?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Pending"}),e.jsx("button",{onClick:()=>H("in_progress"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${R==="in_progress"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"In Progress"}),e.jsx("button",{onClick:()=>H("approved"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${R==="approved"?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Approved"}),e.jsx("button",{onClick:()=>H("completed"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${R==="completed"?"bg-purple-100 text-purple-800 border-purple-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Completed"})]})}),ue?e.jsx(oe,{size:"md",text:"Loading requests..."}):(ce||[]).length>0?e.jsx("div",{className:"space-y-3",children:(()=>{const Z=(ce||[]).filter(F=>{if(R==="all")return!0;const K=F.status?.toLowerCase()||"pending",re=R.toLowerCase();return K===re}).slice(0,5);return Z.length===0&&R!=="all"?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(we,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),e.jsxs("p",{className:"text-sm",children:["No ",R," requests found"]})]}):Z.map((F,K)=>e.jsx(lt,{request:{...F,companyName:F.companyName||"Individual Employer",status:F.status||"pending",priority:F.priority||"normal",selectedUser:F.selectedUser||null,requestedCandidate:F.requestedCandidate||null},onContactEmployer:Ks,onViewDetails:O,getStatusColor:Zs,getPriorityColor:Qs,compact:!0},F.id||K))})()}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(we,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent requests"})]})]})]})]})},_e=()=>{switch(b){case"dashboard":return $e();case"job-seekers":return e.jsx(tt,{});case"requests":return e.jsx(Ys,{});case"contact-messages":return e.jsx(Pt,{});case"categories":return e.jsx(at,{});case"reports-statistics":return e.jsx(Vs,{});case"reports-tables":return e.jsx(kt,{});case"settings":return e.jsx(Et,{});case"payment-methods":return e.jsx(Mt,{});case"profile":return e.jsx(Lt,{});default:return $e()}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(xt,{user:o,onLogout:n,onSearch:se,onFilter:Ie,searchTerm:T,onRefresh:a}),e.jsxs("div",{className:"flex",children:[e.jsx(mt,{sidebarOpen:D,setSidebarOpen:N,navigationItems:[{id:"dashboard",label:"Dashboard",icon:"Home"},{id:"job-seekers",label:"Job Seekers",icon:"Users"},{id:"requests",label:"Employer Requests",icon:"MessageSquare"},{id:"contact-messages",label:"Contact Messages",icon:"Mail"},{id:"categories",label:"Categories",icon:"Briefcase"},{id:"reports",label:"Reports",icon:"BarChart3",subItems:[{id:"reports-statistics",label:"Statistics Reports"},{id:"reports-tables",label:"Table Reports"}]},{id:"settings",label:"Settings",icon:"Settings"},{id:"payment-methods",label:"Payment Methods",icon:"CreditCard"},{id:"profile",label:"Profile",icon:"Shield"}],activeTab:b,setActiveTab:M,user:o,onLogout:n}),e.jsx("div",{className:"flex-1 transition-all duration-300 ml-0",children:e.jsx("div",{className:"p-4 lg:p-6",children:_e()})})]}),j&&P&&e.jsx(Ce,{isOpen:j,onClose:()=>y(!1),title:"Update Request Status",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:P.status,onChange:q=>C({...P,status:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes"}),e.jsx("textarea",{value:L,onChange:q=>$(q.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Add notes about this request..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{onClick:()=>y(!1),variant:"outline",children:"Cancel"}),e.jsx(S,{onClick:()=>J(P.id,P.status,L),className:"bg-red-600 hover:bg-red-700",children:"Update Status"})]})]})})]})};export{ea as default};
