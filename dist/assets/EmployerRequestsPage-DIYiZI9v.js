import{r,j as e,R as $a}from"./vendor-react-P9HPe7xp.js";import{l as W,h as G,n as me,C as ga,u as Ia,L as Ba,B as C,A as $,d as ze}from"./index-L80bQVm6.js";import{a as za}from"./useCategories-BbPsme3-.js";import{m as je}from"./messagingService-CBeQULYw.js";import{D as Oa}from"./DataTable-CzMpEsXG.js";import{m as We}from"./vendor-motion-Dcrv-VGC.js";import{ab as Ua,ae as Wa,aY as Oe,a_ as Ga,ac as Ha,ad as Ne,b0 as ve,aG as ca,aa as Re,aH as Ja,aN as Va,aZ as Ka,bj as Ya,aX as Qa,bu as Xa,au as Za,bv as es,bk as M,bw as as}from"./vendor-common-QxmXWwBZ.js";import{M as ue}from"./Modal-BHRNIglG.js";import{B as da}from"./Badge-5syhZQRK.js";import{A as Ue}from"./Avatar-BXU_UCay.js";const pe={submitRequest:async i=>{try{const c=await W.post("/employer/request",i);return{success:!0,data:c.data.request,message:c.data.message}}catch(c){if(c.response?.data){const{data:o}=c.response;if(o.details&&Array.isArray(o.details))return{success:!1,error:o.details.map(u=>`${u.field}: ${u.message}`).join(", ")};if(o.error)return{success:!1,error:o.error};if(o.message)return{success:!1,error:o.message}}return{success:!1,error:G(c,{context:"submit_employer_request"}).userMessage}}},getAllRequests:async(i={})=>{try{const{page:c=1,limit:l=10,status:o,priority:m,search:u,sortBy:v,sortOrder:b,category:H,dateFrom:x,dateTo:I,...J}=i,p=new URLSearchParams({page:c.toString(),limit:l.toString(),...J});o&&p.append("status",o),m&&p.append("priority",m),u&&p.append("search",u),v&&p.append("sortBy",v),b&&p.append("sortOrder",b),H&&p.append("category",H),x&&p.append("dateFrom",x),I&&p.append("dateTo",I);const R=await W.get(`/employer/requests?${p}`,{headers:me()});return{success:!0,data:{requests:R.data.requests||[],pagination:R.data.pagination||{page:parseInt(c),limit:parseInt(l),total:0,totalPages:1}}}}catch(c){return c.response?.data?.error?{success:!1,error:c.response.data.error}:{success:!1,error:G(c,{context:"get_all_employer_requests"}).userMessage}}},getRequestById:async i=>{try{return{success:!0,data:(await W.get(`/employer/requests/${i}`,{headers:me()})).data}}catch(c){return c.response?.data?.error?{success:!1,error:c.response.data.error}:{success:!1,error:G(c,{context:"get_employer_request_by_id"}).userMessage}}},replyToRequest:async(i,c)=>{try{const l=await W.post(`/employer/requests/${i}/reply`,c,{headers:me()});return{success:!0,data:l.data.messageData,message:l.data.message}}catch(l){if(l.response?.data){const{data:m}=l.response;if(m.details&&Array.isArray(m.details))return{success:!1,error:m.details.map(v=>`${v.field}: ${v.message}`).join(", ")};if(m.error)return{success:!1,error:m.error};if(m.message)return{success:!1,error:m.message}}return{success:!1,error:G(l,{context:"reply_to_employer_request"}).userMessage}}},selectJobSeeker:async(i,c,l="picture")=>{try{const o=await W.post(`/employer/requests/${i}/select`,{selectedUserId:c,detailsType:l},{headers:me()});return{success:!0,data:o.data.request,message:o.data.message}}catch(o){if(o.response?.data){const{data:u}=o.response;if(u.details&&Array.isArray(u.details))return{success:!1,error:u.details.map(b=>`${b.field}: ${b.message}`).join(", ")};if(u.error)return{success:!1,error:u.error};if(u.message)return{success:!1,error:u.message}}return{success:!1,error:G(o,{context:"select_job_seeker_for_request"}).userMessage}}},updateRequestStatus:async(i,c)=>{try{const l=await W.put(`/employer/requests/${i}/status`,c,{headers:me()});return{success:!0,data:l.data.request,message:l.data.message}}catch(l){if(l.response?.data){const{data:m}=l.response;if(m.details&&Array.isArray(m.details))return{success:!1,error:m.details.map(v=>`${v.field}: ${v.message}`).join(", ")};if(m.error)return{success:!1,error:m.error};if(m.message)return{success:!1,error:m.message}}return{success:!1,error:G(l,{context:"update_request_status"}).userMessage}}},getRequestStatistics:async()=>{try{const i=await W.get("/admin/dashboard/stats",{headers:me()});return{success:!0,data:{totalRequests:i.data.overview?.totalEmployerRequests||0,pendingRequests:i.data.overview?.pendingEmployerRequests||0,recentRequests:i.data.recentActivity?.recentEmployerRequests||[],requestDistribution:i.data.distributions?.employerRequests||[]}}}catch(i){return i.response?.data?.error?{success:!1,error:i.response.data.error}:{success:!1,error:G(i,{context:"get_request_statistics"}).userMessage}}},getPublicConversation:async(i,c)=>{try{return{success:!0,data:(await W.get(`/public/employer/requests/${i}`,{params:{email:c}})).data}}catch(l){return l.response?.data?.error?{success:!1,error:l.response.data.error}:{success:!1,error:G(l,{context:"get_public_conversation"}).userMessage}}},replyAsEmployer:async(i,c,l)=>{try{const o=await W.post(`/public/employer/requests/${i}/reply`,{...l,email:c});return{success:!0,data:o.data.messageData,message:o.data.message}}catch(o){if(o.response?.data){const{data:u}=o.response;if(u.details&&Array.isArray(u.details))return{success:!1,error:u.details.map(b=>`${b.field}: ${b.message}`).join(", ")};if(u.error)return{success:!1,error:u.error};if(u.message)return{success:!1,error:u.message}}return{success:!1,error:G(o,{context:"reply_as_employer"}).userMessage}}}},xa=(i={})=>{const{autoFetch:c=!0,includeAdmin:l=!1,itemsPerPage:o=10}=i,[m,u]=r.useState([]),[v,b]=r.useState(!1),[H,x]=r.useState(null),[I,J]=r.useState(null),[p,R]=r.useState(1),[s,q]=r.useState(1),[ge,xe]=r.useState(0),[Y,V]=r.useState({}),[w,Q]=r.useState(""),[D,ae]=r.useState({}),[A,he]=r.useState("createdAt"),[P,we]=r.useState("desc"),k=r.useCallback(async(d=p,g=w,h=D,j={field:A,order:P})=>{if(l){b(!0),x(null);try{const _={page:d,limit:o,search:g,sortBy:j.field,sortOrder:j.order,...h},E=await pe.getAllRequests(_);E.success?(u(E.data.requests||[]),q(E.data.pagination?.totalPages||1),xe(E.data.pagination?.total||0),R(E.data.pagination?.page||1),V(E.data.pagination||{})):x(E.error||"Failed to fetch requests")}catch(_){x("An error occurred while fetching requests"),console.error("Error fetching requests:",_)}finally{b(!1)}}},[l,o,p,w,D,A,P]),se=r.useCallback(async d=>{b(!0),x(null);try{const g=await pe.submitRequest(d);return g.success?{success:!0,data:g.data}:(x(g.error||"Failed to submit request"),{success:!1,error:g.error})}catch{const h="An error occurred while submitting request";return x(h),{success:!1,error:h}}finally{b(!1)}},[]),Ge=r.useCallback(async d=>{if(!l||!d)return null;b(!0),x(null);try{const g=await pe.getRequestById(d);return g.success?(J(g.data),{success:!0,data:g.data}):(x(g.error||"Failed to fetch request"),{success:!1,error:g.error})}catch{const h="An error occurred while fetching request";return x(h),{success:!1,error:h}}finally{b(!1)}},[l]),Ae=r.useCallback(async(d,g)=>{if(!l)return{success:!1,error:"Unauthorized"};b(!0),x(null);try{const h=await pe.replyToRequest(d,g);return h.success?(await k(),{success:!0,data:h.data}):(x(h.error||"Failed to reply to request"),{success:!1,error:h.error})}catch{const j="An error occurred while replying to request";return x(j),{success:!1,error:j}}finally{b(!1)}},[l,k]),te=r.useCallback(async(d,g,h="picture")=>{if(!l)return{success:!1,error:"Unauthorized"};b(!0),x(null);try{const j=await pe.selectJobSeeker(d,g,h);return j.success?(await k(),{success:!0,data:j.data}):(x(j.error||"Failed to send candidate information"),{success:!1,error:j.error})}catch{const _="An error occurred while sending candidate information";return x(_),{success:!1,error:_}}finally{b(!1)}},[l,k]),Ce=r.useCallback(async(d,g)=>{if(!l)return{success:!1,error:"Unauthorized"};b(!0),x(null);try{const h=await pe.updateRequestStatus(d,g);return h.success?(await k(),{success:!0,data:h.data}):(x(h.error||"Failed to update request status"),{success:!1,error:h.error})}catch{const j="An error occurred while updating request status";return x(j),{success:!1,error:j}}finally{b(!1)}},[l,k]),K=r.useCallback(d=>{R(d),k(d,w,D,{field:A,order:P})},[k,w,D,A,P]),re=r.useCallback(()=>{p<s&&K(p+1)},[p,s,K]),He=r.useCallback(()=>{p>1&&K(p-1)},[p,K]),Je=r.useMemo(()=>p<s,[p,s]),Ve=r.useMemo(()=>p>1,[p]),Ke=r.useCallback(d=>{Q(d),R(1)},[]),X=r.useCallback((d,g)=>{const h={...D,[d]:g};ae(h),R(1)},[D]),ye=r.useCallback((d,g)=>{he(d),we(g)},[]),ne=r.useCallback(()=>{k(p,w,D,{field:A,order:P})},[k,p,w,D,A,P]);r.useEffect(()=>{l&&ne()},[ne,l]);const le=r.useCallback(d=>{J(d)},[]),oe=r.useCallback(()=>{J(null)},[]),be=r.useMemo(()=>m.filter(d=>!0),[m]);return r.useEffect(()=>{c&&l&&k()},[k,c,l]),r.useEffect(()=>{x(null)},[I]),{requests:be,selectedRequest:I,loading:v,error:H,currentPage:p,totalPages:s,totalItems:ge,pageInfo:Y,hasNextPage:Je,hasPrevPage:Ve,searchTerm:w,filters:D,sortBy:A,sortOrder:P,fetchRequests:k,submitRequest:se,getRequestById:Ge,replyToRequest:Ae,selectJobSeekerForRequest:te,updateRequestStatus:Ce,goToPage:K,nextPage:re,prevPage:He,setSearchTerm:Ke,setFilters:X,setSortBy:d=>ye(d,P),setSortOrder:d=>ye(A,d),applyFilters:ne,selectRequest:le,clearSelection:oe,hasRequests:m.length>0,requestsCount:m.length,isAdmin:l}},xs=(i={})=>xa({...i,includeAdmin:!0}),ss=({title:i,value:c,change:l,changeType:o="increase",icon:m,color:u,bgColor:v,description:b,index:H=0,trendPeriod:x="7 days",showTrend:I=!0})=>e.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:H*.1},children:e.jsxs(ga,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`w-12 h-12 ${v} rounded-lg flex items-center justify-center`,children:e.jsx(m,{className:`w-6 h-6 ${u}`})}),I&&l&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`flex items-center space-x-1 text-sm ${o==="increase"?"text-green-600":o==="decrease"?"text-red-600":"text-gray-500"}`,children:[o==="increase"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 17l9.2-9.2M17 17V7H7"})}):o==="decrease"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 7l-9.2 9.2M7 7v10h10"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14"})}),e.jsx("span",{children:l})]}),e.jsxs("div",{className:"group relative",children:[e.jsx(Ua,{className:"w-3 h-3 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute bottom-full right-0 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:["Trend based on last ",x]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:c}),e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:i}),e.jsx("p",{className:"text-xs text-gray-500",children:b})]})]})}),ma=i=>{switch(i?.toLowerCase()){case"pending":return"text-orange-600 bg-orange-50 border-orange-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"approved":return"text-green-600 bg-green-50 border-green-200";case"completed":return"text-purple-600 bg-purple-50 border-purple-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";case"rejected":return"text-red-600 bg-red-50 border-red-200";case"active":return"text-green-600 bg-green-50 border-green-200";case"inactive":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},hs=i=>{switch(i?.toLowerCase()){case"pending":return"Pending";case"in_progress":return"In Progress";case"approved":return"Approved";case"completed":return"Completed";case"cancelled":return"Cancelled";case"rejected":return"Rejected";case"active":return"Active";case"inactive":return"Inactive";default:return i||"Unknown"}},ua=i=>{switch(i){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-orange-600 bg-orange-50 border-orange-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},ys=i=>{switch(i){case"JavaScript":return"text-blue-600 bg-blue-50 border-blue-200";case"React":return"text-cyan-600 bg-cyan-50 border-cyan-200";case"Python":return"text-green-600 bg-green-50 border-green-200";case"Java":return"text-orange-600 bg-orange-50 border-orange-200";case"Cooking":return"text-red-600 bg-red-50 border-red-200";case"Housekeeping":return"text-purple-600 bg-purple-50 border-purple-200";case"Childcare":return"text-pink-600 bg-pink-50 border-pink-200";case"Gardening":return"text-emerald-600 bg-emerald-50 border-emerald-200";case"Cleaning":return"text-gray-600 bg-gray-50 border-gray-200";case"Driving":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"Teaching":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"Nursing":return"text-rose-600 bg-rose-50 border-rose-200";case"Construction":return"text-amber-600 bg-amber-50 border-amber-200";case"Agriculture":return"text-lime-600 bg-lime-50 border-lime-200";case"domestic":return"text-blue-600 bg-blue-50 border-blue-200";case"care":return"text-pink-600 bg-pink-50 border-pink-200";case"food":return"text-orange-600 bg-orange-50 border-orange-200";case"maintenance":return"text-green-600 bg-green-50 border-green-200";case"sales":return"text-purple-600 bg-purple-50 border-purple-200";case"transport":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"Technology":return"text-blue-600 bg-blue-50 border-blue-200";case"Healthcare":return"text-green-600 bg-green-50 border-green-200";case"Education":return"text-purple-600 bg-purple-50 border-purple-200";case"Manufacturing":return"text-red-600 bg-red-50 border-red-200";case"Services":return"text-gray-600 bg-gray-50 border-gray-200";case"General":return"text-gray-600 bg-gray-50 border-gray-200";case"Job Seeker":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},pa=(i,c)=>{c==="email"?window.open(`mailto:${i.email}`,"_blank"):c==="phone"&&window.open(`tel:${i.phone}`,"_blank")},ts=({stats:i,className:c=""})=>e.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 ${c}`,children:i.map((l,o)=>e.jsx(ss,{...l,index:o},l.title))}),rs=()=>{const{t:i}=Wa(),{user:c}=Ia(),{requests:l,loading:o,error:m,goToPage:u,applyFilters:v,replyToRequest:b,selectJobSeekerForRequest:H,updateRequestStatus:x}=xa({includeAdmin:!0}),{categories:I,loadingCategories:J,fetchCategories:p}=za(),R={status:[{value:"",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"in_progress",label:"In Progress"},{value:"approved",label:"Approved"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],priority:[{value:"",label:"All Priorities"},{value:"urgent",label:"Urgent"},{value:"high",label:"High"},{value:"normal",label:"Normal"},{value:"low",label:"Low"}],category:[{value:"",label:"All Categories"},...(I||[]).map(a=>({value:a.name_en.toLowerCase(),label:a.name_en}))],dateRange:[{value:"",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"}],monthlyRateRange:[{value:"",label:"All Rates"},{value:"0-50000",label:"0 - 50,000 frw"},{value:"50000-100000",label:"50,000 - 100,000 frw"},{value:"100000-200000",label:"100,000 - 200,000 frw"},{value:"200000+",label:"200,000+ frw"}]},[s,q]=r.useState(null),[ge,xe]=r.useState(!1),[Y,V]=r.useState(!1),[w,Q]=r.useState(null),[D,ae]=r.useState(""),[A,he]=r.useState(""),[P,we]=r.useState(!1),[k,se]=r.useState(""),[Ge,Ae]=r.useState(null),[te,Ce]=r.useState(!1),[K,re]=r.useState(""),[He,Je]=r.useState(!1),[Ve,Ke]=r.useState("picture"),[X,ye]=r.useState(!1),[ne,le]=r.useState(""),[oe,be]=r.useState(""),[d,g]=r.useState(!1),[h,j]=r.useState([]),[_,E]=r.useState(""),[ke,Se]=r.useState(!1),[Ye,ie]=r.useState(""),[Qe,De]=r.useState(!1),[ha,ya]=r.useState([]),[Ee,Xe]=r.useState(!1),[Ze,Z]=r.useState(""),[f,F]=r.useState({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),[ea,Me]=r.useState(!1),[qe,aa]=r.useState(!1),[sa,ee]=r.useState(""),[B,ce]=r.useState({action:"approve",notes:""}),[z,Pe]=r.useState(""),[N,ta]=r.useState({status:"",priority:"",category:"",dateRange:"",monthlyRateRange:""}),[_e,ba]=r.useState(!1),[fa,ra]=r.useState(!1),S=r.useCallback(()=>{V(!1),Q(null),q(null),he(""),ae(""),se(""),be(""),le(""),Ae(null),re(""),xe(!1),g(!1),j([]),E(""),ie(""),Z(""),De(!1),F({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),Z(""),Me(!1),ce({action:"approve",notes:""}),ee("")},[]),ja=async a=>{try{q(a),g(!0),Se(!0),ie("");const t=await je.getMessagesByRequest(a.id);j(t.messages||[])}catch(t){console.error("Error opening messaging:",t),ie("Failed to load messages"),M.error("Failed to load messages")}finally{Se(!1)}},Na=()=>{g(!1),j([]),E(""),ie("")},na=async()=>{if(!(!_.trim()||!s))try{Se(!0),ie(""),await je.sendMessage(s.id,{content:_.trim(),messageType:"text"}),E("");const a=await je.getMessagesByRequest(s.id);j(a.messages||[]),M.success("Message sent successfully")}catch(a){console.error("Error sending message:",a),ie("Failed to send message"),M.error("Failed to send message")}finally{Se(!1)}},va=async()=>{if(s)try{await je.markMessagesAsRead(s.id);const a=await je.getMessagesByRequest(s.id);j(a.messages||[])}catch(a){console.error("Error marking messages as read:",a)}};r.useEffect(()=>{d&&s&&va()},[d,s]);const wa=async()=>{try{const t=await(await fetch(`${$.BASE_URL}/payment-methods/active`)).json();ya(t.paymentMethods||[])}catch(a){console.error("Error fetching payment methods:",a),M.error("Failed to load payment methods")}},Ca=async a=>{q(a),De(!0),F({amount:a.paymentAmount||"5000",currency:a.paymentCurrency||"RWF",description:a.paymentDescription||"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),await wa()},Te=()=>{De(!1),F({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),Z("")},ka=async a=>{if(a.preventDefault(),!f.paymentMethodId||!f.amount){Z("Please select a payment method and enter amount");return}try{Xe(!0),Z("");const t=await fetch(`${$.BASE_URL}/payments/request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem($.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({employerRequestId:s.id,amount:f.amount,currency:f.currency,description:f.description,paymentMethodId:f.paymentMethodId,paymentType:f.paymentType,dueDate:f.dueDate||null})}),n=await t.json();t.ok?(M.success("Payment request sent successfully!"),Te(),L()):Z(n.error||"Failed to send payment request")}catch(t){console.error("Error sending payment request:",t),Z("Network error. Please try again.")}finally{Xe(!1)}},Sa=async a=>{console.log("Opening payment approval modal for request:",a),console.log("Request latestPayment:",a.latestPayment),console.log("Request _backendData:",a._backendData);let t={...a};if(a.latestPayment?(console.log("Using existing latestPayment from Payment model:",a.latestPayment),t.latestPayment={...a.latestPayment,payerName:a.latestPayment.confirmationName||"Not specified",payerPhone:a.latestPayment.confirmationPhone||"Not specified",transferDate:a.latestPayment.confirmationDate||a.latestPayment.createdAt,additionalNotes:a.latestPayment.adminNotes||a.latestPayment.description||"No additional notes",transactionReference:a.latestPayment.paymentReference||`PAY-${a.latestPayment.id}`}):a._backendData&&!a.latestPayment&&(t.latestPayment={id:a._backendData.id,amount:a._backendData.paymentAmount||a.paymentAmount,currency:a._backendData.paymentCurrency||a.paymentCurrency||"RWF",paymentType:a._backendData.paymentDescription?.includes("photo")?"photo_access":"full_details",status:"confirmed",confirmedAt:a._backendData.updatedAt||a.date,createdAt:a._backendData.createdAt||a.date,paymentMethod:"Mobile Money",transactionReference:`REQ-${a.id}-${Date.now()}`,payerName:a._backendData?.employerAccount?.user?.name||a.employerName||"Not specified",payerPhone:a._backendData?.employerAccount?.phoneNumber||a.employerContact?.phone||"Not specified",transferDate:a._backendData.updatedAt||a.date,additionalNotes:a._backendData.paymentDescription||"No additional notes"},console.log("Created latestPayment from _backendData:",t.latestPayment)),!t.latestPayment||!t.latestPayment.amount)try{const n=await fetch(`${$.BASE_URL}/admin/employer-requests/${a.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem($.AUTH_CONFIG.tokenKey)}`}});if(n.ok){const y=await n.json();console.log("Fetched full request data:",y),q(y)}else console.error("Failed to fetch full request data"),q(t)}catch(n){console.error("Error fetching request details:",n),q(t)}else q(t);Me(!0),ce({action:"approve",notes:""}),ee("")},Fe=()=>{Me(!1),ce({action:"approve",notes:""}),ee("")},Pa=async a=>{if(a.preventDefault(),!s?.latestPayment?.id){ee("No payment found to approve");return}try{aa(!0),ee("");const t=await fetch(`${$.BASE_URL}/payment-confirmations/review/${s.latestPayment.id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem($.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({paymentId:s.latestPayment.id,action:B.action,notes:B.notes})}),n=await t.json();if(t.ok){const y=B.action==="approve"?"approved":"rejected";M.success(`Payment ${y} successfully!`),Fe(),L()}else ee(n.error||"Failed to process payment approval")}catch(t){console.error("Error processing payment approval:",t),ee("Network error. Please try again.")}finally{aa(!1)}},la=r.useCallback(()=>{},[Y,w,s,ge,A,D,oe]),Ra=a=>{if(!a)return null;try{const t=n=>{if(!n||n==="Not specified")return"Not specified";if(typeof n=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(n);if(typeof n=="string"){const y=parseFloat(n);return isNaN(y)?n:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(y)}return"Not specified"};return{id:a.id,employerName:a.name||"Unknown",companyName:a.companyName||"Private",candidateName:a.requestedCandidate&&`${a.requestedCandidate.profile?.firstName||""} ${a.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:a.requestedCandidate?.profile?.skills||"General",status:a.status||"pending",priority:a.priority||"normal",date:a.createdAt,monthlyRate:t(a.requestedCandidate?.profile?.monthlyRate),message:a.message||"",employerContact:{email:a.email||"",phone:a.phoneNumber||""},adminNotes:"",lastContactDate:a.updatedAt,isCompleted:a.status==="completed",category:a.requestedCandidate?.profile?.jobCategory?.name_en||"General",candidateExperience:a.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:a.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:a.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:a.requestedCandidate?.profile?.location||"Not specified",candidateCity:a.requestedCandidate?.profile?.city||"Not specified",candidateCountry:a.requestedCandidate?.profile?.country||"Not specified",candidateContact:a.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:a.requestedCandidate?.email||"Not specified",candidateLanguages:a.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:a.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:a.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:a.requestedCandidate?.profile?.description||"Not specified",candidateGender:a.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:a.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:a.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:a.requestedCandidate?.profile?.references||"Not specified",_backendData:a}}catch(t){return console.error("Error transforming request data:",t),{id:a?.id||"unknown",employerName:"Data unavailable",companyName:"Data unavailable",candidateName:"Data unavailable",position:"Data unavailable",status:"pending",priority:"normal",date:new Date,monthlyRate:"Data unavailable",message:"Data unavailable",employerContact:{email:"",phone:""},adminNotes:"",lastContactDate:new Date,isCompleted:!1,category:"Data unavailable",_backendData:a,_hasError:!0}}},Le=l.map(Ra).filter(Boolean),O=Le.map(a=>a._hasError?{...a,employerName:"Data unavailable",companyName:"Data unavailable",candidateName:"Data unavailable",position:"Data unavailable",status:"pending",priority:"normal",monthlyRate:"Data unavailable",message:"Data unavailable",employerContact:{email:"",phone:""}}:{...a,employerName:a.employerName||"Unknown",companyName:a.companyName||"Private",candidateName:a.candidateName||"Not specified",position:a.position||"General",status:a.status||"pending",priority:a.priority||"normal",monthlyRate:a.monthlyRate||"Not specified",message:a.message||"",employerContact:{email:a.employerContact?.email||"",phone:a.employerContact?.phone||""}});$a.useEffect(()=>{try{Le.forEach(a=>{const t=a._backendData?.requestedCandidate?.profile?.photo||a._backendData?.requestedCandidate?.photo||null})}catch(a){console.log("EmployerRequestsPage: debug logging error",a)}},[Le]);const Aa=[{key:"employerInfo",label:"Employer",sortable:!1,render:a=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(Qa,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.employerName}),e.jsx("div",{className:"text-sm text-gray-500",children:a.companyName})]})]})},{key:"candidateInfo",label:"Candidate",sortable:!1,render:a=>{const t=a._backendData?.requestedCandidate,n=t?.profile?.photo||t?.photo||null,y=n?/^https?:\/\//i.test(n)?n:`${$.BASE_URL}/${n.replace(/^\//,"")}`:null;return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ue,{src:y,alt:a.candidateName,size:"sm",fallback:a.candidateName,fallbackSrc:ze}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.candidateName}),e.jsx("div",{className:"text-sm text-gray-500",children:a.position})]})]})}},{key:"category",label:"Category",sortable:!0,searchable:!0,type:"badge",badgeColor:a=>{switch(a?.toLowerCase()){case"domestic":return"text-blue-600 bg-blue-50 border-blue-200";case"care":return"text-pink-600 bg-pink-50 border-pink-200";case"food":return"text-orange-600 bg-orange-50 border-orange-200";case"maintenance":return"text-green-600 bg-green-50 border-green-200";case"transport":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"general":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}},{key:"monthlyRate",label:"Monthly Rate",sortable:!0,type:"text"},{key:"status",label:"Status",sortable:!0,type:"badge",badgeColor:ma},{key:"priority",label:"Priority",sortable:!0,type:"badge",badgeColor:ua},{key:"date",label:"Request Date",sortable:!0,type:"date"},{key:"actions",label:"Actions",sortable:!1,render:a=>e.jsxs("div",{className:"flex items-center gap-1",children:[Be(a).slice(0,4).map((t,n)=>{const y=t.icon;return e.jsxs("button",{onClick:()=>$e(t.key,a),className:`relative group p-2 rounded-lg transition-all duration-200 hover:scale-110 ${t.className} border border-gray-200 hover:border-current`,title:t.title,children:[e.jsx(y,{className:"w-4 h-4"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[t.title,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]},n)}),Be(a).length>4&&e.jsxs("button",{onClick:()=>$e("openActions",a),className:"relative group p-2 rounded-lg transition-all duration-200 hover:scale-110 text-gray-600 hover:bg-gray-50 border border-gray-200 hover:border-gray-400",title:"More actions",children:[e.jsx(Xa,{className:"w-4 h-4"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:["More actions",e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]})]})}];r.useEffect(()=>{p()},[p]),r.useEffect(()=>()=>{S()},[S]),r.useEffect(()=>{la()},[la]);const T=r.useMemo(()=>{let a=O||[];if(z.trim()){const t=z.toLowerCase();a=a.filter(n=>n.employerName?.toLowerCase().includes(t)||n.companyName?.toLowerCase().includes(t)||n.candidateName?.toLowerCase().includes(t)||n.message?.toLowerCase().includes(t)||n.position?.toLowerCase().includes(t))}if(N.status&&(a=a.filter(t=>t.status===N.status)),N.priority&&(a=a.filter(t=>t.priority===N.priority)),N.category&&(a=a.filter(t=>t.category?.toLowerCase()===N.category.toLowerCase())),N.dateRange){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());a=a.filter(y=>{const fe=new Date(y.date);switch(N.dateRange){case"today":return fe>=n;case"week":const _a=new Date(n.getTime()-10080*60*1e3);return fe>=_a;case"month":const Ta=new Date(n.getTime()-720*60*60*1e3);return fe>=Ta;case"quarter":const Fa=new Date(n.getTime()-2160*60*60*1e3);return fe>=Fa;case"year":const La=new Date(n.getTime()-365*24*60*60*1e3);return fe>=La;default:return!0}})}return N.monthlyRateRange&&(a=a.filter(t=>{const n=t.monthlyRate;if(n==="Not specified")return!1;const y=typeof n=="string"?parseFloat(n.replace(/[^\d.]/g,"")):n;if(isNaN(y))return!1;switch(N.monthlyRateRange){case"0-50000":return y>=0&&y<=5e4;case"50000-100000":return y>5e4&&y<=1e5;case"100000-200000":return y>1e5&&y<=2e5;case"200000+":return y>2e5;default:return!0}})),a},[O,z,N]),Da=r.useCallback(a=>{Pe(a),ra(!0);const t=setTimeout(()=>{ra(!1)},300);return()=>clearTimeout(t)},[]),de=r.useCallback((a,t)=>{ta(n=>({...n,[a]:t}))},[]),oa=r.useCallback(()=>{ta({status:"",priority:"",category:"",dateRange:"",monthlyRateRange:""}),Pe("")},[]),U=r.useMemo(()=>{let a=0;return z.trim()&&a++,Object.values(N).forEach(t=>{t&&a++}),a},[z,N]),Ea=r.useMemo(()=>[{title:"Total Requests",value:T.length.toString(),change:`+${T.length-(O||[]).length}`,changeType:T.length>=(O||[]).length?"increase":"decrease",icon:Oe,color:"text-blue-600",bgColor:"bg-blue-50",description:`${U>0?"Filtered":"All"} employer requests`},{title:"Pending Review",value:T.filter(a=>a.status==="pending").length.toString(),change:"+2",changeType:"increase",icon:Ga,color:"text-orange-600",bgColor:"bg-orange-50",description:"Awaiting admin review"},{title:"In Progress",value:T.filter(a=>a.status==="in_progress").length.toString(),change:"+1",changeType:"increase",icon:Ha,color:"text-blue-600",bgColor:"bg-blue-50",description:"Under negotiation"},{title:"Completed",value:T.filter(a=>a.status==="completed").length.toString(),change:"+3",changeType:"increase",icon:Ne,color:"text-green-600",bgColor:"bg-green-50",description:"Successfully closed"}],[T,O,U]),L=r.useCallback(()=>{u(1),v()},[u,v]),$e=(a,t)=>{switch(q(t),ae(t.adminNotes||""),a){case"openActions":V(!0),Q(null);break;case"view":xe(!0),V(!1);break;case"contact":pa(t.employerContact,"email"),S();break;case"call":pa(t.employerContact,"phone"),S();break;case"reply":Q("reply"),V(!0);break;case"message":ja(t);break;case"payment":Ca(t);break;case"paymentApproval":Sa(t);break;case"select":Q("select"),V(!0);break;case"start":Ie("in_progress","Starting to process this request"),S();break;case"approve":Ie("approved","Request approved and ready for completion"),S();break;case"complete":Q("complete"),V(!0);break;case"reactivate":Ie("pending","Request reactivated and back to pending status"),S();break;default:console.warn("Unknown action:",a),S()}},Ie=async(a,t)=>{if(s)try{const n=await x(s.id,{status:a,adminNotes:t});n.success?(M.success(`Request status updated to ${a}. ${t||""}`),L()):(console.error("❌ Failed to update status:",n.error),M.error(`Failed to update status: ${n.error}`))}catch(n){console.error("❌ Error updating status:",n),M.error("Network error. Please try again.")}},Ma=async()=>{if(!(!s||!A.trim())){we(!0),se("");try{const a=await b(s.id,{content:A});if(a.success){const t=a.data.emailSent?`Reply sent successfully to ${s.employerName} at ${s.employerContact.email}`:"Reply saved but email delivery failed. Please check the email configuration.";M.success(t),he(""),ae(""),S(),L()}else console.error("❌ Reply failed:",a.error),se(a.error||"Failed to send reply")}catch(a){console.error("❌ Error sending reply:",a),se("Network error. Please try again.")}finally{we(!1)}}},ia=async(a,t="picture")=>{if(s){Ce(!0),re("");try{const n=await H(s.id,a,t);if(n.success){const y=t==="picture"?`Candidate profile picture sent to ${s.employerName}`:`Complete candidate details sent to ${s.employerName}`;M.success(y),S(),L()}else console.error("❌ Failed to send candidate information:",n.error),re(n.error||"Failed to send candidate information")}catch(n){console.error("❌ Error sending candidate information:",n),re("Network error. Please try again.")}finally{Ce(!1)}}},qa=async()=>{if(s){ye(!0),le("");try{const a=await x(s.id,{status:"completed",adminNotes:oe});a.success?(M.success(`Request completed successfully. ${oe?"Notes have been saved.":""}`),be(""),S(),L()):(console.error("❌ Failed to complete request:",a.error),le(a.error||"Failed to complete request"))}catch(a){console.error("❌ Error completing request:",a),le("Network error. Please try again.")}finally{ye(!1)}}},Be=a=>{const t=[{key:"view",title:"View Details",icon:Za,className:"text-blue-600 hover:bg-blue-50",group:"view"},{key:"message",title:"Message",icon:Oe,className:"text-indigo-600 hover:bg-indigo-50",group:"contact"},{key:"payment",title:"Request Payment",icon:es,className:"text-green-600 hover:bg-green-50",group:"payment"}];(a.status==="payment_confirmed"||a._backendData?.status==="payment_confirmed")&&t.push({key:"paymentApproval",title:"Approve Payment",icon:Ne,className:"text-blue-600 hover:bg-blue-50",group:"payment"});const n=[];switch(a.status){case"pending":n.push({key:"start",title:"Start Processing",icon:as,className:"text-blue-600 hover:bg-blue-50",group:"status"});break;case"in_progress":n.push({key:"approve",title:"Approve Request",icon:Ne,className:"text-green-600 hover:bg-green-50",group:"status"});break;case"approved":n.push({key:"complete",title:"Mark Complete",icon:Ne,className:"text-green-600 hover:bg-green-50",group:"status"});break;case"completed":break;case"cancelled":n.push({key:"reactivate",title:"Reactivate",icon:ve,className:"text-blue-600 hover:bg-blue-50",group:"status"});break;default:n.push({key:"complete",title:"Mark Complete",icon:Ne,className:"text-green-600 hover:bg-green-50",group:"status"})}return[...t,...n]};return o||!l||!O?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(Ba,{size:"lg",text:"Loading employer requests..."})}):m?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Requests"}),e.jsx("p",{className:"text-gray-600 mb-4",children:m}),e.jsxs(C,{onClick:L,variant:"primary",disabled:o,children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),o?"Retrying...":"Try Again"]})]})}):!o&&O&&O.length===0?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"E"})}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Employer Requests"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(C,{variant:"outline",size:"sm",onClick:L,disabled:o,children:"Refresh"})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"No Employer Requests"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There are currently no employer requests to display."}),e.jsxs(C,{onClick:L,variant:"primary",disabled:o,children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),o?"Refreshing...":"Refresh Data"]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Employer Requests"})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(C,{variant:"outline",size:"sm",onClick:L,disabled:o,children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),o?"Refreshing...":"Refresh"]})})]})})}),e.jsxs("div",{className:" mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsx(ts,{stats:Ea})}),e.jsx(We.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(ga,{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Employer Requests (",T.length,")"]}),U>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",T.length," of ",(O||[]).length," total requests"]})]})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ca,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search by employer name, company, candidate, or message...",value:z,onChange:a=>Da(a.target.value),className:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm"}),fa&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-500"})}),z&&e.jsx("button",{onClick:()=>Pe(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:e.jsx(Re,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("button",{onClick:()=>ba(!_e),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${_e?"bg-red-50 border-red-200 text-red-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Ja,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters"}),U>0&&e.jsx("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full",children:U})]}),U>0&&e.jsxs("button",{onClick:oa,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(Re,{className:"h-4 w-4"}),"Clear All"]})]}),_e&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx("select",{value:N.status,onChange:a=>de("status",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:R.status.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsx("select",{value:N.priority,onChange:a=>de("priority",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:R.priority.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("select",{value:N.category,onChange:a=>de("category",a.target.value),disabled:J,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:J?e.jsx("option",{value:"",children:"Loading categories..."}):R.category.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsx("select",{value:N.dateRange,onChange:a=>de("dateRange",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:R.dateRange.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Rate"}),e.jsx("select",{value:N.monthlyRateRange,onChange:a=>de("monthlyRateRange",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:R.monthlyRateRange.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),U>0&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[z&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:['Search: "',z,'"',e.jsx("button",{onClick:()=>Pe(""),className:"ml-1 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(Re,{className:"h-3 w-3"})})]}),Object.entries(N).map(([a,t])=>{if(!t)return null;const n=R[a]?.find(y=>y.value===t);return n?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-800 text-sm rounded-full",children:[n.label,e.jsx("button",{onClick:()=>de(a,""),className:"ml-1 hover:bg-gray-200 rounded-full p-0.5",children:e.jsx(Re,{className:"h-3 w-3"})})]},a):null})]})})]})]}),e.jsx("div",{className:"space-y-4",children:T.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx(ca,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No results found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:U>0?"Try adjusting your search terms or filters to find what you're looking for.":"There are no employer requests to display."}),U>0&&e.jsx(C,{onClick:oa,variant:"outline",size:"sm",className:"mx-auto",children:"Clear All Filters"})]}):e.jsx(Oa,{data:T,columns:Aa,pagination:!0,itemsPerPage:15,showSearch:!1})})]})})]}),ge&&s&&e.jsx(ue,{isOpen:ge,onClose:()=>{xe(!1),q(null)},title:"Request Details",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Employer Information"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:s.employerName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Company"}),e.jsx("p",{className:"text-gray-900",children:s.companyName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:s.employerContact.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-gray-900",children:s.employerContact.phone})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Request Details"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx(da,{color:ma(s.status),children:s.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Priority"}),e.jsx(da,{color:ua(s.priority),children:s.priority})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Request Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Message"}),e.jsx("p",{className:"text-gray-900 mt-1",children:s.message})]})]})})]}),s.candidateName!=="Not specified"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Candidate Information"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 pb-4 border-b border-gray-200",children:[(()=>{const a=s._backendData?.requestedCandidate?.profile?.photo||s._backendData?.requestedCandidate?.photo||null,t=a?/^https?:\/\//i.test(a)?a:`${$.BASE_URL}/${a.replace(/^\//,"")}`:null;return e.jsx(Ue,{src:t,alt:s.candidateName,size:"lg",fallback:s.candidateName,fallbackSrc:ze})})(),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:s.candidateName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.category," • ",s.position]}),e.jsx("p",{className:"text-sm font-medium text-green-600",children:s.monthlyRate})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Job Category"}),e.jsx("p",{className:"text-gray-900",children:s.category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Skills/Position"}),e.jsx("p",{className:"text-gray-900",children:s.position})]})]}),s.candidateExperience!=="Not specified"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Experience Level"}),e.jsx("p",{className:"text-gray-900",children:s.candidateExperienceLevel})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Education"}),e.jsx("p",{className:"text-gray-900",children:s.candidateEducation})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Location"}),e.jsx("p",{className:"text-gray-900",children:s.candidateLocation})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"City"}),e.jsx("p",{className:"text-gray-900",children:s.candidateCity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Country"}),e.jsx("p",{className:"text-gray-900",children:s.candidateCountry})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Contact Number"}),e.jsx("p",{className:"text-gray-900",children:s.candidateContact})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:s.candidateEmail})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Languages"}),e.jsx("p",{className:"text-gray-900",children:s.candidateLanguages})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Certifications"}),e.jsx("p",{className:"text-gray-900",children:s.candidateCertifications})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Availability"}),e.jsx("p",{className:"text-gray-900",children:s.candidateAvailability})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Gender"}),e.jsx("p",{className:"text-gray-900",children:s.candidateGender})]})]}),s.candidateDescription!=="Not specified"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"text-gray-900",children:s.candidateDescription})]}),s.candidateReferences!=="Not specified"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"References"}),e.jsx("p",{className:"text-gray-900",children:s.candidateReferences})]}),s.candidateIdNumber!=="Not specified"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ID Number"}),e.jsx("p",{className:"text-gray-900",children:s.candidateIdNumber})]})]})]})})]})]})}),Y&&s&&!w&&e.jsx(ue,{isOpen:Y,onClose:S,title:`Actions for ${s.employerName} - ${s.companyName}`,maxWidth:"max-w-md",children:e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"grid grid-cols-4 gap-3",children:Be(s).map((a,t)=>{const n=a.icon;return e.jsxs("button",{onClick:()=>$e(a.key,s),className:`relative group flex items-center justify-center p-4 rounded-lg transition-all duration-200 hover:scale-105 ${a.className} border border-gray-200 hover:border-current`,title:a.title,children:[e.jsx(n,{className:"w-6 h-6"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[a.title,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]},t)})})})}),Y&&s&&w&&e.jsxs(ue,{isOpen:Y,onClose:S,title:w==="reply"?"Reply to Request":w==="select"?"Send Candidate Details":w==="complete"?"Complete Request":"Action",size:"md",children:[w==="reply"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Replying to:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Name:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.employerContact.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Phone:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.employerContact.phone})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reply Message ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:A,onChange:a=>he(a.target.value),className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your reply message to the employer...",disabled:P}),P&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Sending reply to employer..."]}),k&&e.jsx("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:k})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Internal)"}),e.jsx("textarea",{value:D,onChange:a=>ae(a.target.value),className:"w-full h-20 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Add internal notes for your reference...",disabled:P}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"These notes are for internal use only and won't be sent to the employer."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{variant:"outline",onClick:()=>{S()},disabled:P,children:"Cancel"}),e.jsx(C,{variant:"primary",onClick:Ma,disabled:!A.trim()||P,children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):"Send Reply"})]})]}),w==="select"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-900 mb-2",children:"Selecting candidate for:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-green-900 ml-1",children:s.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-green-900 ml-1",children:s.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Position:"}),e.jsx("span",{className:"text-green-900 ml-1",children:s.position})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Category:"}),e.jsx("span",{className:"text-green-900 ml-1",children:s.category})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Send Candidate Information"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Send the requested candidate's information to the employer. Choose whether to send just a profile picture or complete details."}),s._backendData?.requestedCandidate?e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const a=s._backendData?.requestedCandidate?.profile?.photo||s._backendData?.requestedCandidate?.photo||null,t=a?/^https?:\/\//i.test(a)?a:`${$.BASE_URL}/${a.replace(/^\//,"")}`:null;return e.jsx(Ue,{src:t,alt:s.candidateName,size:"md",fallback:s.candidateName,fallbackSrc:ze})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-lg",children:s.candidateName}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[s.position," • ",s.candidateExperience]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",s.candidateLocation]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rate:"})," ",s.monthlyRate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Experience Level:"})," ",s.candidateExperienceLevel]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Education:"})," ",s.candidateEducation]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>ia(s._backendData.requestedCandidate.id,"picture"),disabled:te,children:"Send Profile Picture"}),e.jsx(C,{variant:"primary",size:"sm",onClick:()=>ia(s._backendData.requestedCandidate.id,"full"),disabled:te,children:"Send Complete Details"})]})]})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Va,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No candidate specified in this request"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"The employer did not specify a particular candidate"})]})]}),K&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:K}),te&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}),"Sending candidate information to employer..."]}),e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx(C,{variant:"outline",onClick:()=>{S()},disabled:te,children:"Cancel"})})]}),w==="complete"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-900 mb-2",children:"Completing Request:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:s.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:s.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Position:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:s.position})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Current Status:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:s.status})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Completion Notes (Optional)"}),e.jsx("textarea",{value:oe,onChange:a=>be(a.target.value),className:"w-full h-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Add notes about how this request was completed...",disabled:X}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"These notes will be saved with the request and sent to the employer."})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center mr-2",children:e.jsx("span",{className:"text-yellow-800 text-xs",children:"!"})}),e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Warning:"})," This action will permanently mark the request as completed and close it. This action cannot be undone."]})]})}),ne&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:ne}),X&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600 mr-2"}),"Completing request..."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{variant:"outline",onClick:()=>{S()},disabled:X,children:"Cancel"}),e.jsx(C,{variant:"primary",onClick:qa,disabled:X,className:"bg-orange-600 hover:bg-orange-700",children:X?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete Request"})]})]})]}),d&&s&&e.jsx(ue,{isOpen:d,onClose:Na,title:`Messaging - Request #${s.id}`,maxWidth:"max-w-2xl",children:e.jsxs("div",{className:"flex flex-col h-[calc(100vh-200px)]",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto pr-4 space-y-4 mb-4",children:[ke?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"animate-spin h-8 w-8 text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]}):h.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Oe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Start the conversation!"})]}):h.map(a=>e.jsx("div",{className:`flex ${a.fromAdmin?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg shadow-sm ${a.fromAdmin?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"}`,children:[e.jsx("p",{className:"text-sm",children:a.content}),e.jsx("p",{className:`text-xs mt-1 ${a.fromAdmin?"text-blue-100":"text-gray-500"}`,children:new Date(a.createdAt).toLocaleString()})]})},a.id)),Ye&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:Ye})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Type a message...",value:_,onChange:a=>E(a.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",disabled:ke,onKeyPress:a=>a.key==="Enter"&&na()}),e.jsx(C,{variant:"primary",onClick:na,disabled:!_.trim()||ke,children:ke?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(Ka,{className:"h-5 w-5"})})]})]})}),Qe&&s&&e.jsx(ue,{isOpen:Qe,onClose:Te,title:`Request Payment - Request #${s.id}`,maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:ka,className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Request Details:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Candidate:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.candidateName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Status:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:s.status})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentType",value:"photo_access",checked:f.paymentType==="photo_access",onChange:a=>F({...f,paymentType:a.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Photo Access"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Basic candidate photo"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentType",value:"full_details",checked:f.paymentType==="full_details",onChange:a=>F({...f,paymentType:a.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Full Details"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Complete candidate information"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:f.paymentMethodId,onChange:a=>F({...f,paymentMethodId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Payment Method"}),ha.map(a=>e.jsxs("option",{value:a.id,children:[a.name," - ",a.accountNumber]},a.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:f.amount,onChange:a=>F({...f,amount:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"5000",min:"0",step:"100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:f.currency,onChange:a=>F({...f,currency:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"RWF",children:"RWF (Rwandan Franc)"}),e.jsx("option",{value:"USD",children:"USD (US Dollar)"}),e.jsx("option",{value:"EUR",children:"EUR (Euro)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:f.description,onChange:a=>F({...f,description:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:`Payment for ${f.paymentType==="photo_access"?"photo access":"full details"} access to candidate information`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date (Optional)"}),e.jsx("input",{type:"date",value:f.dueDate,onChange:a=>F({...f,dueDate:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]})]}),Ze&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:Ze}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{type:"button",variant:"outline",onClick:Te,disabled:Ee,children:"Cancel"}),e.jsx(C,{type:"submit",variant:"primary",disabled:Ee,className:"bg-green-600 hover:bg-green-700",children:Ee?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):"Send Payment Request"})]})]})}),ea&&s&&e.jsx(ue,{isOpen:ea,onClose:Fe,title:`Approve Payment - Request #${s.id}`,maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:Pa,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Request Overview"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Employer:"}),e.jsx("span",{className:"text-gray-900",children:s.employerName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Company:"}),e.jsx("span",{className:"text-gray-900",children:s.companyName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Candidate:"}),e.jsx("span",{className:"text-gray-900",children:s.candidateName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Request Status:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:s.status?.replace("_"," ")})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-green-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Payment Confirmation Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payer Name:"}),e.jsx("span",{className:"text-gray-900",children:s.latestPayment?.payerName||s.employerName||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Phone Number:"}),e.jsx("span",{className:"text-gray-900",children:s.latestPayment?.payerPhone||s.employerContact?.phone||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payment Reference:"}),e.jsx("span",{className:"text-gray-900 font-mono text-xs",children:s.latestPayment?.transactionReference||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Transfer Amount:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:s.latestPayment?.amount?`${s.latestPayment.amount} RWF`:"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Transfer Date:"}),e.jsx("span",{className:"text-gray-900",children:s.latestPayment?.transferDate||s.latestPayment?.confirmedAt||s.latestPayment?.createdAt?new Date(s.latestPayment.transferDate||s.latestPayment.confirmedAt||s.latestPayment.createdAt).toLocaleDateString():"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payment Method:"}),e.jsx("span",{className:"text-gray-900",children:s.latestPayment?.paymentMethod||"Not specified"})]})]}),s.latestPayment?.additionalNotes&&s.latestPayment.additionalNotes!=="No additional notes"&&e.jsxs("div",{className:"mt-4 bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-2",children:"Additional Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:s.latestPayment.additionalNotes})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-purple-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsx("span",{className:"text-purple-600 font-medium block mb-1",children:"Payment Type:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:s.latestPayment?.paymentType?.replace("_"," ")||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsx("span",{className:"text-purple-600 font-medium block mb-1",children:"Payment Status:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:s.latestPayment?.status||"Not specified"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Action ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"action",value:"approve",checked:B.action==="approve",onChange:a=>ce({...B,action:a.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Approve"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Approve the payment"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"action",value:"reject",checked:B.action==="reject",onChange:a=>ce({...B,action:a.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Reject"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Reject the payment"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:B.notes,onChange:a=>ce({...B,notes:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:"Add any additional notes for the payment approval..."})]}),sa&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:sa}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(C,{type:"button",variant:"outline",onClick:Fe,disabled:qe,children:"Cancel"}),e.jsx(C,{type:"submit",variant:"primary",disabled:qe,className:"bg-green-600 hover:bg-green-700",children:qe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):"Submit Approval"})]})]})}),e.jsx(Ya,{position:"top-right"})]})},bs=Object.freeze(Object.defineProperty({__proto__:null,default:rs},Symbol.toStringTag,{value:"Module"}));export{rs as E,ss as S,ys as a,ua as b,ma as c,bs as d,hs as g,pa as h,xs as u};
