import{j as e,I as Ja,C as na,a4 as mt,a as E,aA as oa,V as ut,av as He,f as M,a0 as Ue,z as Me,aB as Ya,c as Za,r as i,K as Qa,Y as Le,at as Ie,a2 as be,aC as Xa,aD as es,ac as Zt,S as Qt,X as Oe,v as ts,W as Xt,h as ea,P as ta,_ as as,an as ss,az as rs,ab as x}from"./vendor-react-BrVnDVka.js";import{C as la,A as d,b as ns,k as os,L as ls,B as w,l as is}from"./index-C7-mmNOW.js";import{m as fe}from"./messagingService-DwWvOCcG.js";import{D as cs}from"./DataTable-CzbsZQ_A.js";import{m as pt}from"./vendor-motion-DiEA6HXZ.js";import{M as Z}from"./Modal-DWl9TmDr.js";import{B as it}from"./Badge-Dl8LIe_9.js";import{A as ct}from"./Avatar-D2uxOurZ.js";const ds=({title:f,value:o,change:l,changeType:r="increase",icon:m,color:u,bgColor:y,description:P,index:g=0,trendPeriod:k="7 days",showTrend:B=!0,loading:V=!1})=>e.jsx(pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1},children:e.jsxs(la,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`w-12 h-12 ${y} rounded-lg flex items-center justify-center`,children:e.jsx(m,{className:`w-6 h-6 ${u}`})}),B&&l&&!V&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`flex items-center space-x-1 text-sm ${r==="increase"?"text-green-600":r==="decrease"?"text-red-600":"text-gray-500"}`,children:[r==="increase"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 17l9.2-9.2M17 17V7H7"})}):r==="decrease"?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 7l-9.2 9.2M7 7v10h10"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14"})}),e.jsx("span",{children:l})]}),e.jsxs("div",{className:"group relative",children:[e.jsx(Ja,{className:"w-3 h-3 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute bottom-full right-0 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:["Trend based on last ",k]})]})]})]}),e.jsx("div",{children:V?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-1/2"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:o}),e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:f}),e.jsx("p",{className:"text-xs text-gray-500",children:P})]})})]})}),ms=f=>{switch(f?.toLowerCase()){case"pending":return"text-orange-600 bg-orange-50 border-orange-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"approved":return"text-green-600 bg-green-50 border-green-200";case"completed":return"text-purple-600 bg-purple-50 border-purple-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";case"rejected":return"text-red-600 bg-red-50 border-red-200";case"active":return"text-green-600 bg-green-50 border-green-200";case"inactive":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},Ss=f=>{switch(f?.toLowerCase()){case"pending":return"Pending";case"in_progress":return"In Progress";case"approved":return"Approved";case"completed":return"Completed";case"cancelled":return"Cancelled";case"rejected":return"Rejected";case"active":return"Active";case"inactive":return"Inactive";default:return f||"Unknown"}},aa=f=>{switch(f){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-orange-600 bg-orange-50 border-orange-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},Ps=f=>{switch(f){case"JavaScript":return"text-blue-600 bg-blue-50 border-blue-200";case"React":return"text-cyan-600 bg-cyan-50 border-cyan-200";case"Python":return"text-green-600 bg-green-50 border-green-200";case"Java":return"text-orange-600 bg-orange-50 border-orange-200";case"Cooking":return"text-red-600 bg-red-50 border-red-200";case"Housekeeping":return"text-purple-600 bg-purple-50 border-purple-200";case"Childcare":return"text-pink-600 bg-pink-50 border-pink-200";case"Gardening":return"text-emerald-600 bg-emerald-50 border-emerald-200";case"Cleaning":return"text-gray-600 bg-gray-50 border-gray-200";case"Driving":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"Teaching":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"Nursing":return"text-rose-600 bg-rose-50 border-rose-200";case"Construction":return"text-amber-600 bg-amber-50 border-amber-200";case"Agriculture":return"text-lime-600 bg-lime-50 border-lime-200";case"domestic":return"text-blue-600 bg-blue-50 border-blue-200";case"care":return"text-pink-600 bg-pink-50 border-pink-200";case"food":return"text-orange-600 bg-orange-50 border-orange-200";case"maintenance":return"text-green-600 bg-green-50 border-green-200";case"sales":return"text-purple-600 bg-purple-50 border-purple-200";case"transport":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"Technology":return"text-blue-600 bg-blue-50 border-blue-200";case"Healthcare":return"text-green-600 bg-green-50 border-green-200";case"Education":return"text-purple-600 bg-purple-50 border-purple-200";case"Manufacturing":return"text-red-600 bg-red-50 border-red-200";case"Services":return"text-gray-600 bg-gray-50 border-gray-200";case"General":return"text-gray-600 bg-gray-50 border-gray-200";case"Job Seeker":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},sa=(f,o)=>{o==="email"?window.open(`mailto:${f.email}`,"_blank"):o==="phone"&&window.open(`tel:${f.phone}`,"_blank")};class dt{static async getWorkflowNotifications(){try{const o=await fetch(`${d.BASE_URL}/notifications/workflow`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching workflow notifications:",o),o}}static async markAsRead(o){try{const l=await fetch(`${d.BASE_URL}/notifications/${o}/read`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){throw console.error("Error marking notification as read:",l),l}}static async markAllAsRead(){try{const o=await fetch(`${d.BASE_URL}/notifications/mark-all-read`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error marking all notifications as read:",o),o}}static async createWorkflowNotification(o,l,r,m){try{const u=await fetch(`${d.BASE_URL}/notifications/workflow`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({type:o,message:l,requestId:r,status:m})});if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(u){throw console.error("Error creating workflow notification:",u),u}}static async getNotificationCount(){try{const o=await fetch(`${d.BASE_URL}/notifications/count`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching notification count:",o),o}}static async getUserNotifications(){try{const o=await fetch(`${d.BASE_URL}/notifications/user`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching user notifications:",o),o}}static async getNotificationStats(){try{const o=await fetch(`${d.BASE_URL}/notifications/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching notification stats:",o),o}}static async getNotificationPreferences(){try{const o=await fetch(`${d.BASE_URL}/notifications/preferences`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error fetching notification preferences:",o),o}}static async updateNotificationPreference(o,l){try{const r=await fetch(`${d.BASE_URL}/notifications/preferences`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({type:o,optedOut:l})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){throw console.error("Error updating notification preference:",r),r}}static async toggleNotificationPreference(o){try{const r=(await this.getNotificationPreferences()).optedOutTypes.includes(o);return await this.updateNotificationPreference(o,!r)}catch(l){throw console.error("Error toggling notification preference:",l),l}}}class C{static async approveRequest(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/approve`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error approving request:",r),r}}static async rejectRequest(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/reject`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error rejecting request:",r),r}}static async requestFirstPayment(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/request-first-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error requesting first payment:",r),r}}static async approveFirstPayment(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/approve-first-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error approving first payment:",r),r}}static async rejectFirstPayment(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/reject-first-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error rejecting first payment:",r),r}}static async requestSecondPayment(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/request-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error requesting second payment:",r),r}}static async approveFullDetailsRequest(o,l,r=""){try{const m=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/approve-full-details-request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({action:"approve",amount:parseFloat(l)||1e4,notes:r})});if(!m.ok){const y=await m.json();throw new Error(y.error||`HTTP error! status: ${m.status}`)}return await m.json()}catch(m){throw console.error("Error approving full details request:",m),m}}static async rejectFullDetailsRequest(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/reject-full-details-request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error rejecting full details request:",r),r}}static async approveSecondPayment(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/approve-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error approving second payment:",r),r}}static async rejectSecondPayment(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/reject-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error rejecting second payment:",r),r}}static async updateCandidateAvailability(o,l=""){try{const r=await fetch(`${d.BASE_URL}/admin/employer-requests/${o}/update-candidate-availability`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({notes:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error updating candidate availability:",r),r}}static async requestFullDetails(o,l=""){try{const r=await fetch(`${d.BASE_URL}/employer/requests/${o}/request-full-details`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({reason:l})});if(!r.ok){const u=await r.json();throw new Error(u.error||`HTTP error! status: ${r.status}`)}return await r.json()}catch(r){throw console.error("Error requesting full details:",r),r}}static async markHiringDecision(o,l,r=""){try{const m=await fetch(`${d.BASE_URL}/employer/requests/${o}/mark-${l}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({decision:l,notes:r})});if(!m.ok){const y=await m.json();throw new Error(y.error||`HTTP error! status: ${m.status}`)}return await m.json()}catch(m){throw console.error("Error marking hiring decision:",m),m}}static async getPhotoAccess(o){try{const l=await fetch(`${d.BASE_URL}/employer/requests/${o}/photo-access`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!l.ok){const m=await l.json();throw new Error(m.error||`HTTP error! status: ${l.status}`)}return await l.json()}catch(l){throw console.error("Error getting photo access:",l),l}}static async getFullDetails(o){try{const l=await fetch(`${d.BASE_URL}/employer/requests/${o}/full-details`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!l.ok){const m=await l.json();throw new Error(m.error||`HTTP error! status: ${l.status}`)}return await l.json()}catch(l){throw console.error("Error getting full details:",l),l}}static async getAllAdminRequests(o={}){try{const{page:l=1,limit:r=10,status:m,priority:u,search:y,sortBy:P,sortOrder:g,category:k,dateFrom:B,dateTo:V,...gt}=o,L=new URLSearchParams({page:l.toString(),limit:r.toString(),...gt});m&&L.append("status",m),u&&L.append("priority",u),y&&L.append("search",y),P&&L.append("sortBy",P),g&&L.append("sortOrder",g),k&&L.append("category",k),B&&L.append("dateFrom",B),V&&L.append("dateTo",V);const ne=await fetch(`${d.BASE_URL}/admin/employer-requests?${L}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(!ne.ok){const N=await ne.json();throw new Error(N.error||`HTTP error! status: ${ne.status}`)}const je=await ne.json();return{success:!0,data:{requests:je.requests||[],pagination:je.pagination||{page:parseInt(l),limit:parseInt(r),total:0,totalPages:1}}}}catch(l){return console.error("Error getting all admin requests:",l),{success:!1,error:l.message}}}}const ra=({status:f,className:o=""})=>{const r=(m=>{switch(m){case"pending":return{icon:e.jsx(Ue,{className:"w-5 h-5"}),color:"text-yellow-600",bgColor:"bg-yellow-100",label:"Pending Review",description:"Request is waiting for admin approval"};case"approved":return{icon:e.jsx(E,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Approved",description:"Request approved, payment required"};case"first_payment_required":return{icon:e.jsx(He,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"First Payment Required",description:"Pay 5,000 RWF for photo access"};case"first_payment_confirmed":return{icon:e.jsx(E,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"Payment Confirmed",description:"Waiting for admin approval"};case"photo_access_granted":return{icon:e.jsx(M,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Photo Access Granted",description:"You can view candidate photo"};case"full_details_requested":return{icon:e.jsx(ut,{className:"w-5 h-5"}),color:"text-purple-600",bgColor:"bg-purple-100",label:"Full Details Requested",description:"Waiting for admin approval"};case"second_payment_required":return{icon:e.jsx(He,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"Second Payment Required",description:"Pay for full details access"};case"second_payment_confirmed":return{icon:e.jsx(E,{className:"w-5 h-5"}),color:"text-blue-600",bgColor:"bg-blue-100",label:"Second Payment Confirmed",description:"Waiting for admin approval"};case"full_access_granted":return{icon:e.jsx(ut,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Full Access Granted",description:"You can view all candidate details"};case"hiring_decision_made":return{icon:e.jsx(oa,{className:"w-5 h-5"}),color:"text-purple-600",bgColor:"bg-purple-100",label:"Hiring Decision Made",description:"Waiting for admin to update availability"};case"completed":return{icon:e.jsx(E,{className:"w-5 h-5"}),color:"text-green-600",bgColor:"bg-green-100",label:"Completed",description:"Request completed successfully"};case"cancelled":return{icon:e.jsx(mt,{className:"w-5 h-5"}),color:"text-red-600",bgColor:"bg-red-100",label:"Cancelled",description:"Request was cancelled"};default:return{icon:e.jsx(na,{className:"w-5 h-5"}),color:"text-gray-600",bgColor:"bg-gray-100",label:"Unknown Status",description:"Status not recognized"}}})(f);return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${r.bgColor} ${r.color} ${o}`,children:[r.icon,e.jsx("span",{children:r.label})]})},us=({currentStatus:f,className:o=""})=>{const l=[{id:"pending",label:"Request Submitted",icon:e.jsx(Me,{className:"w-5 h-5"}),description:"Request submitted and waiting for admin review"},{id:"approved",label:"Request Approved",icon:e.jsx(E,{className:"w-5 h-5"}),description:"Admin approved the request"},{id:"first_payment_required",label:"First Payment",icon:e.jsx(He,{className:"w-5 h-5"}),description:"Pay 5,000 RWF for photo access"},{id:"photo_access_granted",label:"Photo Access",icon:e.jsx(M,{className:"w-5 h-5"}),description:"View candidate photo and basic info"},{id:"second_payment_required",label:"Second Payment",icon:e.jsx(He,{className:"w-5 h-5"}),description:"Pay for full details access"},{id:"full_access_granted",label:"Full Access",icon:e.jsx(ut,{className:"w-5 h-5"}),description:"View all candidate details"},{id:"hiring_decision_made",label:"Hiring Decision",icon:e.jsx(oa,{className:"w-5 h-5"}),description:"Mark candidate as hired or not hired"},{id:"completed",label:"Completed",icon:e.jsx(E,{className:"w-5 h-5"}),description:"Request completed successfully"}],r=y=>{const P=["pending","approved","first_payment_required","first_payment_confirmed","photo_access_granted","full_details_requested","second_payment_required","second_payment_confirmed","full_access_granted","hiring_decision_made","completed"],g=P.indexOf(f),k=P.indexOf(y);return g===-1||k===-1?"pending":k<g?"completed":k===g?"current":"pending"},m=(y,P)=>P==="completed"?e.jsx(E,{className:"w-5 h-5 text-green-600"}):P==="current"?e.jsx(Ue,{className:"w-5 h-5 text-blue-600"}):e.jsx(Ya,{className:"w-5 h-5 text-gray-400"}),u=y=>{switch(y){case"completed":return"text-green-600 bg-green-50 border-green-200";case"current":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-400 bg-gray-50 border-gray-200"}};return e.jsxs("div",{className:`space-y-4 ${o}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Request Progress"}),e.jsx("div",{className:"space-y-3",children:l.map((y,P)=>{const g=r(y.id),k=P===l.length-1;return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full border-2 flex items-center justify-center ${u(g)}`,children:m(y,g)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:`text-sm font-medium ${g==="current"?"text-blue-900":g==="completed"?"text-green-900":"text-gray-500"}`,children:y.label}),g==="current"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Current"})]}),e.jsx("p",{className:`text-sm mt-1 ${g==="current"?"text-blue-700":g==="completed"?"text-green-700":"text-gray-400"}`,children:y.description})]}),!k&&e.jsx("div",{className:"absolute left-5 top-10 w-0.5 h-8 bg-gray-200"})]},y.id)})})]})},ps=({stats:f,className:o=""})=>e.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 ${o}`,children:f.map((l,r)=>e.jsx(ds,{...l,index:r},l.title))}),gs=()=>{const{t:f}=Za(),{user:o}=ns(),[l,r]=i.useState([]),[m,u]=i.useState(!1),[y,P]=i.useState(null),[g,k]=i.useState(1),[B,V]=i.useState(1),[gt,L]=i.useState(0),[ne,je]=i.useState({}),[N,ia]=i.useState(""),[H,Be]=i.useState({}),[ht,xt]=i.useState(!1),q=i.useCallback(async(t=g,s=N,n=H)=>{u(!0),P(null);try{const c={page:t,limit:10,search:s,...n},p=await C.getAllAdminRequests(c);p.success?(r(p.data.requests||[]),V(p.data.pagination?.totalPages||1),L(p.data.pagination?.total||0),k(p.data.pagination?.page||1),je(p.data.pagination||{})):P(p.error||"Failed to fetch requests")}catch(c){P("An error occurred while fetching requests"),console.error("Error fetching requests:",c)}finally{u(!1)}},[g,N,H]),Q=i.useCallback(t=>{k(t),q(t,N,H)},[q,N,H]);i.useCallback(()=>{g<B&&Q(g+1)},[g,B,Q]),i.useCallback(()=>{g>1&&Q(g-1)},[g,Q]),i.useMemo(()=>g<B,[g,B]),i.useMemo(()=>g>1,[g]);const yt=i.useCallback(()=>{q(g,N,H)},[q,g,N,H]);i.useEffect(()=>{q()},[]);const J=i.useCallback(t=>{ia(t),k(1),q(1,t,H)},[H,q]),X=i.useCallback((t,s)=>{const n={...H,[t]:s};Be(n),Bt(c=>({...c,[t]:s})),k(1),q(1,N,n)},[H,N,q]);i.useCallback(t=>{J(t)},[J]),i.useCallback(t=>{Be(t),k(1),q(1,N,t)},[N,q]);const ca=()=>{},da=()=>{},ma=async()=>{if(!window.confirm(`âš ï¸ DANGER: This will permanently delete all testing data!

This includes:
â€¢ All job seekers and their profiles
â€¢ All employer accounts and requests
â€¢ All payments and messages
â€¢ All notifications and progress data

This action CANNOT be undone!

Admin accounts and job categories will be preserved.

Are you absolutely sure you want to continue?`)||!window.confirm(`ðŸš¨ FINAL WARNING!

You are about to delete ALL testing data.

Type "DELETE" in the next prompt to confirm:`))return;if(window.prompt('Type "DELETE" to confirm deletion:')!=="DELETE"){alert('Deletion cancelled. You must type "DELETE" exactly as shown.');return}xt(!0);try{const c=await is.cleanTestingData();if(c.success)alert(`âœ… Testing data cleaned successfully!

Summary:
â€¢ ${c.summary.users||0} users deleted
â€¢ ${c.summary.employerRequests||0} employer requests deleted
â€¢ ${c.summary.profiles||0} job seeker profiles deleted
â€¢ ${c.summary.payments||0} payments deleted
â€¢ ${c.summary.messages||0} messages deleted
â€¢ ${c.summary.notifications||0} notifications deleted
â€¢ ${c.summary.contacts||0} contacts deleted
â€¢ ${c.summary.auditLogs||0} audit logs deleted

Preserved: Admin accounts, Job categories`),q(1,"",{});else throw new Error(c.details||"Failed to clean data")}catch(c){console.error("Error cleaning testing data:",c),alert(`âŒ Failed to clean testing data!

Error: ${c.message}

Please check the console for more details and try again.`)}finally{xt(!1)}},bt=()=>{},{categories:ua,loadingCategories:ft,fetchCategories:jt}=os(),ee={status:[{value:"",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"first_payment_required",label:"First Payment Required"},{value:"first_payment_confirmed",label:"First Payment Confirmed"},{value:"photo_access_granted",label:"Photo Access Granted"},{value:"full_details_requested",label:"Full Details Requested"},{value:"second_payment_required",label:"Second Payment Required"},{value:"second_payment_confirmed",label:"Second Payment Confirmed"},{value:"full_access_granted",label:"Full Access Granted"},{value:"hiring_decision_made",label:"Hiring Decision Made"},{value:"hired",label:"Hired"},{value:"available",label:"Available"},{value:"process_complete",label:"Process Complete"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"},{value:"payment_required",label:"Payment Required (Legacy)"},{value:"payment_confirmed",label:"Payment Confirmed (Legacy)"}],priority:[{value:"",label:"All Priorities"},{value:"urgent",label:"Urgent"},{value:"high",label:"High"},{value:"normal",label:"Normal"},{value:"low",label:"Low"}],category:[{value:"",label:"All Categories"},...(ua||[]).map(t=>({value:t.name_en.toLowerCase(),label:t.name_en}))],dateRange:[{value:"",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"}],monthlyRateRange:[{value:"",label:"All Rates"},{value:"0-50000",label:"0 - 50,000 frw"},{value:"50000-100000",label:"50,000 - 100,000 frw"},{value:"100000-200000",label:"100,000 - 200,000 frw"},{value:"200000+",label:"200,000+ frw"}]},[a,T]=i.useState(null),[ze,We]=i.useState(!1),[oe,te]=i.useState(!1),[z,le]=i.useState(null),[Nt,Ne]=i.useState(""),[ie,Ge]=i.useState(""),[ae,vt]=i.useState(!1),[wt,ve]=i.useState(""),[hs,Ke]=i.useState(null),[we,Ct]=i.useState(!1),[kt,Ce]=i.useState(""),[xs,St]=i.useState(!1),[ys,Pt]=i.useState("picture"),[ce,At]=i.useState(!1),[ke,A]=i.useState(!1),[de,me]=i.useState(null),[ue,$]=i.useState(!1),[Rt,S]=i.useState(""),[v,I]=i.useState(""),[Se,pe]=i.useState(""),[Dt,Pe]=i.useState(""),[Ae,Ve]=i.useState(""),[pa,qt]=i.useState({}),[_t,ge]=i.useState([]),[Re,Ft]=i.useState(!1),[he,xe]=i.useState(0),[ga,Et]=i.useState(!1),[De,Je]=i.useState(!1),[Tt,ye]=i.useState([]),[qe,_e]=i.useState(""),[Fe,Ee]=i.useState(!1),[$t,se]=i.useState(""),[Lt,Ye]=i.useState(!1),[ha,xa]=i.useState([]),[Ze,It]=i.useState(!1),[Ot,Y]=i.useState(""),[b,U]=i.useState({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),[Mt,Qe]=i.useState(!1),[Xe,Ht]=i.useState(!1),[Ut,K]=i.useState(""),[F,re]=i.useState({action:"approve",notes:""}),[ya,Te]=i.useState(!1),[j,Bt]=i.useState({status:"",priority:"",category:"",dateRange:"",monthlyRateRange:""}),[et,ba]=i.useState(!1),[fa,zt]=i.useState(!1),R=i.useCallback(()=>{te(!1),le(null),T(null),Ge(""),Ne(""),ve(""),Ve(""),Pe(""),Ke(null),Ce(""),We(!1),Je(!1),ye([]),_e(""),se(""),Y(""),Ye(!1),U({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),Y(""),Qe(!1),re({action:"approve",notes:""}),K(""),Te(!1)},[]),ja=async t=>{try{T(t),Je(!0),Ee(!0),se("");const s=await fe.getMessagesByRequest(t.id);ye(s.messages||[])}catch(s){console.error("Error opening messaging:",s),se("Failed to load messages"),x.error("Failed to load messages")}finally{Ee(!1)}},Na=()=>{Je(!1),ye([]),_e(""),se("")},Wt=async()=>{if(!(!qe.trim()||!a))try{Ee(!0),se(""),await fe.sendMessage(a.id,{content:qe.trim(),messageType:"text"}),_e("");const t=await fe.getMessagesByRequest(a.id);ye(t.messages||[]),x.success("Message sent successfully")}catch(t){console.error("Error sending message:",t),se("Failed to send message"),x.error("Failed to send message")}finally{Ee(!1)}},va=async()=>{if(a)try{await fe.markMessagesAsRead(a.id);const t=await fe.getMessagesByRequest(a.id);ye(t.messages||[])}catch(t){console.error("Error marking messages as read:",t)}};i.useEffect(()=>{De&&a&&va()},[De,a]);const Gt=async()=>{try{Et(!0);const t=await dt.getWorkflowNotifications();ge(t.notifications||[]),xe(t.unreadCount||0)}catch(t){console.error("Error fetching notifications:",t),ge([]),xe(0)}finally{Et(!1)}},wa=async t=>{try{await dt.markAsRead(t),ge(s=>s.map(n=>n.id===t?{...n,isRead:!0}:n)),xe(s=>Math.max(0,s-1))}catch(s){console.error("Error marking notification as read:",s)}},Ca=async()=>{try{await dt.markAllAsRead(),ge(t=>t.map(s=>({...s,isRead:!0}))),xe(0)}catch(t){console.error("Error marking all notifications as read:",t)}},ka=(t,s,n,c)=>{const p={id:Date.now(),type:t,message:s,requestId:n,status:c,timestamp:new Date,isRead:!1};ge(_=>[p,..._]),xe(_=>_+1),x.success(s,{duration:5e3,position:"top-right"})};i.useEffect(()=>{Gt();const t=setInterval(Gt,3e4);return()=>clearInterval(t)},[]),i.useEffect(()=>{const t=s=>{Re&&!s.target.closest(".notification-dropdown")&&Ft(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[Re]);const Sa=async()=>{try{const s=await(await fetch(`${d.BASE_URL}/payment-methods/active`)).json();xa(s.paymentMethods||[])}catch(t){console.error("Error fetching payment methods:",t),x.error("Failed to load payment methods")}},Pa=async t=>{T(t),Ye(!0),U({amount:t.paymentAmount||"5000",currency:t.paymentCurrency||"RWF",description:t.paymentDescription||"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),await Sa()},tt=()=>{Ye(!1),U({amount:"",currency:"RWF",description:"",paymentMethodId:"",paymentType:"photo_access",dueDate:""}),Y("")},Aa=async t=>{if(t.preventDefault(),!b.paymentMethodId||!b.amount){Y("Please select a payment method and enter amount");return}try{It(!0),Y("");const s=await fetch(`${d.BASE_URL}/payments/request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({employerRequestId:a.id,amount:b.amount,currency:b.currency,description:b.description,paymentMethodId:b.paymentMethodId,paymentType:b.paymentType,dueDate:b.dueDate||null})}),n=await s.json();s.ok?(x.success("Payment request sent successfully!"),tt(),D()):Y(n.error||"Failed to send payment request")}catch(s){console.error("Error sending payment request:",s),Y("Network error. Please try again.")}finally{It(!1)}},Ra=async t=>{console.log("Opening request details modal for request:",t);try{Te(!0);const s=await fetch(`${d.BASE_URL}/admin/employer-requests/${t.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(s.ok){const n=await s.json();console.log("Fetched full request data from backend:",n),console.log("Employer Account data:",n.employerAccount),console.log("Employer User data:",n.employerAccount?.user);const c=st(n);console.log("Transformed request data:",c),T(c)}else console.error("Failed to fetch full request data"),T(t)}catch(s){console.error("Error fetching request details:",s),T(t)}finally{Te(!1)}We(!0)},Da=async t=>{console.log("Opening payment approval modal for request:",t),console.log("Request latestPayment:",t.latestPayment),console.log("Request _backendData:",t._backendData);try{const s=await fetch(`${d.BASE_URL}/admin/employer-requests/${t.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`}});if(s.ok){const n=await s.json();console.log("Fetched full request data from backend:",n);const c=st(n);console.log("Transformed request data:",c),T(c)}else console.error("Failed to fetch full request data"),T(t)}catch(s){console.error("Error fetching request details:",s),T(t)}Qe(!0),re({action:"approve",notes:""}),K("")},at=()=>{Qe(!1),re({action:"approve",notes:""}),K("")},qa=async t=>{if(t.preventDefault(),!a){K("No request selected");return}try{Ht(!0),K("");let s;const n=a.id;if(a.status==="first_payment_confirmed"||a.status==="payment_confirmed")F.action==="approve"?s=await C.approveFirstPayment(n,F.notes):s=await C.rejectFirstPayment(n,F.notes);else if(a.status==="second_payment_confirmed")F.action==="approve"?s=await C.approveSecondPayment(n,F.notes):s=await C.rejectSecondPayment(n,F.notes);else{K("Invalid status for payment approval");return}if(s){const c=F.action==="approve"?"approved":"rejected";x.success(`Payment ${c} successfully!`),at(),D()}else K("Failed to process payment approval")}catch(s){console.error("Error processing payment approval:",s),K(s.message||"Network error. Please try again.")}finally{Ht(!1)}},Kt=i.useCallback(()=>{},[oe,z,a,ze,ie,Nt,Ae]),st=t=>{if(!t)return null;try{const s=n=>{if(!n||n==="Not specified")return"Not specified";if(typeof n=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(n);if(typeof n=="string"){const c=parseFloat(n);return isNaN(c)?n:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(c)}return"Not specified"};return{id:t.id,employerName:t.employerAccount?.user?.name||t.employerAccount?.companyName||t.name||"Unknown",companyName:t.employerAccount?.companyName||t.companyName||"Private",candidateName:t.requestedCandidate&&`${t.requestedCandidate.profile?.firstName||""} ${t.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:t.requestedCandidate?.profile?.skills||"General",status:t.status||"pending",priority:t.priority||"normal",date:t.createdAt,monthlyRate:s(t.requestedCandidate?.profile?.monthlyRate),message:t.message||"",employerContact:{email:t.employerAccount?.user?.email||t.employerAccount?.email||t.email||"",phone:t.employerAccount?.phoneNumber||t.employerAccount?.user?.phoneNumber||t.phoneNumber||""},employerDetails:{companyAddress:t.employerAccount?.companyAddress||"",industry:t.employerAccount?.industry||"",companySize:t.employerAccount?.companySize||"",website:t.employerAccount?.website||"",description:t.employerAccount?.description||"",establishedYear:t.employerAccount?.establishedYear||"",contactPerson:t.employerAccount?.contactPerson||""},adminNotes:"",lastContactDate:t.updatedAt,isCompleted:t.status==="completed",category:t.requestedCandidate?.profile?.jobCategory?.name_en||"General",latestPayment:t.payments&&t.payments.length>0?{id:t.payments[0].id,amount:t.payments[0].amount,currency:t.payments[0].currency||"RWF",paymentType:t.payments[0].paymentType,status:t.payments[0].status,confirmationName:t.payments[0].confirmationName,confirmationPhone:t.payments[0].confirmationPhone,confirmationDate:t.payments[0].confirmationDate,paymentReference:t.payments[0].paymentReference,adminNotes:t.payments[0].adminNotes,createdAt:t.payments[0].createdAt,updatedAt:t.payments[0].updatedAt}:null,candidateExperience:t.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:t.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:t.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:t.requestedCandidate?.profile?.location||"Not specified",candidateCity:t.requestedCandidate?.profile?.city||"Not specified",candidateCountry:t.requestedCandidate?.profile?.country||"Not specified",candidateContact:t.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:t.requestedCandidate?.email||"Not specified",candidateLanguages:t.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:t.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:t.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:t.requestedCandidate?.profile?.description||"Not specified",candidateGender:t.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:t.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:t.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:t.requestedCandidate?.profile?.references||"Not specified",_backendData:t}}catch(s){return console.error("Error transforming request data:",s),{id:t?.id||"unknown",employerName:"Data unavailable",companyName:"Data unavailable",candidateName:"Data unavailable",position:"Data unavailable",status:"pending",priority:"normal",date:new Date,monthlyRate:"Data unavailable",message:"Data unavailable",employerContact:{email:"",phone:""},adminNotes:"",lastContactDate:new Date,isCompleted:!1,category:"Data unavailable",_backendData:t,_hasError:!0}}},rt=i.useMemo(()=>!l||!Array.isArray(l)?[]:l.map(st).filter(Boolean),[l]),W=rt.map(t=>t._hasError?{...t,employerName:"Data unavailable",companyName:"Data unavailable",candidateName:"Data unavailable",position:"Data unavailable",status:"pending",priority:"normal",monthlyRate:"Data unavailable",message:"Data unavailable",employerContact:{email:"",phone:""}}:{...t,employerName:t.employerName||"Unknown",companyName:t.companyName||"Private",candidateName:t.candidateName||"Not specified",position:t.position||"General",status:t.status||"pending",priority:t.priority||"normal",monthlyRate:t.monthlyRate||"Not specified",message:t.message||"",employerContact:{email:t.employerContact?.email||"",phone:t.employerContact?.phone||""}});Qa.useEffect(()=>{try{rt.forEach(t=>{const s=t._backendData?.requestedCandidate?.profile?.photo||t._backendData?.requestedCandidate?.photo||null})}catch(t){console.log("EmployerRequestsPage: debug logging error",t)}},[rt]);const _a=[{key:"employerInfo",label:"Employer",sortable:!1,render:t=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(Xt,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.employerName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.companyName})]})]})},{key:"candidateInfo",label:"Candidate",sortable:!1,render:t=>{const s=t._backendData?.requestedCandidate,n=s?.profile?.photo||s?.photo||null,c=n?/^https?:\/\//i.test(n)?n:`${d.BASE_URL}/${n.replace(/^\//,"")}`:null;return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ct,{src:c,alt:t.candidateName,size:"sm",fallback:t.candidateName}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.candidateName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.position})]})]})}},{key:"category",label:"Category",sortable:!0,searchable:!0,type:"badge",badgeColor:t=>{switch(t?.toLowerCase()){case"domestic":return"text-blue-600 bg-blue-50 border-blue-200";case"care":return"text-pink-600 bg-pink-50 border-pink-200";case"food":return"text-orange-600 bg-orange-50 border-orange-200";case"maintenance":return"text-green-600 bg-green-50 border-green-200";case"transport":return"text-indigo-600 bg-indigo-50 border-indigo-200";case"general":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}},{key:"monthlyRate",label:"Monthly Rate",sortable:!0,type:"text"},{key:"status",label:"Status",sortable:!0,type:"badge",badgeColor:ms},{key:"priority",label:"Priority",sortable:!0,type:"badge",badgeColor:aa},{key:"date",label:"Request Date",sortable:!0,type:"date"},{key:"actions",label:"Actions",sortable:!1,render:t=>e.jsxs("div",{className:"flex items-center gap-1",children:[lt(t).slice(0,4).map((s,n)=>{const c=s.icon,p=pa[`${s.key}-${t.id}`];return e.jsxs("button",{onClick:()=>nt(s.key,t),disabled:p,className:`relative group p-2 rounded-lg transition-all duration-200 hover:scale-110 ${s.className} border border-gray-200 hover:border-current ${p?"opacity-50 cursor-not-allowed":""}`,title:s.title,children:[p?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):e.jsx(c,{className:"w-4 h-4"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[p?"Processing...":s.title,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]},n)}),lt(t).length>4&&e.jsxs("button",{onClick:()=>nt("openActions",t),className:"relative group p-2 rounded-lg transition-all duration-200 hover:scale-110 text-gray-600 hover:bg-gray-50 border border-gray-200 hover:border-gray-400",title:"More actions",children:[e.jsx(rs,{className:"w-4 h-4"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:["More actions",e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]})]})}];i.useEffect(()=>{jt()},[jt]),i.useEffect(()=>()=>{R()},[R]),i.useEffect(()=>{Kt()},[Kt]);const O=i.useMemo(()=>{let t=W||[];if(j.status&&j.status!=="all"&&(t=t.filter(s=>s.status===j.status)),N.trim()){const s=N.toLowerCase();t=t.filter(n=>n.employerName?.toLowerCase().includes(s)||n.companyName?.toLowerCase().includes(s)||n.candidateName?.toLowerCase().includes(s)||n.message?.toLowerCase().includes(s)||n.position?.toLowerCase().includes(s))}if(j.status&&(t=t.filter(s=>s.status===j.status)),j.priority&&(t=t.filter(s=>s.priority===j.priority)),j.category&&(t=t.filter(s=>s.category?.toLowerCase()===j.category.toLowerCase())),j.dateRange){const s=new Date,n=new Date(s.getFullYear(),s.getMonth(),s.getDate());t=t.filter(c=>{const p=new Date(c.date);switch(j.dateRange){case"today":return p>=n;case"week":const _=new Date(n.getTime()-10080*60*1e3);return p>=_;case"month":const $e=new Date(n.getTime()-720*60*60*1e3);return p>=$e;case"quarter":const Ka=new Date(n.getTime()-2160*60*60*1e3);return p>=Ka;case"year":const Va=new Date(n.getTime()-365*24*60*60*1e3);return p>=Va;default:return!0}})}return j.monthlyRateRange&&(t=t.filter(s=>{const n=s.monthlyRate;if(n==="Not specified")return!1;const c=typeof n=="string"?parseFloat(n.replace(/[^\d.]/g,"")):n;if(isNaN(c))return!1;switch(j.monthlyRateRange){case"0-50000":return c>=0&&c<=5e4;case"50000-100000":return c>5e4&&c<=1e5;case"100000-200000":return c>1e5&&c<=2e5;case"200000+":return c>2e5;default:return!0}})),t},[W,N,j]),Fa=i.useCallback(t=>{J(t),zt(!0);const s=setTimeout(()=>{zt(!1)},300);return()=>clearTimeout(s)},[]),Vt=i.useCallback(()=>{const t={status:"",priority:"",category:"",dateRange:"",monthlyRateRange:""};Bt(t),Be(t),J(""),k(1),q(1,"",t)},[q,J]),G=i.useMemo(()=>{let t=0;return N.trim()&&t++,Object.values(j).forEach(s=>{s&&t++}),t},[N,j]),Ea=i.useMemo(()=>[{title:"Total Requests",value:O.length.toString(),change:`+${O.length-(W||[]).length}`,changeType:O.length>=(W||[]).length?"increase":"decrease",icon:Le,color:"text-blue-600",bgColor:"bg-blue-50",description:`${G>0?"Filtered":"All"} employer requests`},{title:"Pending Review",value:O.filter(t=>t.status==="pending").length.toString(),change:"+2",changeType:"increase",icon:Ue,color:"text-orange-600",bgColor:"bg-orange-50",description:"Awaiting admin approval"},{title:"Payment Pending",value:O.filter(t=>["first_payment_required","second_payment_required","first_payment_confirmed","second_payment_confirmed","payment_required","payment_confirmed"].includes(t.status)).length.toString(),change:"+1",changeType:"increase",icon:Ie,color:"text-yellow-600",bgColor:"bg-yellow-50",description:"Payment processing"},{title:"Completed",value:O.filter(t=>t.status==="completed").length.toString(),change:"+3",changeType:"increase",icon:E,color:"text-green-600",bgColor:"bg-green-50",description:"Successfully closed"}],[O,W,G]),D=i.useCallback(()=>{Q(1),yt()},[Q,yt]),nt=(t,s)=>{switch(T(s),Ne(s.adminNotes||""),t){case"openActions":te(!0),le(null);break;case"view":Ra(s),te(!1);break;case"contact":sa(s.employerContact,"email"),R();break;case"call":sa(s.employerContact,"phone"),R();break;case"reply":le("reply"),te(!0);break;case"message":ja(s);break;case"payment":Pa(s);break;case"paymentApproval":Da(s);break;case"select":le("select"),te(!0);break;case"approveRequest":h("approveRequest",s);break;case"rejectRequest":h("rejectRequest",s);break;case"requestFirstPayment":h("requestFirstPayment",s);break;case"viewPaymentDetails":h("viewPaymentDetails",s);break;case"approveFirstPayment":h("approveFirstPayment",s);break;case"rejectFirstPayment":h("rejectFirstPayment",s);break;case"requestSecondPayment":h("requestSecondPayment",s);break;case"viewPhotoAccess":h("viewPhotoAccess",s);break;case"approveFullDetailsRequest":h("approveFullDetailsRequest",s);break;case"rejectFullDetailsRequest":h("rejectFullDetailsRequest",s);break;case"approveSecondPayment":h("approveSecondPayment",s);break;case"rejectSecondPayment":h("rejectSecondPayment",s);break;case"viewFullDetails":h("viewFullDetails",s);break;case"waitForHiringDecision":h("waitForHiringDecision",s);break;case"reviewHiringDecision":h("reviewHiringDecision",s);break;case"updateCandidateAvailability":h("updateCandidateAvailability",s);break;case"viewCompletedRequest":h("viewCompletedRequest",s);break;case"start":ot("in_progress","Starting to process this request"),R();break;case"approve":ot("approved","Request approved and ready for completion"),R();break;case"complete":le("complete"),te(!0);break;case"reactivate":ot("pending","Request reactivated and back to pending status"),R();break;default:console.warn("Unknown action:",t),R()}},ot=async(t,s)=>{if(a)try{const n=await bt(a.id,{status:t,adminNotes:s});n.success?(x.success(`Request status updated to ${t}. ${s||""}`),D()):(console.error("âŒ Failed to update status:",n.error),x.error(`Failed to update status: ${n.error}`))}catch(n){console.error("âŒ Error updating status:",n),x.error("Network error. Please try again.")}},Ta=async()=>{if(!(!a||!ie.trim())){vt(!0),ve("");try{const t=await ca(a.id,{content:ie});if(t.success){const s=t.data.emailSent?`Reply sent successfully to ${a.employerName} at ${a.employerContact.email}`:"Reply saved but email delivery failed. Please check the email configuration.";x.success(s),Ge(""),Ne(""),R(),D()}else console.error("âŒ Reply failed:",t.error),ve(t.error||"Failed to send reply")}catch(t){console.error("âŒ Error sending reply:",t),ve("Network error. Please try again.")}finally{vt(!1)}}},Jt=async(t,s="picture")=>{if(a){Ct(!0),Ce("");try{const n=await da(a.id,t,s);if(n.success){const c=s==="picture"?`Candidate profile picture sent to ${a.employerName}`:`Complete candidate details sent to ${a.employerName}`;x.success(c),R(),D()}else console.error("âŒ Failed to send candidate information:",n.error),Ce(n.error||"Failed to send candidate information")}catch(n){console.error("âŒ Error sending candidate information:",n),Ce("Network error. Please try again.")}finally{Ct(!1)}}},$a=async()=>{if(a){At(!0),Pe("");try{const t=await bt(a.id,{status:"completed",adminNotes:Ae});t.success?(x.success(`Request completed successfully. ${Ae?"Notes have been saved.":""}`),Ve(""),R(),D()):(console.error("âŒ Failed to complete request:",t.error),Pe(t.error||"Failed to complete request"))}catch(t){console.error("âŒ Error completing request:",t),Pe("Network error. Please try again.")}finally{At(!1)}}},La=async()=>{if(a)try{$(!0),S("");const t=await C.requestFullDetails(a.id,v);t.message&&(x.success(t.message),A(!1),I(""),D())}catch(t){console.error("Error requesting full details:",t),S(t.message||"Failed to request full details")}finally{$(!1)}},Yt=async t=>{if(a)try{$(!0),S("");const s=await C.markHiringDecision(a.id,t,v);s.message&&(x.success(s.message),A(!1),I(""),D())}catch(s){console.error("Error marking hiring decision:",s),S(s.message||"Failed to mark hiring decision")}finally{$(!1)}},Ia=async()=>{if(a)try{$(!0),S("");const t=await C.getPhotoAccess(a.id);Ke(t),Pt("photo"),St(!0),A(!1)}catch(t){console.error("Error getting photo access:",t),S(t.message||"Failed to get photo access")}finally{$(!1)}},Oa=async()=>{if(a)try{$(!0),S("");const t=await C.getFullDetails(a.id);Ke(t),Pt("full"),St(!0),A(!1)}catch(t){console.error("Error getting full details:",t),S(t.message||"Failed to get full details")}finally{$(!1)}},Ma=t=>({approveRequest:"Approve Request",rejectRequest:"Reject Request",requestFirstPayment:"Request First Payment",viewPaymentDetails:"View Payment Details",approveFirstPayment:"Approve First Payment",rejectFirstPayment:"Reject First Payment",requestSecondPayment:"Request Second Payment",viewPhotoAccess:"View Photo Access",approveFullDetailsRequest:"Approve Full Details Request",rejectFullDetailsRequest:"Reject Full Details Request",approveSecondPayment:"Approve Second Payment",rejectSecondPayment:"Reject Second Payment",viewFullDetails:"View Full Details",waitForHiringDecision:"Wait for Hiring Decision",reviewHiringDecision:"Review Hiring Decision",updateCandidateAvailability:"Update Candidate Availability",viewCompletedRequest:"View Completed Request",request_full_details:"Request Full Details",mark_hired:"Mark as Hired",mark_not_hired:"Mark as Not Hired",get_photo_access:"View Photo Access",get_full_details:"View Full Details"})[t]||"Workflow Action",Ha=t=>t==="requestSecondPayment"&&o?.role==="admin"?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Request Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Request ID:"})," #",a.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",a.status.replace("_"," ").replace(/\b\w/g,n=>n.toUpperCase())]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Employer:"})," ",a.employerName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Candidate:"})," ",a.candidateName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Company:"})," ",a.companyName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(a.date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Second Payment Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:v,onChange:n=>I(n.target.value),className:"w-full px-3 py-2 border-2 border-blue-500 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-semibold",placeholder:"Enter amount (e.g. 10000)",min:"1",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Request Notes (Optional)"}),e.jsx("textarea",{value:Se,onChange:n=>pe(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Add any notes about the second payment request..."})]})]}):t==="approveFullDetailsRequest"&&o?.role==="admin"?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Approve Full Details Request"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Request ID:"})," #",a.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",a.status.replace("_"," ").replace(/\b\w/g,n=>n.toUpperCase())]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Employer:"})," ",a.employerName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Candidate:"})," ",a.candidateName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Company:"})," ",a.companyName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(a.date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Second Payment Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:v,onChange:n=>I(n.target.value),className:"w-full px-3 py-2 border-2 border-green-500 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-lg font-semibold",placeholder:"Enter amount (e.g. 10000)",min:"1",required:!0}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Set the amount for the second payment to grant full details access"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Notes (Optional)"}),e.jsx("textarea",{value:Se,onChange:n=>pe(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:3,placeholder:"Add any notes about approving full details access..."})]})]}):["approveRequest","rejectRequest","requestFirstPayment","approveFirstPayment","rejectFirstPayment","rejectFullDetailsRequest","approveSecondPayment","rejectSecondPayment","updateCandidateAvailability","request_full_details","mark_hired","mark_not_hired"].includes(t)?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:Ua(t)}),e.jsx("textarea",{value:v,onChange:n=>I(n.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:Ba(t)})]}):t.startsWith("view")||t==="reviewHiringDecision"||t==="waitForHiringDecision"?e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Information"}),e.jsx("p",{className:"text-blue-800 text-sm",children:za(t)})]}):null,Ua=t=>({approveRequest:"Approval Notes (Optional)",rejectRequest:"Rejection Reason (Required)",requestFirstPayment:"Payment Request Notes (Optional)",approveFirstPayment:"Approval Notes (Optional)",rejectFirstPayment:"Rejection Reason (Required)",requestSecondPayment:"Payment Request Notes (Optional)",approveFullDetailsRequest:"Approval Notes (Optional)",rejectFullDetailsRequest:"Rejection Reason (Required)",approveSecondPayment:"Approval Notes (Optional)",rejectSecondPayment:"Rejection Reason (Required)",updateCandidateAvailability:"Update Notes (Optional)",request_full_details:"Reason for requesting full details (optional)",mark_hired:"Notes about hiring decision (optional)",mark_not_hired:"Notes about not hiring (optional)"})[t]||"Notes (Optional)",Ba=t=>({approveRequest:"Add any notes about approving this request...",rejectRequest:"Explain why this request is being rejected...",requestFirstPayment:"Add any notes about the payment request...",approveFirstPayment:"Add any notes about approving the first payment...",rejectFirstPayment:"Explain why the first payment is being rejected...",requestSecondPayment:"Add any notes about the second payment request...",approveFullDetailsRequest:"Add any notes about approving full details access...",rejectFullDetailsRequest:"Explain why full details access is being rejected...",approveSecondPayment:"Add any notes about approving the second payment...",rejectSecondPayment:"Explain why the second payment is being rejected...",updateCandidateAvailability:"Add any notes about updating candidate availability...",request_full_details:"Explain why you need full details...",mark_hired:"Add any notes about the hiring decision...",mark_not_hired:"Add any notes about why the candidate was not hired..."})[t]||"Add notes...",za=t=>({viewPaymentDetails:"View payment confirmation details and approve or reject the payment.",viewPhotoAccess:"View the photo access that has been granted to the employer.",viewFullDetails:"View the full details access that has been granted to the employer.",reviewHiringDecision:"Review the hiring decision made by the employer and update candidate availability.",waitForHiringDecision:"The employer has full access and should make a hiring decision soon.",viewCompletedRequest:"This request has been completed successfully."})[t]||"No additional information available.",Wa=t=>({approveRequest:"Approving Request...",rejectRequest:"Rejecting Request...",requestFirstPayment:"Requesting Payment...",approveFirstPayment:"Approving Payment...",rejectFirstPayment:"Rejecting Payment...",requestSecondPayment:"Requesting Payment...",approveFullDetailsRequest:"Approving Full Details...",rejectFullDetailsRequest:"Rejecting Full Details...",approveSecondPayment:"Approving Payment...",rejectSecondPayment:"Rejecting Payment...",updateCandidateAvailability:"Updating Status...",request_full_details:"Requesting Details...",mark_hired:"Marking as Hired...",mark_not_hired:"Marking as Not Hired...",get_photo_access:"Loading Photo Access...",get_full_details:"Loading Full Details..."})[t]||"Processing...",Ga=t=>{const n={approveRequest:{text:"Approve Request",className:"bg-green-600 hover:bg-green-700",onClick:()=>h("approveRequest",a)},rejectRequest:{text:"Reject Request",className:"bg-red-600 hover:bg-red-700",onClick:()=>h("rejectRequest",a)},requestFirstPayment:{text:"Request First Payment",className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>h("requestFirstPayment",a)},approveFirstPayment:{text:"Approve First Payment",className:"bg-green-600 hover:bg-green-700",onClick:()=>h("approveFirstPayment",a)},rejectFirstPayment:{text:"Reject First Payment",className:"bg-red-600 hover:bg-red-700",onClick:()=>h("rejectFirstPayment",a)},requestSecondPayment:{text:"Request Second Payment",className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>h("requestSecondPayment",a)},approveFullDetailsRequest:{text:"Approve Full Details",className:"bg-green-600 hover:bg-green-700",onClick:()=>h("approveFullDetailsRequest",a)},rejectFullDetailsRequest:{text:"Reject Full Details",className:"bg-red-600 hover:bg-red-700",onClick:()=>h("rejectFullDetailsRequest",a)},approveSecondPayment:{text:"Approve Second Payment",className:"bg-green-600 hover:bg-green-700",onClick:()=>h("approveSecondPayment",a)},rejectSecondPayment:{text:"Reject Second Payment",className:"bg-red-600 hover:bg-red-700",onClick:()=>h("rejectSecondPayment",a)},updateCandidateAvailability:{text:"Update Candidate Status",className:"bg-purple-600 hover:bg-purple-700",onClick:()=>h("updateCandidateAvailability",a)},request_full_details:{text:"Request Full Details",className:"bg-purple-600 hover:bg-purple-700",onClick:La},mark_hired:{text:"Mark as Hired",className:"bg-green-600 hover:bg-green-700",onClick:()=>Yt("hired")},mark_not_hired:{text:"Mark as Not Hired",className:"bg-red-600 hover:bg-red-700",onClick:()=>Yt("not_hired")},get_photo_access:{text:"View Photo Access",className:"bg-blue-600 hover:bg-blue-700",onClick:Ia},get_full_details:{text:"View Full Details",className:"bg-indigo-600 hover:bg-indigo-700",onClick:Oa}}[t];return n?e.jsx(w,{onClick:n.onClick,disabled:ue,className:n.className,children:ue?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),Wa(t)]}):n.text}):null},h=async(t,s)=>{T(s),me(t),S(""),I("");const n=`${t}-${s.id}`;qt(c=>({...c,[n]:!0}));try{$(!0);let c;const p=s.id;switch(t){case"approveRequest":c=await C.approveRequest(p,v);break;case"rejectRequest":c=await C.rejectRequest(p,v);break;case"requestFirstPayment":c=await C.requestFirstPayment(p,v);break;case"viewPaymentDetails":A(!0);return;case"approveFirstPayment":console.log("Approving first payment for request:",p,"with notes:",v),c=await C.approveFirstPayment(p,v),console.log("First payment approval result:",c);break;case"rejectFirstPayment":c=await C.rejectFirstPayment(p,v);break;case"requestSecondPayment":if(a?.status==="second_payment_required"){x.error("Second payment already requested for this request.");return}if(!ke){me("requestSecondPayment"),S(""),I(""),pe(""),A(!0);return}if(!v||isNaN(Number(v))||Number(v)<=0){S("Please enter a valid amount for the second payment."),x.error("Please enter a valid amount for the second payment.");return}console.log(`Admin ${o?.id||o?.email} is requesting second payment of ${v} for request #${a.id}`);try{$(!0);const _=await fetch(`${d.BASE_URL}/admin/employer-requests/${a.id}/request-second-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(d.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify({amount:v,notes:Se})}),$e=await _.json();_.ok?(x.success("Second payment requested successfully."),A(!1),I(""),pe(""),D()):(S($e.error||"Failed to request second payment."),x.error($e.error||"Failed to request second payment."))}catch{S("Network error. Please try again."),x.error("Network error. Please try again.")}finally{$(!1)}break;case"viewPhotoAccess":A(!0);return;case"approveFullDetailsRequest":if(!ke){me("approveFullDetailsRequest"),S(""),I(""),pe(""),A(!0);return}c=await C.approveFullDetailsRequest(p,v,Se);break;case"rejectFullDetailsRequest":c=await C.rejectFullDetailsRequest(p,v);break;case"approveSecondPayment":c=await C.approveSecondPayment(p,v);break;case"rejectSecondPayment":c=await C.rejectSecondPayment(p,v);break;case"viewFullDetails":A(!0);return;case"waitForHiringDecision":x("Waiting for employer to make hiring decision...",{icon:"â³",duration:3e3});return;case"reviewHiringDecision":A(!0);return;case"updateCandidateAvailability":c=await C.updateCandidateAvailability(p,v);break;case"viewCompletedRequest":A(!0);return;default:throw new Error(`Unknown workflow action: ${t}`)}if(c){const _=c.message||`${t.replace(/([A-Z])/g," $1").toLowerCase()} completed successfully`;x.success(_),ka(t,_,p,c.newStatus||"updated"),A(!1),me(null),I(""),S(""),D()}else{const _=`${t.replace(/([A-Z])/g," $1").toLowerCase()} completed successfully`;x.success(_),A(!1),me(null),I(""),S(""),D()}}catch(c){console.error(`Error in workflow action ${t}:`,c),S(c.message||`Failed to ${t.replace(/([A-Z])/g," $1").toLowerCase()}`),x.error(`Failed to ${t.replace(/([A-Z])/g," $1").toLowerCase()}`)}finally{$(!1),qt(c=>({...c,[n]:!1}))}},lt=t=>{const s=[{key:"view",title:"View Details",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"view"},{key:"message",title:"Message",icon:Le,className:"text-indigo-600 hover:bg-indigo-50",group:"contact"}],n=[];switch(t.status){case"pending":n.push({key:"approveRequest",title:"Approve Request",icon:E,className:"text-green-600 hover:bg-green-50",group:"workflow"},{key:"rejectRequest",title:"Reject Request",icon:mt,className:"text-red-600 hover:bg-red-50",group:"workflow"});break;case"approved":n.push({key:"requestFirstPayment",title:"Request First Payment",icon:Ie,className:"text-yellow-600 hover:bg-yellow-50",group:"workflow"});break;case"first_payment_required":n.push({key:"viewPaymentDetails",title:"View Payment Details",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"first_payment_confirmed":n.push({key:"paymentApproval",title:"Approve First Payment",icon:E,className:"text-green-600 hover:bg-green-50",group:"workflow"});break;case"photo_access_granted":n.push({key:"requestSecondPayment",title:"Request Second Payment",icon:Ie,className:"text-yellow-600 hover:bg-yellow-50",group:"workflow"},{key:"viewPhotoAccess",title:"View Photo Access",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"full_details_requested":n.push({key:"approveFullDetailsRequest",title:"Approve Full Details",icon:E,className:"text-green-600 hover:bg-green-50",group:"workflow"},{key:"rejectFullDetailsRequest",title:"Reject Full Details",icon:mt,className:"text-red-600 hover:bg-red-50",group:"workflow"});break;case"second_payment_required":n.push({key:"viewPaymentDetails",title:"View Payment Details",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"second_payment_confirmed":n.push({key:"paymentApproval",title:"Approve Second Payment",icon:E,className:"text-green-600 hover:bg-green-50",group:"workflow"});break;case"payment_required":n.push({key:"viewPaymentDetails",title:"View Payment Details",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;case"payment_confirmed":n.push({key:"paymentApproval",title:"Approve Payment",icon:E,className:"text-green-600 hover:bg-green-50",group:"workflow"});break;case"full_access_granted":n.push({key:"viewFullDetails",title:"View Full Details",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"},{key:"waitForHiringDecision",title:"Wait for Hiring Decision",icon:Ue,className:"text-orange-600 hover:bg-orange-50",group:"workflow"});break;case"hiring_decision_made":n.push({key:"reviewHiringDecision",title:"Review Hiring Decision",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"},{key:"updateCandidateAvailability",title:"Update Candidate Status",icon:Me,className:"text-purple-600 hover:bg-purple-50",group:"workflow"});break;case"completed":n.push({key:"viewCompletedRequest",title:"View Completed Request",icon:M,className:"text-gray-600 hover:bg-gray-50",group:"workflow"});break;case"cancelled":n.push({key:"reactivate",title:"Reactivate",icon:be,className:"text-blue-600 hover:bg-blue-50",group:"workflow"});break;default:n.push({key:"view",title:"View Details",icon:M,className:"text-blue-600 hover:bg-blue-50",group:"workflow"})}return[...s,...n]};return m||!l||!W?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(ls,{size:"lg",text:"Loading employer requests..."})}):y?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Requests"}),e.jsx("p",{className:"text-gray-600 mb-4",children:y}),e.jsxs(w,{onClick:D,variant:"primary",disabled:m,children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),m?"Retrying...":"Try Again"]})]})}):!m&&W&&W.length===0?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"E"})}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Employer Requests"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(w,{variant:"outline",size:"sm",onClick:D,disabled:m,children:"Refresh"})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"No Employer Requests"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There are currently no employer requests to display."}),e.jsxs(w,{onClick:D,variant:"primary",disabled:m,children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),m?"Refreshing...":"Refresh Data"]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Employer Requests"})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:ma,disabled:ht,className:"flex items-center px-3 py-2 text-sm font-medium text-red-600 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 hover:border-red-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Clean all testing data (preserves admin accounts and job categories)",children:ht?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600 mr-2"}),"Cleaning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"h-4 w-4 mr-2"}),"Clean Data"]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Ft(!Re),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",title:"Workflow Notifications",children:[he>0?e.jsx(es,{className:"h-5 w-5 text-orange-500"}):e.jsx(Zt,{className:"h-5 w-5"}),he>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:he>9?"9+":he})]}),Re&&e.jsxs("div",{className:"notification-dropdown absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Workflow Notifications"}),he>0&&e.jsx("button",{onClick:Ca,className:"text-sm text-blue-600 hover:text-blue-800",children:"Mark all read"})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:ga?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading notifications..."})]}):_t.length===0?e.jsxs("div",{className:"p-4 text-center text-gray-500",children:[e.jsx(Zt,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):_t.map(t=>e.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${t.isRead?"":"bg-blue-50"}`,onClick:()=>{t.isRead||wa(t.id),t.requestId},children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 rounded-full mt-2 ${t.isRead?"bg-gray-300":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:t.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(t.timestamp).toLocaleString()}),t.status&&e.jsxs("span",{className:"inline-block mt-1 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:["Status: ",t.status]})]})]})},t.id))})]})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:D,disabled:m,children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),m?"Refreshing...":"Refresh"]})]})]})})}),e.jsxs("div",{className:" mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsx(ps,{stats:Ea})}),e.jsx(pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(la,{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Employer Requests (",O.length,")"]}),G>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",O.length," of ",(W||[]).length," total requests"]})]})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Qt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search by employer name, company, candidate, or message...",value:N,onChange:t=>Fa(t.target.value),className:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm"}),fa&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-500"})}),N&&e.jsx("button",{onClick:()=>J(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:e.jsx(Oe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("button",{onClick:()=>ba(!et),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${et?"bg-red-50 border-red-200 text-red-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(ts,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters"}),G>0&&e.jsx("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full",children:G})]}),G>0&&e.jsxs("button",{onClick:Vt,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Clear All"]})]}),et&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx("select",{value:j.status,onChange:t=>X("status",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:ee.status.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsx("select",{value:j.priority,onChange:t=>X("priority",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:ee.priority.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("select",{value:j.category,onChange:t=>X("category",t.target.value),disabled:ft,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:ft?e.jsx("option",{value:"",children:"Loading categories..."}):ee.category.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsx("select",{value:j.dateRange,onChange:t=>X("dateRange",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:ee.dateRange.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Rate"}),e.jsx("select",{value:j.monthlyRateRange,onChange:t=>X("monthlyRateRange",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:ee.monthlyRateRange.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),G>0&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[N&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:['Search: "',N,'"',e.jsx("button",{onClick:()=>J(""),className:"ml-1 hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(Oe,{className:"h-3 w-3"})})]}),Object.entries(j).map(([t,s])=>{if(!s)return null;const n=ee[t]?.find(c=>c.value===s);return n?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-800 text-sm rounded-full",children:[n.label,e.jsx("button",{onClick:()=>X(t,""),className:"ml-1 hover:bg-gray-200 rounded-full p-0.5",children:e.jsx(Oe,{className:"h-3 w-3"})})]},t):null})]})})]})]}),e.jsx("div",{className:"space-y-4",children:O.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx(Qt,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No results found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:G>0?"Try adjusting your search terms or filters to find what you're looking for.":"There are no employer requests to display."}),G>0&&e.jsx(w,{onClick:Vt,variant:"outline",size:"sm",className:"mx-auto",children:"Clear All Filters"})]}):e.jsx(cs,{data:O,columns:_a,pagination:!0,itemsPerPage:15,showSearch:!1})})]})})]}),ze&&a&&e.jsx(Z,{isOpen:ze,onClose:()=>{We(!1),T(null),Te(!1)},title:`Request Details - #${a.id}`,size:"xl",children:e.jsxs("div",{className:"space-y-6 relative",children:[ya&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Loading request details..."}),e.jsx("div",{className:"text-xs text-gray-500 text-center max-w-xs",children:"Fetching the latest information from the database."})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Request #",a.id]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Created on ",new Date(a.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[e.jsx(ra,{status:a.status}),e.jsxs(it,{color:aa(a.priority),children:[a.priority," Priority"]})]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Xt,{className:"w-5 h-5 mr-2 text-blue-600"}),"Employer Information"]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Full Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.employerName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Company Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.companyName})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsxs("label",{className:"text-sm font-medium text-blue-600 block mb-1 flex items-center",children:[e.jsx(ea,{className:"w-4 h-4 mr-1"}),"Email Address"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.employerContact.email||"Not provided"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsxs("label",{className:"text-sm font-medium text-blue-600 block mb-1 flex items-center",children:[e.jsx(ta,{className:"w-4 h-4 mr-1"}),"Phone Number"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.employerContact.phone||"Not provided"})]})]})]}),(a.employerDetails.companyAddress||a.employerDetails.industry||a.employerDetails.companySize||a.employerDetails.website||a.employerDetails.description||a.employerDetails.establishedYear||a.employerDetails.contactPerson)&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-blue-200",children:[e.jsx("h4",{className:"text-md font-semibold text-blue-900 mb-3",children:"Additional Company Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.employerDetails.companyAddress&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Company Address"}),e.jsx("p",{className:"text-gray-900 text-sm",children:a.employerDetails.companyAddress})]}),a.employerDetails.industry&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Industry"}),e.jsx("p",{className:"text-gray-900 text-sm",children:a.employerDetails.industry})]}),a.employerDetails.companySize&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Company Size"}),e.jsx("p",{className:"text-gray-900 text-sm",children:a.employerDetails.companySize})]}),a.employerDetails.website&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Website"}),e.jsx("a",{href:a.employerDetails.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline",children:a.employerDetails.website})]}),a.employerDetails.establishedYear&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Established Year"}),e.jsx("p",{className:"text-gray-900 text-sm",children:a.employerDetails.establishedYear})]}),a.employerDetails.contactPerson&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-1",children:"Contact Person"}),e.jsx("p",{className:"text-gray-900 text-sm",children:a.employerDetails.contactPerson})]})]}),a.employerDetails.description&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("label",{className:"text-sm font-medium text-blue-600 block mb-2",children:"Company Description"}),e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:a.employerDetails.description})]})})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Le,{className:"w-5 h-5 mr-2 text-green-600"}),"Request Information"]}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-2",children:"Request Message"}),e.jsx("p",{className:"text-gray-900 leading-relaxed",children:a.message||"No message provided"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Request Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(a.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Last Updated"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(a.lastContactDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsx("label",{className:"text-sm font-medium text-green-600 block mb-1",children:"Request ID"}),e.jsxs("p",{className:"text-gray-900 font-mono text-sm",children:["#",a.id]})]})]})]})})]}),a.candidateName!=="Not specified"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Me,{className:"w-5 h-5 mr-2 text-purple-600"}),"Candidate Information"]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center space-x-6 pb-6 border-b border-purple-200 mb-6",children:[(()=>{const t=a._backendData?.requestedCandidate?.profile?.photo||a._backendData?.requestedCandidate?.photo||null,s=t?/^https?:\/\//i.test(t)?t:`${d.BASE_URL}/${t.replace(/^\//,"")}`:null;return e.jsx(ct,{src:s,alt:a.candidateName,size:"xl",fallback:a.candidateName,fallbackSrc:defaultProfileImage})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.candidateName}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsx(it,{color:"text-purple-600 bg-purple-100 border-purple-200",children:a.category}),e.jsx(it,{color:"text-blue-600 bg-blue-100 border-blue-200",children:a.position})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-lg font-semibold text-green-600",children:a.monthlyRate})]}),a.candidateExperienceLevel!=="Not specified"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Experience:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.candidateExperienceLevel})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Job Category"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.category})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Skills/Position"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.position})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Experience Level"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateExperienceLevel})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Education Level"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateEducation})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsxs("label",{className:"text-sm font-medium text-purple-600 block mb-1 flex items-center",children:[e.jsx(ta,{className:"w-4 h-4 mr-1"}),"Contact Number"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateContact})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsxs("label",{className:"text-sm font-medium text-purple-600 block mb-1 flex items-center",children:[e.jsx(ea,{className:"w-4 h-4 mr-1"}),"Email Address"]}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateEmail})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Location Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Location"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateLocation})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"City"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateCity})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Country"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateCountry})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Skills & Qualifications"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Languages"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateLanguages})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Certifications"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateCertifications})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Gender"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateGender})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Marital Status"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateMaritalStatus})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"ID Number"}),e.jsx("p",{className:"text-gray-900 font-medium font-mono text-sm",children:a.candidateIdNumber})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Availability"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsx("label",{className:"text-sm font-medium text-purple-600 block mb-1",children:"Availability Status"}),e.jsx("p",{className:"text-gray-900 font-medium",children:a.candidateAvailability})]})]}),a.candidateDescription!=="Not specified"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"Description"}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:e.jsx("p",{className:"text-gray-900 leading-relaxed",children:a.candidateDescription})})]}),a.candidateReferences!=="Not specified"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-purple-900 mb-3",children:"References"}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:e.jsx("p",{className:"text-gray-900 leading-relaxed",children:a.candidateReferences})})]})]})]})]})]})}),oe&&a&&!z&&e.jsx(Z,{isOpen:oe,onClose:R,title:`Actions for ${a.employerName} - ${a.companyName}`,maxWidth:"max-w-md",children:e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"grid grid-cols-4 gap-3",children:lt(a).map((t,s)=>{const n=t.icon;return e.jsxs("button",{onClick:()=>nt(t.key,a),className:`relative group flex items-center justify-center p-4 rounded-lg transition-all duration-200 hover:scale-105 ${t.className} border border-gray-200 hover:border-current`,title:t.title,children:[e.jsx(n,{className:"w-6 h-6"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10",children:[t.title,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-gray-900"})]})]},s)})})})}),oe&&a&&z&&e.jsxs(Z,{isOpen:oe,onClose:R,title:z==="reply"?"Reply to Request":z==="select"?"Send Candidate Details":z==="complete"?"Complete Request":"Action",size:"md",children:[z==="reply"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Replying to:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Name:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.employerContact.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Phone:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.employerContact.phone})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reply Message ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:ie,onChange:t=>Ge(t.target.value),className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your reply message to the employer...",disabled:ae}),ae&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Sending reply to employer..."]}),wt&&e.jsx("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:wt})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Internal)"}),e.jsx("textarea",{value:Nt,onChange:t=>Ne(t.target.value),className:"w-full h-20 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Add internal notes for your reference...",disabled:ae}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"These notes are for internal use only and won't be sent to the employer."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(w,{variant:"outline",onClick:()=>{R()},disabled:ae,children:"Cancel"}),e.jsx(w,{variant:"primary",onClick:Ta,disabled:!ie.trim()||ae,children:ae?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):"Send Reply"})]})]}),z==="select"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-900 mb-2",children:"Selecting candidate for:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-green-900 ml-1",children:a.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-green-900 ml-1",children:a.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Position:"}),e.jsx("span",{className:"text-green-900 ml-1",children:a.position})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Category:"}),e.jsx("span",{className:"text-green-900 ml-1",children:a.category})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Send Candidate Information"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Send the requested candidate's information to the employer. Choose whether to send just a profile picture or complete details."}),a._backendData?.requestedCandidate?e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[(()=>{const t=a._backendData?.requestedCandidate?.profile?.photo||a._backendData?.requestedCandidate?.photo||null,s=t?/^https?:\/\//i.test(t)?t:`${d.BASE_URL}/${t.replace(/^\//,"")}`:null;return e.jsx(ct,{src:s,alt:a.candidateName,size:"md",fallback:a.candidateName,fallbackSrc:defaultProfileImage})})(),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-lg",children:a.candidateName}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[a.position," â€¢ ",a.candidateExperience]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",a.candidateLocation]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rate:"})," ",a.monthlyRate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Experience Level:"})," ",a.candidateExperienceLevel]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Education:"})," ",a.candidateEducation]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>Jt(a._backendData.requestedCandidate.id,"picture"),disabled:we,children:"Send Profile Picture"}),e.jsx(w,{variant:"primary",size:"sm",onClick:()=>Jt(a._backendData.requestedCandidate.id,"full"),disabled:we,children:"Send Complete Details"})]})]})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Me,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No candidate specified in this request"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"The employer did not specify a particular candidate"})]})]}),kt&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:kt}),we&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}),"Sending candidate information to employer..."]}),e.jsx("div",{className:"flex justify-end space-x-3",children:e.jsx(w,{variant:"outline",onClick:()=>{R()},disabled:we,children:"Cancel"})})]}),z==="complete"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-900 mb-2",children:"Completing Request:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:a.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:a.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Position:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:a.position})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Current Status:"}),e.jsx("span",{className:"text-orange-900 ml-1",children:a.status})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Completion Notes (Optional)"}),e.jsx("textarea",{value:Ae,onChange:t=>Ve(t.target.value),className:"w-full h-24 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Add notes about how this request was completed...",disabled:ce}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"These notes will be saved with the request and sent to the employer."})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center mr-2",children:e.jsx("span",{className:"text-yellow-800 text-xs",children:"!"})}),e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Warning:"})," This action will permanently mark the request as completed and close it. This action cannot be undone."]})]})}),Dt&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:Dt}),ce&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600 mr-2"}),"Completing request..."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(w,{variant:"outline",onClick:()=>{R()},disabled:ce,children:"Cancel"}),e.jsx(w,{variant:"primary",onClick:$a,disabled:ce,className:"bg-orange-600 hover:bg-orange-700",children:ce?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete Request"})]})]})]}),De&&a&&e.jsx(Z,{isOpen:De,onClose:Na,title:`Messaging - Request #${a.id}`,maxWidth:"max-w-2xl",children:e.jsxs("div",{className:"flex flex-col h-[calc(100vh-200px)]",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto pr-4 space-y-4 mb-4",children:[Fe?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(be,{className:"animate-spin h-8 w-8 text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]}):Tt.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Le,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Start the conversation!"})]}):Tt.map(t=>e.jsx("div",{className:`flex ${t.fromAdmin?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg shadow-sm ${t.fromAdmin?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"}`,children:[e.jsx("p",{className:"text-sm",children:t.content}),e.jsx("p",{className:`text-xs mt-1 ${t.fromAdmin?"text-blue-100":"text-gray-500"}`,children:new Date(t.createdAt).toLocaleString()})]})},t.id)),$t&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:$t})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Type a message...",value:qe,onChange:t=>_e(t.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",disabled:Fe,onKeyPress:t=>t.key==="Enter"&&Wt()}),e.jsx(w,{variant:"primary",onClick:Wt,disabled:!qe.trim()||Fe,children:Fe?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(as,{className:"h-5 w-5"})})]})]})}),Lt&&a&&e.jsx(Z,{isOpen:Lt,onClose:tt,title:`Request Payment - Request #${a.id}`,maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:Aa,className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Request Details:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Employer:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.companyName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Candidate:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.candidateName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Status:"}),e.jsx("span",{className:"text-blue-900 ml-1",children:a.status})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentType",value:"photo_access",checked:b.paymentType==="photo_access",onChange:t=>U({...b,paymentType:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Photo Access"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Basic candidate photo"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentType",value:"full_details",checked:b.paymentType==="full_details",onChange:t=>U({...b,paymentType:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Full Details"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Complete candidate information"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:b.paymentMethodId,onChange:t=>U({...b,paymentMethodId:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Payment Method"}),ha.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.accountNumber]},t.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:b.amount,onChange:t=>U({...b,amount:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"5000",min:"0",step:"100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:b.currency,onChange:t=>U({...b,currency:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"RWF",children:"RWF (Rwandan Franc)"}),e.jsx("option",{value:"USD",children:"USD (US Dollar)"}),e.jsx("option",{value:"EUR",children:"EUR (Euro)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:b.description,onChange:t=>U({...b,description:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:`Payment for ${b.paymentType==="photo_access"?"photo access":"full details"} access to candidate information`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date (Optional)"}),e.jsx("input",{type:"date",value:b.dueDate,onChange:t=>U({...b,dueDate:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]})]}),Ot&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:Ot}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(w,{type:"button",variant:"outline",onClick:tt,disabled:Ze,children:"Cancel"}),e.jsx(w,{type:"submit",variant:"primary",disabled:Ze,className:"bg-green-600 hover:bg-green-700",children:Ze?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):"Send Payment Request"})]})]})}),Mt&&a&&e.jsx(Z,{isOpen:Mt,onClose:at,title:`Approve Payment - Request #${a.id}`,maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:qa,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Request Overview"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Employer:"}),e.jsx("span",{className:"text-gray-900",children:a.employerName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Company:"}),e.jsx("span",{className:"text-gray-900",children:a.companyName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Candidate:"}),e.jsx("span",{className:"text-gray-900",children:a.candidateName})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[e.jsx("span",{className:"text-blue-600 font-medium block mb-1",children:"Request Status:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:a.status?.replace("_"," ")})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-green-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Payment Confirmation Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payer Name:"}),e.jsx("span",{className:"text-gray-900",children:a.latestPayment?.confirmationName||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Phone Number:"}),e.jsx("span",{className:"text-gray-900",children:a.latestPayment?.confirmationPhone||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Payment Reference:"}),e.jsx("span",{className:"text-gray-900 font-mono text-xs",children:a.latestPayment?.paymentReference||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Transfer Amount:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:a.latestPayment?.amount?`${a.latestPayment.amount} RWF`:"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-1",children:"Confirmation Date:"}),e.jsx("span",{className:"text-gray-900",children:a.latestPayment?.confirmationDate?new Date(a.latestPayment.confirmationDate).toLocaleDateString():"Not specified"})]})]}),a.latestPayment?.adminNotes&&a.latestPayment.adminNotes!=="No additional notes"&&e.jsxs("div",{className:"mt-4 bg-white rounded-lg p-3 border border-green-100",children:[e.jsx("span",{className:"text-green-600 font-medium block mb-2",children:"Additional Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:a.latestPayment.adminNotes})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100",children:[e.jsxs("h4",{className:"text-lg font-semibold text-purple-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsx("span",{className:"text-purple-600 font-medium block mb-1",children:"Payment Type:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:a.latestPayment?.paymentType?.replace("_"," ")||"Not specified"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsx("span",{className:"text-purple-600 font-medium block mb-1",children:"Payment Status:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:a.latestPayment?.status||"Not specified"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Action ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"action",value:"approve",checked:F.action==="approve",onChange:t=>re({...F,action:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Approve"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Approve the payment"})]})]}),e.jsxs("label",{className:"flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"action",value:"reject",checked:F.action==="reject",onChange:t=>re({...F,action:t.target.value}),className:"mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Reject"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Reject the payment"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:F.notes,onChange:t=>re({...F,notes:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:"Add any additional notes for the payment approval..."})]}),Ut&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:Ut}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(w,{type:"button",variant:"outline",onClick:at,disabled:Xe,children:"Cancel"}),e.jsx(w,{type:"submit",variant:"primary",disabled:Xe,className:"bg-green-600 hover:bg-green-700",children:Xe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):"Submit Approval"})]})]})}),ke&&a&&e.jsx(Z,{isOpen:ke,onClose:ue?void 0:()=>A(!1),title:`${Ma(de)}`,className:"max-w-2xl",children:e.jsxs("div",{className:"space-y-6 relative",children:[ue&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Processing your request..."}),e.jsx("div",{className:"text-xs text-gray-500 text-center max-w-xs",children:"This may take a few moments as we send notifications and update the system."})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Request Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Request ID:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["#",a.id]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:"ml-2",children:e.jsx(ra,{status:a.status})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Employer:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.employerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Candidate:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.candidateName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Created:"}),e.jsx("span",{className:"ml-2",children:new Date(a.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Company:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.companyName})]})]})]}),de!=="requestSecondPayment"&&de!=="approveFullDetailsRequest"&&e.jsx(us,{currentStatus:a.status}),Ha(de),Rt&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(na,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:Rt})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(w,{variant:"outline",onClick:()=>A(!1),disabled:ue,children:"Cancel"}),Ga(de)]})]})}),e.jsx(ss,{position:"top-right"})]})},As=Object.freeze(Object.defineProperty({__proto__:null,default:gs},Symbol.toStringTag,{value:"Module"}));export{gs as E,dt as N,ds as S,Ps as a,aa as b,ms as c,As as d,Ss as g,sa as h};
