import{r as l,j as e,g as _e,P as Xe,e as ke,a as Le,C as $e,_ as ze,S as ps,f as Qe,$ as Cs,J as fs,O as ys,x as qe,a5 as ks,a6 as Ss,a7 as Ps,s as Ie,V as Re,U as Je,a8 as ns,d as As,a9 as Es,X as ue,M as Ms,aa as z,ab as os,ac as is,ad as Rs,I as cs,a0 as Ue,ae as Ds,H as K,af as Ls,ag as $s,ah as qs,ai as Ne,aj as ve,c as Ze,ak as Fs,al as Ts,am as Ke,a2 as _s,q as zs,an as Ve,ao as xe,ap as Is,Z as Us,v as Bs,aq as bs,E as Oe,p as Os,ar as we,as as Ye,at as Js,a3 as Ce,au as Hs,av as Gs,aw as Fe,ax as Ws,F as Vs,h as Ys,T as Xs,k as Qs,D as ds,y as Zs,z as Ks,b as et}from"./vendor-react-BksKsjF4.js";import{d as he,h as pe,g as Ae,B as S,e as ms,i as Se,L as ge,C as Q,u as js,A as me,k as st}from"./index-BzccmGOD.js";import{a as Ns}from"./useJobSeekers-CpICJycy.js";import{a as tt,b as at}from"./useCategories-Dkh-pSoo.js";import{m as Pe}from"./vendor-motion-DGjYdUW3.js";import{g as us,N as Te,E as rt,S as Be,a as lt,b as nt,c as ot,h as it}from"./EmployerRequestsPage-CJXhL9GN.js";import{B}from"./Badge-BvinhsTB.js";import{A as xs}from"./Avatar-RDIauMxJ.js";import{M as De}from"./Modal-Dw40RohV.js";import ct from"./JobSeekersPage-_qku_cMS.js";import dt from"./ReportsPage-z_OHR_Dp.js";import{D as vs}from"./DataTable-BY5Fyv48.js";import{c as Ee}from"./contactService-BcAIFBUu.js";import mt from"./JobCategoriesPage-D9lioTBC.js";import{a as gs}from"./adminProfileService-Dt9VQi4G.js";import"./vendor-common-BZD0eUgH.js";import"./vendor-gsap-lnFyu4_T.js";import"./categoryService-Dkkoqz5s.js";import"./messagingService-B3La2tbu.js";import"./endpoints-CXiMw_A_.js";import"./useApprovalManagement-Dq466qHA.js";import"./StatusBadge-DwaX9bo4.js";const Me={submitRequest:async s=>{try{const n=await he.post("/employer/request",s);return{success:!0,data:n.data.request,message:n.data.message}}catch(n){if(n.response?.data){const{data:r}=n.response;if(r.details&&Array.isArray(r.details))return{success:!1,error:r.details.map(f=>`${f.field}: ${f.message}`).join(", ")};if(r.error)return{success:!1,error:r.error};if(r.message)return{success:!1,error:r.message}}return{success:!1,error:pe(n,{context:"submit_employer_request"}).userMessage}}},getAllRequests:async(s={})=>{try{const{page:n=1,limit:c=10,status:r,priority:m,search:f,sortBy:C,sortOrder:u,category:x,dateFrom:g,dateTo:A,...E}=s,y=new URLSearchParams({page:n.toString(),limit:c.toString(),...E});r&&y.append("status",r),m&&y.append("priority",m),f&&y.append("search",f),C&&y.append("sortBy",C),u&&y.append("sortOrder",u),x&&y.append("category",x),g&&y.append("dateFrom",g),A&&y.append("dateTo",A);const P=await he.get(`/employer/requests?${y}`,{headers:Ae()});return{success:!0,data:{requests:P.data.requests||[],pagination:P.data.pagination||{page:parseInt(n),limit:parseInt(c),total:0,totalPages:1}}}}catch(n){return n.response?.data?.error?{success:!1,error:n.response.data.error}:{success:!1,error:pe(n,{context:"get_all_employer_requests"}).userMessage}}},getRequestById:async s=>{try{return{success:!0,data:(await he.get(`/employer/requests/${s}`,{headers:Ae()})).data}}catch(n){return n.response?.data?.error?{success:!1,error:n.response.data.error}:{success:!1,error:pe(n,{context:"get_employer_request_by_id"}).userMessage}}},replyToRequest:async(s,n)=>{try{const c=await he.post(`/employer/requests/${s}/reply`,n,{headers:Ae()});return{success:!0,data:c.data.messageData,message:c.data.message}}catch(c){if(c.response?.data){const{data:m}=c.response;if(m.details&&Array.isArray(m.details))return{success:!1,error:m.details.map(C=>`${C.field}: ${C.message}`).join(", ")};if(m.error)return{success:!1,error:m.error};if(m.message)return{success:!1,error:m.message}}return{success:!1,error:pe(c,{context:"reply_to_employer_request"}).userMessage}}},selectJobSeeker:async(s,n,c="picture")=>{try{const r=await he.post(`/employer/requests/${s}/select`,{selectedUserId:n,detailsType:c},{headers:Ae()});return{success:!0,data:r.data.request,message:r.data.message}}catch(r){if(r.response?.data){const{data:f}=r.response;if(f.details&&Array.isArray(f.details))return{success:!1,error:f.details.map(u=>`${u.field}: ${u.message}`).join(", ")};if(f.error)return{success:!1,error:f.error};if(f.message)return{success:!1,error:f.message}}return{success:!1,error:pe(r,{context:"select_job_seeker_for_request"}).userMessage}}},updateRequestStatus:async(s,n)=>{try{const c=await he.put(`/employer/requests/${s}/status`,n,{headers:Ae()});return{success:!0,data:c.data.request,message:c.data.message}}catch(c){if(c.response?.data){const{data:m}=c.response;if(m.details&&Array.isArray(m.details))return{success:!1,error:m.details.map(C=>`${C.field}: ${C.message}`).join(", ")};if(m.error)return{success:!1,error:m.error};if(m.message)return{success:!1,error:m.message}}return{success:!1,error:pe(c,{context:"update_request_status"}).userMessage}}},getRequestStatistics:async()=>{try{const s=await he.get("/admin/dashboard/stats",{headers:Ae()});return{success:!0,data:{totalRequests:s.data.overview?.totalEmployerRequests||0,pendingRequests:s.data.overview?.pendingEmployerRequests||0,recentRequests:s.data.recentActivity?.recentEmployerRequests||[],requestDistribution:s.data.distributions?.employerRequests||[]}}}catch(s){return s.response?.data?.error?{success:!1,error:s.response.data.error}:{success:!1,error:pe(s,{context:"get_request_statistics"}).userMessage}}},getPublicConversation:async(s,n)=>{try{return{success:!0,data:(await he.get(`/public/employer/requests/${s}`,{params:{email:n}})).data}}catch(c){return c.response?.data?.error?{success:!1,error:c.response.data.error}:{success:!1,error:pe(c,{context:"get_public_conversation"}).userMessage}}},replyAsEmployer:async(s,n,c)=>{try{const r=await he.post(`/public/employer/requests/${s}/reply`,{...c,email:n});return{success:!0,data:r.data.messageData,message:r.data.message}}catch(r){if(r.response?.data){const{data:f}=r.response;if(f.details&&Array.isArray(f.details))return{success:!1,error:f.details.map(u=>`${u.field}: ${u.message}`).join(", ")};if(f.error)return{success:!1,error:f.error};if(f.message)return{success:!1,error:f.message}}return{success:!1,error:pe(r,{context:"reply_as_employer"}).userMessage}}}},ut=(s={})=>{const{autoFetch:n=!0,includeAdmin:c=!1,itemsPerPage:r=10}=s,[m,f]=l.useState([]),[C,u]=l.useState(!1),[x,g]=l.useState(null),[A,E]=l.useState(null),[y,P]=l.useState(1),[N,q]=l.useState(1),[p,b]=l.useState(0),[L,T]=l.useState({}),[F,X]=l.useState(""),[_,t]=l.useState({}),[a,d]=l.useState("createdAt"),[j,$]=l.useState("desc"),D=l.useCallback(async(o=y,R=F,M=_,U={field:a,order:j})=>{if(c){u(!0),g(null);try{const de={page:o,limit:r,search:R,sortBy:U.field,sortOrder:U.order,...M},le=await Me.getAllRequests(de);le.success?(f(le.data.requests||[]),q(le.data.pagination?.totalPages||1),b(le.data.pagination?.total||0),P(le.data.pagination?.page||1),T(le.data.pagination||{})):g(le.error||"Failed to fetch requests")}catch(de){g("An error occurred while fetching requests"),console.error("Error fetching requests:",de)}finally{u(!1)}}},[c,r,y,F,_,a,j]),W=l.useCallback(async o=>{u(!0),g(null);try{const R=await Me.submitRequest(o);return R.success?{success:!0,data:R.data}:(g(R.error||"Failed to submit request"),{success:!1,error:R.error})}catch{const M="An error occurred while submitting request";return g(M),{success:!1,error:M}}finally{u(!1)}},[]),ee=l.useCallback(async o=>{if(!c||!o)return null;u(!0),g(null);try{const R=await Me.getRequestById(o);return R.success?(E(R.data),{success:!0,data:R.data}):(g(R.error||"Failed to fetch request"),{success:!1,error:R.error})}catch{const M="An error occurred while fetching request";return g(M),{success:!1,error:M}}finally{u(!1)}},[c]),v=l.useCallback(async(o,R)=>{if(!c)return{success:!1,error:"Unauthorized"};u(!0),g(null);try{const M=await Me.replyToRequest(o,R);return M.success?(await D(),{success:!0,data:M.data}):(g(M.error||"Failed to reply to request"),{success:!1,error:M.error})}catch{const U="An error occurred while replying to request";return g(U),{success:!1,error:U}}finally{u(!1)}},[c,D]),O=l.useCallback(async(o,R,M="picture")=>{if(!c)return{success:!1,error:"Unauthorized"};u(!0),g(null);try{const U=await Me.selectJobSeeker(o,R,M);return U.success?(await D(),{success:!0,data:U.data}):(g(U.error||"Failed to send candidate information"),{success:!1,error:U.error})}catch{const de="An error occurred while sending candidate information";return g(de),{success:!1,error:de}}finally{u(!1)}},[c,D]),k=l.useCallback(async(o,R)=>{if(!c)return{success:!1,error:"Unauthorized"};u(!0),g(null);try{const M=await Me.updateRequestStatus(o,R);return M.success?(await D(),{success:!0,data:M.data}):(g(M.error||"Failed to update request status"),{success:!1,error:M.error})}catch{const U="An error occurred while updating request status";return g(U),{success:!1,error:U}}finally{u(!1)}},[c,D]),w=l.useCallback(o=>{P(o),D(o,F,_,{field:a,order:j})},[D,F,_,a,j]),V=l.useCallback(()=>{y<N&&w(y+1)},[y,N,w]),Y=l.useCallback(()=>{y>1&&w(y-1)},[y,w]),re=l.useMemo(()=>y<N,[y,N]),be=l.useMemo(()=>y>1,[y]),je=l.useCallback(o=>{X(o),P(1)},[]),ne=l.useCallback((o,R)=>{const M={..._,[o]:R};t(M),P(1)},[_]),ce=l.useCallback((o,R)=>{d(o),$(R)},[]),oe=l.useCallback(()=>{D(y,F,_,{field:a,order:j})},[D,y,F,_,a,j]);l.useEffect(()=>{c&&oe()},[oe,c]);const ae=l.useCallback(o=>{E(o)},[]),h=l.useCallback(()=>{E(null)},[]),i=l.useMemo(()=>m.filter(o=>!0),[m]);return l.useEffect(()=>{n&&c&&D()},[D,n,c]),l.useEffect(()=>{g(null)},[A]),{requests:i,selectedRequest:A,loading:C,error:x,currentPage:y,totalPages:N,totalItems:p,pageInfo:L,hasNextPage:re,hasPrevPage:be,searchTerm:F,filters:_,sortBy:a,sortOrder:j,fetchRequests:D,submitRequest:W,getRequestById:ee,replyToRequest:v,selectJobSeekerForRequest:O,updateRequestStatus:k,goToPage:w,nextPage:V,prevPage:Y,setSearchTerm:je,setFilters:ne,setSortBy:o=>ce(o,j),setSortOrder:o=>ce(a,o),applyFilters:oe,selectRequest:ae,clearSelection:h,hasRequests:m.length>0,requestsCount:m.length,isAdmin:c}},ws=(s={})=>ut({...s,includeAdmin:!0}),xt=({isConnected:s,lastUpdate:n,onRefresh:c,showLastUpdate:r=!0,className:m=""})=>e.jsx("div",{className:`flex items-center space-x-2 text-sm ${m}`,children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(Pe.div,{animate:{scale:s?[1,1.2,1]:1,opacity:s?1:.5},transition:{duration:2,repeat:s?1/0:0,ease:"easeInOut"}})})}),gt=({request:s,onContactEmployer:n,onViewDetails:c,getStatusColor:r,getPriorityColor:m,compact:f=!1})=>{if(!s)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No request data available"});const C=s.name||s.employerName||"Unknown Employer",u=s.companyName||"Unknown Company",x=s.status||"pending",g=s.priority||"normal",A=s.message||"No message provided",E=s.email||"",y=s.phoneNumber||"",P=s.createdAt||new Date().toISOString(),N=s.selectedUser||s.hasSelectedCandidate,q=s.requestedCandidate,p=s.selectedUser;let b="No candidate selected",L=null;return N&&p?.profile?(b=`${p.profile.firstName} ${p.profile.lastName}`,L=p):q?.profile&&(b=`${q.profile.firstName} ${q.profile.lastName}`,L=q),f?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:C}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:u})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{variant:"outline",size:"xs",className:r?r(x):"bg-gray-100 text-gray-800",children:us(x)}),e.jsx(B,{variant:"outline",size:"xs",className:m?m(g):"bg-gray-100 text-gray-800",children:g})]})]}),e.jsxs("div",{className:"mt-2",children:[N?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"✓ Selected:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:b})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"⏳ Requesting:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:b})]}),L?.profile?.skills&&e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-xs text-gray-700",children:L.profile.skills})]})]})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:C}),e.jsx("p",{className:"text-sm text-gray-600",children:u})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{variant:"outline",size:"sm",className:r?r(x):"bg-gray-100 text-gray-800",children:us(x)}),e.jsx(B,{variant:"outline",size:"sm",className:m?m(g):"bg-gray-100 text-gray-800",children:g})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:A}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[E&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:E})]}),y&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Xe,{className:"w-4 h-4"}),e.jsx("span",{children:y})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Candidate Information"}),N?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"✓ Selected Candidate:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:b})]}),L?.profile?.skills&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Skills: "}),e.jsx("span",{className:"text-sm text-gray-700",children:L.profile.skills})]}),L?.profile?.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Experience: "}),e.jsx("span",{className:"text-sm text-gray-700",children:L.profile.experience})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No candidate selected yet"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(P).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[n&&e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>n(s),children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Contact"]}),c&&e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>c(s),children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})},ht=({jobSeeker:s,onViewDetails:n,getCategoryColor:c,compact:r=!1})=>{if(!s)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No job seeker data available"});const f=(c||(C=>{const u={JavaScript:"bg-yellow-100 text-yellow-800",React:"bg-blue-100 text-blue-800","Node.js":"bg-green-100 text-green-800",Python:"bg-blue-100 text-blue-800",Django:"bg-green-100 text-green-800",PostgreSQL:"bg-blue-100 text-blue-800",AWS:"bg-orange-100 text-orange-800",Docker:"bg-blue-100 text-blue-800",Git:"bg-red-100 text-red-800",Java:"bg-orange-100 text-orange-800",Cooking:"bg-red-100 text-red-800",Housekeeping:"bg-purple-100 text-purple-800",Childcare:"bg-pink-100 text-pink-800",Gardening:"bg-emerald-100 text-emerald-800",Cleaning:"bg-gray-100 text-gray-800",Driving:"bg-indigo-100 text-indigo-800",Teaching:"bg-yellow-100 text-yellow-800",Nursing:"bg-rose-100 text-rose-800",Construction:"bg-amber-100 text-amber-800",Agriculture:"bg-lime-100 text-lime-800",Technology:"bg-blue-100 text-blue-800",Healthcare:"bg-green-100 text-green-800",Education:"bg-purple-100 text-purple-800",Manufacturing:"bg-red-100 text-red-800",Services:"bg-gray-100 text-gray-800",General:"bg-gray-100 text-gray-800","Job Seeker":"bg-gray-100 text-gray-800",default:"bg-gray-100 text-gray-800"};return u[C]||u.default}))(s?.category||"General");return r?e.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(xs,{src:s?.avatar,alt:s?.name||"Job Seeker",size:"sm",fallback:s?.name||"JS",fallbackSrc:ms}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:s?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:s?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(B,{variant:"outline",size:"xs",className:f,children:s?.category||"General"}),e.jsx("span",{className:"text-xs text-gray-500",children:s?.location||"Unknown"})]}),s?.approvalStatus&&e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${s.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":s.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[s.approvalStatus==="approved"?e.jsx(Le,{className:"w-3 h-3"}):s.approvalStatus==="rejected"?e.jsx($e,{className:"w-3 h-3"}):e.jsx(ze,{className:"w-3 h-3"}),s.approvalStatus==="approved"?"Verified":s.approvalStatus==="rejected"?"Rejected":"Pending"]})}),s?.category&&s.category.includes(",")&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[s.category.split(",").slice(0,3).map((C,u)=>e.jsx("span",{className:"inline-block px-1 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:C.trim()},u)),s.category.split(",").length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.category.split(",").length-3," more"]})]})]})]}):e.jsxs("div",{className:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(xs,{src:s?.avatar,alt:s?.name||"Job Seeker",size:"md",fallback:s?.name||"JS",fallbackSrc:ms}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:s?.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?.title||"Job Seeker"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s?.location||"Unknown"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s?.experience||"0"," years"]}),e.jsx(B,{variant:"outline",size:"sm",className:f,children:s?.category||"General"})]}),s?.approvalStatus&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${s.approvalStatus==="approved"?"bg-green-100 text-green-700 border border-green-200":s.approvalStatus==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[s.approvalStatus==="approved"?e.jsx(Le,{className:"w-3.5 h-3.5"}):s.approvalStatus==="rejected"?e.jsx($e,{className:"w-3.5 h-3.5"}):e.jsx(ze,{className:"w-3.5 h-3.5"}),s.approvalStatus==="approved"?"Verified Profile":s.approvalStatus==="rejected"?"Profile Rejected":"Under Review"]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["Daily: ",s?.dailyRate?.toLocaleString()||"0"," frw"]}),e.jsxs("span",{children:["Monthly: ",s?.monthlyRate?.toLocaleString()||"0"," frw"]})]})]}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>n?.(s),title:"View Details",children:e.jsx(ke,{className:"w-4 h-4"})})]})},pt=({logo:s="J",title:n="Admin Panel",subtitle:c="Job Portal Management"})=>e.jsx("div",{className:"flex items-center justify-between p-5 border-b border-slate-200 bg-slate-50/60",children:e.jsxs("div",{className:"flex items-center space-x-2.5",children:[e.jsx("div",{className:"w-9 h-9 bg-red-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-base",children:s})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-slate-800 text-base",children:n}),e.jsx("span",{className:"text-xs text-slate-500",children:c})]})]})}),ft=({searchValue:s="",onSearchChange:n,placeholder:c="Search..."})=>e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:c,value:s,onChange:r=>n?.(r.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-md text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-200"})]})}),yt=({item:s,isActive:n,onClick:c})=>{const[r,m]=l.useState(!1),C={Home:ns,Users:Je,MessageSquare:Re,Briefcase:Ie,BarChart3:Ps,Settings:Ss,TestTube:ks,User:qe,FileText:ys,Calendar:fs,Star:Cs,MapPin:Qe,Mail:_e,Phone:Xe}[s.icon]||ns,u=()=>{s.subItems?m(!r):c(s.id)},x=g=>{c(g)};return e.jsxs("li",{children:[e.jsxs("button",{onClick:u,className:`
          relative w-full flex items-center space-x-2.5 px-3 py-2.5 rounded-md text-left transition-all duration-200 group
          ${n?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
        `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx(C,{className:`
              h-4.5 w-4.5 flex-shrink-0
              ${n?"text-red-600":"text-slate-500 group-hover:text-slate-700"}
            `})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:`text-sm ${n?"font-medium":"font-normal"}`,children:s.label}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.badge&&e.jsx("span",{className:`
                px-1.5 py-0.5 text-xs font-medium rounded-full
                ${n?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}
              `,children:s.badge}),s.subItems&&e.jsx("div",{className:"flex items-center",children:r?e.jsx(As,{className:"w-4 h-4 text-slate-500"}):e.jsx(Es,{className:"w-4 h-4 text-slate-500"})})]})]})]}),s.subItems&&r&&e.jsx("ul",{className:"ml-6 mt-1 space-y-0.5",children:s.subItems.map(g=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>x(g.id),className:`
                  relative w-full flex items-center space-x-2.5 px-3 py-2 rounded-md text-left transition-all duration-200 group
                  ${n===g.id?"bg-red-50 text-red-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}
                `,children:[e.jsx("div",{className:"flex items-center justify-center min-w-[24px]",children:e.jsx("div",{className:`
                    w-1.5 h-1.5 rounded-full
                    ${n===g.id?"bg-red-600":"bg-slate-400 group-hover:bg-slate-600"}
                  `})}),e.jsx("span",{className:`text-sm ${n===g.id?"font-medium":"font-normal"}`,children:g.label})]})},g.id))})]})},bt=({navigationItems:s,activeItem:n,onItemClick:c})=>e.jsx("nav",{className:"flex-1 px-3 py-2 overflow-y-auto",children:e.jsx("ul",{className:"space-y-0.5",children:s.map(r=>e.jsx(yt,{item:r,isActive:n===r.id,onClick:c},r.id))})}),jt=({sidebarOpen:s,setSidebarOpen:n,navigationItems:c,activeTab:r,setActiveTab:m,user:f,onLogout:C,className:u=""})=>{const[x,g]=l.useState("");l.useEffect(()=>{const P=()=>{window.innerWidth>=768?n(!0):n(!1)};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[n]);const A=()=>{n(!s)},E=P=>{m(P),window.innerWidth<768&&n(!1)},y=P=>{g(P)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:A,className:"fixed top-6 left-6 z-50 p-3 rounded-lg bg-white shadow-md border border-slate-100 md:hidden hover:bg-slate-50 transition-all duration-200","aria-label":"Toggle sidebar",children:s?e.jsx(ue,{className:"h-5 w-5 text-slate-600"}):e.jsx(Ms,{className:"h-5 w-5 text-slate-600"})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300",onClick:A}),e.jsxs("div",{className:`
          fixed top-0 left-0 h-full bg-white border-r border-slate-200 z-40 transition-all duration-300 ease-in-out flex flex-col w-64 md:w-80 md:sticky md:top-0 md:h-screen md:left-0 md:static
          ${s?"translate-x-0":"-translate-x-full"}
          md:translate-x-0 md:static md:z-auto
          ${u}
        `,children:[e.jsx(pt,{logo:"J",title:"Admin Panel",subtitle:"Job Portal Management"}),e.jsx(ft,{searchValue:x,onSearchChange:y,placeholder:"Search..."}),e.jsx(bt,{navigationItems:c,activeItem:r,onItemClick:E})]})]})},Nt=()=>{const[s,n]=l.useState([]),[c,r]=l.useState({total:0,unread:0,read:0}),[m,f]=l.useState(!1),[C,u]=l.useState(!1),[x,g]=l.useState([]);l.useEffect(()=>{A(),E(),N()},[]);const A=async()=>{try{u(!0);const b=await Te.getUserNotifications();n(b.notifications||[])}catch(b){console.error("Error fetching notifications:",b),z.error("Failed to load notifications")}finally{u(!1)}},E=async()=>{try{const b=await Te.getNotificationStats();r(b.stats||{total:0,unread:0,read:0})}catch(b){console.error("Error fetching notification stats:",b)}},y=async b=>{try{await Te.markAsRead(b),n(L=>L.map(T=>T.id===b?{...T,isRead:!0,readAt:new Date().toISOString()}:T)),r(L=>({...L,unread:L.unread-1,read:L.read+1}))}catch(L){console.error("Error marking notification as read:",L),z.error("Failed to mark notification as read")}},P=async()=>{try{await Te.markAllAsRead(),n(b=>b.map(L=>({...L,isRead:!0,readAt:new Date().toISOString()}))),r(b=>({...b,unread:0,read:b.total})),z.success("All notifications marked as read")}catch(b){console.error("Error marking all notifications as read:",b),z.error("Failed to mark all notifications as read")}},N=async()=>{try{const b=await Te.getNotificationPreferences();g(b.optedOutTypes||[])}catch(b){console.error("Error fetching notification preferences:",b)}},q=b=>{switch(b){case"request_received":return e.jsx(cs,{className:"w-5 h-5 text-blue-500"});case"request_approved":return e.jsx(Le,{className:"w-5 h-5 text-green-600"});case"hired":return e.jsx(is,{className:"w-5 h-5 text-emerald-600"});case"cancelled":return e.jsx(ue,{className:"w-5 h-5 text-red-500"});case"payment_confirmed":case"photo_access_granted":case"full_access_granted":case"matched_with_employer":return e.jsx(Le,{className:"w-5 h-5 text-green-500"});case"request_rejected":case"payment_rejected":case"full_details_rejected":return e.jsx($e,{className:"w-5 h-5 text-red-500"});case"payment_request":case"full_details_requested":return e.jsx(cs,{className:"w-5 h-5 text-blue-500"});default:return e.jsx(os,{className:"w-5 h-5 text-gray-400"})}},p=b=>{const L=new Date(b),F=Math.floor((new Date-L)/1e3);return F<60?"Just now":F<3600?`${Math.floor(F/60)}m ago`:F<86400?`${Math.floor(F/3600)}h ago`:`${Math.floor(F/86400)}d ago`};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>f(!m),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(os,{className:"w-6 h-6"}),c.unread>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:c.unread>9?"9+":c.unread})]}),m&&e.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),e.jsxs("div",{className:"flex items-center gap-2",children:[c.unread>0&&e.jsxs("button",{onClick:P,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx(is,{className:"w-4 h-4"}),"Mark all read"]}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ue,{className:"w-5 h-5"})})]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[c.unread," unread of ",c.total," total"]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:C?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading notifications..."}):s.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications yet"}):s.map(b=>e.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors ${b.isRead?"":"bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[q(b.type),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:b.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:b.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:p(b.createdAt)})]}),!b.isRead&&e.jsx("button",{onClick:()=>y(b.id),className:"ml-2 p-1 text-gray-400 hover:text-gray-600",title:"Mark as read",children:e.jsx(Rs,{className:"w-4 h-4"})})]})})]})},b.id))}),s.length>0&&e.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:e.jsx("button",{onClick:A,className:"text-sm text-blue-600 hover:text-blue-800 w-full text-center",children:"Refresh notifications"})})]})]})},vt=({user:s,onLogout:n,onSearch:c,onFilter:r,searchTerm:m="",onRefresh:f})=>e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-4 md:px-6 py-4 sticky top-0 z-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome back, ",s?.firstName||s?.email||"Admin"]})]})}),e.jsx("div",{className:"flex-1 max-w-md mx-4 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search...",value:m,onChange:C=>c?.(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[f&&e.jsx(S,{variant:"ghost",size:"sm",onClick:f,title:"Refresh data",children:e.jsx(Ue,{className:"w-5 h-5"})}),e.jsx(Nt,{}),e.jsx("div",{className:"relative",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(qe,{className:"w-4 h-4 text-red-600"})}),e.jsx("span",{className:"hidden md:block text-sm font-medium",children:s?.firstName||s?.email||"Admin"})]})}),e.jsx(S,{variant:"outline",size:"sm",onClick:n,className:"hidden md:block",children:"Logout"})]})]})}),wt=()=>qs.create({page:{flexDirection:"column",backgroundColor:"#ffffff",padding:15,fontSize:9},header:{marginBottom:10,borderBottom:"2 solid #3b82f6",paddingBottom:5},title:{fontSize:24,fontWeight:"bold",color:"#1f2937",marginBottom:2},subtitle:{fontSize:16,color:"#6b7280",marginBottom:2},dateRange:{fontSize:12,color:"#9ca3af",marginBottom:6},table:{display:"table",width:"auto",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,borderColor:"#e5e7eb"},tableRow:{margin:"auto",flexDirection:"row"},tableColHeader:{width:"auto",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#3b82f6",backgroundColor:"#3b82f6",padding:1,minHeight:18,justifyContent:"center",alignItems:"center"},tableCol:{width:"1",borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0,borderColor:"#e5e7eb",padding:1,minHeight:5,justifyContent:"center",alignItems:"center"},tableCellHeader:{margin:"2",fontSize:11,fontWeight:"bold",color:"#ffffff",textAlign:"center"},tableCell:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"center"},tableCellLeft:{margin:"2",fontSize:9,color:"#1f2937",textAlign:"left"},footer:{position:"absolute",bottom:15,left:15,right:15,textAlign:"center",color:"#6b7280",fontSize:8,borderTop:"1 solid #e5e7eb",paddingTop:5},pageNumber:{position:"absolute",bottom:15,right:15,color:"#6b7280",fontSize:8},alternateRow:{backgroundColor:"#f9fafb"}}),Ct=(s,n,c,r)=>{const m=wt(),f=r.title||Et(s);r.subtitle||`${f.toLowerCase()}`;const C=r.dateRange||`Export Date: ${new Date().toLocaleDateString()}`,u=Mt(s,c);return K.createElement(Ls,{},K.createElement($s,{size:"A4",orientation:"landscape",style:m.page},[K.createElement(Ne,{key:"header",style:m.header},[K.createElement(ve,{key:"title",style:m.title},"Job Portal System"),K.createElement(ve,{key:"subtitle",style:m.subtitle},f),K.createElement(ve,{key:"dateRange",style:m.dateRange},C)]),K.createElement(Ne,{key:"table",style:m.table},[K.createElement(Ne,{key:"header-row",style:m.tableRow},u.map((x,g)=>K.createElement(Ne,{key:`header-${g}`,style:[m.tableColHeader,{width:hs(x.key)}]},K.createElement(ve,{style:m.tableCellHeader},x.label)))),...n.map((x,g)=>K.createElement(Ne,{key:`row-${g}`,style:[m.tableRow,g%2===1?m.alternateRow:{}]},u.map((A,E)=>K.createElement(Ne,{key:`cell-${g}-${E}`,style:[m.tableCol,{width:hs(A.key)}]},K.createElement(ve,{style:St(A.key)},Rt(x,A,s))))))]),K.createElement(Ne,{key:"footer",style:m.footer},K.createElement(ve,{},`Generated by Job Portal System • Total records: ${n.length}`)),K.createElement(ve,{key:"pageNumber",style:m.pageNumber,render:({pageNumber:x,totalPages:g})=>`Page ${x} of ${g}`})]))},kt=async(s,n,c,r={})=>{try{if(!n||!Array.isArray(n)||n.length===0)throw new Error("No table data provided");if(!c||!Array.isArray(c)||c.length===0)throw new Error("No columns provided");const m=Ct(s,n,c,r);return await Ds(m).toBlob()}catch(m){throw console.error("Error generating react-pdf:",m),new Error(`Failed to generate PDF report: ${m.message}`)}},hs=(s,n)=>s==="jobseeker_info"?"40%":s==="employer_info"||s==="candidate_info"||s==="job_details"?"30%":{name:"20%",email:"25%",phone:"15%",location:"20%",category:"20%",experience:"15%",status:"12%",priority:"12%",demand:"12%",count:"10%",percentage:"10%",createdAt:"15%",registeredAt:"15%",employerName:"20%",companyName:"20%",candidateName:"20%",candidateEmail:"20%",candidateContact:"15%",position:"20%",monthlyRate:"15%",contactEmail:"20%"}[s]||"15%",St=s=>["jobseeker_info","employer_info","candidate_info","job_details","name","email","location","category","position","companyName","employerName","candidateName","candidateEmail"].includes(s)?{textAlign:"left"}:{textAlign:"center"},Pt=(s,n)=>!s&&s!==0?"N/A":n==="status"||n==="priority"||n==="demand"?At(s):n==="percentage"?`${s}%`:n==="monthlyRate"&&s!=="Not specified"?s:typeof s=="string"&&s.length>30?s.substring(0,27)+"...":s,At=s=>s?{Active:"Active",Inactive:"Inactive",pending:"Pending",in_progress:"In Progress",completed:"Completed",urgent:"Urgent",high:"High",normal:"Normal",low:"Low",High:"High",Medium:"Medium",Low:"Low"}[s]||s:"N/A",Et=s=>({"job-seekers":"Job Seekers Report","employer-requests":"Employer Requests Report",categories:"Job Categories Report",locations:"Location Distribution Report",skills:"Skills Analysis Report"})[s]||"Table Report",Mt=(s,n)=>s==="job-seekers"?[{key:"jobseeker_info",label:"Job Seeker Info",subColumns:["name","email","phone","location"]},{key:"job_details",label:"Job Details",subColumns:["category","experience"]},{key:"registeredAt",label:"Registration Date",subColumns:["registeredAt"]},{key:"status",label:"Status",subColumns:["status"]}]:s==="employer-requests"?[{key:"employer_info",label:"Employer Info",subColumns:["employerName","companyName","employerEmail"]},{key:"candidate_info",label:"Candidate Info",subColumns:["candidateName","candidateEmail","candidateContact"]},{key:"job_details",label:"Job Details",subColumns:["category","monthlyRate","status","priority"]},{key:"createdAt",label:"Request Date",subColumns:["createdAt"]}]:s==="categories"?[{key:"category",label:"Category",subColumns:["category"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:s==="locations"?[{key:"location",label:"Location",subColumns:["location"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:s==="skills"?[{key:"skill",label:"Skill",subColumns:["skill"]},{key:"count",label:"Count",subColumns:["count"]},{key:"percentage",label:"Percentage",subColumns:["percentage"]}]:n.map(c=>({key:c.key,label:c.label,subColumns:[c.key]})),Rt=(s,n,c)=>{if(!n.subColumns||n.subColumns.length===1){const m=n.subColumns?n.subColumns[0]:n.key;return Pt(s[m],m)}const r=n.subColumns.map(m=>{const f=s[m];return!f||f==="Not provided"||f==="Not specified"||f==="Unknown"?null:f}).filter(Boolean);return r.length===0?"N/A":r.length===1?r[0]:n.key==="jobseeker_info"?`${r[0]}
${r[1]}
${r[2]}
${r[3]}`:n.key==="employer_info"?`${r[0]}
${r[1]}
${r[2]||"N/A"}`:n.key==="candidate_info"?`${r[0]}
${r[1]}
${r[2]||"N/A"}`:n.key==="job_details"?c==="job-seekers"?`${r[0]}
${r[1]}`:c==="employer-requests"?`${r[0]}
${r[1]}
${r[2]}
${r[3]}`:r.join(`
`):r.join(`
`)},Dt=async(s,n)=>{try{const c=URL.createObjectURL(s),r=document.createElement("a");return r.href=c,r.download=n,r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(c),!0}catch(c){return console.error("Error saving PDF:",c),!1}},Lt=(s,n,c)=>{try{const r=n.map(g=>g.label).join(","),m=s.map(g=>n.map(A=>{const E=g[A.key];return typeof E=="string"&&(E.includes(",")||E.includes('"'))?`"${E.replace(/"/g,'""')}"`:E||""}).join(",")),f=[r,...m].join(`
`),C=new Blob([f],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),x=URL.createObjectURL(C);return u.setAttribute("href",x),u.setAttribute("download",c),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u),!0}catch(r){return console.error("Error exporting CSV:",r),!1}},$t=(s,n,c)=>{try{let r='<table border="1">';r+="<tr>",n.forEach(u=>{r+=`<th style="background-color: #3b82f6; color: white; padding: 8px; text-align: center; font-weight: bold;">${u.label}</th>`}),r+="</tr>",s.forEach(u=>{r+="<tr>",n.forEach(x=>{const g=u[x.key]||"";r+=`<td style="padding: 6px; border: 1px solid #e5e7eb;">${g}</td>`}),r+="</tr>"}),r+="</table>";const m=new Blob([r],{type:"application/vnd.ms-excel"}),f=document.createElement("a"),C=URL.createObjectURL(m);return f.setAttribute("href",C),f.setAttribute("download",c.replace(".xlsx",".html")),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f),!0}catch(r){return console.error("Error exporting Excel:",r),!1}},qt=()=>{const{t:s}=Ze(),[n,c]=l.useState("30"),[r,m]=l.useState(!1),[f,C]=l.useState(null),[u,x]=l.useState(!0),[g,A]=l.useState(""),[E,y]=l.useState(null),[P,N]=l.useState("job-seekers"),[q,p]=l.useState(""),[b,L]=l.useState("pdf"),{jobSeekers:T,loading:F,error:X,fetchJobSeekers:_}=Ns({autoFetch:!0,itemsPerPage:1e3}),{requests:t,loading:a,error:d,fetchRequests:j}=ws({autoFetch:!0,itemsPerPage:1e3}),{categories:$,loading:D,error:W,fetchCategories:ee}=tt({includeAdmin:!0,autoFetch:!0});l.useEffect(()=>{v()},[n]);const v=async()=>{try{x(!0),A("");const[h,i]=await Promise.all([Se.getAnalytics({period:n}),Se.getDashboardStats()]);h.success?C(h.data):A(h.error||"Failed to load analytics data"),i.success&&y(i.data)}catch(h){console.error("Error loading report data:",h),A("Network error. Please try again.")}finally{x(!1)}},O=[{value:"7",label:"Last 7 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days"},{value:"365",label:"Last Year"}],k=[{value:"job-seekers",label:"Job Seekers",icon:Je},{value:"employer-requests",label:"Employer Requests",icon:Re},{value:"categories",label:"Categories",icon:Ie},{value:"locations",label:"Locations",icon:Qe},{value:"skills",label:"Skills",icon:Fs}],w=async h=>{m(!0);try{const i=oe(h),o=ce(h);if(!i||i.length===0)return z.error("No data available for export"),!1;const R=new Date().toISOString().split("T")[0],M=`table-report-${h}-${R}`;let U=!1;switch(b){case"pdf":const de={title:ae(h),subtitle:`Comprehensive data table for ${ae(h).toLowerCase()}`,dateRange:`Last ${n} days (${new Date(Date.now()-parseInt(n)*24*60*60*1e3).toLocaleDateString()} - ${new Date().toLocaleDateString()})`};try{const H=await kt(h,i,o,de),G=`${M}.pdf`;U=await Dt(H,G)}catch(H){return console.error("PDF generation error:",H),z.error(`PDF generation failed: ${H.message}`),!1}U?z.success(`${ae(h)} exported successfully as PDF!`):z.error("Failed to save PDF file");break;case"csv":const le=`${M}.csv`;U=Lt(i,o,le),U?z.success(`${ae(h)} exported successfully as CSV!`):z.error("Failed to save CSV file");break;case"excel":const He=`${M}.xlsx`;U=$t(i,o,He),U?z.success(`${ae(h)} exported successfully as Excel!`):z.error("Failed to save Excel file");break;default:return z.error("Unsupported export format"),!1}return U}catch(i){return console.error("Error exporting report:",i),z.error("Error generating export report. Please try again."),!1}finally{m(!1)}},V=async()=>{m(!0);try{await Promise.all([v(),_(),j(),ee()])}catch(h){console.error("Error refreshing data:",h),A("Failed to refresh data. Please try again.")}finally{m(!1)}},Y=()=>!T||T.length===0?[]:T.map(h=>({id:h.id,name:`${h.profile?.firstName||h.firstName||h.name||"Unknown"} ${h.profile?.lastName||h.lastName||""}`,email:h.email||h.profile?.email||"Not provided",phone:h.profile?.contactNumber||h.contactNumber||h.phone||"Not provided",location:h.profile?.location||h.location||h.city||"Not specified",category:h.profile?.jobCategory?.name_en||h.jobCategory?.name_en||h.category||"Not specified",experience:h.profile?.experienceLevel||h.experienceLevel||h.experience||"Not specified",registeredAt:h.registeredAt||h.createdAt?new Date(h.registeredAt||h.createdAt).toLocaleDateString():"Unknown",status:h.status||"Active"})),re=()=>{if(!t||t.length===0)return[];const h=i=>{if(!i||i==="Not specified")return"Not specified";if(typeof i=="number")return new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(i);if(typeof i=="string"){const o=parseFloat(i);return isNaN(o)?i:new Intl.NumberFormat("en-RW",{style:"currency",currency:"frw",minimumFractionDigits:0}).format(o)}return"Not specified"};return t.map(i=>({id:i.id,employerName:i.name||i.employerName||i.employer?.name||"Unknown",companyName:i.companyName||i.employer?.company||"Private",candidateName:i.requestedCandidate&&`${i.requestedCandidate.profile?.firstName||""} ${i.requestedCandidate.profile?.lastName||""}`.trim()||"Not specified",position:i.requestedCandidate?.profile?.skills||i.position||i.jobTitle||"General",status:i.status||"pending",priority:i.priority||"normal",monthlyRate:h(i.requestedCandidate?.profile?.monthlyRate),createdAt:i.createdAt?new Date(i.createdAt).toLocaleDateString():"Unknown",contactEmail:i.email||i.employerContact?.email||i.employer?.email||"Not provided",lastContactDate:i.updatedAt,isCompleted:i.status==="completed",category:i.requestedCandidate?.profile?.jobCategory?.name_en||"General",candidateExperience:i.requestedCandidate?.profile?.experience||"Not specified",candidateExperienceLevel:i.requestedCandidate?.profile?.experienceLevel||"Not specified",candidateEducation:i.requestedCandidate?.profile?.educationLevel||"Not specified",candidateLocation:i.requestedCandidate?.profile?.location||"Not specified",candidateCity:i.requestedCandidate?.profile?.city||"Not specified",candidateCountry:i.requestedCandidate?.profile?.country||"Not specified",candidateContact:i.requestedCandidate?.profile?.contactNumber||"Not specified",candidateEmail:i.requestedCandidate?.email||"Not specified",candidateLanguages:i.requestedCandidate?.profile?.languages||"Not specified",candidateCertifications:i.requestedCandidate?.profile?.certifications||"Not specified",candidateAvailability:i.requestedCandidate?.profile?.availability||"Not specified",candidateDescription:i.requestedCandidate?.profile?.description||"Not specified",candidateGender:i.requestedCandidate?.profile?.gender||"Not specified",candidateMaritalStatus:i.requestedCandidate?.profile?.maritalStatus||"Not specified",candidateIdNumber:i.requestedCandidate?.profile?.idNumber||"Not specified",candidateReferences:i.requestedCandidate?.profile?.references||"Not specified",message:i.message||"",_backendData:i}))},be=()=>{if(!$||$.length===0)return[];const h={};return T?.forEach(i=>{const o=i.profile?.jobCategory?.name_en||i.jobCategory?.name_en||i.category||"Uncategorized";h[o]=(h[o]||0)+1}),$.map(i=>{const o=h[i.name_en]||0,R=T?.length||1,M=Math.round(o/R*100);return{id:i.id,name:i.name_en||i.name,count:o,percentage:M,status:"Active"}})},je=()=>{if(!T||T.length===0)return[];const h={};return T.forEach(i=>{const o=i.profile?.location||i.location||i.city||"Unknown";h[o]=(h[o]||0)+1}),Object.entries(h).map(([i,o])=>{const R=T.length,M=Math.round(o/R*100);return{id:i,name:i,count:o,percentage:M,status:"Active"}}).sort((i,o)=>o.count-i.count)},ne=()=>{if(!T||T.length===0)return[];const h={};return T.forEach(i=>{const o=i.profile?.skills||i.skills||"";o&&o.split(",").map(M=>M.trim()).filter(M=>M).forEach(M=>{h[M]=(h[M]||0)+1})}),Object.entries(h).map(([i,o])=>{const R=T.length,M=Math.round(o/R*100),U=o>R*.3?"High":o>R*.1?"Medium":"Low";return{id:i,name:i,count:o,percentage:M,demand:U}}).sort((i,o)=>o.count-i.count)},ce=h=>{switch(h){case"job-seekers":return[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"location",label:"Location",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"experience",label:"Experience",sortable:!0},{key:"registeredAt",label:"Registered",sortable:!0},{key:"status",label:"Status",sortable:!0,render:i=>e.jsx(B,{variant:i.status==="Active"?"success":"warning",children:i.status})}];case"employer-requests":return[{key:"employerName",label:"Employer Name",sortable:!0},{key:"companyName",label:"Company",sortable:!0},{key:"contactEmail",label:"Employer Email",sortable:!0},{key:"candidateName",label:"Candidate Name",sortable:!0},{key:"candidateEmail",label:"Candidate Email",sortable:!0},{key:"candidateContact",label:"Candidate Phone",sortable:!0},{key:"position",label:"Position/Skills",sortable:!0},{key:"category",label:"Category",sortable:!0},{key:"monthlyRate",label:"Monthly Rate",sortable:!0},{key:"status",label:"Status",sortable:!0,render:i=>e.jsx(B,{variant:i.status==="completed"?"success":i.status==="in_progress"?"warning":i.status==="pending"?"info":"danger",children:i.status.replace("_"," ")})},{key:"priority",label:"Priority",sortable:!0,render:i=>e.jsx(B,{variant:i.priority==="urgent"?"danger":i.priority==="high"?"warning":i.priority==="normal"?"info":"secondary",children:i.priority})},{key:"createdAt",label:"Created",sortable:!0}];case"categories":return[{key:"name",label:"Category Name",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:i=>e.jsxs("span",{children:[i.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:i=>e.jsx(B,{variant:"success",children:i.status})}];case"locations":return[{key:"name",label:"Location",sortable:!0},{key:"count",label:"Job Seekers",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:i=>e.jsxs("span",{children:[i.percentage,"%"]})},{key:"status",label:"Status",sortable:!0,render:i=>e.jsx(B,{variant:"success",children:i.status})}];case"skills":return[{key:"name",label:"Skill Name",sortable:!0},{key:"count",label:"Count",sortable:!0},{key:"percentage",label:"Percentage",sortable:!0,render:i=>e.jsxs("span",{children:[i.percentage,"%"]})},{key:"demand",label:"Demand Level",sortable:!0,render:i=>e.jsx(B,{variant:i.demand==="High"?"success":i.demand==="Medium"?"warning":"info",children:i.demand})}];default:return[]}},oe=h=>{switch(h){case"job-seekers":return Y();case"employer-requests":return re();case"categories":return be();case"locations":return je();case"skills":return ne();default:return[]}},ae=h=>{const i=k.find(o=>o.value===h);return i?i.label:"Report"};return u||F||a||D?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(ge,{size:"lg",text:"Loading table reports..."})}):g||X||d||W?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ys,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Table Reports"}),e.jsx("p",{className:"text-red-600 mb-4",children:g||X||d||W}),e.jsxs(S,{onClick:V,variant:"outline",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Table Reports"})})}),e.jsx(Q,{className:"",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsx("select",{value:n,onChange:h=>c(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:O.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]})}),k.map(h=>{const i=h.icon,o=P===h.value;return e.jsx("button",{onClick:()=>N(h.value),className:`p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md ${o?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 hover:border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(i,{className:`w-6 h-6 ${o?"text-blue-600":"text-gray-500"}`}),e.jsx("span",{className:"text-sm font-medium text-center",children:h.label})]})},h.value)})]})}),P&&e.jsxs(Q,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:ae(P)}),e.jsxs("p",{className:"text-gray-600",children:["Comprehensive data table for ",ae(P).toLowerCase()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:b,onChange:h=>L(h.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"excel",children:"Excel"})]}),e.jsxs(S,{onClick:()=>w(P),disabled:r,className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"w-3 h-3"}),r?"Exporting...":`Export ${b.toUpperCase()}`]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(S,{onClick:V,variant:"outline",disabled:r,className:"flex items-center gap-2",children:[e.jsx(Ue,{className:`w-3 h-3 ${r?"animate-spin":""}`}),r?"Refreshing...":"Refresh"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(vs,{columns:ce(P),data:oe(P),pagination:!0,itemsPerPage:15,searchTerm:q,onSearchChange:p,className:"w-full"})})]}),e.jsx(Ke,{position:"top-right"})]})},Ft=(s={})=>{const{autoFetch:n=!1,itemsPerPage:c=10,page:r=1,searchTerm:m="",status:f="",category:C=""}=s,[u,x]=l.useState([]),[g,A]=l.useState(!1),[E,y]=l.useState(""),[P,N]=l.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[q,p]=l.useState(null),b=l.useCallback(async(a={})=>{A(!0),y("");try{const d={page:a.page||r,limit:a.itemsPerPage||c,search:a.searchTerm||m,status:a.status||f,category:a.category||C,...a},j=await Ee.getAllContacts(d);j.success?(x(Array.isArray(j.data.contacts)?j.data.contacts:[]),j.data.pagination&&N(j.data.pagination),j.data.statistics&&p(j.data.statistics)):y(j.error)}catch(d){y("Failed to fetch contact messages"),console.error("Error fetching contact messages:",d)}finally{A(!1)}},[r,c,m,f,C]),L=l.useCallback(async a=>{A(!0),y("");try{const d=await Ee.getMessageById(a);return d.success?d.data:(y(d.error),null)}catch(d){return y("Failed to fetch contact message"),console.error("Error fetching contact message:",d),null}finally{A(!1)}},[]),T=l.useCallback(async(a,d)=>{A(!0),y("");try{const j=await Ee.respondToMessage(a,d);return j.success?(await b(),j):(y(j.error),j)}catch{return y("Failed to respond to message"),{success:!1,error:"Failed to respond to message"}}finally{A(!1)}},[b]),F=l.useCallback(async a=>{try{const d=await Ee.markAsRead(a);return d.success?(x(j=>j.map($=>$.id===a?{...$,isRead:!0}:$)),d):(y(d.error),d)}catch(d){return y("Failed to mark message as read"),console.error("Error marking message as read:",d),{success:!1,error:"Failed to mark message as read"}}},[]),X=l.useCallback(async a=>{try{const d=await Ee.deleteMessage(a);return d.success?(x(j=>j.filter($=>$.id!==a)),d):(y(d.error),d)}catch(d){return y("Failed to delete message"),console.error("Error deleting message:",d),{success:!1,error:"Failed to delete message"}}},[]),_=l.useCallback(async()=>{try{const a=await Ee.getStatistics();return a.success?(p(a.data),a.data):(y(a.error),null)}catch(a){return y("Failed to fetch statistics"),console.error("Error fetching statistics:",a),null}},[]),t=l.useCallback(()=>b(),[b]);return l.useEffect(()=>{n&&(b(),_())},[n,b,_]),{messages:u,loading:g,error:E,pagination:P,statistics:q,fetchMessages:b,fetchMessageById:L,respondToMessage:T,markAsRead:F,deleteMessage:X,fetchStatistics:_,refreshMessages:t}},Tt=()=>{const{t:s}=Ze(),[n,c]=l.useState(""),[r,m]=l.useState(""),[f,C]=l.useState(""),[u,x]=l.useState(null),[g,A]=l.useState(!1),[E,y]=l.useState(!1),[P,N]=l.useState(!1),[q,p]=l.useState({subject:"",message:""}),[b,L]=l.useState(!1),{messages:T,loading:F,error:X,statistics:_,fetchMessages:t,respondToMessage:a,markAsRead:d,deleteMessage:j,refreshMessages:$}=Ft({autoFetch:!0,itemsPerPage:15}),[D,W]=l.useState(1),ee=15,O=(Array.isArray(T)?T.map(o=>({...o,createdAt:o.createdAt||""})):[]).filter(o=>{const R=!n||o.status===n,M=!r||o.category===r,U=!f||o.priority===f;return R&&M&&U}),k=Math.ceil(O.length/ee),w=O.slice((D-1)*ee,D*ee),V=(o,R)=>{x(R),A(!0)};l.useEffect(()=>{t({status:n,category:r,priority:f})},[n,r,f]);const Y=async o=>{x(o),A(!0),o.isRead||await d(o.id)},re=o=>{x(o),p({subject:`Re: ${o.subject}`,message:""}),y(!0)},be=o=>{x(o),N(!0)},je=async o=>{if(o.preventDefault(),!localStorage.getItem("job_portal_token")){z.error("You are not logged in. Please log in again."),window.location.href="/login";return}if(!q.subject.trim()||!q.message.trim()){z.error("Please fill in both subject and message");return}if(u&&u.status==="responded"){z.error("This message has already been responded to. You cannot reply again."),y(!1);return}L(!0);try{const M=await a(u.id,q);M.success?(z.success("Response sent successfully!"),y(!1),p({subject:"",message:""}),x(null)):z.error(M.error||"Failed to send response")}catch{z.error("Failed to send response. Please try again.")}finally{L(!1)}},ne=async()=>{(await j(u.id)).success?(z.success("Message deleted successfully!"),N(!1),x(null)):z.error("Failed to delete message")},ce=o=>{switch(o){case"unread":return e.jsx(B,{variant:"warning",children:"Unread"});case"read":return e.jsx(B,{variant:"info",children:"Read"});case"responded":return e.jsx(B,{variant:"success",children:"Responded"});case"archived":return e.jsx(B,{variant:"secondary",children:"Archived"});default:return e.jsx(B,{variant:"outline",children:o})}},oe=o=>{switch(o){case"low":return e.jsx(B,{variant:"secondary",children:"Low"});case"normal":return e.jsx(B,{variant:"info",children:"Normal"});case"high":return e.jsx(B,{variant:"warning",children:"High"});case"urgent":return e.jsx(B,{variant:"danger",children:"Urgent"});default:return e.jsx(B,{variant:"outline",children:o})}},ae=o=>{switch(o){case"general":return e.jsx(B,{variant:"info",children:"General"});case"support":return e.jsx(B,{variant:"warning",children:"Support"});case"feedback":return e.jsx(B,{variant:"success",children:"Feedback"});case"complaint":return e.jsx(B,{variant:"danger",children:"Complaint"});default:return e.jsx(B,{variant:"outline",children:o})}},h=[{key:"name",label:"Name",sortable:!0,render:o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:o.name})]})},{key:"email",label:"Email",sortable:!0,render:o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_e,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:o.email})]})},{key:"subject",label:"Subject",sortable:!0,render:o=>e.jsx("div",{className:"max-w-xs truncate",title:o.subject,children:o.subject})},{key:"category",label:"Category",sortable:!0,render:o=>ae(o.category)},{key:"priority",label:"Priority",sortable:!0,render:o=>oe(o.priority)},{key:"status",label:"Status",sortable:!0,render:o=>ce(o.status)},{key:"submittedAt",label:"Date",sortable:!0,render:o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fs,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:new Date(o.createdAt).toLocaleDateString()})]})}],i=o=>[{key:"view",label:"View",icon:ke,onClick:()=>Y(o),variant:"outline"},{key:"reply",label:"Reply",icon:Ve,onClick:()=>{o.status==="responded"?z.error("This message has already been responded to."):re(o)},variant:"primary",disabled:o.status==="responded"},{key:"delete",label:"Delete",icon:xe,onClick:()=>be(o),variant:"danger"}];return F&&T.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(ge,{size:"lg",text:"Loading contact messages..."})}):X&&T.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx($e,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error Loading Contact Messages"}),e.jsx("p",{className:"text-red-600 mb-4",children:X}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Authentication Issue:"})," This error usually means you need to log in again or your session has expired."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsxs(S,{onClick:$,variant:"outline",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsx(S,{onClick:()=>window.location.href="/login",variant:"primary",children:"Go to Login"})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-gray-600",children:"Manage and respond to contact form submissions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(S,{onClick:$,variant:"outline",disabled:F,className:"flex items-center gap-2",children:[e.jsx(Ue,{className:`w-4 h-4 ${F?"animate-spin":""}`}),F?"Refreshing...":"Refresh"]})})]}),_&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(Q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Re,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.total||0})]})]})}),e.jsx(Q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(ze,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Unread Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.unread||0})]})]})}),e.jsx(Q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Le,{className:"w-6 h-6 text-green-600"})}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:_.responded||0})})]})}),e.jsx(Q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(_s,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Archived"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.archived||0})]})]})})]}),e.jsx(Q,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:n,onChange:o=>c(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"unread",children:"Unread"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"responded",children:"Responded"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:r,onChange:o=>m(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"feedback",children:"Feedback"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{value:f,onChange:o=>C(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(S,{onClick:()=>{c(""),m(""),C("")},variant:"outline",className:"w-full",children:[e.jsx(zs,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})})]})}),e.jsx(vs,{columns:h,data:w,pagination:!0,itemsPerPage:ee,actionButtons:i,onRowAction:V,className:"w-full"}),k>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>W(D-1),disabled:D===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",D," of ",k]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>W(D+1),disabled:D===k,children:"Next"})]}),e.jsx(De,{isOpen:g,onClose:()=>A(!1),title:"View Message",maxWidth:"max-w-2xl",children:u&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:u.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:u.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("p",{className:"text-gray-900",children:u.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("div",{children:ae(u.category)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{children:ce(u.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(u.createdAt).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:u.message})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(S,{onClick:()=>{A(!1),re(u)},variant:"primary",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Reply"]}),e.jsx(S,{onClick:()=>A(!1),variant:"outline",children:"Close"})]})]})}),e.jsx(De,{isOpen:E,onClose:()=>y(!1),title:"Reply to Message",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:je,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:q.subject,onChange:o=>p(R=>({...R,subject:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:q.message,onChange:o=>p(R=>({...R,message:o.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Type your response...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{type:"button",onClick:()=>y(!1),variant:"outline",disabled:b,children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",disabled:b,children:b?e.jsxs("span",{className:"flex items-center",children:[e.jsx(ge,{size:"sm",className:"mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Send Reply"]})})]})]})}),e.jsx(Ke,{position:"top-right"}),e.jsx(De,{isOpen:P,onClose:()=>N(!1),title:"Delete Message",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(xe,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Message"}),e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to delete this message? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{onClick:()=>N(!1),variant:"outline",children:"Cancel"}),e.jsxs(S,{onClick:ne,variant:"danger",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})},_t=({loadingTime:s,apiCalls:n,cacheHits:c,errors:r,showDetails:m=!1})=>{const[f,C]=l.useState(!1);if(l.useEffect(()=>{const g=setTimeout(()=>{(s>2e3||r.length>0)&&C(!0)},2e3);return()=>clearTimeout(g)},[s,r.length]),!f)return null;const x=s<1e3?{status:"excellent",color:"text-green-600",bg:"bg-green-50"}:s<2e3?{status:"good",color:"text-blue-600",bg:"bg-blue-50"}:s<5e3?{status:"fair",color:"text-yellow-600",bg:"bg-yellow-50"}:{status:"poor",color:"text-red-600",bg:"bg-red-50"};return e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 ${x.bg} border rounded-lg shadow-lg p-4 max-w-sm transition-all duration-300`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`font-semibold ${x.color}`,children:"Performance Monitor"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["Load Time: ",e.jsxs("span",{className:x.color,children:[s,"ms"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Is,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["API Calls: ",n]})]}),c>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Us,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:["Cache Hits: ",c]})]}),r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{children:["Errors: ",r.length]})]})]}),m&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{children:["Status: ",e.jsx("span",{className:x.color,children:x.status})]}),e.jsxs("div",{children:["Performance: ",s<1e3?"🚀":s<2e3?"⚡":s<5e3?"🐌":"🐌🐌"]})]})})]})},zt=()=>{const{user:s,updateUser:n}=js(),[c,r]=l.useState("profile"),[m,f]=l.useState(!1),[C,u]=l.useState(!0),[x,g]=l.useState({type:"",text:""}),[A,E]=l.useState({startTime:Date.now(),loadingTime:0,apiCalls:0,cacheHits:0,errors:[]}),[y,P]=l.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:""}),[N,q]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[p,b]=l.useState({}),[L,T]=l.useState(!1),[F,X]=l.useState(!1),[_,t]=l.useState(!1),a=l.useMemo(()=>[{id:"profile",label:"Profile",icon:qe},{id:"security",label:"Security",icon:Bs}],[]),d=l.useCallback(async()=>{try{u(!0),E(w=>({...w,apiCalls:w.apiCalls+1})),console.log("🔄 Loading admin profile...");const k=await Se.getAdminProfile();if(console.log("📊 Admin profile result:",k),k.success){const w=k.data;console.log("👤 Admin data received:",w),P({firstName:w.firstName||w.profile?.firstName||"",lastName:w.lastName||w.profile?.lastName||"",email:w.email||"",phone:w.phone||w.phoneNumber||w.profile?.phoneNumber||"",location:w.location||w.city||w.profile?.city||"",bio:w.bio||w.profile?.bio||""}),k.fromCache&&E(V=>({...V,cacheHits:V.cacheHits+1}))}else console.warn("⚠️ Failed to load admin profile from API, using user context data"),console.warn("❌ API Error:",k.error),s&&(console.log("👤 Falling back to user context data:",s),P({firstName:s.profile?.firstName||s.firstName||"",lastName:s.profile?.lastName||s.lastName||"",email:s.email||"",phone:s.profile?.phoneNumber||s.phoneNumber||"",location:s.profile?.city||s.city||"",bio:s.profile?.bio||s.bio||""})),E(w=>({...w,errors:[...w.errors,k.error||"Failed to load admin profile"]}))}catch(k){console.error("💥 Error loading admin profile:",k),s&&(console.log("👤 Falling back to user context data on error:",s),P({firstName:s.profile?.firstName||s.firstName||"",lastName:s.profile?.lastName||s.lastName||"",email:s.email||"",phone:s.profile?.phoneNumber||s.phoneNumber||"",location:s.profile?.city||s.city||"",bio:s.profile?.bio||s.bio||""})),E(w=>({...w,errors:[...w.errors,"Network error loading admin profile"]}))}finally{u(!1)}},[s]);l.useEffect(()=>{const w=Date.now()-A.startTime;E(V=>({...V,loadingTime:w}))},[C]),l.useEffect(()=>{d()},[d]);const j=l.useCallback(k=>{const{name:w,value:V}=k.target;P(Y=>({...Y,[w]:V})),p[w]&&b(Y=>({...Y,[w]:""}))},[p]),$=l.useCallback(k=>{const{name:w,value:V}=k.target;q(Y=>({...Y,[w]:V})),p[w]&&b(Y=>({...Y,[w]:""}))},[p]),D=l.useCallback(()=>{const k={};return y.firstName.trim()||(k.firstName="First name is required"),y.lastName.trim()||(k.lastName="Last name is required"),y.email.trim()?/\S+@\S+\.\S+/.test(y.email)||(k.email="Email is invalid"):k.email="Email is required",y.phone&&y.phone.replace(/\D/g,"").length<9&&(k.phone="Phone number must be at least 9 digits"),b(k),Object.keys(k).length===0},[y]),W=l.useCallback(()=>{const k={};return N.currentPassword||(k.currentPassword="Current password is required"),N.newPassword?N.newPassword.length<8&&(k.newPassword="Password must be at least 8 characters"):k.newPassword="New password is required",N.newPassword!==N.confirmPassword&&(k.confirmPassword="Passwords do not match"),b(k),Object.keys(k).length===0},[N]),ee=l.useCallback(async()=>{if(D())try{f(!0),E(w=>({...w,apiCalls:w.apiCalls+1}));const k=await Se.updateAdminProfile(y);k.success?(g({type:"success",text:"Profile updated successfully!"}),n&&n({...s,...y}),setTimeout(()=>g({type:"",text:""}),3e3)):(g({type:"error",text:k.error||"Failed to update profile"}),E(w=>({...w,errors:[...w.errors,k.error||"Profile update failed"]})))}catch{g({type:"error",text:"Network error. Please try again."}),E(w=>({...w,errors:[...w.errors,"Network error during profile update"]}))}finally{f(!1)}},[y,D,n,s]),v=l.useCallback(async()=>{if(W())try{f(!0),E(w=>({...w,apiCalls:w.apiCalls+1}));const k=await Se.changeAdminPassword({currentPassword:N.currentPassword,newPassword:N.newPassword});k.success?(g({type:"success",text:"Password changed successfully!"}),q({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>g({type:"",text:""}),3e3)):(g({type:"error",text:k.error||"Failed to change password"}),E(w=>({...w,errors:[...w.errors,k.error||"Password change failed"]})))}catch{g({type:"error",text:"Network error. Please try again."}),E(w=>({...w,errors:[...w.errors,"Network error during password change"]}))}finally{f(!1)}},[N,W]),O=l.useMemo(()=>x.text?e.jsxs(Pe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`p-4 rounded-lg flex items-center space-x-2 ${x.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[x.type==="success"?e.jsx(Le,{className:"w-5 h-5"}):e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{children:x.text}),e.jsx("button",{onClick:()=>g({type:"",text:""}),className:"ml-auto hover:opacity-70 transition-opacity",children:e.jsx(ue,{className:"w-4 h-4"})})]}):null,[x]);return C?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ge,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your profile and system settings"})]})}),O,e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:a.map(k=>{const w=k.icon;return e.jsxs("button",{onClick:()=>r(k.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${c===k.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:k.label})]},k.id)})})}),e.jsxs("div",{className:"mt-6",children:[c==="profile"&&e.jsx(Pe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(Q,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:y.firstName,onChange:j,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.firstName?"border-red-300":"border-gray-300"}`}),p.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:y.lastName,onChange:j,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.lastName?"border-red-300":"border-gray-300"}`}),p.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:y.email,onChange:j,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.email?"border-red-300":"border-gray-300"}`}),p.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:y.phone,onChange:j,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.phone?"border-red-300":"border-gray-300"}`}),p.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:y.location,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{name:"bio",value:y.bio,onChange:j,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"Tell us about yourself..."})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(S,{variant:"primary",onClick:ee,disabled:m,children:[m?e.jsx(ge,{size:"sm"}):e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})})}),c==="security"&&e.jsx(Pe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs(Q,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:L?"text":"password",name:"currentPassword",value:N.currentPassword,onChange:$,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.currentPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>T(!L),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:L?e.jsx(Oe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ke,{className:"w-4 h-4 text-gray-400"})})]}),p.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:F?"text":"password",name:"newPassword",value:N.newPassword,onChange:$,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.newPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>X(!F),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:F?e.jsx(Oe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ke,{className:"w-4 h-4 text-gray-400"})})]}),p.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.newPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:_?"text":"password",name:"confirmPassword",value:N.confirmPassword,onChange:$,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors ${p.confirmPassword?"border-red-300":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>t(!_),className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:opacity-70 transition-opacity",children:_?e.jsx(Oe,{className:"w-4 h-4 text-gray-400"}):e.jsx(ke,{className:"w-4 h-4 text-gray-400"})})]}),p.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.confirmPassword})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(S,{variant:"primary",onClick:v,disabled:m,children:[m?e.jsx(ge,{size:"sm"}):e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Change Password"]})})]})]})})]})]}),e.jsx(_t,{loadingTime:A.loadingTime,apiCalls:A.apiCalls,cacheHits:A.cacheHits,errors:A.errors,showDetails:!0})]})},It=()=>{const[s,n]=l.useState([]),[c,r]=l.useState(!0),[m,f]=l.useState(""),[C,u]=l.useState(!1),[x,g]=l.useState(!1),[A,E]=l.useState(!1),[y,P]=l.useState(null),[N,q]=l.useState({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0}),[p,b]=l.useState(!1),[L,T]=l.useState(!1),F=l.useCallback(async()=>{try{r(!0),f("");const v=await fetch(`${me.BASE_URL}/payment-methods/admin/all`,{headers:{Authorization:`Bearer ${localStorage.getItem(me.AUTH_CONFIG.tokenKey)}`}});if(v.ok){const O=await v.json();n(O.paymentMethods||[])}else{const O=await v.json();f(O.error||"Failed to fetch payment methods")}}catch(v){console.error("Error fetching payment methods:",v),f("Network error. Please try again.")}finally{r(!1)}},[]);l.useEffect(()=>{F()},[F]);const X=()=>{q({name:"",type:"mobile_money",accountName:"",accountNumber:"",bankName:"",sortOrder:0,isActive:!0})},_=()=>{X(),u(!0)},t=v=>{P(v),q({name:v.name,type:v.type,accountName:v.accountName,accountNumber:v.accountNumber,bankName:v.bankName||"",sortOrder:v.sortOrder,isActive:v.isActive}),g(!0)},a=v=>{P(v),E(!0)},d=()=>{u(!1),g(!1),E(!1),P(null),X()},j=async v=>{if(v.preventDefault(),!N.name||!N.type||!N.accountName||!N.accountNumber){z.error("Please fill in all required fields");return}try{b(!0);const O=x?`${me.BASE_URL}/payment-methods/${y.id}`:`${me.BASE_URL}/payment-methods`,w=await fetch(O,{method:x?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem(me.AUTH_CONFIG.tokenKey)}`},body:JSON.stringify(N)}),V=await w.json();if(w.ok){const Y=x?"updated":"created";z.success(`Payment method ${Y} successfully!`),d(),F()}else z.error(V.error||`Failed to ${x?"update":"create"} payment method`)}catch(O){console.error("Error submitting payment method:",O),z.error("Network error. Please try again.")}finally{b(!1)}},$=async()=>{if(y)try{b(!0);const v=await fetch(`${me.BASE_URL}/payment-methods/${y.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem(me.AUTH_CONFIG.tokenKey)}`}});if(v.ok)z.success("Payment method deleted successfully!"),d(),F();else{const O=await v.json();z.error(O.error||"Failed to delete payment method")}}catch(v){console.error("Error deleting payment method:",v),z.error("Network error. Please try again.")}finally{b(!1)}},D=async v=>{try{const O=await fetch(`${me.BASE_URL}/payment-methods/${v.id}/toggle`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem(me.AUTH_CONFIG.tokenKey)}`}});if(O.ok)z.success(`Payment method ${v.isActive?"deactivated":"activated"} successfully!`),F();else{const k=await O.json();z.error(k.error||"Failed to toggle payment method status")}}catch(O){console.error("Error toggling payment method status:",O),z.error("Network error. Please try again.")}},W=v=>{switch(v){case"mobile_money":return e.jsx(Gs,{className:"h-4 w-4"});case"bank_transfer":return e.jsx(Hs,{className:"h-4 w-4"});case"cash":return e.jsx(Ye,{className:"h-4 w-4"});default:return e.jsx(Ye,{className:"h-4 w-4"})}},ee=v=>{switch(v){case"mobile_money":return"Mobile Money";case"bank_transfer":return"Bank Transfer";case"cash":return"Cash";default:return v}};return c?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(ge,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Methods"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage payment methods for employer requests"})]}),e.jsxs(S,{onClick:_,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(we,{className:"h-5 w-5 mr-2"}),"Add Payment Method"]})]})}),m&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-800",children:m})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Payment Methods (",s.length,")"]})}),s.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ye,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No payment methods found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first payment method to get started"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:s.map((v,O)=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 cursor-move",disabled:L,children:e.jsx(Js,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-gray-500",children:W(v.type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:v.name}),e.jsx(B,{variant:v.isActive?"success":"secondary",className:"ml-2",children:v.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",ee(v.type),v.bankName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Bank:"})," ",v.bankName]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Account:"})," ",v.accountName,e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"font-medium",children:"Number:"})," ",v.accountNumber]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>D(v),className:v.isActive?"text-orange-600 hover:text-orange-700":"text-green-600 hover:text-green-700",children:v.isActive?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"h-4 w-4 mr-1"}),"Activate"]})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>t(v),children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>a(v),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})},v.id))})]})]}),(C||x)&&e.jsx(De,{isOpen:C||x,onClose:d,title:x?"Edit Payment Method":"Add Payment Method",maxWidth:"max-w-2xl",children:e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Method Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:N.name,onChange:v=>q({...N,name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., MTN MOMO, Airtel Money, Bank of Rwanda",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:N.type,onChange:v=>q({...N,type:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Holder Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:N.accountName,onChange:v=>q({...N,accountName:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Job Portal, Company Name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Number/Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:N.accountNumber,onChange:v=>q({...N,accountNumber:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 0788123456, 1234567890",required:!0})]}),N.type==="bank_transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:N.bankName,onChange:v=>q({...N,bankName:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Bank of Rwanda, Equity Bank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",value:N.sortOrder,onChange:v=>q({...N,sortOrder:parseInt(v.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lower numbers appear first in the list"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:N.isActive,onChange:v=>q({...N,isActive:v.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Active (available for payments)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{type:"button",variant:"outline",onClick:d,disabled:p,children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),x?"Updating...":"Creating..."]}):x?"Update Method":"Create Method"})]})]})}),A&&y&&e.jsx(De,{isOpen:A,onClose:d,title:"Delete Payment Method",maxWidth:"max-w-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-700",children:["Are you sure you want to delete the payment method ",e.jsxs("strong",{children:['"',y.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone. If this method is being used by existing payments, it cannot be deleted."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{variant:"outline",onClick:d,disabled:p,children:"Cancel"}),e.jsx(S,{variant:"danger",onClick:$,disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):"Delete Method"})]})]})}),e.jsx(Ke,{})]})},Ut=()=>{const[s,n]=l.useState(!1),[c,r]=l.useState(!1),[m,f]=l.useState(null),[C,u]=l.useState({personal:{name:"",title:"",location:"",email:"",phone:"",aboutMe:"",github:"",facebook:"",linkedin:"",twitter:"",instagram:""},skills:{frontend:[],backend:[],database:[],devops:[],design:[],management:[]},experience:[],education:[],certifications:[],projects:[]}),[x,g]=l.useState(null);l.useEffect(()=>{E()},[]);const A=t=>t?(t.projects&&Array.isArray(t.projects)?t.projects=t.projects.map(a=>({...a,tech:Array.isArray(a.tech)?a.tech:typeof a.tech=="string"?a.tech.split(",").map(d=>d.trim()).filter(d=>d):[]})):t.projects||(t.projects=[]),t.experience&&Array.isArray(t.experience)?t.experience=t.experience.map(a=>({...a,achievements:Array.isArray(a.achievements)?a.achievements:[]})):t.experience||(t.experience=[]),t.skills&&typeof t.skills=="object"?Object.keys(t.skills).forEach(a=>{Array.isArray(t.skills[a])||(t.skills[a]=[])}):t.skills||(t.skills={frontend:[],backend:[],database:[],devops:[],design:[],management:[]}),t.education||(t.education=[]),t.certifications||(t.certifications=[]),t.personal||(t.personal={}),console.log("✅ AdminProfileManagement: Data normalized successfully:",t),t):(console.warn("⚠️ AdminProfileManagement: No data received, using defaults"),{personal:{},skills:{frontend:[],backend:[],database:[],devops:[],design:[],management:[]},experience:[],education:[],certifications:[],projects:[]}),E=async(t=0)=>{try{n(!0),f(null),console.log("🔍 AdminProfileManagement: Loading profile data...");const d=await gs.getPublicProfile();console.log("✅ AdminProfileManagement: Profile data loaded:",d);const j=A(d);console.log("🔍 AdminProfileManagement: Setting normalized profile data:",j),u(j)}catch(d){if(console.error("❌ AdminProfileManagement: Error loading profile data:",d),t<2){console.log(`🔄 Retrying profile load... (${t+1}/2)`),setTimeout(()=>{E(t+1)},2e3*(t+1));return}f("Failed to load profile data after multiple attempts. Please try again."),Fe.error("Failed to load profile data")}finally{n(!1)}},y=async()=>{try{r(!0),console.log("🔍 AdminProfileManagement: Saving profile data...");try{await gs.updateProfile(C),Fe.success("Profile updated successfully!"),g(null),console.log("✅ AdminProfileManagement: Profile saved successfully")}catch(t){if(console.error("❌ AdminProfileManagement: Update failed, trying to create new profile..."),t.response?.status===404)Fe("Creating new profile...",{icon:"ℹ️",duration:2e3}),await E(),Fe.success("Profile created successfully!");else throw t}}catch(t){console.error("❌ AdminProfileManagement: Error saving profile data:",t),Fe.error("Failed to save profile data. Please check your authentication.")}finally{r(!1)}},P=(t,a)=>{u(d=>({...d,[t]:[...d[t]||[],a]}))},N=(t,a,d)=>{u(j=>({...j,[t]:j[t].map(($,D)=>D===a?d:$)}))},q=(t,a)=>{u(d=>({...d,[t]:d[t].filter((j,$)=>$!==a)}))};if(s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading profile data..."})]})});if(!C)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Profile Data Not Available"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load profile data. Please try refreshing the page."}),e.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})});const p=C.personal||{},b=C.skills||{},L=C.experience||[],T=C.education||[],F=C.certifications||[],_=(C.projects||[]||[]).map(t=>{try{return{...t,tech:Array.isArray(t.tech)?t.tech:typeof t.tech=="string"?t.tech.split(",").map(a=>a.trim()).filter(a=>a):[]}}catch(a){return console.error("❌ AdminProfileManagement: Error processing project:",t,a),{...t,tech:[]}}});return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(Pe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Profile Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your professional profile and platform information"})]}),m&&e.jsx(Pe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Profile"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:m}),e.jsx("button",{onClick:E,className:"mt-2 text-sm text-red-600 hover:text-red-500 font-medium",children:"Try Again"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(Q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-blue-600"}),"Personal Information"]}),e.jsx(S,{onClick:()=>g(x==="personal"?null:"personal"),variant:"outline",size:"sm",children:x==="personal"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"})})]}),x==="personal"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:p.name,onChange:t=>u(a=>({...a,personal:{...a.personal,name:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:p.title,onChange:t=>u(a=>({...a,personal:{...a.personal,title:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:p.location,onChange:t=>u(a=>({...a,personal:{...a.personal,location:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:p.email,onChange:t=>u(a=>({...a,personal:{...a.personal,email:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:p.phone,onChange:t=>u(a=>({...a,personal:{...a.personal,phone:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GitHub"}),e.jsx("input",{type:"text",value:p.github,onChange:t=>u(a=>({...a,personal:{...a.personal,github:t.target.value}})),placeholder:"github.com/username",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Facebook"}),e.jsx("input",{type:"text",value:p.facebook,onChange:t=>u(a=>({...a,personal:{...a.personal,facebook:t.target.value}})),placeholder:"facebook.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn"}),e.jsx("input",{type:"text",value:p.linkedin,onChange:t=>u(a=>({...a,personal:{...a.personal,linkedin:t.target.value}})),placeholder:"linkedin.com/in/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Twitter/X"}),e.jsx("input",{type:"text",value:p.twitter,onChange:t=>u(a=>({...a,personal:{...a.personal,twitter:t.target.value}})),placeholder:"twitter.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instagram"}),e.jsx("input",{type:"text",value:p.instagram,onChange:t=>u(a=>({...a,personal:{...a.personal,instagram:t.target.value}})),placeholder:"instagram.com/username or full URL",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"About Me"}),e.jsx("textarea",{value:p.aboutMe,onChange:t=>u(a=>({...a,personal:{...a.personal,aboutMe:t.target.value}})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:p.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ie,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:p.title})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:p.location})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:p.email})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:p.phone})]}),p.github&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ws,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:p.github})]}),p.facebook&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Vs,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-gray-700",children:p.facebook})]}),p.linkedin&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ys,{className:"w-4 h-4 text-blue-700"}),e.jsx("span",{className:"text-gray-700",children:p.linkedin})]}),p.twitter&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xs,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-gray-700",children:p.twitter})]}),p.instagram&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qs,{className:"w-4 h-4 text-pink-600"}),e.jsx("span",{className:"text-gray-700",children:p.instagram})]}),p.aboutMe&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsx("p",{className:"text-gray-700 text-sm",children:p.aboutMe})})]})]}),e.jsxs(Q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5 text-blue-600"}),"Skills"]}),e.jsx(S,{onClick:()=>g(x==="skills"?null:"skills"),variant:"outline",size:"sm",children:x==="skills"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"})})]}),x==="skills"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Add New Skill Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Category name (e.g., Design, Marketing, Languages)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm",onKeyPress:t=>{if(t.key==="Enter"&&t.target.value.trim()){const a=t.target.value.trim().toLowerCase();b[a]||(u(d=>({...d,skills:{...d.skills,[a]:[]}})),t.target.value="")}}}),e.jsxs(S,{onClick:t=>{const a=t.target.previousElementSibling,d=a.value.trim().toLowerCase();d&&!b[d]&&(u(j=>({...j,skills:{...j.skills,[d]:[]}})),a.value="")},variant:"outline",size:"sm",className:"whitespace-nowrap",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add Category"]})]})]}),Object.entries(b).map(([t,a])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",value:t,onChange:d=>{const j=d.target.value.trim().toLowerCase();if(j&&j!==t){const $={...b};$[j]=$[t],delete $[t],u(D=>({...D,skills:$}))}},className:"font-semibold text-gray-800 capitalize bg-transparent border-b border-transparent hover:border-gray-300 focus:border-blue-500 focus:outline-none px-1 py-1",placeholder:"Category name"})}),e.jsx(S,{onClick:()=>{if(Object.keys(b).length>1){const d={...b};delete d[t],u(j=>({...j,skills:d}))}},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",disabled:Object.keys(b).length<=1,children:e.jsx(xe,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"space-y-2",children:[a.map((d,j)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:d,onChange:$=>{const D=[...a];D[j]=$.target.value,u(W=>({...W,skills:{...W.skills,[t]:D}}))},placeholder:"Skill name",className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx(S,{onClick:()=>{const $=a.filter((D,W)=>W!==j);u(D=>({...D,skills:{...D.skills,[t]:$}}))},variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(xe,{className:"w-3 h-3"})})]},j)),e.jsxs(S,{onClick:()=>{const d=[...a,""];u(j=>({...j,skills:{...j.skills,[t]:d}}))},variant:"outline",size:"sm",className:"w-full",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add Skill"]})]})]},t))]}):e.jsx("div",{className:"space-y-4",children:Object.entries(b).map(([t,a])=>e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2 capitalize",children:t}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((d,j)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:d},j))})]},t))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(Q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-blue-600"}),"Professional Experience"]}),e.jsx(S,{onClick:()=>g(x==="experience"?null:"experience"),variant:"outline",size:"sm",children:x==="experience"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"})})]}),x==="experience"?e.jsxs("div",{className:"space-y-4",children:[L.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.position,onChange:d=>N("experience",a,{...t,position:d.target.value}),placeholder:"Job Position",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.company,onChange:d=>N("experience",a,{...t,company:d.target.value}),placeholder:"Company Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.period,onChange:d=>N("experience",a,{...t,period:d.target.value}),placeholder:"Employment Period (e.g., 2020-2023)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("textarea",{value:t.description,onChange:d=>N("experience",a,{...t,description:d.target.value}),placeholder:"Job Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Achievements (one per line)"}),e.jsx("textarea",{value:t.achievements?t.achievements.join(`
`):"",onChange:d=>N("experience",a,{...t,achievements:d.target.value.split(`
`).filter(j=>j.trim())}),placeholder:"List your key achievements...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs(S,{onClick:()=>q("experience",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Remove Experience"]})]},a)),e.jsxs(S,{onClick:()=>P("experience",{position:"",company:"",period:"",description:"",achievements:[]}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add Experience"]})]}):e.jsx("div",{className:"space-y-4",children:L.length>0?L.map((t,a)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.position}),e.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t.period})]}),e.jsx("h4",{className:"text-md font-medium text-blue-600 mb-2",children:t.company}),e.jsx("p",{className:"text-gray-700 mb-3 leading-relaxed",children:t.description}),t.achievements&&t.achievements.length>0&&e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.achievements.map((d,j)=>e.jsx("li",{className:"text-sm text-gray-600",children:d},j))})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No experience added yet."})})]}),e.jsxs(Q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Zs,{className:"w-5 h-5 text-blue-600"}),"Education"]}),e.jsx(S,{onClick:()=>g(x==="education"?null:"education"),variant:"outline",size:"sm",children:x==="education"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"})})]}),x==="education"?e.jsxs("div",{className:"space-y-4",children:[T.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.degree,onChange:d=>N("education",a,{...t,degree:d.target.value}),placeholder:"Degree/Qualification",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.school,onChange:d=>N("education",a,{...t,school:d.target.value}),placeholder:"School/University",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:t.period,onChange:d=>N("education",a,{...t,period:d.target.value}),placeholder:"Study Period (e.g., 2016-2020)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("textarea",{value:t.description,onChange:d=>N("education",a,{...t,description:d.target.value}),placeholder:"Description of your studies",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(S,{onClick:()=>q("education",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Remove Education"]})]},a)),e.jsxs(S,{onClick:()=>P("education",{degree:"",school:"",period:"",description:""}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add Education"]})]}):e.jsx("div",{className:"space-y-4",children:T.length>0?T.map((t,a)=>e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.degree}),e.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t.period})]}),e.jsx("h4",{className:"text-md font-medium text-green-600 mb-1",children:t.school}),e.jsx("p",{className:"text-gray-700 text-sm",children:t.description})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No education added yet."})})]}),e.jsxs(Q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ks,{className:"w-5 h-5 text-blue-600"}),"Certifications"]}),e.jsx(S,{onClick:()=>g(x==="certifications"?null:"certifications"),variant:"outline",size:"sm",children:x==="certifications"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"})})]}),x==="certifications"?e.jsxs("div",{className:"space-y-4",children:[F.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 space-y-2",children:[e.jsx("input",{type:"text",value:t.name,onChange:d=>N("certifications",a,{...t,name:d.target.value}),placeholder:"Certification Name",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx("input",{type:"text",value:t.issuer,onChange:d=>N("certifications",a,{...t,issuer:d.target.value}),placeholder:"Issuing Organization",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx("input",{type:"text",value:t.year,onChange:d=>N("certifications",a,{...t,year:d.target.value}),placeholder:"Year",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsxs(S,{onClick:()=>q("certifications",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Remove"]})]},a)),e.jsxs(S,{onClick:()=>P("certifications",{name:"",issuer:"",year:""}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add Certification"]})]}):e.jsx("div",{className:"space-y-3",children:F.length>0?F.map((t,a)=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-3",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.issuer," • ",t.year]})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No certifications added yet."})})]}),e.jsxs(Q,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5 text-blue-600"}),"Key Projects"]}),e.jsx(S,{onClick:()=>g(x==="projects"?null:"projects"),variant:"outline",size:"sm",children:x==="projects"?e.jsx(ue,{className:"w-4 h-4"}):e.jsx(Ce,{className:"w-4 h-4"})})]}),x==="projects"?e.jsxs("div",{className:"space-y-4",children:[_.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",value:t.name,onChange:d=>N("projects",a,{...t,name:d.target.value}),placeholder:"Project Name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs("select",{value:t.status,onChange:d=>N("projects",a,{...t,status:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"development",children:"Development"}),e.jsx("option",{value:"completed",children:"Completed"})]}),e.jsx("textarea",{value:t.description,onChange:d=>N("projects",a,{...t,description:d.target.value}),placeholder:"Project Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("input",{type:"text",value:Array.isArray(t.tech)?t.tech.join(", "):t.tech,onChange:d=>N("projects",a,{...t,tech:d.target.value.split(",").map(j=>j.trim()).filter(j=>j)}),placeholder:"Technologies (comma-separated)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),e.jsxs(S,{onClick:()=>q("projects",a),variant:"outline",size:"sm",className:"w-full text-red-600 hover:text-red-700",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Remove Project"]})]},a)),e.jsxs(S,{onClick:()=>P("projects",{name:"",status:"development",description:"",tech:[]}),variant:"outline",size:"sm",className:"w-full",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Add Project"]})]}):e.jsx("div",{className:"space-y-4",children:_.length>0?_.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="live"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]}),e.jsx("p",{className:"text-gray-700 mb-3 text-sm leading-relaxed",children:t.description}),t.tech&&Array.isArray(t.tech)&&t.tech.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tech.map((d,j)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:d},j))})]},a)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No projects added yet."})})]})]})]}),e.jsx(Pe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 text-center",children:e.jsx(S,{onClick:y,disabled:c,className:"px-8 py-3 text-lg",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-5 h-5 mr-2"}),"Save All Changes"]})})})]})})},da=()=>{const{t:s}=Ze(),{user:n,logout:c}=js(),r=et(),{liveData:m,lastUpdate:f,isConnected:C,manualRefresh:u,addNotification:x}=st(),[g,A]=l.useState("dashboard"),[E,y]=l.useState(!0),[P,N]=l.useState(null),[q,p]=l.useState(!1),[b,L]=l.useState(""),[T,F]=l.useState(""),[X,_]=l.useState(null),[t,a]=l.useState(!0),[d,j]=l.useState(null),[$,D]=l.useState("all"),[W,ee]=l.useState(!1),[v,O]=l.useState(!1),[k,w]=l.useState(!1),[V,Y]=l.useState(!1),{jobSeekers:re,loading:be,fetchJobSeekers:je}=Ns({autoFetch:!1,itemsPerPage:5}),{requests:ne,loading:ce,fetchRequests:oe}=ws({autoFetch:!1}),{fetchCategories:ae}=at({autoFetch:!1}),h=async(H=0)=>{try{a(!0),j(null),console.log(`🔄 Loading dashboard data sequentially... (attempt ${H+1})`);try{ee(!0),console.log("📊 Loading dashboard statistics...");const Z=await Se.getDashboardStats();Z.success?(_(Z.data),console.log("✅ Dashboard statistics loaded")):console.warn("⚠️ Failed to load dashboard statistics")}catch(Z){console.error("❌ Error loading dashboard statistics:",Z)}finally{ee(!1)}try{O(!0),console.log("👥 Loading job seekers data..."),await je(),console.log("✅ Job seekers data loaded")}catch(Z){console.error("❌ Error loading job seekers:",Z)}finally{O(!1)}try{w(!0),console.log("📝 Loading employer requests..."),await oe(),console.log("✅ Employer requests loaded")}catch(Z){console.error("❌ Error loading employer requests:",Z)}finally{w(!1)}try{Y(!0),console.log("🏷️ Loading job categories..."),await ae(),console.log("✅ Job categories loaded")}catch(Z){console.error("❌ Error loading job categories:",Z)}finally{Y(!1)}console.log("✅ Dashboard data loading completed")}catch(Z){if(console.error("❌ Critical error in dashboard loading:",Z),H<2){console.log(`🔄 Retrying dashboard load... (${H+1}/2)`),setTimeout(()=>{h(H+1)},2e3*(H+1));return}j("Failed to load dashboard data after multiple attempts. Please refresh the page."),x({message:"Dashboard failed to load. Please refresh.",type:"error",duration:1e4})}finally{a(!1)}},i=async()=>{try{a(!0),await h(),x({message:"Dashboard refreshed successfully",type:"success",duration:3e3})}catch{j("Failed to refresh dashboard data"),x({message:"Failed to refresh dashboard",type:"error",duration:5e3})}finally{a(!1)}};l.useEffect(()=>{m.dashboard&&_(m.dashboard),m.requests,m.jobSeekers},[m]);const o=()=>{c(),r("/")},R=H=>{N(H),L(H.adminNotes||""),p(!0)},M=async(H,G,Z)=>{try{const fe=await Se.updateRequestStatus(H,{status:G,adminNotes:Z});fe.success?(await oe(),p(!1),N(null),L(""),x({message:`Request ${G==="completed"?"marked as completed":"status updated"} successfully!`,type:"success",duration:5e3})):x({message:`Error: ${fe.error}`,type:"error",duration:5e3})}catch(fe){x({message:"Failed to update request status",type:"error",duration:5e3}),console.error("Request update error:",fe)}},U=H=>{F(H)},de=()=>{};if(l.useEffect(()=>{h()},[]),t)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(ge,{size:"lg",text:"Loading Dashboard..."})});if(d)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Dashboard Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:d}),e.jsx(S,{onClick:h,className:"w-full",children:"Retry"})]})});const le=()=>{const H=X||{},G=H.data||H,Z=J=>{if(!Array.isArray(J))return[];const se={};return J.forEach(I=>{I.profile?.skills&&I.profile.skills.split(",").map(ie=>ie.trim()).forEach(ie=>{se[ie]=(se[ie]||0)+1})}),Object.entries(se).map(([I,te])=>({name:I,count:te})).sort((I,te)=>te.count-I.count).slice(0,5)},fe=(J,se=0)=>{if(se===0)return J>0?{change:"+100%",changeType:"increase"}:{change:"0%",changeType:"neutral"};const I=(J-se)/se*100,te=I>=0?`+${Math.round(I)}%`:`${Math.round(I)}%`,ie=I>0?"increase":I<0?"decrease":"neutral";return{change:te,changeType:ie}},es=(J,se=7)=>{const I=new Date,te=new Date(I.getTime()-se*24*60*60*1e3),ie=new Date(I.getTime()-se*2*24*60*60*1e3),Ge=J.filter(We=>new Date(We.createdAt)>=te).length,ye=J.filter(We=>{const ls=new Date(We.createdAt);return ls>=ie&&ls<te}).length;return fe(Ge,ye)},ss=es(re||[]),ts=es(ne||[]),as=fe((ne||[]).filter(J=>J.status==="pending").length,Math.max(1,Math.floor((ne||[]).filter(J=>J.status==="pending").length*.8))),rs=fe(G.overview?.totalCategories||G.totalCategories||0,Math.max(1,Math.floor((G.overview?.totalCategories||G.totalCategories||0)*.9)));return Z(re||[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:i,disabled:t,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})}),e.jsx(xt,{isConnected:C,lastUpdate:f,onRefresh:u,className:"text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 ",children:[e.jsx(Be,{title:"Total Job Seekers",value:G.overview?.totalJobSeekers||G.totalJobSeekers||0,icon:Je,change:ss.change,changeType:ss.changeType,color:"text-blue-600",bgColor:"bg-blue-100",description:"Active job seekers",index:0,trendPeriod:"7 days",loading:W}),e.jsx(Be,{title:"Employer Requests",value:G.overview?.totalEmployerRequests||G.totalEmployerRequests||0,icon:Re,change:ts.change,changeType:ts.changeType,color:"text-green-600",bgColor:"bg-green-100",description:"Total requests",index:1,trendPeriod:"7 days",loading:k}),e.jsx(Be,{title:"Pending Requests",value:G.overview?.pendingEmployerRequests||G.pendingEmployerRequests||0,icon:ze,change:as.change,changeType:as.changeType,color:"text-orange-600",bgColor:"bg-orange-100",description:"Awaiting review",index:2,trendPeriod:"7 days",loading:k}),e.jsx(Be,{title:"Categories",value:G.overview?.totalCategories||G.totalCategories||0,icon:Ie,change:rs.change,changeType:rs.changeType,color:"text-purple-600",bgColor:"bg-purple-100",description:"Job categories",index:3,showTrend:!1,loading:V})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Q,{title:"Latest Job Seekers",subtitle:"Most recently registered candidates (showing latest 5)",children:be?e.jsx(ge,{size:"md",text:"Loading job seekers..."}):(G.recentActivity?.recentJobSeekers||re||[]).length>0?e.jsx("div",{className:"space-y-3",children:(G.recentActivity?.recentJobSeekers||re||[]).slice(0,5).map((J,se)=>{const I=(re||[]).find(ye=>ye.id===J.id)||J,te=I?.profile?.photo||I?.avatar||I?.photo||null,Ge=(ye=>ye?/^https?:\/\//i.test(ye)?ye:`${me.BASE_URL}/${ye.replace(/^\//,"")}`:null)(te);return e.jsx(ht,{jobSeeker:{id:J.id,name:J.name||`${J?.profile?.firstName||""} ${J?.profile?.lastName||""}`.trim()||"Unknown",title:"Job Seeker",category:J.skills?.split(",")[0]||"General",avatar:Ge,location:J.location||J?.profile?.location||"Unknown",dailyRate:J.dailyRate,monthlyRate:J.monthlyRate},onViewDetails:R,getCategoryColor:lt,compact:!0},J.id||se)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Je,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent job seekers"})]})}),e.jsxs(Q,{title:"Latest Employer Requests",subtitle:"Most recent job requests with candidate details (showing latest 5)",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx("button",{onClick:()=>D("all"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${$==="all"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>D("pending"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${$==="pending"?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Pending"}),e.jsx("button",{onClick:()=>D("in_progress"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${$==="in_progress"?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"In Progress"}),e.jsx("button",{onClick:()=>D("approved"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${$==="approved"?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Approved"}),e.jsx("button",{onClick:()=>D("completed"),className:`px-2 py-1 text-xs font-medium rounded-full border transition-colors ${$==="completed"?"bg-purple-100 text-purple-800 border-purple-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"}`,children:"Completed"})]})}),ce?e.jsx(ge,{size:"md",text:"Loading requests..."}):(ne||[]).length>0?e.jsx("div",{className:"space-y-3",children:(()=>{const se=(ne||[]).filter(I=>{if($==="all")return!0;const te=I.status?.toLowerCase()||"pending",ie=$.toLowerCase();return te===ie}).slice(0,5);return se.length===0&&$!=="all"?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(Re,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),e.jsxs("p",{className:"text-sm",children:["No ",$," requests found"]})]}):se.map((I,te)=>e.jsx(gt,{request:{...I,companyName:I.companyName||"Individual Employer",status:I.status||"pending",priority:I.priority||"normal",selectedUser:I.selectedUser||null,requestedCandidate:I.requestedCandidate||null},onContactEmployer:it,onViewDetails:R,getStatusColor:ot,getPriorityColor:nt,compact:!0},I.id||te))})()}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Re,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No recent requests"})]})]})]})]})},He=()=>{switch(g){case"dashboard":return le();case"job-seekers":return e.jsx(ct,{});case"requests":return e.jsx(rt,{});case"contact-messages":return e.jsx(Tt,{});case"categories":return e.jsx(mt,{});case"reports-statistics":return e.jsx(dt,{});case"reports-tables":return e.jsx(qt,{});case"settings":return e.jsx(zt,{});case"payment-methods":return e.jsx(It,{});case"profile":return e.jsx(Ut,{});default:return le()}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(vt,{user:n,onLogout:o,onSearch:U,onFilter:de,searchTerm:T,onRefresh:i}),e.jsxs("div",{className:"flex",children:[e.jsx(jt,{sidebarOpen:E,setSidebarOpen:y,navigationItems:[{id:"dashboard",label:"Dashboard",icon:"Home"},{id:"job-seekers",label:"Job Seekers",icon:"Users"},{id:"requests",label:"Employer Requests",icon:"MessageSquare"},{id:"contact-messages",label:"Contact Messages",icon:"Mail"},{id:"categories",label:"Categories",icon:"Briefcase"},{id:"reports",label:"Reports",icon:"BarChart3",subItems:[{id:"reports-statistics",label:"Statistics Reports"},{id:"reports-tables",label:"Table Reports"}]},{id:"settings",label:"Settings",icon:"Settings"},{id:"payment-methods",label:"Payment Methods",icon:"CreditCard"},{id:"profile",label:"Profile",icon:"Shield"}],activeTab:g,setActiveTab:A,user:n,onLogout:o}),e.jsx("div",{className:"flex-1 transition-all duration-300 ml-0",children:e.jsx("div",{className:"p-4 lg:p-6",children:He()})})]}),q&&P&&e.jsx(De,{isOpen:q,onClose:()=>p(!1),title:"Update Request Status",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:P.status,onChange:H=>N({...P,status:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes"}),e.jsx("textarea",{value:b,onChange:H=>L(H.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Add notes about this request..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{onClick:()=>p(!1),variant:"outline",children:"Cancel"}),e.jsx(S,{onClick:()=>M(P.id,P.status,b),className:"bg-red-600 hover:bg-red-700",children:"Update Status"})]})]})})]})};export{da as default};
